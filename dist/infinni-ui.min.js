!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.editMask=t():e.editMask=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=77)}([function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),r=n(34),a=n(27),l=function(e){function t(t,n,i,o){var r=e.call(this,t,n,i,o)||this;return r.width=o.width,r}return i(t,e),t.prototype.getIsComplete=function(){return this.getIsValid()},t.prototype.getIsValid=function(){var e=this.getText(),t=e.replace(/[^\d]/g,"");return parseInt(t,10)>=this.min&&t.length===this.width},t.prototype.updateText=function(){var e=this.text||"",t=e.replace(/[^\d]/g,"");e=this.getIsEmpty()?o.padEnd(t,this.width,this.getBlank()):this.isActive?o.padEnd(t,this.width,this.getBlank()):this.formatDecimal(t),this.setText(e)},t.prototype.getInputRegexp=function(){return new RegExp("^[\\d]{1,"+this.width+"}")},t.prototype.finalizeInput=function(){var e=!1;if(this.getIsComplete()){var t=this.getText(),n=t.replace(/[^\d]/g,"");n.length<this.width&&(this.setText(this.formatDecimal(n)),e=!0)}return e},t.prototype.formatDecimal=function(e){return r.padStart(e,this.width,"0")},t}(a.DecimalPattern);t.FixedWidthPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=function(e){function t(t,n,i){var o=e.call(this,t,n)||this;return o.isRequired=!1,o.isRequired=i,o}return i(t,e),t.prototype.getIsRequired=function(){return this.isRequired},t.prototype.getIsComplete=function(){return!this.getIsEmpty()},t.prototype.getIsEmpty=function(){var e=this.text;return null===e||void 0===e||""===e||0===e.length||0===this.cleanBlank(e).length},t.prototype.cleanBlank=function(t){return e.prototype.cleanBlank.call(this,t).replace(/\s/g,"")},t.prototype.updateText=function(){var e;e=this.getIsEmpty()?this.getBlank():this.cleanBlank(this.text).substr(0,1),this.setText(e)},t.prototype.setInput=function(e,t){var n=null;e=this.trimBlank(e);var i=e.substr(0,1);return this.validateInput(i)?(this.setText(i),n=i,e=e.substr(i.length)):this.getIsRequired()&&0!==i.length||(n="",this.setText(n)),t&&t(e,n),e},t.prototype.applyValue=function(e){var t=e;t===this.getBlank()?this.setText(""):this.validateInput(t)&&this.setText(t)},t.prototype.getIsValid=function(){return!this.getIsRequired()||!this.getIsEmpty()},t}(o.Pattern);t.TemplatePattern=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(27),r=n(6),a=function(e){function t(t,n,i,o){var r=e.call(this,t,n,i,o)||this;return r.minWidth=o.minWidth,r.maxWidth=o.maxWidth,r}return i(t,e),t.prototype.updateText=function(){var e=this.text||"",t=e.replace(/[^\d]/g,"");e=this.getIsEmpty()?r.padEnd("",this.minWidth,this.getBlank()):this.isActive?r.padEnd(t,this.minWidth,this.getBlank()):r.padEnd(t.replace(/^0+/,"0"),this.minWidth,this.getBlank()),this.setText(e)},t.prototype.getInputRegexp=function(){return/^\d+/},t}(o.DecimalPattern);t.FloatWidthPattern=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="_",o=function(){function e(e,t,n){this.locale=e,this.template=t,this.name=n,this.isActive=!1,this.isEditable=!0,this.blank=i}return e.prototype.setBlank=function(e){this.blank=e||i},e.prototype.getBlank=function(){return this.blank},e.prototype.getName=function(){return this.name},e.prototype.canActivate=function(){return!0},e.prototype.setIsActive=function(e){this.canActivate()||(e=!1),this.isActive=e},e.prototype.getNextInput=function(){return this.getText()},e.prototype.getPrevInput=function(){return this.getText()},e.prototype.getText=function(){return null!==this.text&&void 0!==this.text||this.updateText(),this.text},e.prototype.canInputChar=function(e){return!0},e.prototype.setText=function(e){var t=this.isEqualText(e,this.text);return this.text=e,t},e.prototype.isEqualText=function(e,t){return e===t},e.prototype.trimBlankLeft=function(e){for(var t=this.getBlank();0===e.indexOf(t);)e=e.substring(t.length);return e},e.prototype.trimBlankRight=function(e){for(var t=this.getBlank();e.lastIndexOf(t)===e.length-1;)e=e.substring(0,t.length-1);return e},e.prototype.cleanBlank=function(e){for(var t=this.getBlank();-1!==e.indexOf(t);)e=e.replace(t,"");return e},e.prototype.trimBlank=function(e){for(var t=this.getBlank();e.substr(0,1)===t;)e=e.substr(1);for(;e.substr(e.length-1)===t;)e=e.substr(0,e.length-1);return e},e.prototype.finalizeInput=function(){return!1},e.prototype.getValue=function(){},e}();t.Pattern=o},function(e,t,n){"use strict";function i(e){var t=e.replace(/[^\d]/g,"");return parseInt(t,10)>2}Object.defineProperty(t,"__esModule",{value:!0}),t.isCompleteHours=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(34),o=n(6),r=n(17),a=function(){function e(e){this.locale=e}return e.prototype.getDecimalSeparator=function(){return this.locale.numberDecimalSeparator},e.prototype.getNegativePattern=function(){return this.locale.numberNegativePattern},e.prototype.getPositivePattern=function(){return this.locale.numberPositivePattern},e.prototype.getGroupSeparator=function(){return this.locale.numberGroupSeparator},e.prototype.getGroupSize=function(){return this.locale.numberGroupSize},e.prototype.formatEmpty=function(e){var t=e.blank,n=[i.padStart("",1,t)];e.decimalDigits>0&&n.push(i.padStart("",e.decimalDigits,t));var o=n.join(this.getDecimalSeparator());return this.wrapSignPattern(o,e)},e.prototype.format=function(e,t){var n=[],i=this.splitNumberByParts(e),r=i.integral,a=i.fractional;n.push(this.formatGroup(r)),t.decimalDigits>0&&(a=o.padEnd(a||"",t.decimalDigits,"0"),n.push(a.substr(0,t.decimalDigits)));var l=n.join(this.getDecimalSeparator());return this.wrapSignPattern(l,t)},e.prototype.formatValue=function(e,t){if(r.isEmpty(e))return this.formatEmpty(t);var n=e.toFixed(t.decimalDigits).split(".").join(this.getDecimalSeparator());return this.format(n,t)},e.prototype.formatInput=function(e,t){var n=[],r=this.splitNumberByParts(e),a=r.integral,l=r.fractional,s=t.decimalDigits;a.length>0?n.push(this.formatGroup(a)):n.push(i.padStart("",1,t.blank)),t.decimalDigits>0&&(l=l||"",n.push(o.padEnd(l.substr(0,s),s,"0")));var u=n.join(this.getDecimalSeparator());return this.wrapSignPattern(u,t)},e.prototype.getPattern=function(e){return e?this.getNegativePattern():this.getPositivePattern()},e.prototype.getWrapper=function(e){return this.getPattern(e.isNegative).split(/n/i)},e.prototype.wrapSignPattern=function(e,t){return this.getWrapper(t).join(e)},e.prototype.splitNumberByParts=function(e){var t=e.split(this.getDecimalSeparator()).map(function(e){return e.replace(/[^\d]/g,"")});return{integral:t[0],fractional:t[1]}},e.prototype.formatGroup=function(e){for(var t=[],n=this.getGroupSize(),i=this.getGroupSeparator(),o=e;o.length>0;o=o.substr(0,o.length-n))t.push(o.substr(-n));return t.reverse().join(i)},e}();t.NumberFormatter=a},function(e,t,n){"use strict";function i(e,t,n){return n=n||" ",e.length>t?e:(t-=e.length,t>n.length&&(n+=n.repeat(t/n.length)),e+n.slice(0,t))}Object.defineProperty(t,"__esModule",{value:!0}),t.padEnd=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.el=e,this.mask=t,this.subscribeToElementEvents(),this.updateInputElement()}return e.prototype.getValue=function(){return this.mask.getValue()},e.prototype.setValue=function(e){this.mask.setValue(e),this.updateInputElement()},e.prototype.onChangeValue=function(e){this.mask.onChangeValue(e)},e.prototype.onInvalidValue=function(e){this.mask.onInvalidValue(e)},e.prototype.setCursorPosition=function(e,t){var n=this;t=t||e,this.el.setSelectionRange(e,t),setTimeout(function(){n.el&&n.el.setSelectionRange(e,t)},4)},e.prototype.selectAll=function(){this.el.setSelectionRange(0,this.el.value.length)},e.prototype.subscribeToElementEvents=function(){this.el.addEventListener("keydown",this),this.el.addEventListener("input",this),this.el.addEventListener("focus",this),this.el.addEventListener("blur",this)},e.prototype.unsubscribeToElementEvents=function(){this.el.removeEventListener("keydown",this),this.el.removeEventListener("input",this),this.el.removeEventListener("focus",this),this.el.removeEventListener("blur",this)},e.prototype.destroy=function(){this.unsubscribeToElementEvents(),this.mask.dispose(),this.mask=null,this.el=null},e.prototype.handleEvent=function(e){switch(e.type){case"keydown":this.onKeydownHandler(e);break;case"input":this.onInputHandler();break;case"focus":this.onFocusHandler();break;case"blur":this.onBlurHandler()}},e.prototype.onBlurHandler=function(){this.mask.updateDisplay(),this.updateInputElement()},e.prototype.onFocusHandler=function(){if(this.mask.getIsEmpty()){var e=this.el.selectionStart,t=this.mask.getInputPosition(e);this.updateInputElement(t)}},e.prototype.onInputHandler=function(){var e=this.el.selectionStart,t=this.el.value,n=this.mask.setInput(t,e);this.updateInputElement(n)},e.prototype.onKeydownHandler=function(e){if(!(e.altKey||e.ctrlKey||e.shiftKey)){var t,n=this.el.selectionStart;switch(e.key){case"ArrowUp":e.preventDefault(),t=this.mask.setNextPatternValue(n),t&&this.updateInputElement(t.start,t.end);break;case"ArrowDown":e.preventDefault(),t=this.mask.setPrevPatternValue(n),t&&this.updateInputElement(t.start,t.end)}}},e.prototype.updateInputElement=function(e,t){this.el.value=this.mask.getText(),void 0!==e&&null!==e?(t=t||e,this.mask.getInvalid()?this.selectAll():this.setCursorPosition(e,t)):this.mask.getInvalid()&&this.selectAll()},e}();t.Editor=i},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=function(e){function t(t,n,i){var o=e.call(this,t,n,"number")||this;return o.isNegative=!1,o.decimalDigits=i,o}return i(t,e),t.prototype.setIsNegative=function(e){this.isNegative=e},t.prototype.getIsNegative=function(){return this.isNegative},t.prototype.toggleSign=function(){this.isNegative=!this.isNegative},t.prototype.getIsEmpty=function(){var e;return e=null===this.text||void 0===this.text||0===this.text.replace(/[^\d]/g,"").length},t.prototype.getIsComplete=function(){return this.parser.isComplete(this.getText(),this.decimalDigits)},t.prototype.getIsValid=function(){return this.parser.isComplete(this.getText(),this.decimalDigits)},t.prototype.applyValue=function(e){this.setIsNegative(e<0);var t="";null!==e&&void 0!==e&&isFinite(e)&&!isNaN(e)&&(e=Math.abs(e),t=this.formatter.formatValue(e,{decimalDigits:this.decimalDigits,isNegative:this.getIsNegative(),blank:this.getBlank()})),this.setText(t)},t.prototype.getNextInput=function(){var e,t=this.getText(),n=this.parser.parse(t,{decimalDigits:this.decimalDigits,isNegative:this.getIsNegative()},0),i=parseInt(n.integralPart.replace(/[^\d]/g,""),10);return isFinite(i)&&!isNaN(i)?(i++,e=i.toString(10)+n.separatorPart+n.fractionalPart):e="0"+n.separatorPart+n.fractionalPart,e},t.prototype.getPrevInput=function(){var e,t=this.getText(),n=this.parser.parse(t,{decimalDigits:this.decimalDigits,isNegative:this.getIsNegative()},0),i=parseInt(n.integralPart.replace(/[^\d]/g,""),10);return isFinite(i)&&!isNaN(i)?(i--,e=i.toString(10)+n.separatorPart+n.fractionalPart):e="0"+n.separatorPart+n.fractionalPart,e},t.prototype.updateText=function(){var e,t=this.text||"",n={decimalDigits:this.decimalDigits,blank:this.getBlank(),isNegative:this.getIsNegative()};e=this.getIsEmpty()?this.formatter.formatEmpty(n):this.isActive?this.formatter.formatInput(t,n):this.formatter.format(t,n),this.setText(e)},t.prototype.setInput=function(e,t){for(var n=null,i=this.getBlank();0===e.indexOf(i);)e=e.substring(i.length);var o=this.parser.parse(e,{isNegative:this.getIsNegative(),decimalDigits:this.decimalDigits},0);return n=0===o.input.length?"":o.integralPart+o.separatorPart+o.fractionalPart,null!==n&&this.setText(n),t&&t(e,n),e},t.prototype.getValue=function(){var e=this.getText(),t=this.parser.parse(e,{decimalDigits:this.decimalDigits,isNegative:this.getIsNegative()},0),n=t.integralPart.replace(/[^\d]/g,""),i=t.fractionalPart.replace(/[^\d]/g,""),o=[n,i||"0"].join("."),r=+o;return isFinite(r)&&!isNaN(r)&&this.getIsNegative()&&(r=-r),r},t}(o.Pattern);t.BaseNumberPattern=r},function(e,t,n){"use strict";function i(e,t){return new o.StaticPattern(t,e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(29);t.buildStaticPattern=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(73),o=n(76),r=n(35),a=n(32),l=n(30),s=function(){function e(e){var t=this;this.locale=e,this.patterns=new i.PatternsList,this.invalid=!1,this.value=new o.ValueModel,this.eventEmitter=new a.EventEmitter,this.value.onChange(function(e,n){return t.onChangeValueHandler(n)})}return e.prototype.setPatterns=function(e){this.patterns.setList(e)},e.prototype.getInvalid=function(){return this.invalid},e.prototype.getIsEmpty=function(){return this.patterns.getIsEmpty()},e.prototype.onChangeValue=function(e){return this.value.onChange(function(t,n){return e.call(null,n)})},e.prototype.onInvalidValue=function(e){return this.eventEmitter.on(l.OutOfRangeEvent.eventName,e)},e.prototype.onChangeValueHandler=function(e){this.updateInvalid(),void 0!==e.newValue&&(this.lastValue=e.newValue,e.params.update&&this.applyValue(e.newValue))},e.prototype.applyValue=function(e){this.patterns.getList().map(function(t,n){return t.applyValue(e)}),this.patterns.updateText()},e.prototype.getText=function(){return this.getInvalid()?this.getInvalidText():this.patterns.getText()},e.prototype.setNextPatternValue=function(e){var t=this.patterns.setNextPatternValue(e);return this.updateValue(),t},e.prototype.setPrevPatternValue=function(e){var t=this.patterns.setPrevPatternValue(e);return this.updateValue(),t},e.prototype.setInput=function(e,t){var n=this.patterns.setInput(e,t),i=this.getText();this.patterns.updateText();var o=this.restorePosition(i,n);return this.updateValue(),o},e.prototype.setValue=function(e){this.value.setValue(e,{update:!0})},e.prototype.getValue=function(){return this.value.getValue()},e.prototype.getInputPosition=function(e){return this.patterns.getInputPosition(e)},e.prototype.handleKey=function(e,t){return null},e.prototype.restorePosition=function(e,t){return r.restorePosition(e,this.getText(),t)},e.prototype.updateDisplay=function(){return this.patterns.updateDisplay(),this},e.prototype.updateValue=function(){if(this.patterns.getIsValid()){var e=this.buildValue();this.validate(e)&&this.value.setValue(this.buildValue())}else this.value.setValue(void 0)},e.prototype.updateInvalid=function(){},e.prototype.getInvalidText=function(){return"Error"},e.prototype.setInvalid=function(e){this.invalid=e},e.prototype.validate=function(e){return!0},e.prototype.dispose=function(){this.patterns.dispose(),this.lastValue=null,this.value.dispose(),this.eventEmitter.dispose()},e}();t.Mask=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.patternsBuilder=this.initPatternsBuilder()}return e.prototype.build=function(e,t){var n=this.createMask(t),i=this.patternsBuilder.build(e,t);return n.setPatterns(i),n},e}();t.MaskBuilder=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.defaultPatternBuilder=e,this.registeredPatterns=[]}return e.prototype.registerPattern=function(e,t){return this.registeredPatterns.push({patternSelector:e,patternBuilder:t}),this},e.prototype.build=function(e,t){var n=this,i=[e];return this.registeredPatterns.forEach(function(e){var n=0;do{var o=i[n];if("string"==typeof o&&o.length>0){var r=e.patternSelector.match(o);if(null!==r){var a=[o.substring(0,r.start),e.patternBuilder(r.text,t),o.substr(r.end)];i.splice.apply(i,[n,1].concat(a)),n++}}n++}while(n<i.length)}),this.defaultPatternBuilder&&i.forEach(function(e,o){"string"==typeof e&&e.length>0&&(i[o]=n.defaultPatternBuilder(e,t))}),i=i.filter(function(e){return"string"!=typeof e})},e}();t.PatternsBuilder=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.locale=e}return e.prototype.parse=function(e,t,n){void 0===n&&(n=0);var i=e.substr(n);return t.decimalDigits>0?this.parseFloatNumber(i,t):this.parseIntegerNumber(i,t)},e.prototype.isComplete=function(e,t){var n,i=this.getDecimalSeparator();if(0===t)n=e.replace(/[^\d]/g,"").length>0;else{var o=e.split(i).map(function(e){return e.replace(/[^\d]/g,"")}),r=o[0];o[1],n=r.length>0}return n},e.prototype.parseFloatNumber=function(e,t){var n={separatorPart:"",integralPart:"",fractionalPart:"",input:e},i=this.run(e,[this.integralPartParser,this.decimalSeparatorParser,this.fractionalPartParser],t);return n.integralPart=i[0],n.separatorPart=i[1],n.fractionalPart=i[2],n.input=i.join(""),n},e.prototype.parseIntegerNumber=function(e,t){var n={integralPart:"",fractionalPart:"",input:e},i=this.run(e,[this.integralPartParser],t);return n.integralPart=i[0],n.input=i.join(""),n},e.prototype.run=function(e,t,n){for(var i=t.map(function(e){return""}),o=0,r=0;o<t.length;o+=1){var a=t[o].parse(e,r,n);if(null===a)break;r=a.end,i[o]=a.text||""}return i},e}();t.BaseNumberParser=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.decimalSeparator=e}return e.prototype.parse=function(e,t,n){var i=this.decimalSeparator,o=null;return e.indexOf(i,t)===t&&(o={text:i,start:t,end:t+i.length}),o},e}();t.DecimalSeparatorParser=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.parse=function(e,t,n){var i=new RegExp("[\\d]{1,"+n.decimalDigits+"}"),o=null,r=e.substr(t).match(i);return r&&(o={text:r[0],start:t+r.index,end:t+r.index+r[0].length}),o},e}();t.FractionalPartParser=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.groupSeparator=e,this.decimalSeparator=t}return e.prototype.parse=function(e,t,n){for(var i=t,o=/\d/,r="",a=this.groupSeparator;i<e.length;)if(e.indexOf(a,i)===i)r+=a,i+=a.length;else if(e[i].match(o))r+=e[i],i+=1;else{if(e.indexOf(this.decimalSeparator,i)===i)break;i++}return{text:r,start:i-r.length,end:i}},e}();t.IntegralPartParser=i},function(e,t,n){"use strict";function i(e){return void 0===e||null===e}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=i},function(e,t,n){"use strict";function i(e){var t;return t=null===e||void 0===e?"":new Date(e).getUTCDate().toString()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDay=i},function(e,t,n){"use strict";function i(e){var t;return t=null===e||void 0===e?"":new Date(e).getUTCHours().toString()}Object.defineProperty(t,"__esModule",{value:!0}),t.getHours=i},function(e,t,n){"use strict";function i(e){var t;if(null===e||void 0===e)t="";else{var n=new Date(e).getUTCHours();t=0===n?"12":n<13?n.toString():(n-12).toString()}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getHours12=i},function(e,t,n){"use strict";function i(e){var t;return t=null===e||void 0===e?"":(new Date(e).getUTCMonth()+1).toString()}Object.defineProperty(t,"__esModule",{value:!0}),t.getMonth=i},function(e,t,n){"use strict";function i(e){var t=e.replace(/[^\d]/g,"");return parseInt(t,10)>3}Object.defineProperty(t,"__esModule",{value:!0}),t.isCompleteDay=i},function(e,t,n){"use strict";function i(e){var t=e.replace(/[^\d]/g,"");return parseInt(t,10)>=6}Object.defineProperty(t,"__esModule",{value:!0}),t.isCompleteMinutes=i},function(e,t,n){"use strict";function i(e){var t=e.replace(/[^\d]/g,"");return parseInt(t,10)>=2}Object.defineProperty(t,"__esModule",{value:!0}),t.isCompleteMonth=i},function(e,t,n){"use strict";function i(e){var t=e.replace(/[^\d]/g,"");return parseInt(t,10)>=6}Object.defineProperty(t,"__esModule",{value:!0}),t.isCompleteSeconds=i},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),r=n(85),a=n(81),l=function(e){function t(t,n,i){var o=e.call(this,t,n,i)||this;return o.parser=new r.PercentParser(t),o.formatter=new a.PercentFormatter(t),o}return i(t,e),t}(o.BaseNumberPattern);t.PercentPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=function(e){function t(t,n,i,o){var r=e.call(this,t,n,i)||this;return r.min=o.min,r.max=o.max,r}return i(t,e),t.prototype.getIsEmpty=function(){var e;return e=null===this.text||void 0===this.text||0===this.text.replace(/[^\d]/g,"").length},t.prototype.getIsValid=function(){var e=this.getText(),t=e.replace(/[^\d]/g,""),n=parseInt(t,10);return n>=this.min&&n<=this.max},t.prototype.getNextInput=function(){var e;if(this.getIsEmpty())e=this.min.toString(10);else{var t=this.getText(),n=parseInt(t.replace(/[^\d]/g,""),10);e=n<this.max?""+ ++n:t}return e},t.prototype.getPrevInput=function(){var e;if(this.getIsEmpty())e=this.min.toString(10);else{var t=this.getText(),n=parseInt(t.replace(/[^\d]/g,""),10);e=n>this.min?""+--n:t}return e},t.prototype.canInputChar=function(e){return/\d/.test(e)},t.prototype.setInput=function(e,t){var n=this,i=null;e=this.trimBlankLeft(e);var o=e.match(this.getInputRegexp());if(0===e.length)i="";else if(o){var r=o[0],a=r.split("").map(function(e,t,n){return n.slice(0,t+1).join("")}).filter(function(e){return parseInt(e,10)<=n.max}).pop();a.length&&(i=a,e=e.substring(o.index+a.length))}return null!==i&&this.setText(i),t&&t(e,i),e},t.prototype.getValue=function(){var e=this.text||"",t=e.replace(/[^\d]/g,"");return 0===t.length?null:parseInt(t,10)},t}(o.Pattern);t.DecimalPattern=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(6),a=function(e){function t(t,n,i,o){var r=e.call(this,t,n,i)||this;return r.list=o,r.minWidth=o.map(function(e){return e.length}).sort()[0],r}return i(t,e),t.prototype.getIsEmpty=function(){var e,t=this.text;if(null===t||void 0===t)e=!0;else{for(var n=this.getBlank();-1!==t.indexOf(n);)t=t.replace(n,"");e=0===t.length}return e},t.prototype.getNextInput=function(){var e=this.getText(),t=e,n=this.list.map(function(e){return e.toUpperCase()}).indexOf(e.toUpperCase());return-1===n?t=this.list[0]:n+1<this.list.length&&(t=this.list[n+1]),t},t.prototype.getPrevInput=function(){var e=this.getText(),t=e,n=this.list.map(function(e){return e.toUpperCase()}).indexOf(e.toUpperCase());return-1===n?t=this.list[0]:n-1>=0&&(t=this.list[n-1]),t},t.prototype.getIsValid=function(){var e=this.getText().toUpperCase();return this.list.map(function(e){return e.toUpperCase()}).some(function(t){return t===e})},t.prototype.getIsComplete=function(){return this.getIsValid()},t.prototype.updateText=function(){var e=this.text||"",t=this.minWidth;if(!this.getIsEmpty()){var n=e.toUpperCase(),i=this.list.map(function(e){return e.toUpperCase()}).filter(function(e){return-1!==e.indexOf(n)}).sort(function(e,t){return e.length-t.length}).pop();void 0!==i&&(t=i.length)}e=r.padEnd(e,t,this.getBlank()),this.setText(e)},t.prototype.setInput=function(e,t){var n=null;if(0===e.length)n="";else{for(var i=this.list.map(function(e){return e.toUpperCase()}).sort(function(e,t){return e.length-t.length}),o=Math.max.apply(Math,i.map(function(e){return e.length})),r=[],a=1;a<=Math.min(o,e.length);a+=1)!function(t){var n=e.substr(0,t);i.some(function(e){return e.substr(0,t)===n.toUpperCase()})&&r.push(n)}(a);var l=r.sort(function(e,t){return e.length-t.length}).map(function(e){return e.length}).pop();void 0===l?n="":(n=e.substr(0,l),e=e.substr(l+1))}return null!==n&&this.setText(n),t&&t(e,n),e},t.prototype.getValue=function(){var e=this.list.map(function(e){return e.toUpperCase()}).indexOf(this.getText().toUpperCase());return-1===e?null:e},t.prototype.finalizeInput=function(){var e=!1,t=this.getText().toUpperCase(),n=this.list.filter(function(e){return 0===e.toUpperCase().indexOf(t)});return 1===n.length&&(this.setText(n[0]),e=!0),e},t}(o.Pattern);t.ListPattern=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getIsComplete=function(){return!0},t.prototype.getIsValid=function(){return!0},t.prototype.applyValue=function(e){},t.prototype.getIsEmpty=function(){return!0},t.prototype.setInput=function(e,t){var n=this.getText(),i="",o=e.indexOf(n);return-1!==o&&(i=n,e=e.substring(0,o)+e.substring(o+n.length)),t&&t(e,i),e},t.prototype.updateText=function(){this.text=this.template},t.prototype.canActivate=function(){return!1},t}(o.Pattern);t.StaticPattern=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.value=e}return e}();i.eventName="OutOfRangeEvent",t.OutOfRangeEvent=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.text=e}return e.prototype.match=function(e){var t=null,n=e.indexOf(this.text);return-1!==n&&(t={text:this.text,start:n,end:n+this.text.length}),t},e}();t.StringSelector=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.handlers={}}return e.prototype.on=function(e,t){var n=this.handlers[e];return n||(this.handlers[e]=n=[]),-1===n.indexOf(t)&&n.push(t),function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}},e.prototype.dispose=function(){var e=this;Object.keys(this.handlers).forEach(function(t){return delete e.handlers[t]})},e.prototype.emit=function(e,t){var n=this.handlers[e];Array.isArray(n)&&n.forEach(function(n){return n.call(null,e,t)})},e}();t.EventEmitter=i},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(13),r=n(16),a=n(14),l=n(15),s=function(e){function t(t){var n=e.call(this,t)||this;return n.locale=t,n.integralPartParser=new r.IntegralPartParser(t.numberGroupSeparator,t.numberDecimalSeparator),n.decimalSeparatorParser=new a.DecimalSeparatorParser(t.numberDecimalSeparator),n.fractionalPartParser=new l.FractionalPartParser,n}return i(t,e),t.prototype.getDecimalSeparator=function(){return this.locale.numberDecimalSeparator},t}(o.BaseNumberParser);t.NumberParser=s},function(e,t,n){"use strict";function i(e,t,n){return n=n||" ",e.length>t?e:(t-=e.length,t>n.length&&(n+=n.repeat(t/n.length)),n.slice(0,t)+e)}Object.defineProperty(t,"__esModule",{value:!0}),t.padStart=i},function(e,t,n){"use strict";function i(e,t,n){return e.substr(0,n).split("").reduce(function(e,n){var i=t.indexOf(n,e);return-1!==i?i+1:e},0)}Object.defineProperty(t,"__esModule",{value:!0}),t.restorePosition=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(74),o=n(78),r=n(41),a=n(58),l=n(67),s="en",u=function(){function e(){this.builder=new i.Builder,this.options={locale:s},this.initialized=!1,this.builder.register("DateTime",new r.DateTimeMaskBuilder),this.builder.register("Number",new a.NumberMaskBuilder),this.builder.register("Template",new l.TemplateMaskBuilder)}return e.prototype.init=function(e){var t=this;this.initialized||(e&&Object.keys(e).forEach(function(n){return t.options[n]=e[n]}),this.locale=new o.Locale(this.options.locale),this.initialized=!0)},e.prototype.getLocale=function(){return this.initialize(),this.locale},e.prototype.createDateTimeMask=function(e,t){this.initialize();var n=this.createMask("DateTime",e);return t=t||{},void 0!==t.timezoneOffset&&n.setTimezoneOffset(t.timezoneOffset),n},e.prototype.createNumberMask=function(e){return this.initialize(),this.createMask("Number",e)},e.prototype.createTemplateMask=function(e,t){this.initialize(),t=t||{};var n=this.createMask("Template",e,t);return void 0!==t.maskSaveLiteral&&n.setMaskSaveLiteral(t.maskSaveLiteral),n},e.prototype.createMask=function(e,t,n){return this.builder.build(e,t,this.locale)},e.prototype.initialize=function(){this.init()},e}();t.API=u},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.setTimezoneOffset=function(e){return this.getMask().setTimezoneOffset(e)},t.prototype.getTimezoneOffset=function(){return this.getMask().getTimezoneOffset()},t.prototype.setMinValue=function(e){this.getMask().setMinValue(e);
},t.prototype.getMinValue=function(){return this.getMask().getMinValue()},t.prototype.setMaxValue=function(e){this.getMask().setMaxValue(e)},t.prototype.getMaxValue=function(){return this.getMask().getMaxValue()},t.prototype.getMask=function(){return this.mask},t}(o.Editor);t.DateTimeEditor=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.onKeydownHandler=function(t){if(e.prototype.onKeydownHandler.call(this,t),!(t.altKey||t.ctrlKey||t.shiftKey)){var n=this.el.selectionStart;switch(t.key){case"-":case"Backspace":case"Delete":n=this.mask.handleKey(t.key,n),null!==n&&(t.preventDefault(),this.updateInputElement(n))}}},t}(o.Editor);t.NumberEditor=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.setMaskSaveLiteral=function(e){this.getMask().setMaskSaveLiteral(e)},t.prototype.getMaskSaveLiteral=function(){return this.getMask().getMaskSaveLiteral()},t.prototype.getMask=function(){return this.mask},t}(o.Editor);t.TemplateEditor=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),r=n(17),a=n(30),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timezoneOffset=0,t}return i(t,e),t.prototype.setTimezoneOffset=function(e){this.timezoneOffset=e},t.prototype.getTimezoneOffset=function(){return this.timezoneOffset},t.prototype.setMinValue=function(e){this.minValue=e},t.prototype.getMinValue=function(){return this.minValue},t.prototype.setMaxValue=function(e){this.maxValue=e},t.prototype.getMaxValue=function(){return this.maxValue},t.prototype.buildValue=function(){var e,t=this.lastValue||0,n=new Date(t-60*this.getTimezoneOffset()*1e3),i=this.patterns.getPatternsValue(),o=r.isEmpty(i.year)?n.getUTCFullYear():i.year,a=r.isEmpty(i.month)?n.getUTCMonth():i.month,l=r.isEmpty(i.day)?n.getUTCDate():i.day,s=r.isEmpty(i.minutes)?n.getUTCMinutes():i.minutes,u=r.isEmpty(i.seconds)?n.getUTCSeconds():i.seconds,c=r.isEmpty(i.milliseconds)?n.getUTCMilliseconds():i.milliseconds;return e=r.isEmpty(i.hours)?n.getUTCHours():r.isEmpty(i.meridiem)?i.hours:0===i.meridiem&&12===i.hours?0:1===i.meridiem&&12===i.hours?12:1===i.meridiem?i.hours+12:i.hours,Date.UTC(o,a,l,e,s,u,c)+60*this.getTimezoneOffset()*1e3},t.prototype.applyValue=function(t){null!==t&&void 0!==t&&(t-=60*this.getTimezoneOffset()*1e3),e.prototype.applyValue.call(this,t)},t.prototype.validate=function(e){var t,n=this.getMinValue(),i=this.getMaxValue();if(!(t=!!r.isEmpty(e)||(r.isEmpty(n)||r.isEmpty(i)?r.isEmpty(n)?!!r.isEmpty(i)||e<=i:e>=n:e>=n&&e<=i))){var o=new a.OutOfRangeEvent(e);this.eventEmitter.emit(a.OutOfRangeEvent.eventName,o)}return t},t}(o.Mask);t.DateTimeMask=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(11),r=n(40),a=n(12),l=n(9),s=n(31),u=n(56),c=n(42),d=n(48),p=n(45),h=n(47),f=n(49),m=n(50),g=n(54),y=n(43),v=n(46),b=n(44),I=n(53),_=n(51),x=n(52),w=n(55),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.initPatternsBuilder=function(){return new a.PatternsBuilder(l.buildStaticPattern).registerPattern(new s.StringSelector("dd"),function(e,t){return new c.DayPattern(t,e)}).registerPattern(new s.StringSelector("d"),function(e,t){return new m.ShortDayPattern(t,e)}).registerPattern(new s.StringSelector("MMMM"),function(e,t){return new y.FullMonthPattern(t,e)}).registerPattern(new s.StringSelector("MM"),function(e,t){return new d.MonthPattern(t,e)}).registerPattern(new s.StringSelector("M"),function(e,t){return new g.ShortMonthPattern(t,e)}).registerPattern(new s.StringSelector("yyyy"),function(e,t){return new u.YearPattern(t,e)}).registerPattern(new s.StringSelector("HH"),function(e,t){return new p.HoursPattern(t,e)}).registerPattern(new s.StringSelector("H"),function(e,t){return new x.ShortHoursPattern(t,e)}).registerPattern(new s.StringSelector("hh"),function(e,t){return new b.Hours12Pattern(t,e)}).registerPattern(new s.StringSelector("h"),function(e,t){return new _.ShortHours12Pattern(t,e)}).registerPattern(new s.StringSelector("mm"),function(e,t){return new h.MinutesPattern(t,e)}).registerPattern(new s.StringSelector("m"),function(e,t){return new I.ShortMinutesPattern(t,e)}).registerPattern(new s.StringSelector("ss"),function(e,t){return new f.SecondsPattern(t,e)}).registerPattern(new s.StringSelector("s"),function(e,t){return new w.ShortSecondsPattern(t,e)}).registerPattern(new s.StringSelector("tt"),function(e,t){return new v.MeridiemPattern(t,e)})},t.prototype.createMask=function(e){return new r.DateTimeMask(e)},t}(o.MaskBuilder);t.DateTimeMaskBuilder=C},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(22),a=n(18),l=function(e){function t(t,n){return e.call(this,t,n,"day",{min:1,max:31,width:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return r.isCompleteDay(this.getText())},t.prototype.applyValue=function(e){if(null===e||void 0===e)this.setText("");else{var t=a.getDay(e);this.setText(this.formatDecimal(t))}},t}(o.FixedWidthPattern);t.DayPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(28),r=("январь,февраль,март,апрель,май,июнь,июль,август,сентябрь,октябрь,ноябрь,декабрь".split(","),function(e){function t(t,n){return e.call(this,t,n,"month",t.months.full)||this}return i(t,e),t.prototype.applyValue=function(e){var t;if(null===e||void 0===e)t="";else{var n=new Date(e),i=n.getUTCMonth();t=this.locale.months.full[i]}this.setText(t)},t}(o.ListPattern));t.FullMonthPattern=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(4),a=n(20),l=function(e){function t(t,n){return e.call(this,t,n,"hours",{min:1,max:12,width:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return r.isCompleteHours(this.getText())},t.prototype.applyValue=function(e){var t=a.getHours12(e);this.setText(this.formatDecimal(t))},t}(o.FixedWidthPattern);t.Hours12Pattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(4),a=n(19),l=function(e){function t(t,n){return e.call(this,t,n,"hours",{min:0,max:23,width:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return r.isCompleteHours(this.getText())},t.prototype.applyValue=function(e){if(null===e||void 0===e)this.setText("");else{var t=a.getHours(e);this.setText(this.formatDecimal(t))}},t}(o.FixedWidthPattern);t.HoursPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(28),r="AM",a="PM",l=function(e){function t(t,n){return e.call(this,t,n,"meridiem",[r,a])||this}return i(t,e),t.prototype.applyValue=function(e){var t;t=null===e||void 0===e?"":new Date(e).getUTCHours()>=12?a:r,this.setText(t)},t}(o.ListPattern);t.MeridiemPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(23),a=function(e){function t(t,n){return e.call(this,t,n,"minutes",{min:0,max:59,width:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return r.isCompleteMinutes(this.getText())},t.prototype.applyValue=function(e){if(null===e||void 0===e)this.setText("");else{var t=new Date(e).getUTCMinutes();this.setText(this.formatDecimal(t.toString()))}},t}(o.FixedWidthPattern);t.MinutesPattern=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(24),a=n(21),l=function(e){function t(t,n){return e.call(this,t,n,"month",{min:1,max:12,width:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return r.isCompleteMonth(this.getText())},t.prototype.applyValue=function(e){if(null===e||void 0===e)this.setText("");else{var t=a.getMonth(e);this.setText(this.formatDecimal(t))}},t.prototype.getValue=function(){var t=e.prototype.getValue.call(this);return null===t?t:t-1},t}(o.FixedWidthPattern);t.MonthPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(25),a=function(e){function t(t,n){return e.call(this,t,n,"seconds",{min:0,max:59,width:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return r.isCompleteSeconds(this.getText())},t.prototype.applyValue=function(e){if(null===e||void 0===e)this.setText("");else{var t=new Date(e).getUTCSeconds();this.setText(this.formatDecimal(t.toString()))}},t}(o.FixedWidthPattern);t.SecondsPattern=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),r=n(22),a=n(18),l=function(e){function t(t,n){return e.call(this,t,n,"day",{min:1,max:31,minWidth:1,maxWidth:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return r.isCompleteDay(this.getText())},t.prototype.applyValue=function(e){this.setText(a.getDay(e))},t}(o.FloatWidthPattern);t.ShortDayPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(2),a=n(20),l=function(e){function t(t,n){return e.call(this,t,n,"hours",{min:1,max:12,minWidth:1,maxWidth:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return o.isCompleteHours(this.getText())},t.prototype.applyValue=function(e){if(null===e||void 0===e)this.setText("");else{var t=a.getHours12(e);this.setText(t)}},t}(r.FloatWidthPattern);t.ShortHours12Pattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(2),a=n(19),l=function(e){function t(t,n){return e.call(this,t,n,"hours",{min:0,max:23,minWidth:1,maxWidth:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return o.isCompleteHours(this.getText())},t.prototype.applyValue=function(e){if(null===e||void 0===e)this.setText("");else{var t=a.getHours(e);this.setText(t)}},t}(r.FloatWidthPattern);t.ShortHoursPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),r=n(23),a=function(e){function t(t,n){return e.call(this,t,n,"minutes",{min:0,max:59,minWidth:1,maxWidth:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return r.isCompleteMinutes(this.getText())},t.prototype.applyValue=function(e){if(null===e||void 0===e)this.setText("");else{var t=new Date(e).getUTCMinutes();this.setText(t.toString())}},t}(o.FloatWidthPattern);t.ShortMinutesPattern=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),r=n(24),a=n(21),l=function(e){function t(t,n){return e.call(this,t,n,"month",{min:1,max:12,minWidth:1,maxWidth:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return r.isCompleteMonth(this.getText())},t.prototype.applyValue=function(e){this.setText(a.getMonth(e))},t.prototype.getValue=function(){var t=e.prototype.getValue.call(this);return null===t?t:t-1},t}(o.FloatWidthPattern);t.ShortMonthPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),r=n(25),a=function(e){function t(t,n){return e.call(this,t,n,"seconds",{min:0,max:59,minWidth:1,maxWidth:2})||this}return i(t,e),t.prototype.getIsComplete=function(){return r.isCompleteSeconds(this.getText())},t.prototype.applyValue=function(e){if(null===e||void 0===e)this.setText("");else{var t=new Date(e).getUTCSeconds();this.setText(t.toString())}},t}(o.FloatWidthPattern);t.ShortSecondsPattern=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=function(e){function t(t,n){return e.call(this,t,n,"year",{min:1,max:9999,width:4})||this}return i(t,e),t.prototype.applyValue=function(e){if(null===e||void 0===e)this.setText("");else{var t=new Date(e).getUTCFullYear();this.setText(this.formatDecimal(t.toString()))}},t}(o.FixedWidthPattern);t.YearPattern=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),r=n(86),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.buildValue=function(){return this.patterns.getInputPattern().getValue()},t.prototype.handleKey=function(e,t){var n=null,i=this.getText();switch(e){case"-":n=this.tryToggleSign(t,i);break;case"Backspace":n=1===t&&"-"===i.charAt(0)?this.tryToggleSign(t,i):n;break;case"Delete":n=0===t&&"-"===i.charAt(0)?this.tryToggleSign(t,i):n}return n},t.prototype.restorePosition=function(t,n){for(var i=this.locale.numberGroupSeparator,o=t.substring(0,n),r=t.substr(n),a=n;-1!==o.indexOf(i);)o=o.replace(i,""),a-=i.length;for(;-1!==r.indexOf(i);)r=r.replace(i,"");return e.prototype.restorePosition.call(this,o+r,a)},t.prototype.setNextPatternValue=function(e){if(this.patterns.getIsValid()){var t=this.value.getValue(),n=r.restoreNumberPrecision(t,t+1);this.value.setValue(n,{update:!0})}return this.patterns.getInputPatternSelection()},t.prototype.setPrevPatternValue=function(e){if(this.patterns.getIsValid()){var t=this.value.getValue(),n=r.restoreNumberPrecision(t,t-1);this.value.setValue(n,{update:!0})}return this.patterns.getInputPatternSelection()},t.prototype.getInvalidText=function(){var e=this.value.getValue(),t=void 0!==e&&null!==e,n=null,i=this.locale;return t&&isNaN(e)?n=i.NaNSymbol:t&&!isFinite(e)&&(n=e===Number.POSITIVE_INFINITY?i.positiveInfinitySymbol:i.negativeInfinitySymbol),n},t.prototype.updateInvalid=function(){var e=this.value.getValue(),t=void 0!==e&&null!==e;t&&isNaN(e)?this.setInvalid(!0):t&&!isFinite(e)?this.setInvalid(!0):this.setInvalid(!1)},t.prototype.tryToggleSign=function(e,t){var n=this.patterns.getInputPattern();if(!n)return null;n.toggleSign(),this.patterns.updateText();var i=this.restorePosition(t,e);return this.updateValue(),i},t}(o.Mask);t.NumberMask=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(57),r=n(11),a=n(12),l=n(9),s=n(75),u=n(60),c=n(59),d=n(61),p=n(62),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.createMask=function(e){return new o.NumberMask(e)},t.prototype.initPatternsBuilder=function(){return new a.PatternsBuilder(l.buildStaticPattern).registerPattern(new s.RegExpSelector(/n\d*/i),u.buildNumberPattern).registerPattern(new s.RegExpSelector(/c\d*/i),c.buildCurrencyPattern).registerPattern(new s.RegExpSelector(/p\d*/),d.buildPercentPattern).registerPattern(new s.RegExpSelector(/P\d*/),p.buildPercentTransformedPattern)},t}(r.MaskBuilder);t.NumberMaskBuilder=h},function(e,t,n){"use strict";function i(e,t){var n=/c(\d*)/i,i=e.match(n),r=i[1];return new o.CurrencyPattern(t,e,0===r.length?t.currencyDecimalDigits:parseInt(r,10))}Object.defineProperty(t,"__esModule",{value:!0});var o=n(63);t.buildCurrencyPattern=i},function(e,t,n){"use strict";function i(e,t){var n=/n(\d*)/i,i=e.match(n),r=i[1];return new o.NumberPattern(t,e,0===r.length?t.numberDecimalDigits:parseInt(r,10))}Object.defineProperty(t,"__esModule",{value:!0});var o=n(64);t.buildNumberPattern=i},function(e,t,n){"use strict";function i(e,t){var n=/p(\d*)/,i=e.match(n),r=i[1];return new o.PercentPattern(t,e,0===r.length?t.percentDecimalDigits:parseInt(r,10))}Object.defineProperty(t,"__esModule",{value:!0});var o=n(26);t.buildPercentPattern=i},function(e,t,n){"use strict";function i(e,t){var n=/P(\d*)/,i=e.match(n),r=i[1];return new o.PercentTransformedPattern(t,e,0===r.length?t.percentDecimalDigits:parseInt(r,10))}Object.defineProperty(t,"__esModule",{value:!0});var o=n(65);t.buildPercentTransformedPattern=i},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),r=n(84),a=n(80),l=function(e){function t(t,n,i){var o=e.call(this,t,n,i)||this;return o.parser=new r.CurrencyParser(t),o.formatter=new a.CurrencyFormatter(t),o}return i(t,e),t}(o.BaseNumberPattern);t.CurrencyPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),r=n(33),a=n(5),l=function(e){function t(t,n,i){var o=e.call(this,t,n,i)||this;return o.parser=new r.NumberParser(t),o.formatter=new a.NumberFormatter(t),o}return i(t,e),t}(o.BaseNumberPattern);t.NumberPattern=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(26),r=n(17),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.applyValue=function(t){r.isEmpty(t)||!isFinite(t)||isNaN(t)||(t*=100),e.prototype.applyValue.call(this,t)},t.prototype.getValue=function(){var t=e.prototype.getValue.call(this);return r.isEmpty(t)||!isFinite(t)||isNaN(t)||(t/=100),t},t}(o.PercentPattern);t.PercentTransformedPattern=a},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),r=n(29),a=n(1),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.maskSaveLiteral=!0,t}return i(t,e),t.prototype.setMaskSaveLiteral=function(e){this.maskSaveLiteral=e},t.prototype.applyValue=function(e){e=e||"";var t=this.patterns,n=t.getList();if(this.getMaskSaveLiteral())n.forEach(function(t,n){return t.applyValue(e.substr(n,1))});else{var i=0;n.filter(function(e){return!(e instanceof r.StaticPattern)}).forEach(function(t){return t.applyValue(e.substr(i++,1))})}this.patterns.updateText()},t.prototype.getMaskSaveLiteral=function(){return this.maskSaveLiteral},t.prototype.buildValue=function(){var e=this;return this.patterns.getList().filter(function(t){return!!e.getMaskSaveLiteral()||t instanceof a.TemplatePattern}).map(function(e){return e.getText()}).join("")},t}(o.Mask);t.TemplateMask=l},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(11),r=n(12),a=n(66),l=n(9),s=n(31),u=n(70),c=n(72),d=n(69),p=n(71),h=n(68),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.initPatternsBuilder=function(){return new r.PatternsBuilder(l.buildStaticPattern).registerPattern(new s.StringSelector("#"),function(e,t){return new c.SignTemplatePattern(t,e,(!1))}).registerPattern(new s.StringSelector("9"),function(e,t){return new u.DigitTemplatePattern(t,e,(!1))}).registerPattern(new s.StringSelector("0"),function(e,t){return new u.DigitTemplatePattern(t,e,(!0))}).registerPattern(new s.StringSelector("c"),function(e,t){return new d.CharTemplatePattern(t,e,(!1))}).registerPattern(new s.StringSelector("C"),function(e,t){return new d.CharTemplatePattern(t,e,(!0))}).registerPattern(new s.StringSelector("l"),function(e,t){return new p.LetterTemplatePattern(t,e,(!1))}).registerPattern(new s.StringSelector("L"),function(e,t){return new p.LetterTemplatePattern(t,e,(!0))}).registerPattern(new s.StringSelector("a"),function(e,t){return new h.AlphanumericTemplatePattern(t,e,(!1))}).registerPattern(new s.StringSelector("A"),function(e,t){return new h.AlphanumericTemplatePattern(t,e,(!0))})},t.prototype.createMask=function(e){return new a.TemplateMask(e)},t}(o.MaskBuilder);t.TemplateMaskBuilder=f},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=function(e){function t(t,n,i){var o=e.call(this,t,n,i)||this;return o.regexpLetter=new RegExp("[0-9"+t.letter+"]"),o}return i(t,e),t.prototype.validateInput=function(e){return this.regexpLetter.test(e)},t}(o.TemplatePattern);t.AlphanumericTemplatePattern=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.validateInput=function(e){return/^.*$/.test(e)},t}(o.TemplatePattern);t.CharTemplatePattern=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.validateInput=function(e){return/\d/.test(e)},t}(o.TemplatePattern);t.DigitTemplatePattern=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=function(e){function t(t,n,i){var o=e.call(this,t,n,i)||this;return o.regexpLetter=new RegExp("["+t.letter+"]"),o}return i(t,e),t.prototype.validateInput=function(e){return this.regexpLetter.test(e)},t}(o.TemplatePattern);t.LetterTemplatePattern=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.validateInput=function(e){return/^[\d+-]$/.test(e)},t}(o.TemplatePattern);t.SignTemplatePattern=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(87),o=n(35),r=function(){function e(){this.list=[]}return e.prototype.setList=function(e){this.list=e.slice()},e.prototype.getList=function(){return this.list},e.prototype.getIsComplete=function(){return this.list.every(function(e){return e.getIsComplete()})},e.prototype.getIsValid=function(){return this.list.every(function(e){return e.getIsValid()})},e.prototype.getIsEmpty=function(){return this.list.every(function(e){return e.getIsEmpty()})},e.prototype.setInput=function(e,t){var n=this.getText(),o=i.strDiff(n,e,t),r=t||0;switch(o.operation){case i.DiffOperation.Insert:1===o.dst.length&&this.isSeparator(o.dst,o.position)?(r=this.getNextPatternOffset(t),!1):r=this.inputInsert(o.position,o.dst);break;case i.DiffOperation.Change:r=this.inputChange(o.position,o.src,o.dst);break;case i.DiffOperation.Delete:r=this.inputDelete(o.position,o.src)}return r},e.prototype.isSeparator=function(e,t){var n=!1,i=this.getPatternByPositionLeft(t),o=this.list.indexOf(i),r=this.list[o+1];return r&&!1===r.canActivate()&&(n=e===r.getText()),n},e.prototype.getNextPatternOffset=function(e){var t=e,n=this.getPatternByPositionLeft(e),i=this.getNextPattern(n);return i&&(t=this.getPatternOffset(i)),t},e.prototype.getNextPattern=function(e){var t=this.list.indexOf(e);return this.list.slice(t+1).filter(function(e){return e.canActivate()})[0]},e.prototype.inputInsert=function(e,t){var n=this.getInputPatternByPosition(e);
if(!n)return e;var i=n.getText(),o=this.getPatternOffset(n),r=i.substring(0,e-o),a=i.substring(e-o),l=r+t+a;if(1===t.length&&e>=o&&e<o+i.length&&!n.canInputChar(t))return e;for(var s,u=l,c="",d=this,p=this.list.indexOf(n);p<this.list.length&&"break"!==function(e){var t=d.list[e];return t===n||t.getIsEmpty()?(t.setInput(u,function(e,n){u=e,n&&n.length&&(c+=n,s=t)}),0===u.length?"break":void 0):"break"}(p);p++);if(s){this.setActive(s);var h="",f=r+t;s.finalizeInput()&&n===s&&(c=f=s.getText());for(var m=this.list.slice(this.list.indexOf(n),this.list.indexOf(s)+1).map(function(e){return e.getText()}).join(""),p=0,g=0;p<f.length;p++){var y=f.substr(p,1),v=c.indexOf(y,g);-1!==v&&(h+=y,g=v+1)}e=o+h.split("").reduce(function(e,t){var n=m.indexOf(t,e);return-1!==n?n+1:e},0),s.getIsComplete()&&this.getPatternOffset(s)+s.getText().length===e&&(e=this.forwardPosition(e))}return e},e.prototype.forwardPosition=function(e){var t=this.getPatternByPositionLeft(e),n=this.getPatternByPositionRight(e),i=e;if(t!==n&&!n.canActivate()){for(var o=this.list.indexOf(n),r=void 0,a=o+1;a<this.list.length;a++)if(this.list[a].canActivate()){r=this.list[a];break}r&&(i=this.getPatternOffset(r))}return i},e.prototype.inputChange=function(e,t,n){var i,o=this.getPatternByPositionRight(e),r=this.getPatternByPositionLeft(e+t.length),a=o.getText(),l=this.getPatternOffset(o),s=a.substring(0,e-l),u=a.substring(e-l+t.length),c=s+n+u,d="";if(o===r)i=o,o.setInput(c,function(e,t){t&&t.length&&(d=t)}),o.getIsEmpty()&&(e=l);else for(var p=this.list.indexOf(o),h=this.list.indexOf(r),f=c,m=this,g=p;g<=h;g++)!function(e){var t=m.list[e];t.setInput(f,function(e,n){f=e,n&&n.length&&(d+=n,i=t)})}(g);if(i){this.setActive(i);for(var y=this.list.slice(this.list.indexOf(o),this.list.indexOf(i)+1).map(function(e){return e.getText()}).join(""),v="",b=s+n,g=0,I=0;g<b.length;g++){var _=b.substr(g,1),x=d.indexOf(_,I);-1!==x&&(v+=_,I=x+1)}e=l+v.split("").reduce(function(e,t){var n=y.indexOf(t,e);return-1!==n?n+1:e},0)}return e},e.prototype.inputDelete=function(e,t){var n=this.getPatternByPositionRight(e),i=this.getPatternByPositionLeft(e+t.length),r=this.list.indexOf(n),a=this.list.indexOf(i);if(n===i){var l=n.getText(),s=this.getPatternOffset(n),u=l.substring(0,e-s),c=l.substring(e-s+t.length);this.setActive(n);var d="";n.setInput(u+c,function(e,t){d=t}),e=n.canActivate()&&n.getIsEmpty()?s:s+o.restorePosition(l,d,e-s)}else{var l=i.getText(),s=this.getPatternOffset(i),p=l.substring(e-s+t.length);i.setInput(p),l=n.getText(),s=this.getPatternOffset(n),p=l.substring(0,e-s),n.setInput(p),this.list.slice(r+1,a).forEach(function(e){return e.setInput("")}),n.canActivate()&&n.getIsEmpty()&&(e=s),this.setActive(n)}return e},e.prototype.setNextPatternValue=function(e){var t=null,n=this.getPatternByPositionRight(e);if(n.canActivate()){var i=n.getNextInput();n.setInput(i),this.clearActive(),this.updateText();var o=this.getPatternOffset(n);t={start:o,end:o+n.getText().length}}return t},e.prototype.setPrevPatternValue=function(e){var t=null,n=this.getPatternByPositionRight(e);if(n.canActivate()){var i=n.getPrevInput();n.setInput(i),this.clearActive(),this.updateText();var o=this.getPatternOffset(n);t={start:o,end:o+n.getText().length}}return t},e.prototype.getInputPosition=function(e){for(var t,n,i=this.getInputPatternByPosition(e),o=this.list.indexOf(i),r=this.list.slice(0,o+1).filter(function(e){return e.canActivate()}).reverse(),a=0;a<r.length;a+=1)if(!r[a].getIsEmpty()){n=r[a];break}if(n){var l=this.getPatternOffset(n),s=n.getText();t=e>l+s.length?l+s.length:e<l?l:e}else n=r.pop(),t=this.getPatternOffset(n);return t},e.prototype.clearActive=function(){this.list.forEach(function(e){return e.setIsActive(!1)})},e.prototype.setActive=function(e){this.list.forEach(function(t){return t.setIsActive(t===e)})},e.prototype.getText=function(){return this.list.map(function(e){return e.getText()}).join("")},e.prototype.getPatternByPosition=function(e){var t=[];return this.list.forEach(function(e){e.getText().split("").forEach(function(n){return t.push(e)})}),t[e]},e.prototype.getPatternsByPosition=function(e){var t=[];return this.list.forEach(function(e){e.getText().split("").forEach(function(n){return t.push(e)})}),[t.slice(0,e).filter(function(e){return null!==e}).pop(),t.slice(e).filter(function(e){return null!==e}).reverse().pop()]},e.prototype.getInputPatternByPosition=function(e){var t,n=[];this.list.forEach(function(e){e.getText().split("").forEach(function(t){return n.push(e)})});var i=n.slice(0,e).filter(function(e){return null!==e}).reverse(),o=n.slice(e).filter(function(e){return null!==e}),r=o[0];if(r&&r.canActivate())t=r;else if(i[0]&&i[0].canActivate())r=i[0],t=r.canActivate()?r:o[0];else for(var a=0;a<o.length;a++)if(o[a].canActivate()){t=o[a];break}return t},e.prototype.getPatternByPositionRight=function(e){var t=this.getPatternsByPosition(e);return t[1]||t[0]},e.prototype.getPatternByPositionLeft=function(e){var t=this.getPatternsByPosition(e);return t[0]||t[1]},e.prototype.getPatternOffset=function(e){for(var t=0,n=0;n<this.list.length&&this.list[n]!==e;n++)t+=this.list[n].getText().length;return t},e.prototype.getInputPatternSelection=function(){var e=this.getInputPattern(),t=this.getPatternOffset(e);return{start:t,end:t+e.getText().length}},e.prototype.getInputPattern=function(){for(var e=null,t=0;t<this.list.length;t+=1){var n=this.list[t];if(n.canActivate()){e=n;break}}return e},e.prototype.getPatternsValue=function(){var e={};return this.list.forEach(function(t){var n=t.getName();n&&(e[n]=t.getValue())}),e},e.prototype.updateText=function(){this.list.forEach(function(e){return e.updateText()})},e.prototype.updateDisplay=function(){this.setActive(null),this.updateText()},e.prototype.dispose=function(){this.list.length=0},e}();t.PatternsList=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.builders={}}return e.prototype.build=function(e,t,n){return this.builders[e].build(t,n)},e.prototype.register=function(e,t){this.builders[e]=t},e}();t.Builder=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.regexp=e}return e.prototype.match=function(e){var t,n,i=null,o=e.match(this.regexp);return o&&(t=o[0],n=e.indexOf(t),i={text:t,start:n,end:n+t.length}),i},e}();t.RegExpSelector=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(32),o=function(){function e(){this.eventEmitter=new i.EventEmitter}return e.prototype.setValue=function(e,t){var n=this.value!==e;"number"==typeof e&&"number"==typeof this.value&&isNaN(e)&&isNaN(this.value)&&(n=!1);var i=this.value;if(this.value=e,n){var o={oldValue:i,newValue:e,params:t||{}};this.eventEmitter.emit("change",o)}},e.prototype.getValue=function(){return this.value},e.prototype.onChange=function(e){return this.eventEmitter.on("change",e)},e.prototype.dispose=function(){this.eventEmitter.dispose(),this.value=null},e}();t.ValueModel=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(36),o=n(37),r=n(39),a=n(38),l=function(){function e(){}return e.dateTime=function(t,n,i){var r=e.api.createDateTimeMask(n,i);return new o.DateTimeEditor(t,r)},e.template=function(t,n,i){var o=e.api.createTemplateMask(n,i);return new r.TemplateEditor(t,o)},e.number=function(t,n){var i=e.api.createNumberMask(n);return new a.NumberEditor(t,i)},e}();l.api=new i.API,t.Mask=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(33),o=n(5),r=n(79),a=function(){function e(e){var t=this;this.numberParser=new i.NumberParser(this),this.numberFormatter=new o.NumberFormatter(this);var n=new r.Localization,a=n.getLocalization(e);Object.keys(a).forEach(function(e){return t[e]=a[e]})}return e}();t.Locale=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(83),o=n(82),r=function(){function e(){}return e.prototype.getLocalization=function(e){e=e.toUpperCase();var t;switch(e){case"RU":case"RU-RU":t=new i.Ru;break;case"EN":case"EN-US":t=new o.En;break;default:t=this.getDefaultLocalization()}return t},e.prototype.getDefaultLocalization=function(){return new i.Ru},e}();t.Localization=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getDecimalSeparator=function(){return this.locale.currencyDecimalSeparator},t.prototype.getNegativePattern=function(){return this.locale.currencyNegativePattern},t.prototype.getPositivePattern=function(){return this.locale.currencyPositivePattern},t.prototype.getGroupSeparator=function(){return this.locale.currencyGroupSeparator},t.prototype.getCurrencySymbol=function(){return this.locale.currencySymbol},t.prototype.getWrapper=function(e){var t=this;return this.getPattern(e.isNegative).split(/c/i).map(function(e){return e.replace("$",t.getCurrencySymbol())})},t}(o.NumberFormatter);t.CurrencyFormatter=r},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getDecimalSeparator=function(){return this.locale.percentDecimalSeparator},t.prototype.getNegativePattern=function(){return this.locale.percentNegativePattern},t.prototype.getPositivePattern=function(){return this.locale.percentPositivePattern},t.prototype.getGroupSeparator=function(){return this.locale.percentGroupSeparator},t.prototype.getPercentSymbol=function(){return this.locale.percentSymbol},t.prototype.getWrapper=function(e){var t=this;return this.getPattern(e.isNegative).split(/p/i).map(function(e){return e.replace("%",t.getPercentSymbol())})},t}(o.NumberFormatter);t.PercentFormatter=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.letter="a-zA-Z",this.numberDecimalDigits=2,this.numberDecimalSeparator=".",this.numberGroupSeparator=",",this.numberGroupSize=3,this.numberNegativePattern="-n",this.numberPositivePattern="n",this.percentDecimalDigits=2,this.percentDecimalSeparator=".",this.percentGroupSeparator=",",this.percentSymbol="%",this.percentNegativePattern="-p %",this.percentPositivePattern="p %",this.currencyDecimalDigits=2,this.currencyDecimalSeparator=".",this.currencyGroupSeparator=",",this.currencySymbol="$",this.currencyNegativePattern="($c)",this.currencyPositivePattern="$c",this.negativeInfinitySymbol="-Infinity",this.positiveInfinitySymbol="Infinity",this.NaNSymbol="NaN",this.months={full:"January,February,March,April,May,June,July,August,September,October,November,December".split(",")}}return e}();t.En=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.letter="а-яА-Яa-zA-Z",this.numberDecimalDigits=2,this.numberDecimalSeparator=",",this.numberGroupSeparator=" ",this.numberGroupSize=3,this.numberNegativePattern="-n",this.numberPositivePattern="n",this.percentDecimalDigits=2,this.percentDecimalSeparator=",",this.percentGroupSeparator=" ",this.percentSymbol="%",this.percentNegativePattern="-p %",this.percentPositivePattern="p %",this.currencyDecimalDigits=2,this.currencyDecimalSeparator=",",this.currencyGroupSeparator=" ",this.currencySymbol="р.",this.currencyNegativePattern="-c$",this.currencyPositivePattern="c$",this.negativeInfinitySymbol="-бесконечность",this.positiveInfinitySymbol="бесконечность",this.NaNSymbol="NaN",this.months={full:"январь,февраль,март,апрель,май,июнь,июль,август,сентябрь,октябрь,ноябрь,декабрь".split(",")}}return e}();t.Ru=i},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(13),r=n(16),a=n(14),l=n(15),s=function(e){function t(t){var n=e.call(this,t)||this;return n.locale=t,n.integralPartParser=new r.IntegralPartParser(t.currencyGroupSeparator,t.currencyDecimalSeparator),n.decimalSeparatorParser=new a.DecimalSeparatorParser(t.currencyDecimalSeparator),n.fractionalPartParser=new l.FractionalPartParser,n}return i(t,e),t.prototype.getDecimalSeparator=function(){return this.locale.currencyDecimalSeparator},t}(o.BaseNumberParser);t.CurrencyParser=s},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(13),r=n(16),a=n(14),l=n(15),s=function(e){function t(t){var n=e.call(this,t)||this;return n.locale=t,n.integralPartParser=new r.IntegralPartParser(t.percentGroupSeparator,t.percentDecimalSeparator),n.decimalSeparatorParser=new a.DecimalSeparatorParser(t.percentDecimalSeparator),n.fractionalPartParser=new l.FractionalPartParser,n}return i(t,e),t.prototype.getDecimalSeparator=function(){return this.locale.percentDecimalSeparator},t}(o.BaseNumberParser);t.PercentParser=s},function(e,t,n){"use strict";function i(e,t){var n=e.toString(10).split("."),i=n[1],o=void 0===i?"":i;return+t.toFixed(o.length)}Object.defineProperty(t,"__esModule",{value:!0}),t.restoreNumberPrecision=i},function(e,t,n){"use strict";function i(e,t,n){var i=u.None,r={operation:i};if(e===t)r={operation:u.None};else if(0===t.length)r={operation:u.Delete,src:e,position:0};else{var a=l(e,t),c=s(e.substr(a),t.substr(a)),d=void 0,p=void 0,h=a;0===a&&0===c?(i=u.Change,d=e,p=t):a+c<e.length?(i=u.Change,d=e.substr(a,e.length-a-c),p=t.substr(a,t.length-a-c),0===p.length&&d.length>0&&(p=void 0,i=u.Delete)):e.length>t.length?(i=u.Delete,d=e.substr(a,e.length-a-c)):e.length<t.length?(i=u.Insert,p=t.substr(a,t.length-a-c)):(i=u.Change,d=e.substr(a,e.length-a-c),p=t.substr(a,t.length-a-c)),r={operation:i,src:d,dst:p,position:h}}return o(e,t,r,n)}function o(e,t,n,i){switch(n.operation){case u.Insert:n=r(e,t,n,i);break;case u.Delete:n=a(e,t,n,i)}return n}function r(e,t,n,i){for(var o=null,r=n.position;r>=0;r-=n.dst.length){var a=r-n.dst.length;if(t.substring(a,r)===n.dst&&a===i-n.dst.length){o=a;break}}return null!==o&&(n.position=o),n}function a(e,t,n,i){for(var o=null,r=n.position;r>=0;r-=n.src.length){var a=r-n.src.length;if(e.substring(a,r)===n.src){if(!(a>=i))break;o=a}}return null!==o&&(n.position=o),n}function l(e,t){for(var n=Math.min(e.length,t.length),i=0,o=0;o<n&&e[o]===t[o];o+=1)i++;return i}function s(e,t){for(var n=e.split("").reverse(),i=t.split("").reverse(),o=0,r=Math.min(n.length,i.length),a=0;a<r&&n[a]===i[a];a+=1)o++;return o}Object.defineProperty(t,"__esModule",{value:!0});var u;!function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Change=2]="Change",e[e.None=3]="None"}(u=t.DiffOperation||(t.DiffOperation={})),t.strDiff=i}])}),function(){function MessageBus(e){function t(e){return"object"==typeof e&&"undefined"!=typeof e.name&&(e=e.name),e}var n={};this.send=function(i,o){if(i=t(i),n[i]){var r;e&&e.getContext&&(r=e.getContext()),n[i].forEach(function(e){e(r,{value:o})})}},this.subscribe=function(e,i){e=t(e),n[e]||(n[e]=[]),n[e].push(i)},this.unsubscribeByType=function(e){e=t(e),n[e]&&delete n[e]},this.getView=function(){return e},this.dispose=function(){n={}}}function AuthenticationProvider(e){this.baseAddress=e}function BasePathOfProperty(e,t,n){this.isRelativeProperty(e)?this.basePathOfProperty=n.basePathOfProperty+this.excludeFirstChar(e):this.basePathOfProperty=e,n?(this.indexesInParentLists=n.indexesInParentLists?n.indexesInParentLists.slice():[],this.indexesInParentLists.push(t),this.parentBasePath=n):"undefined"!=typeof t&&null!==t&&(this.indexesInParentLists=[t],this.basePathOfProperty+=t)}function EventsManager(){this.handlers={}}function HashMap(){this._keys=[],this._values=[]}function HiddenScreen(){this.middleElement=$("<div></div>").css({position:"absolute",top:"-10000px"})}function Logger(e){this.messages=[],this.setLevel(e||LOG_LEVEL.debug),this.showMessages=!0}function guid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}function ValidationResult(){this.IsValid=!0,this.Items=[]}function Collection(e,t,n){function i(e,t){return e<t?-1:e>t?1:0}Array.isArray(e)||(e=[]),this._items=e.map(function(e,t){return this.createCollectionItem(e,t)},this),this._idProperty=t,this._comparator=n||i,this.events=new CollectionEventManager}function CollectionEventManager(){}function ActionExecutor(e){var t=null;return function(){null===t&&(t=e.get());var n=Array.prototype.filter.call(arguments,function(e){return"function"==typeof e}).pop(),i=t.getProperty("canExecute");i?new Promise(function(e,t){e()}).then(function(){return i()}).then(function(e){e&&t.execute.call(t,n)}):t.execute.call(t,n)}}function ActionFactory(e,t,n){function i(){return t.build(e,n)}return{get:i}}function BaseScriptExecutor(e,t){var n=null;return function(i){var o=e?e.getContext():null;return null===n&&(n=t.get()),n.call(null,o,i)}}function CompiledScriptFactory(e,t){function n(){var n=t.getScriptsStorage(),i=n.getScripts().getById(e);return i?i.func:void 0}return{get:n}}function Executor(e,t,n){var i,o,r;return"string"==typeof e?"{"===e[0]&&"}"===e[e.length-1]?(r=e.substring(1,e.length-1),i=BaseScriptExecutor(n.parentView,InlineScriptFactory(r,t,n))):(o=e,i=BaseScriptExecutor(n.parentView,CompiledScriptFactory(o,n.parentView))):null!==e&&"object"==typeof e&&(i=ActionExecutor(ActionFactory(e,t,n))),i?i:function(){}}function InlineScriptFactory(e,t,n){function i(){var i={parentView:n.parentView,parent:n.parent,basePathOfProperty:n.basePathOfProperty},o={Body:e,Name:"InlineScript"},r=t.buildType("Script",o,i);return function(e,t){return r.call(null,e,t)}}return{get:i}}function ContainerControl(e){_.superClass(ContainerControl,this,e)}function ListEditorBaseControl(e){_.superClass(ListEditorBaseControl,this,e),this.initialize_editorBaseControl()}function TextEditorBaseControl(e){_.superClass(TextEditorBaseControl,this,e),this.initialize_editorBaseControl()}function EventManager(){this.handlers={}}function TextBoxControl(e){_.superClass(TextBoxControl,this,e)}function DateTimePickerControl(e){_.superClass(DateTimePickerControl,this,e)}function DatePickerControl(e){_.superClass(DatePickerControl,this,e)}function TimePickerControl(e){_.superClass(TimePickerControl,this,e)}function ButtonControl(e){_.superClass(ButtonControl,this,e)}function ButtonEditControl(e){_.superClass(ButtonEditControl,this,e)}function ComboBoxBaseViewStrategy(e){this.dropdownView=e}function ComboBoxGroupViewStrategy(e){ComboBoxBaseViewStrategy.call(this,e)}function ComboBoxPlainViewStrategy(e){ComboBoxBaseViewStrategy.call(this,e)}function DataGridControl(){_.superClass(DataGridControl,this)}function DataGridRowControl(){_.superClass(DataGridRowControl,this)}function DataNavigationButtonFactory(e){this._dataNavigation=e}function DataNavigationControl(e){_.superClass(DataNavigationControl,this,e)}function ListBoxViewGroupStrategy(e){this.listbox=e}function ListBoxViewPlainStrategy(e){this.listbox=e}function ListBoxControl(e){_.superClass(ListBoxControl,this,e)}function PopupButtonControl(e){_.superClass(PopupButtonControl,this,e)}function StackPanelControl(e){_.superClass(StackPanelControl,this,e)}function StackPanelViewGroupStrategy(e){this.stackPanel=e}function StackPanelViewPlainStrategy(e){this.stackPanel=e}function TablePanelControl(e){_.superClass(TablePanelControl,this,e)}function CellControl(e){_.superClass(CellControl,this,e)}function RowControl(e){_.superClass(RowControl,this,e)}function TabPanelControl(e){_.superClass(TabPanelControl,this,e)}function TabPageControl(e){_.superClass(TabPageControl,this,e)}function TreeViewControl(){_.superClass(TreeViewControl,this)}function CheckBoxControl(e){_.superClass(CheckBoxControl,this,e),this.initialize_editorBaseControl()}function ComboBoxControl(e){_.superClass(ListBoxControl,this,e)}function ContextMenuControl(){_.superClass(ContextMenuControl,this)}function DividerControl(e){_.superClass(DividerControl,this,e)}function FileBoxControl(e){_.superClass(FileBoxControl,this,e),this.initialize_editorBaseControl()}function FormControl(e){_.superClass(FormControl,this,e)}function GridPanelControl(e){_.superClass(GridPanelControl,this,e)}function IconControl(){_.superClass(IconControl,this)}function ImageBoxControl(e){_.superClass(ImageBoxControl,this,e),this.initialize_editorBaseControl()}function IndeterminateCheckBoxControl(e){_.superClass(IndeterminateCheckBoxControl,this,e),this.initialize_editorBaseControl()}function LinkElementControl(){_.superClass(LinkElementControl,this)}function MenuBarControl(e){_.superClass(MenuBarControl,this,e)}function NumericBoxControl(e){_.superClass(NumericBoxControl,this,e)}function PanelControl(e){_.superClass(PanelControl,this,e)}function ScrollPanelControl(e){_.superClass(ScrollPanelControl,this,e)}function ToggleButtonControl(e){_.superClass(ToggleButtonControl,this,e),this.initialize_editorBaseControl()}function ToolBarControl(e){_.superClass(ToolBarControl,this,e)}function ViewControl(e){_.superClass(ViewControl,this,e)}function ExtensionPanelsRegister(){this.items={},this.register=function(e){var t=e.name,n=e.initialize;delete e.name,delete e.initialize,_.extend(n.prototype,e),this.items[t]=n},this.getByName=function(e){return this.items[e]}}function Container(e,t){_.superClass(Container,this,e,t)}function ContainerBuilder(){_.superClass(ContainerBuilder,this)}function ListEditorBase(e,t){_.superClass(ListEditorBase,this,e,t),this.initialize_editorBase()}function ListEditorBaseBuilder(){_.superClass(ListEditorBaseBuilder,this),this.initialize_editorBaseBuilder()}function TextEditorBase(e){_.superClass(TextEditorBase,this,e),this.initialize_editorBase()}function TextEditorBaseBuilder(){_.superClass(TextEditorBaseBuilder,this),this.initialize_editorBaseBuilder()}function ListBox(e,t){_.superClass(ListBox,this,e,t)}function ListBoxBuilder(){_.superClass(ListBoxBuilder,this)}function TextBox(e){_.superClass(TextBox,this,e)}function TextBoxBuilder(){_.superClass(TextBoxBuilder,this)}function DateTimePicker(e){_.superClass(DateTimePicker,this,e)}function DateTimePickerBuilder(){_.superClass(DateTimePickerBuilder,this)}function DatePicker(e){_.superClass(DatePicker,this,e),this.setMode("DatePicker"),this.setTimeZone()}function DatePickerBuilder(){_.superClass(DatePickerBuilder,this)}function TimePicker(e){_.superClass(TimePicker,this,e),this.setMode("TimePicker"),this.setTimeZone()}function TimePickerBuilder(){_.superClass(TimePickerBuilder,this)}function StackPanel(e,t){_.superClass(StackPanel,this,e,t)}function StackPanelBuilder(){_.superClass(StackPanelBuilder,this)}function Button(e,t){_.superClass(Button,this,e,t),this.buttonInit()}function ButtonBuilder(){_.superClass(ButtonBuilder,this)}function ButtonEdit(e){_.superClass(ButtonEdit,this,e)}function ButtonEditBuilder(){_.superClass(ButtonEditBuilder,this)}function CheckBox(e){_.superClass(CheckBox,this,e),this.initialize_editorBase()}function CheckBoxBuilder(){_.superClass(CheckBoxBuilder,this),this.initialize_editorBaseBuilder()}function ComboBox(e){_.superClass(ComboBox,this,e)}function ComboBoxBuilder(){_.superClass(ComboBoxBuilder,this)}function ContextMenu(e){_.superClass(ContextMenu,this,e)}function ContextMenuBuilder(){_.superClass(ContextMenuBuilder,this)}function DataGrid(e){_.superClass(DataGrid,this,e)}function DataGridBuilder(){_.superClass(DataGridBuilder,this),this.columnBuilder=new DataGridColumnBuilder}function setDefaultCheckAllBehavior(e){function t(e,t){o(_.isEqual(t.newValue,i()))}function n(t,n){var a=n.value;if(a!==r){o(a);var l=a?i():[];e.setValue(l)}}function i(){var t=e.getValueSelector(),n=e.getItems().toArray();return n.map(function(e){return t(void 0,{value:e})})}function o(t){r=t,e.setCheckAll(t)}var r=e.getCheckAll();e.onValueChanged(t),e.onCheckAllChanged(n)}function DataGridColumn(){this._values=Object.create(null)}function DataGridColumnBuilder(){}function DataGridRowBuilder(){_.superClass(DataGridRowBuilder,this)}function DataNavigation(e){_.superClass(DataNavigation,this,e)}function DataNavigationBuilder(){_.superClass(DataNavigationBuilder,this)}function Divider(e){_.superClass(Divider,this,e)}function DividerBuilder(){_.superClass(DividerBuilder,this)}function ExtensionPanel(e){_.superClass(ExtensionPanel,this,e)}function ExtensionPanelBuilder(){}function FileBox(e){_.superClass(FileBox,this,e),this.initialize_editorBase()}function FileBoxBuilder(){_.superClass(FileBoxBuilder,this),this.initialize_editorBaseBuilder()}function FileBoxValueConverter(e){this._element=e}function Form(e){_.superClass(Form,this,e)}function FormBuilder(){_.superClass(FormBuilder,this)}function Frame(){_.superClass(Frame,this),this.initialize_editorBase()}function FrameBuilder(){_.superClass(TextEditorBaseBuilder,this),this.initialize_editorBaseBuilder()}function GridPanel(e){_.superClass(GridPanel,this,e)}function GridPanelBuilder(){_.superClass(GridPanelBuilder,this)}function Icon(e){_.superClass(Icon,this,e)}function IconBuilder(){_.superClass(ButtonBuilder,this)}function ImageBox(e){_.superClass(ImageBox,this,e),this.initialize_editorBase()}function ImageBoxBuilder(){_.superClass(ImageBoxBuilder,this),this.initialize_editorBaseBuilder()}function ImageBoxValueConverter(e){this._element=e}function IndeterminateCheckBox(e){_.superClass(IndeterminateCheckBox,this,e),this.initialize_editorBase()}function IndeterminateCheckBoxBuilder(){_.superClass(IndeterminateCheckBoxBuilder,this),this.initialize_editorBaseBuilder()}function Label(e,t){_.superClass(Label,this,e,t),this.initialize_editorBase()}function LabelBuilder(){_.superClass(TextEditorBaseBuilder,this),this.initialize_editorBaseBuilder()}function Link(e){_.superClass(Link,this,e)}function LinkBuilder(){_.superClass(LinkBuilder,this)}function MenuBar(e){_.superClass(MenuBar,this,e)}function MenuBarBuilder(){_.superClass(MenuBarBuilder,this)}function NumericBox(e){_.superClass(NumericBox,this,e)}function NumericBoxBuilder(){_.superClass(NumericBoxBuilder,this)}function Panel(e){_.superClass(Panel,this,e)}function PanelBuilder(){_.superClass(PanelBuilder,this)}function PasswordBox(e){_.superClass(PasswordBox,this,e),this.initialize_editorBase()}function PasswordBoxBuilder(){_.superClass(PasswordBoxBuilder,this),this.initialize_editorBaseBuilder()}function PopupButton(e,t){_.superClass(PopupButton,this,e,t),this.buttonInit()}function PopupButtonBuilder(){_.superClass(PopupButtonBuilder,this)}function RadioGroupBuilder(){_.superClass(RadioGroupBuilder,this)}function ScrollPanel(e){_.superClass(ScrollPanel,this,e)}function ScrollPanelBuilder(){_.superClass(ScrollPanelBuilder,this)}function TabPanel(e){_.superClass(TabPanel,this,e)}function TabPanelBuilder(){_.superClass(TabPanelBuilder,this)}function TablePanel(e){_.superClass(TablePanel,this,e)}function TablePanelBuilder(){_.superClass(TablePanelBuilder,this)}function ToggleButton(e){_.superClass(ToggleButton,this,e),this.initialize_editorBase()}function ToggleButtonBuilder(){_.superClass(ToggleButtonBuilder,this),this.initialize_editorBaseBuilder()}function ToolBarBuilder(){_.superClass(ToolBarBuilder,this)}function TooltipBuilder(){_.superClass(TooltipBuilder,this)}function TreeView(e){_.superClass(TreeView,this,e)}function TreeViewBuilder(){_.superClass(TreeViewBuilder,this)}function View(e){_.superClass(View,this,e);var t=this;this.eventManager=new EventManager,this.openStrategy=new OpenModeDefaultStrategy,this.openStrategy.setView(this),this.members={},this.membersDeferreds={},this.handlers={onBeforeLoaded:$.Deferred(),onLoaded:$.Deferred(),onSelectedElementChange:null},this._initContext();var n=this.getView();n&&(n.onClosing&&n.onClosing(function(e,n){if(!t.isRemoved)return t.eventManager.trigger("onClosing",t.getContext(),t._getScriptArgs())}),n.onClosed&&n.onClosed(function(e,n){t.close(null,null,!0)})),this.control.get("dataSources").onChange(function(){t._initDataSourceHandlers()})}function ViewBuilder(){_.superClass(ViewBuilder,this)}function ViewPanel(e){_.superClass(ViewPanel,this,e)}function ViewPanelBuilder(){}function DataGridRow(e){_.superClass(DataGridRow,this,e),this._transformRowProperties({rowBackground:"background",rowForeground:"foreground",rowTextStyle:"textStyle",rowStyle:"style"})}function TabPage(e){_.superClass(TabPage,this,e),this.events=new EventsManager;var t=this;this.control.on("close",function(){t.close()})}function TabPageBuilder(){_.superClass(TabPageBuilder,this)}function Cell(e){_.superClass(Cell,this,e)}function CellBuilder(){_.superClass(CellBuilder,this)}function Row(e){_.superClass(Row,this,e)}function RowBuilder(){_.superClass(RowBuilder,this)}function BaseAction(e){this.parentView=e,this._properties=Object.create(null),_.defaults(this._properties,this.defaults),this.initDefaultValues()}function BaseEditAction(e){_.superClass(BaseEditAction,this,e)}function AcceptAction(e){_.superClass(AcceptAction,this,e)}function AcceptActionBuilder(){}function AddAction(e){_.superClass(AddAction,this,e)}function AddActionBuilder(){}function CancelAction(e){_.superClass(CancelAction,this,e)}function CancelActionBuilder(){}function CreateItemAction(){_.superClass(CreateItemAction,this)}function CreateItemActionBuilder(){}function DeleteAction(e){_.superClass(DeleteAction,this,e)}function DeleteActionBuilder(){}function EditAction(e){_.superClass(EditAction,this,e)}function EditActionBuilder(){}function OpenAction(e){_.superClass(OpenAction,this,e)}function OpenActionBuilder(){}function RouteToAction(){_.superClass(RouteToAction,this),this.href="",this.replace=!1}function RouteToActionBuilder(){}function SaveAction(e){_.superClass(SaveAction,this,e)}function SaveActionBuilder(){}function SelectAction(e){_.superClass(SelectAction,this,e)}function SelectActionBuilder(){}function DownloadExecutor(e,t,n){this.guid=guid(),this.options={timeout:6e4,poll:100},this.resultCallback=e,this.successCallback=t,this.failCallback=n}function ServerAction(e){_.superClass(ServerAction,this,e),this.provider=InfinniUI.providerRegister.build("ServerActionProvider"),this.updateContentTypeStrategy(),this.on("change:contentType",this.updateContentTypeStrategy)}function ServerActionBuilder(){}function UpdateAction(e){_.superClass(UpdateAction,this,e)}function UpdateActionBuilder(){}function ApplicationBuilder(){this.builder||(this.builder=new Builder,this.registerElementBuilders()),InfinniUI.global.factory=this}function Builder(){var e=[];this.appView=null,this.register=function(t,n){e[t]=n},this.buildType=function(t,n,i){if(i=i||{},"undefined"==typeof e[t])return null;var o=_.extend({builder:this,metadata:n},i),r=i.parentView?i.parentView.getContext():{};return e[t].build(r,o)},this.build=function(e,t){var n,i,o=null;t=t||{};for(var r in e){n=r;break}return"undefined"==typeof n||null===n?console.error("Builder: Не переданы метаданные"):(i=e[n],o=this.buildType(n,i,t)),
o},this.buildMany=function(e,t){var n=[];if(e)for(var i=0;i<e.length;i++){var o=this.build(e[i],t);null!==o&&n.push(o)}return n},this.buildBinding=function(e,t){var n=this.buildType("PropertyBinding",e,t);return n}}function MetadataProviderREST(e,t,n){this.getMetadata=function(i){var o=e.constructMetadataRequest();new RequestExecutor(i,t,n,this.cache).makeRequest(o)}}function QueryConstructorMetadata(e,t){this.constructMetadataRequest=function(){return{requestUrl:e+"/"+t.Path,method:"GET"}}}function RequestExecutor(e,t,n,i){var o=function(n){t&&t(n),e&&e(n)},r=function(t){n&&n(t),e&&e(t.responseJSON)},a=function(e,t){if("undefined"==typeof i||null===i)return t(e);var n=i.get(e);if(n!==!1){console.log("Fetch from cache");var r=$.Deferred();return o(n),r.resolve(n),r.promise()}return t(e).then(function(t){i.set(e,t)})},l=function(e,t){var n=new RequestExecutorDataStrategy(e);return n.request(t,o,r)};this.makeRequest=function(e){return a(e,l.bind(void 0,"json"))},this.makeRequestRaw=function(e){return a(e,l.bind(void 0,"raw"))}}function DataProviderRegister(){var e={};this.register=function(t,n){e[t]=n},this.build=function(t,n){var i=e[t];return"undefined"!=typeof i&&null!==i?new e[t](n):null}}function ObjectDataSourceBuilder(){}function ParameterBuilder(){this.build=function(e,t){var n,i=t.metadata,o=t.builder,r=t.parentView,a=t.basePathOfProperty;if("Value"in i){if(n=new Parameter({view:r}),n.setName(i.Name),InfinniUI.Metadata.isBindingMetadata(i.Value)){var l=o.buildBinding(i.Value,{parentView:r,basePathOfProperty:a});l.bindElement(n,"")}else n.setValue(i.Value);i.OnPropertyChanged&&n.onPropertyChanged("",function(e,t){var n=new ScriptExecutor(r);return n.executeScript(i.OnPropertyChanged,t)})}return n}}function BooleanFormatBuilder(){this.build=function(e,t){var n=new BooleanFormat;return n.setFalseText(t.metadata.FalseText),n.setTrueText(t.metadata.TrueText),n}}function DateTimeFormat(e){this.setFormat(e)}function DateTimeFormatBuilder(){this.build=function(e,t){var n=new DateTimeFormat;return n.setFormat(t.metadata.Format),"number"==typeof t.metadata.TimeZone&&n.setOptions({TimeZone:t.metadata.TimeZone}),n}}function NumberFormat(e){this.setFormat(e)}function NumberFormatBuilder(){this.build=function(e,t){var n=new NumberFormat;return n.setFormat(t.metadata.Format),n}}function ObjectFormat(e){this.setFormat(e),this.formatters=[DateTimeFormat,NumberFormat]}function ObjectFormatBuilder(){this.build=function(e,t){var n=new ObjectFormat;return n.setFormat(t.metadata.Format),n}}function LinkViewBuilderBase(){}function InlineViewBuilder(){_.superClass(InlineViewBuilder,this)}function LinkView(e){this.openMode="Default",this.parent=e,this.viewTemplate=function(){return""}}function MetadataViewBuilder(){_.superClass(MetadataViewBuilder,this)}function SpecialApplicationView(){this.isView=!0,this.getContainer=function(){return this.$container},this.open=function(e){this.$container=e,e&&e.addClass("special-application-view")},this.getApplicationView=function(){return this},this.getContext=function(){return null}}function subscribeRecalculationOnWindowResize(e){function t(){InfinniUI.AutoHeightService.recalculation(e)}var n,i=40,o=50;$(window).resize(function(){clearTimeout(n),n=setTimeout(_.debounce(t,o),i)})}function getHomePageLinkViewPromise(){var e=$.Deferred(),t=InfinniUI.config.homePage;return"string"==typeof t?$.ajax({url:t,dataType:"json"}).then(function(t){e.resolve({LinkView:{InlineView:{View:t}}})},function(e,t,n){console.error(t)}):e.resolve({LinkView:{AutoView:t}}),e.promise()}function ScriptBuilder(){}function ScriptExecutor(e){this.parent=e}function RouterService(e){var t=function(e){var t={};t.routes={};for(var n=0,o=e.length;n<o;n+=1){if(e[n].originalPath=e[n].Path,e[n].Path.search("<%")!==-1)for(var r,a,l=/\<\%[\sa-zA-Z0-9]+\%\>/g;r=l.exec(e[n].Path);)a=r[0].replace(/\s+/g,"").slice(2,-2),e[n].Path=e[n].Path.slice(0,r.index)+":"+a+e[n].Path.slice(r.index+r[0].length),l.lastIndex=r.index+a.length;t.routes[e[n].Path.slice(1)]=e[n].Name,t[e[n].Name]=i(e[n].Name,e[n].Action)}return t},n=function(t,n){for(var i=n||"yes",o=0,r=e.length;o<r;o+=1)if(e[o].Name===t)return"yes"===i?e[o].originalPath:e[o].Path},i=function(e,t){return function(){var n={name:e,params:Array.prototype.slice.call(arguments),routeParams:u._params};new ScriptExecutor({getContext:function(){return u._context||"No context"}}).executeScript(t,n)}},o=t(e),r=function(){if(InfinniUI.AppRouter)console.log("Попытка повторно запустить routerService");else{var e=Backbone.Router.extend(o);InfinniUI.AppRouter=new e,Backbone.history=Backbone.history||new Backbone.History({}),Backbone.history.start(InfinniUI.config.historyAPI)}},a=function(e){this._context=e},l=function(e){this._params=e},s=function(e){this._params=_.extend(this._params||{},e)},u={getLinkByName:n,startRouter:r,setContext:a,setParams:l,addParams:s};return u}window.InfinniUI=window.InfinniUI||{},window.InfinniUI.Template=window.InfinniUI.Template||{},window.InfinniUI.Template["controls/loaderIndicator/template.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div id="loaderIndicator" style="display:none;">\n    <div class="cssload-spin-box"></div>\n</div>';return __p},window.InfinniUI.Template["linkView/template/dialog.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}function dialogWidthClass(e){return"small"==e?"modal-sm":"large"==e?"modal-lg":""}function dialogWidthValue(e){return 0==e.search(/\d/)?"width:"+e+";":""}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='\n\n<div class="modal container modal-scrollable" id="full-width" tabindex="-1" role="dialog" aria-hidden="false">\n    <div class="modal-dialog '+(null==(__t=dialogWidthClass(dialogWidth))?"":__t)+'" style="'+(null==(__t=dialogWidthValue(dialogWidth))?"":__t)+'">\n        <div class="modal-content">\n            <div class="modal-header">\n                <button type="button" class="close firstfocuselementinmodal pl-close-modal">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n                <h4 class="modal-title"></h4>\n            </div>\n            <div class="modal-body"></div>\n        </div>\n    </div>\n</div>';return __p},window.InfinniUI.Template["controls/buttonEdit/template/textBoxArea.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="pl-control-label" for="'+__e(guid)+'"></label>\r\n<textarea class="pl-control pl-control-editor pl-editor form-control pl-text-area-input" id="'+__e(guid)+'"></textarea>\r\n\r\n<div class="pl-control-hint-text help-block hidden"></div>\r\n<div class="pl-control-error-text help-block hidden"></div>\r\n<div class="pl-control-warning-text help-block hidden"></div>';return __p},window.InfinniUI.Template["controls/buttonEdit/template/textBoxInput.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="pl-control-label" for="'+__e(guid)+'"></label>\r\n\r\n<div class="input-group pl-button-edit-group">\r\n    <input class="pl-control form-control pl-control-editor pl-editor pl-text-box-input pl-button-edit-group__control" type="text" id="'+__e(guid)+'">\r\n    <span class="pl-button-edit-button pl-button-edit-button_clear input-group-addon">\r\n        <i class="pl-button-edit-button__icon pl-button-edit-button__icon_clear fa fa-times"></i>\r\n    </span>\r\n    <span class="pl-button-edit-button pl-button-edit-button_action input-group-addon">\r\n        <i class="pl-button-edit-button__icon pl-button-edit-button__icon_action fa"></i>\r\n    </span>\r\n</div>\r\n\r\n<div class="pl-control-hint-text help-block hidden"></div>\r\n<div class="pl-control-error-text help-block hidden"></div>\r\n<div class="pl-control-warning-text help-block hidden"></div>\r\n\r\n\r\n';return __p},window.InfinniUI.Template["controls/checkBox/template/checkBox.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="checkbox">\r\n    <label>\r\n        <input type="checkbox" id="'+__e(guid)+'">\r\n        <span class="checkbox-custom-body"></span>\r\n        <span class="checkbox-label"></span>\r\n    </label>\r\n</div>';return __p},window.InfinniUI.Template["controls/comboBox/template/combobox.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="pl-control-label" for="'+__e(guid)+'"></label>\n\n<div class="input-group control-wrap">\n    <div class="pl-control form-control" id="'+__e(guid)+'">\n        <div class="pl-combobox__value"></div>\n    </div>\n    <span class="pl-combobox__clear input-group-addon"><i class="fa fa-times"></i></span>\n    <span class="pl-combobox__grip input-group-addon"><i class="fa fa-chevron-down"></i></span>\n</div>\n';return __p},window.InfinniUI.Template["controls/contextMenu/template/contextMenu.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="pl-popup-button__dropdown">\n    <ul class="pl-popup-button__items dropdown-menu">\n        ',items.forEach(function(e,t){__p+='\n        <li class="pl-popup-button__item"></li>\n        '}),__p+="\n    </ul>\n</div>\n";return __p},window.InfinniUI.Template["controls/dataGrid/template/dataGrid.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-datagrid__head">\n    <div class="pl-datagrid-container pl-datagrid-container_head">\n        <table class="pl-datagrid-table pl-datagrid-table_head table">\n            <thead>\n            <tr class="pl-datagrid-row pl-datagrid-row_first">\n                <td class="pl-datagrid-row__cell pl-datagrid-row__cell_width pl-datagrid-row__cell_checker" style=""></td>\n            </tr>\n            <tr class="pl-datagrid-row pl-datagrid-row_header">\n                <th class="pl-datagrid-row__cell pl-datagrid-row__cell_toggle">\n                    <div class="pl-datagrid-toggle  pl-datagrid-toggle_all">\n                        <input class="pl-datagrid-toggle__button" type="checkbox"><span></span>\n                    </div>\n                </th>\n            </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<div class="pl-datagrid__body">\n    <table class="pl-datagrid-table pl-datagrid-table_body table">\n        <tbody>\n        <tr class="pl-datagrid-row pl-datagrid-row_first">\n            <td class="pl-datagrid-row__cell pl-datagrid-row__cell_width pl-datagrid-row__cell_checker" style=""></td>\n        </tr>\n        </tbody>\n    </table>\n</div>\n\n';return __p},window.InfinniUI.Template["controls/dataGrid/template/dataGridWithoutScroll.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-datagrid__body">\n    <table class="pl-datagrid-table pl-datagrid-table_body table">\n        <thead>\n        <tr class="pl-datagrid-row pl-datagrid-row_first">\n            <td class="pl-datagrid-row__cell pl-datagrid-row__cell_width pl-datagrid-row__cell_checker" style=""></td>\n        </tr>\n        <tr class="pl-datagrid-row pl-datagrid-row_header">\n            <th class="pl-datagrid-row__cell pl-datagrid-row__cell_toggle">\n                <div class="pl-datagrid-toggle pl-datagrid-toggle_all">\n                    <input class="pl-datagrid-toggle__button" type="checkbox"><span></span>\n                </div>\n            </th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</div>\n';return __p},window.InfinniUI.Template["controls/dataGrid/template/headerCell.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<th class="pl-datagrid-row__cell"></th>';return __p},window.InfinniUI.Template["controls/dataGrid/template/sizeCell.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<td class="pl-datagrid-row__cell pl-datagrid-row__cell_width" style=""></td>';return __p},window.InfinniUI.Template["controls/dataNavigation/template/dataNavigation.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-data-navigation-size">\r\n\r\n    <div class="pl-page-size">\r\n\r\n    </div>\r\n</div>\r\n\r\n<div class="pl-data-navigation-pager">\r\n    <nav>\r\n        <ul class="pagination">\r\n\r\n        </ul>\r\n    </nav>\r\n</div>\r\n\r\n';return __p},window.InfinniUI.Template["controls/dateTimePicker/template/date.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="pl-control-label" for="'+__e(guid)+'"></label>\r\n\r\n\r\n<div class="input-group">\r\n    <input class="pl-editor pl-control form-control pl-datepicker-input" type="text" id="'+__e(guid)+'" >\r\n\r\n    <span class="pl-datepicker-calendar input-group-addon"><i class="fa fa-calendar"></i></span>\r\n</div>\r\n\r\n\r\n\r\n<div class="pl-control-hint-text help-block hidden"></div>\r\n<div class="pl-control-error-text help-block hidden"></div>\r\n<div class="pl-control-warning-text help-block hidden"></div>';return __p},window.InfinniUI.Template["controls/dateTimePicker/template/dateTime.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="pl-control-label" for="'+__e(guid)+'"></label>\r\n\r\n<div class="input-group">\r\n    <input class="pl-editor pl-control form-control pl-datepicker-input" type="text" id="'+__e(guid)+'" >\r\n    <span class="pl-datepicker-calendar input-group-addon"><i class="fa fa-calendar"></i></span>\r\n</div>\r\n\r\n<div class="pl-control-hint-text help-block hidden"></div>\r\n<div class="pl-control-error-text help-block hidden"></div>\r\n<div class="pl-control-warning-text help-block hidden"></div>';return __p},window.InfinniUI.Template["controls/dateTimePicker/template/select.date.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="backdrop"></div>\n\n\n<div class="datepicker-date pl-dropdown-content">\n    <div class="days"></div>\n    <div class="months" style="display: none;"></div>\n    <div class="years"  style="display: none;"></div>\n    <div class="pl-datepicker-footer btn-group btn-group-sm" role="group">\n        <a class="today today-date btn btn-default">'+(null==(__t=InfinniUI.localized.strings.DateTimePicker.today)?"":__t)+'</a>\n        <a class="datepicker-clear btn btn-default">'+(null==(__t=InfinniUI.localized.strings.DateTimePicker.clear)?"":__t)+"</a>\n    </div>\n</div>\n\n";return __p},window.InfinniUI.Template["controls/dateTimePicker/template/select.dateTime.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="backdrop"></div>\n\n<div class="datepicker-datetime pl-dropdown-content">\n        <div class="days"></div>\n        <div class="months" style="display: none;"></div>\n        <div class="years"  style="display: none;"></div>\n        <div class="times" style="display: none;"></div>\n        <div class="hours" style="display: none;"></div>\n        <div class="minutes" style="display: none;"></div>\n\n        <div class="pl-datetimepicker-footer btn-group btn-group-sm" role="group">\n            <a class="datepicker-clear btn btn-default">'+(null==(__t=InfinniUI.localized.strings.DateTimePicker.clear)?"":__t)+"</a>\n        </div>\n    </div>\n</div>\n\n";return __p},window.InfinniUI.Template["controls/dateTimePicker/template/select.time.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="backdrop"></div>\n\n<div class="datepicker-time pl-dropdown-content">\n    <div class="times"></div>\n    <div class="hours" style="display: none;"></div>\n    <div class="minutes" style="display: none;"></div>\n    <div class="seconds" style="display: none;"></div>\n    <div class="pl-datetimepicker-footer btn-group btn-group-sm" role="group">\n        <a class="datepicker-clear btn btn-default">'+(null==(__t=InfinniUI.localized.strings.DateTimePicker.clear)?"":__t)+"</a>\n    </div>\n</div>\n\n\n";return __p},window.InfinniUI.Template["controls/dateTimePicker/template/time.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="pl-control-label" for="'+__e(guid)+'"></label>\r\n\r\n<div class="input-group">\r\n    <input class="pl-editor pl-control form-control pl-datepicker-input" type="text" id="'+__e(guid)+'" >\r\n    <span class="pl-datepicker-calendar input-group-addon"><i class="fa fa-clock-o"></i></span>\r\n</div>\r\n\r\n<div class="pl-control-hint-text help-block hidden"></div>\r\n<div class="pl-control-error-text help-block hidden"></div>\r\n<div class="pl-control-warning-text help-block hidden"></div>';return __p},window.InfinniUI.Template["controls/fileBox/template/template.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="form-group">\n    <label class="pl-control-label">Прикрепленный файл</label>\n\n    <div class="input-group pl-filebox-edit">\n        <span class="form-control pl-filebox-file-empty">'+(null==(__t=InfinniUI.localized.strings.FileBox.noFile)?"":__t)+'</span><!-- Файла нет -->\n\n        <span class="form-control pl-filebox-file-upload"><span>filename.ext</span></span><!-- Файл выбран на загрузку -->\n\n        <span class="form-control pl-filebox-file-download"><!-- Файл загружен -->\n            <a href="javascript:;" title="Скачать файл" class="pl-filebox-file-download-url" target="_blank">filename.ext</a>\n        </span>\n\n        <span class="input-group-btn">\n            <label class="btn btn-default pl-filebox-btn-pick" for="file'+__e(guid)+'"><!-- Выбор файла на для загрузки -->\n                <span class="fa fa-folder-open"></span>\n            </label>\n\n             <button class="btn btn-default pl-filebox-btn-remove" type="button"><!-- Удаление выбранного или загруженного файла -->\n                 <span class="fa fa-times"></span>\n             </button>\n        </span>\n\n    </div>\n\n    <div class="pl-control-hint-text pl-text-wrapping"></div>\n    <div class="pl-control-error-text pl-text-wrapping"></div>\n    <div class="pl-control-warning-text pl-text-wrapping"></div>\n\n\n    <input type="file" class="hidden" id="file'+__e(guid)+'">\n</div>\n';return __p},window.InfinniUI.Template["controls/form/template/form.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)items.forEach(function(e,t){__p+='\n    <div class="pl-form-i pl-clearfix"></div>\n'}),__p+="\n";return __p},window.InfinniUI.Template["controls/frame/template/frame.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<iframe style="width: 100%;border: none;"></iframe>';return __p},window.InfinniUI.Template["controls/gridPanel/template/row.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-clearfix"></div>';return __p},window.InfinniUI.Template["controls/imageBox/template/imageBox.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="pl-image">\n    <div class="pl-image-wrapper">\n      <img src="">\n    </div>\n    <span class="pl-image-remove" type="button" title="Удалить"></span>\n</div>\n\n<div class="pl-image-file">\n    <input type="file" class="pl-image-file-input" id="'+__e(guid)+'" tabindex="-1">\n    <label class="pl-image-file-upload-button" for="'+__e(guid)+'">Выберите файл</label>\n</div>\n\n<div class="pl-control-hint-text pl-text-wrapping"></div>\n<div class="pl-control-error-text pl-text-wrapping"></div>\n<div class="pl-control-warning-text pl-text-wrapping"></div>\n\n\n';return __p},window.InfinniUI.Template["controls/indeterminateCheckBox/template/indeterminateCheckBox.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="indeterminateCheckBox">\n\t<label>\n\t\t<input type="checkbox" id="'+__e(guid)+'">\n\t\t<span class="indeterminateCheckBox-custom-body"></span>\n\t\t<span class="indeterminateCheckBox-label"></span>\n\t</label>\n</div>\n';return __p},window.InfinniUI.Template["controls/menuBar/template/menuBar.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="container-fluid">\n    ',items.forEach(function(e,t){__p+='\n    <ul class="nav navbar-nav">\n        <li class="pl-menu-bar-item"></li>\n    </ul>\n    '}),__p+="\n</div>\n\n";return __p},window.InfinniUI.Template["controls/numericBox/template/numericBox.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="pl-control-label" for="'+__e(guid)+'"></label>\r\n<div class="input-group">\r\n    <span class="pl-numeric-box-min input-group-addon"><i class="fa fa-minus"></i></span>\r\n    <input  class="pl-editor pl-control form-control pl-numeric-box-input" type="text" id="'+__e(guid)+'" >\r\n    <span class="pl-numeric-box-max input-group-addon"><i class="fa fa-plus"></i></span>\r\n</div>\r\n\r\n<div class="pl-control-hint-text help-block hidden"></div>\r\n<div class="pl-control-error-text help-block hidden"></div>\r\n<div class="pl-control-warning-text help-block hidden"></div>\r\n\r\n\r\n';return __p},window.InfinniUI.Template["controls/panel/template/panel.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="pl-panel-header panel-heading">Panel header</div>\n<div class="pl-panel-body panel-body">\n    ',items.forEach(function(e,t){__p+='\n    <div class="pl-panel-i"></div>\n    '}),__p+="\n</div>";return __p},window.InfinniUI.Template["controls/passwordBox/template/passwordBox.off.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<form autocomplete="off" onsubmit="return false;">\r\n<label class="pl-control-label" for="'+__e(guid)+'"></label>\r\n<input class="pl-control form-control pl-password-box-input" type="password" id="'+__e(guid)+'">\r\n<div class="pl-control-hint-text help-block hidden"></div>\r\n<div class="pl-control-error-text help-block hidden"></div>\r\n<div class="pl-control-warning-text help-block hidden"></div>\r\n</form>';return __p},window.InfinniUI.Template["controls/passwordBox/template/passwordBox.on.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="pl-control-label" for="'+__e(guid)+'"></label>\r\n<input class="pl-control form-control pl-password-box-input" type="password" id="'+__e(guid)+'">\r\n<div class="pl-control-hint-text help-block hidden"></div>\r\n<div class="pl-control-error-text help-block hidden"></div>\r\n<div class="pl-control-warning-text help-block hidden"></div>';return __p},window.InfinniUI.Template["controls/scrollPanel/template/scrollPanel.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="pl-scrollpanel-body">\n    ',items.forEach(function(e,t){__p+='\n    <div class="pl-scrollpanel-i"></div>\n    '}),__p+="\n</div>";return __p},window.InfinniUI.Template["controls/tabPanel/template/tabPanel.bottom.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-tabpanel-content"></div>\n<ul class="pl-tabpanel-header nav nav-pills"></ul>';return __p},window.InfinniUI.Template["controls/tabPanel/template/tabPanel.left.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="row">\n    <div class="col-sm-3">\n        <ul class="pl-tabpanel-header nav nav-pills nav-stacked"></ul>\n    </div>\n    <div class="col-sm-9">\n        <div class="pl-tabpanel-content"></div>\n    </div>\n</div>\n\n';return __p},window.InfinniUI.Template["controls/tabPanel/template/tabPanel.none.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-tabpanel-content"></div>\n<div class="pl-tabpanel-header hidden"></div>';return __p},window.InfinniUI.Template["controls/tabPanel/template/tabPanel.right.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="row">\n    <div class="col-sm-9">\n        <div class="pl-tabpanel-content"></div>\n    </div>\n    <div class="col-sm-3">\n        <ul class="pl-tabpanel-header nav nav-pills nav-stacked"></ul>\n    </div>\n</div>\n\n';return __p},window.InfinniUI.Template["controls/tabPanel/template/tabPanel.top.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<ul class="pl-tabpanel-header nav nav-pills"></ul>\n<div class="pl-tabpanel-content"></div>';return __p},window.InfinniUI.Template["controls/textBox/template/multiline.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="pl-control-label" for="'+__e(guid)+'"></label>\r\n\r\n<textarea class="pl-editor pl-control form-control pl-text-area-input" id="'+__e(guid)+'"></textarea>\r\n\r\n<div class="pl-control-hint-text help-block hidden"></div>\r\n<div class="pl-control-error-text help-block hidden"></div>\r\n<div class="pl-control-warning-text help-block hidden"></div>';return __p},window.InfinniUI.Template["controls/textBox/template/oneline.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="pl-control-label" for="'+__e(guid)+'"></label>\r\n\r\n<input class="pl-editor pl-control form-control pl-text-box-input pl-control-editor" type="text" id="'+__e(guid)+'">\r\n\r\n<div class="pl-control-hint-text help-block hidden"></div>\r\n<div class="pl-control-error-text help-block hidden"></div>\r\n<div class="pl-control-warning-text help-block hidden"></div>\r\n\r\n';return __p},window.InfinniUI.Template["controls/toggleButton/template/toggleButton.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="togglebutton-box">\r\n    <div class="togglebutton-container">\r\n        <span class="togglebutton-handle-on"></span>\r\n        <span class="togglebutton-handle-label">&nbsp;</span>\r\n        <span class="togglebutton-handle-off"></span>\r\n    </div>\r\n</div>';return __p},window.InfinniUI.Template["controls/toolBar/template/toolBar.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-tool-bar__container"></div>';return __p},window.InfinniUI.Template["controls/toolBar/template/toolBarItem.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div style="display: inline-block;"></div>';return __p},window.InfinniUI.Template["controls/treeView/template/node-checkbox.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-treeview-node__button"><!-- pl-treeview-node__button_collapse -->\r\n    <span class="pl-treeview-node__icon pl-treeview-node__icon_collapsed fa fa-fw fa-plus-square-o"></span>\r\n    <span class="pl-treeview-node__icon pl-treeview-node__icon_expanded fa fa-fw fa-minus-square-o "></span>\r\n    <span class="pl-treeview-node__icon pl-treeview-node__icon_blank fa fa-fw"></span>\r\n    <!-- expand/collapse button -->\r\n</div>\r\n\r\n<div class="pl-treeview-node__item pl-treeview-item"><!-- pl-treeview-item_checked -->\r\n    <div class="pl-treeview-item__checker pl-treeview-item__checker_checkbox">\r\n        <span class="pl-treeview-node__icon pl-treeview-node__icon_checked fa fa-fw fa-check-square-o"></span>\r\n        <span class="pl-treeview-node__icon pl-treeview-node__icon_unchecked fa fa-fw fa-square-o"></span>\r\n    </div>\r\n\r\n    <div class="pl-treeview-item__content"><!-- pl-treeview-item__content_selected -->\r\n        <!-- item content HTML markup -->\r\n    </div>\r\n</div>\r\n\r\n<div class="pl-treeview-node__items"><!-- pl-treeview-node__items_expanded -->\r\n    <!-- subitems list -->\r\n</div>';return __p},window.InfinniUI.Template["controls/treeView/template/node-radio.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-treeview-node__button"><!-- pl-treeview-node__button_collapse -->\r\n    <span class="pl-treeview-node__icon pl-treeview-node__icon_collapsed fa fa-fw fa-plus-square-o"></span>\r\n    <span class="pl-treeview-node__icon pl-treeview-node__icon_expanded fa fa-fw fa-minus-square-o "></span>\r\n    <span class="pl-treeview-node__icon pl-treeview-node__icon_blank fa fa-fw"></span>\r\n    <!-- expand/collapse button -->\r\n</div>\r\n\r\n<div class="pl-treeview-node__item pl-treeview-item"><!-- pl-treeview-item_checked -->\r\n    <div class="pl-treeview-item__checker pl-treeview-item__checker_radio"></div>\r\n\r\n    <div class="pl-treeview-item__content"><!-- pl-treeview-item__content_selected -->\r\n        <!-- item content HTML markup -->\r\n    </div>\r\n</div>\r\n\r\n<div class="pl-treeview-node__items"><!-- pl-treeview-node__items_expanded -->\r\n    <!-- subitems list -->\r\n</div>';return __p},window.InfinniUI.Template["controls/treeView/template/treeview.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+="";return __p},window.InfinniUI.Template["services/ajaxLoaderIndicator/template/template.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-ajaxloader-indicator"></div>';return __p},window.InfinniUI.Template["services/messageBox/template/default.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="modal-dialog">\n    <div class="modal-content pl-messagebox pl-messagebox_'+(null==(__t=type)?"":__t)+'">\n        <div class="modal-body pl-messagebox__body">\n            <p class="pl-messagebox-content">\n                <i class="fa-lg fa fa-warning pl-messagebox-content__icon pl-messagebox-content__icon_'+(null==(__t=type)?"":__t)+'"></i>\n                '+(null==(__t=text)?"":__t)+'\n            </p>\n        </div>\n\n        <div class="modal-footer pl-messagebox__footer">\n            ',buttons.forEach(function(e,t){__p+="\n\n            ",__p+=0===t?'\n            <a href tabindex="0"\n               class="btn firstfocuselementinmodal pl-messagebox-button pl-messagebox-button_'+(null==(__t=e.type)?"":__t)+'"\n               data-index="'+(null==(__t=t)?"":__t)+'">'+(null==(__t=e.name)?"":__t)+"</a>\n            ":'\n            <a href class="btn pl-messagebox-button pl-messagebox-button_'+(null==(__t=e.type)?"":__t)+'"\n               data-index="'+(null==(__t=t)?"":__t)+'">'+(null==(__t=e.name)?"":__t)+"</a>\n            "}),__p+='\n\n            <div class="lastfocuselementinmodal" tabindex="0"></div>\n        </div>\n\n    </div>\n\n</div>\n';return __p},window.InfinniUI.Template["controls/button/commonView/template/button.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<button class="btntext btn"></button>\n';return __p},window.InfinniUI.Template["controls/comboBox/values/template/value.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-combobox-value-item"></div>\n<a class="pl-combobox-value-remove" tabindex="-1">&times;</a>';return __p},window.InfinniUI.Template["controls/comboBox/values/template/values.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<li class="pl-combobox-search">\n    <input class="pl-combobox-search-text" type="text">\n</li>\n\n\n<style>\n    .pl-combobox-values {\n        margin: 0;\n        padding: 0;\n    }\n\n    .pl-combobox-values:before, .pl-combobox-values:after {\n        content: "";\n        display: table;\n    }\n\n    .pl-combobox-values:after {\n        clear: both;\n    }\n\n    .pl-combobox-value, .pl-combobox-search {\n        display: block;\n        float: left;\n    }\n\n    .pl-combobox-value {\n        border: 1px solid #adadad;\n        border-radius: 4px;\n        margin-right: 4px;\n    }\n\n    .pl-combobox-value-item, .pl-combobox-value-remove {\n        float: left;\n        display: block;\n    }\n\n    .pl-combobox-value-remove {\n        margin: 0 4px;\n        cursor: pointer;\n        outline: none;\n        font-weight: 600;\n    }\n\n    .pl-combobox-value-remove, .pl-combobox-value-remove:hover, .pl-combobox-value-remove:focus {\n        text-decoration: none;\n        outline: none;\n    }\n\n    .pl-combobox-search input {\n        border: none;\n        outline: none;\n    }\n\n</style>';
return __p},window.InfinniUI.Template["controls/dataGrid/dataGridRow/template/dataCell.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<td class="pl-datagrid-row__cell"></td>';return __p},window.InfinniUI.Template["controls/dataGrid/dataGridRow/template/multiSelect.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<td class="pl-datagrid-row__cell pl-datagrid-row__cell_toggle">\r\n\t<div class="pl-datagrid-toggle">\r\n\t\t<input class="pl-datagrid-toggle__button" type="checkbox"><span></span>\r\n\t</div>\r\n</td>';return __p},window.InfinniUI.Template["controls/dataGrid/dataGridRow/template/singleSelect.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<td class="pl-datagrid-row__cell pl-datagrid-row__cell_toggle">\r\n\t <div class="pl-datagrid-toggle">\r\n    \t<input class="pl-datagrid-toggle__button" type="radio"><span></span>\r\n    </div>\r\n</td>';return __p},window.InfinniUI.Template["controls/dataNavigation/buttons/template/next.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<a href="javascript:;"><span>&raquo;</span></a>';return __p},window.InfinniUI.Template["controls/dataNavigation/buttons/template/page.tpl.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<a href="javascript:;">'+__e(pageNumber+1)+"</a>";return __p},window.InfinniUI.Template["controls/dataNavigation/buttons/template/prev.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<a href="javascript:;"><span>&laquo;</span></a>';return __p},window.InfinniUI.Template["controls/dataNavigation/pageSizes/template/pageSizes.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<button type="button" class="btn btn-default ',active&&(__p+="active"),__p+='" data-size="'+(null==(__t=size)?"":__t)+'">'+(null==(__t=size)?"":__t)+"</button>";return __p},window.InfinniUI.Template["controls/dateTimePicker/template/date/days.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<table>\n    <thead>\n    <tr class="navigation">\n        <th class="navigation-prev">\n            <button class="btn-month-prev btn btn-default"><i class="fa fa-caret-left"></i></button>\n        </th>\n        <th colspan="5" class="years">\n            <span class="years-month"></span>\n            <span class="years-year"></span>\n        </th>\n        <th class="navigation-next">\n            <button class="btn-month-next btn btn-default"><i class="fa fa-caret-right"></i></button>\n        </th>\n    </tr>\n    <tr class="weekdays weekdays-head">\n        <th class="day"></th>\n        <th class="day"></th>\n        <th class="day"></th>\n        <th class="day"></th>\n        <th class="day"></th>\n        <th class="day"></th>\n        <th class="day"></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class="weekdays weekdays-calendar">\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n    </tr>\n    <tr class="weekdays weekdays-calendar">\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n    </tr>\n    <tr class="weekdays weekdays-calendar">\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n    </tr>\n    <tr class="weekdays weekdays-calendar">\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n    </tr>\n    <tr class="weekdays weekdays-calendar">\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n    </tr>\n    <tr class="weekdays weekdays-calendar">\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n         <td class="day day-calendar"></td>\n    </tr>\n    </tbody>\n</table>\n<div>\n    <a class="time btn btn-link">'+(null==(__t=InfinniUI.localized.strings.DateTimePicker.time)?"":__t)+"</a>\n</div>\n";return __p},window.InfinniUI.Template["controls/dateTimePicker/template/date/months.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<table>\r\n    <thead>\r\n    <tr class="navigation">\r\n        <th class="navigation-prev">\r\n            <button class="btn-year btn-year-prev btn btn-default"><i class="fa fa-caret-left"></i></button>\r\n        </th>\r\n        <th class="year" colspan="2">Год</th>\r\n        <th class="navigation-next">\r\n            <button class="btn-year btn-year-next btn btn-default"><i class="fa fa-caret-right"></i></button>\r\n        </th>\r\n    </tr>\r\n    </thead>\r\n    <tbody class="month-list">\r\n    <tr>\r\n        <td class="month"></td>\r\n        <td class="month"></td>\r\n        <td class="month"></td>\r\n        <td class="month"></td>\r\n    </tr>\r\n    <tr>\r\n        <td class="month"></td>\r\n        <td class="month"></td>\r\n        <td class="month"></td>\r\n        <td class="month"></td>\r\n    </tr>\r\n    <tr>\r\n        <td class="month"></td>\r\n        <td class="month"></td>\r\n        <td class="month"></td>\r\n        <td class="month"></td>\r\n    </tr>\r\n    </tbody>\r\n</table>';return __p},window.InfinniUI.Template["controls/dateTimePicker/template/date/years.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<table>\r\n    <thead>\r\n    <tr class="navigation">\r\n        <th class="navigation-prev">\r\n            <button class="btn-year btn-year-prev btn btn-default"><i class="fa fa-caret-left"></i></button>\r\n        </th>\r\n        <th colspan="2">\r\n            <span class="year-begin"></span>\r\n            -\r\n            <span class="year-end"></span>\r\n        </th>\r\n        <th class="navigation-next">\r\n            <button class="btn-year btn-year-next btn btn-default"><i class="fa fa-caret-right"></i></button>\r\n        </th>\r\n    </tr>\r\n    </thead>\r\n    <tbody class="year-list">\r\n    <tr class="years">\r\n        <td class="year year-begin">1999</td>\r\n        <td class="year">2000</td>\r\n        <td class="year">2001</td>\r\n        <td class="year">2002</td>\r\n    </tr>\r\n    <tr class="years">\r\n        <td class="year">2003</td>\r\n        <td class="year">2004</td>\r\n        <td class="year">2005</td>\r\n        <td class="year">2006</td>\r\n    </tr>\r\n    <tr class="years">\r\n        <td class="year">2003</td>\r\n        <td class="year">2004</td>\r\n        <td class="year">2005</td>\r\n        <td class="year">2006</td>\r\n    </tr>\r\n    <tr class="years">\r\n        <td class="year">2003</td>\r\n        <td class="year">2004</td>\r\n        <td class="year">2005</td>\r\n        <td class="year">2006</td>\r\n    </tr>\r\n    <tr class="years">\r\n        <td class="year">2007</td>\r\n        <td class="year">2008</td>\r\n        <td class="year">2009</td>\r\n        <td class="year year-end">2010</td>\r\n    </tr>\r\n    </tbody>\r\n</table>';return __p},window.InfinniUI.Template["controls/dateTimePicker/template/time/hours.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<style>\r\n    .timepicker-hours .hour {\r\n        padding: 10px;\r\n    }\r\n\r\n    .hour-unavailable {\r\n        background-color: #dddddd;\r\n        cursor: not-allowed;\r\n        color: #777777;\r\n        opacity: 1;\r\n    }\r\n\r\n    .timepicker-hours {\r\n        cursor: pointer;\r\n    }\r\n\r\n    .hour-today {\r\n        background: #d4e2ee;\r\n    }\r\n\r\n    .hour-selected {\r\n        border: 1px solid #FF0000;\r\n    }\r\n</style>\r\n<div class="timepicker-hours">\r\n    <table>\r\n        <tbody>\r\n        <tr>\r\n            <td class="hour">00</td>\r\n            <td class="hour">01</td>\r\n            <td class="hour">02</td>\r\n            <td class="hour">03</td>\r\n        </tr>\r\n        <tr>\r\n            <td class="hour">04</td>\r\n            <td class="hour">05</td>\r\n            <td class="hour">06</td>\r\n            <td class="hour">07</td>\r\n        </tr>\r\n        <tr>\r\n            <td class="hour">08</td>\r\n            <td class="hour">09</td>\r\n            <td class="hour">10</td>\r\n            <td class="hour">11</td>\r\n        </tr>\r\n\r\n        <tr>\r\n            <td class="hour">12</td>\r\n            <td class="hour">13</td>\r\n            <td class="hour">14</td>\r\n            <td class="hour">15</td>\r\n        </tr>\r\n        <tr>\r\n            <td class="hour">16</td>\r\n            <td class="hour">17</td>\r\n            <td class="hour">18</td>\r\n            <td class="hour">19</td>\r\n        </tr>\r\n        <tr>\r\n            <td class="hour">20</td>\r\n            <td class="hour">21</td>\r\n            <td class="hour">22</td>\r\n            <td class="hour">23</td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n';return __p},window.InfinniUI.Template["controls/dateTimePicker/template/time/minutes.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<style>\r\n    .minute {\r\n        padding: 10px;\r\n    }\r\n\r\n    .minute-unavailable {\r\n        background-color: #dddddd;\r\n        cursor: not-allowed;\r\n        color: #777777;\r\n        opacity: 1;\r\n    }\r\n\r\n    .timepicker-minutes {\r\n        cursor: pointer;\r\n    }\r\n\r\n    .minute-selected {\r\n        border: 1px solid #FF0000;\r\n    }\r\n\r\n</style>\r\n<div class="timepicker-minutes">\r\n    <table>\r\n        <tbody>\r\n        <tr>\r\n            <td class="minute" data-minute="0">00</td>\r\n            <td class="minute" data-minute="5">05</td>\r\n            <td class="minute" data-minute="10">10</td>\r\n            <td class="minute" data-minute="15">15</td>\r\n        </tr>\r\n        <tr>\r\n            <td class="minute" data-minute="20">20</td>\r\n            <td class="minute" data-minute="25">25</td>\r\n            <td class="minute" data-minute="30">30</td>\r\n            <td class="minute" data-minute="35">35</td>\r\n        </tr>\r\n        <tr>\r\n            <td class="minute" data-minute="40">40</td>\r\n            <td class="minute" data-minute="45">45</td>\r\n            <td class="minute" data-minute="50">50</td>\r\n            <td class="minute" data-minute="55">55</td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n</div>';return __p},window.InfinniUI.Template["controls/dateTimePicker/template/time/seconds.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="timepicker-seconds">\r\n    <table>\r\n        <tbody>\r\n        <tr>\r\n            <td class="second" data-second="0">00</td>\r\n            <td class="second" data-second="5">05</td>\r\n            <td class="second" data-second="10">10</td>\r\n            <td class="second" data-second="15">15</td>\r\n        </tr>\r\n        <tr>\r\n            <td class="second" data-second="20">20</td>\r\n            <td class="second" data-second="25">25</td>\r\n            <td class="second" data-second="30">30</td>\r\n            <td class="second" data-second="35">35</td>\r\n        </tr>\r\n        <tr>\r\n            <td class="second" data-second="40">40</td>\r\n            <td class="second" data-second="45">45</td>\r\n            <td class="second" data-second="50">50</td>\r\n            <td class="second" data-second="55">55</td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n</div>';return __p},window.InfinniUI.Template["controls/dateTimePicker/template/time/time.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<style>\n    /*.time-segment {*/\n        /*font-size: 36px;*/\n        /*font-weight: bold;*/\n        /*padding: 10px;*/\n    /*}*/\n\n    /*.time-spin {*/\n        /*text-align: center;*/\n        /*font-size: 36px;*/\n        /*font-weight: bold;*/\n    /*}*/\n\n    /*.time-spin-up, .time-spin-down {*/\n        /*width: 100%;*/\n        /*text-decoration: none;*/\n\n        /*user-select: none;*/\n        /*-webkit-user-select: none;*/\n        /*-moz-user-select: none;*/\n        /*-ms-user-select: none;*/\n    /*}*/\n\n    /*.time-spin-up:hover, .time-spin-down:hover {*/\n        /*text-decoration: none;*/\n    /*}*/\n\n    /*.times .days {*/\n        /*width: 100%;*/\n        /*text-align: center;*/\n        /*display: inline-block;*/\n    /*}*/\n</style>\n<div><a class="days btn btn-link">'+(null==(__t=InfinniUI.localized.strings.DateTimePicker.date)?"":__t)+'</a></div>\n<table>\n    <tbody>\n    <tr>\n        <td class="time-spin">\n            <a class="time-spin-up time-spin-hour btn btn-link">\n                <i class="fa fa-chevron-up"></i>\n            </a>\n        </td>\n        <td></td>\n        <td class="time-spin">\n            <a class="time-spin-up time-spin-minute btn btn-link">\n                <i class="fa fa-chevron-up"></i>\n            </a>\n        </td>\n        <td></td>\n        <td class="time-spin">\n            <a class="time-spin-up time-spin-second btn btn-link">\n                <i class="fa fa-chevron-up"></i>\n            </a>\n        </td>\n        <td></td>\n    </tr>\n    <tr>\n        <td class="time-segment">\n            <span class="time-segment-hour">12</span>\n        </td>\n        <td class="time-segment">:</td>\n        <td class="time-segment">\n            <span class="time-segment-minute">14</span>\n        </td>\n        <td class="time-segment">:</td>\n        <td class="time-segment">\n            <span class="time-segment-second">00</span>\n        </td>\n        <td class="time-segment">\n            <button class="period" style="display: none;">AM/PM</button>\n        </td>\n    </tr>\n    <tr>\n        <td class="time-spin">\n            <a class="time-spin-down time-spin-hour btn btn-link">\n                <i class="fa fa-chevron-down"></i>\n            </a>\n        </td>\n        <td></td>\n        <td class="time-spin">\n            <a class="time-spin-down time-spin-minute btn btn-link">\n                <i class="fa fa-chevron-down"></i>\n            </a>\n        </td>\n        <td></td>\n        <td class="time-spin">\n            <a class="time-spin-down time-spin-second btn btn-link">\n                <i class="fa fa-chevron-down"></i>\n            </a>\n        </td>\n        <td></td>\n    </tr>\n    </tbody>\n</table>\n';return __p},window.InfinniUI.Template["controls/label/commonView/template/label.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<label class="label-control" title=""></label>\n';return __p},window.InfinniUI.Template["controls/listBox/baseView/template/listBox.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}function buildListboxInput(e,t,n){__p+=t?'\n        <input type = "checkbox" name="'+(null==(__t=n+"-"+e)?"":__t)+'" />\n    ':'\n        <input type = "radio" name="'+(null==(__t=n)?"":__t)+'" />\n    '}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='\n\n<ul class="pl-listbox-control list-group">\n    ',items.forEach(function(e,t){__p+="\n        <li ",focusable&&(__p+='tabindex="0"'),__p+=' class="pl-listbox-i list-group-item">\n            <div class="pl-listbox-input">\n                ',buildListboxInput(t,isMultiselect,inputName),__p+='\n                <span></span>\n            </div>\n            <div class="pl-listbox-body"></div>\n        </li>\n    '}),__p+="\n</ul>";return __p},window.InfinniUI.Template["controls/listBox/baseView/template/listBoxGrouped.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}function buildGroupedListboxInput(e,t,n){__p+=t?'\n            <input type = "checkbox" name="'+(null==(__t=n+"-"+e)?"":__t)+'" />\n        ':'\n            <input type = "radio" name="'+(null==(__t=n)?"":__t)+'" />\n        '}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj){__p+='\n\n<ul class="pl-listbox-control pl-listbox-grouped">\n    ';var i=0;groups.forEach(function(e,t){__p+="\n        <li ",focusable&&(__p+='tabindex="0"'),__p+=' class="pl-listbox-group-i">\n            <div class="pl-listbox-group-title"></div>\n            <ul class="pl-listbox-group-body">\n                ',e.items.forEach(function(e,t){__p+="\n                    <li ",focusable&&(__p+='tabindex="0"'),__p+=' class="pl-listbox-i">\n                        <div class="pl-listbox-input">\n                            ',buildGroupedListboxInput(i,isMultiselect,inputName),i++,__p+='\n                            <span></span>\n                        </div>\n                        <div class="pl-listbox-body"></div>\n                    </li>\n                '}),__p+="\n            </ul>\n        </li>\n    "}),__p+="\n</ul>\n"}return __p},window.InfinniUI.Template["controls/listBox/checkingView/template/listBox.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}function buildListboxInput(e,t,n){__p+=t?'\n        <input type = "checkbox" name="'+(null==(__t=n+"-"+e)?"":__t)+'" />\n    ':'\n        <input type = "radio" name="'+(null==(__t=n)?"":__t)+'" />\n    '}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='\n\n<ul class="pl-listbox-control">\n    ',items.forEach(function(e,t){__p+="\n    <li ",focusable&&(__p+='tabindex="0"'),__p+=' class="pl-listbox-i ',print(isMultiselect?"checkbox":"radio"),__p+='">\n        <div class="pl-listbox-input">\n            ',buildListboxInput(t,isMultiselect,inputName),__p+='\n            <span></span>\n        </div>\n        <div class="pl-listbox-body"></div>\n    </li>\n    '}),__p+="\n</ul>\n\n\n";return __p},window.InfinniUI.Template["controls/listBox/checkingView/template/listBoxGrouped.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}function buildGroupedListboxInput(e,t,n){__p+=t?'\n            <input type = "checkbox" name="'+(null==(__t=n+"-"+e)?"":__t)+'" />\n        ':'\n            <input type = "radio" name="'+(null==(__t=n)?"":__t)+'" />\n        '}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj){__p+='\n\n<ul class="pl-listbox-control pl-listbox-grouped">\n    ';var i=0;groups.forEach(function(e,t){__p+="\n        <li ",focusable&&(__p+='tabindex="0"'),__p+=' class="pl-listbox-group-i">\n            <div class="pl-listbox-group-title"></div>\n            <ul class="pl-listbox-group-body">\n                ',e.items.forEach(function(e,t){__p+="\n                    <li ",focusable&&(__p+='tabindex="0"'),__p+=' class="pl-listbox-i">\n                        <div class="pl-listbox-input">\n                            ',buildGroupedListboxInput(i,isMultiselect,inputName),i++,__p+='\n                            <span></span>\n                        </div>\n                        <div class="pl-listbox-body"></div>\n                    </li>\n                '}),__p+="\n            </ul>\n        </li>\n    "}),__p+="\n</ul>\n"}return __p},window.InfinniUI.Template["controls/popupButton/commonView/template/popupButton.dropdown.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="pl-popup-button__dropdown">\n    <div class="backdrop" style="position: fixed; top: 0; left: 0; bottom: 0; right: 0; background: rgba(0, 0, 0, 0);"></div>\n    <ul class="pl-popup-button__items dropdown-menu">\n        ',items.forEach(function(e,t){__p+='\n        <li class="pl-popup-button__item"></li>\n        '}),__p+="\n    </ul>\n</div>";return __p},window.InfinniUI.Template["controls/popupButton/commonView/template/popupButton.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="btn-group">\n    <button class="pl-popup-button__button btn"></button>\n    <button type="button" class="btn dropdown-toggle pl-popup-button__grip">\n        <span class="caret"></span>\n    </button>\n</div>';return __p},window.InfinniUI.Template["controls/popupButton/forMenuView/template/popupButton.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<span class="pl-popup-button__button"></span>\n<span class="caret"></span>';return __p},window.InfinniUI.Template["controls/stackPanel/baseView/template/stackPanel.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)items.forEach(function(e,t){__p+='\n    <li class="pl-stack-panel-i pl-clearfix"></li>\n'});return __p},window.InfinniUI.Template["controls/stackPanel/baseView/template/stackPanelGroup.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj){__p+='<div class="pl-stack-panel__content pl-stack-panel-group">\r\n    <div class="pl-stack-panel-group__header"><!-- Group Header here--></div>\r\n    <div class="pl-stack-panel-group__body">\r\n        <div class="pl-stack-panel-list">\r\n            <!-- Group\'s items here -->\r\n            ';for(var i=0;i<items.length;i+=1)__p+='\r\n            <div class="pl-stack-panel-list__item"></div><!--- Item in Group -->\r\n            ';__p+="\r\n        </div>\r\n    </div>\r\n</div>"}return __p},window.InfinniUI.Template["controls/stackPanel/baseView/template/stackPanelGrouped.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+="";return __p},window.InfinniUI.Template["controls/tabPanel/tabHeader/template/tabHeader.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<a class="pl-tabheader-text"></a>\n<a class="pl-tabheader-close pl-close">&times;</a>\n\n<style>\n    .pl-tabheader {\n        position: relative;\n        cursor: pointer;\n    }\n\n    .pl-tabheader-close.pl-close {\n        position: absolute;\n        right: 0;\n        top:0;\n    }\n</style>';return __p},window.InfinniUI.Template["controls/tabPanel/tabPage/template/tabPage.tpl.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="pl-tabpage-body">\n    ',items.forEach(function(e,t){__p+='\n    <div class="pl-tabpage-i"></div>\n    '}),__p+="\n</div>";return __p},window.InfinniUI.Template["controls/comboBox/dropdown/group/template/template.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="pl-combobox-group__header"></div>\n<div class="pl-combobox-group__items"></div>';return __p},window.InfinniUI.Template["controls/comboBox/dropdown/template/group/template.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="backdrop" style="position: fixed; top: 0; left: 0; bottom: 0; right: 0; background: rgba(0, 0, 0, 0);"></div>\n\n<!--<style>-->\n    <!--.pl-combobox-group__items > .pl-combobox-selected {-->\n        <!--border-left: 4px solid #39b3d7;-->\n    <!--}-->\n<!--</style>-->\n<div class="pl-dropdown-content" style="position: relative; background: #FFFFFF; padding: 5px;">\n    <div class="form-group pl-combobox-filter">\n        <input type="text" class="pl-combobox-filter-text form-control">\n    </div>\n    <div class="pl-combobox-items-empty">\n        По запросу "<span></span>" ничего не найдено\n    </div>\n\n    <div class="pl-combobox-items" style="background: rgba(255, 255, 255, 1);">\n        <label>Dropdown items</label>\n    </div>\n</div>\n\n';return __p},window.InfinniUI.Template["controls/comboBox/dropdown/template/plain/template.tpl.html"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="backdrop" style="position: fixed; top: 0; left: 0; bottom: 0; right: 0; background: rgba(0, 0, 0, 0);"></div>\n\n<div class="pl-combobox-dropdown pl-dropdown-content">\n    <div class="form-group pl-combobox-filter">\n        <input type="text" class="pl-combobox-filter-text form-control">\n    </div>\n    <div class="pl-combobox-items-empty"></div>\n    <div class="pl-combobox-items" style="background: rgba(255, 255, 255, 1);">\n        <label>Dropdown items</label>\n    </div>\n</div>\n';return __p};var InfinniUI=window.InfinniUI||{};window.InfinniUI=InfinniUI,InfinniUI.Utils=InfinniUI.Utils||{},InfinniUI.Template=InfinniUI.Template||{},InfinniUI.config=InfinniUI.config||{},InfinniUI.global=InfinniUI.global||{},InfinniUI.Mixins=InfinniUI.Mixins||{},InfinniUI.Metadata=InfinniUI.Metadata||{},InfinniUI.Theme=InfinniUI.Theme||{},InfinniUI.localizations=InfinniUI.localizations||{"ru-RU":{caption:"Русский",name:"ru-RU"},"en-US":{caption:"English",name:"en-US"}},InfinniUI.Providers={},InfinniUI.ColorStyle={transparent:"Transparent",primary1:"Primary1",primary2:"Primary2",primary3:"Primary3",accent1:"Accent1",accent2:"Accent2",accent3:"Accent3",background1:"Background1",background2:"Background2",background3:"Background3",background4:"Background4",white:"White",black:"Black"},InfinniUI.ElementHorizontalAlignment={left:"Left",right:"Right",center:"Center",justify:"Stretch"},InfinniUI.TextHorizontalAlignment={left:"Left",right:"Right",center:"Center",justify:"Justify"},InfinniUI.TextStyle={display4:"Display4",display3:"Display3",display2:"Display2",display1:"Display1",headline:"Headline",title:"Title",subhead:"Subhead",caption:"Caption",body1:"Body1",body2:"Body2",menu:"Menu",button:"Button"},InfinniUI.ScrollVisibility={auto:"Auto",visible:"Visible",hidden:"Hidden"},InfinniUI.StackPanelOrientation={horizontal:"Horizontal",vertical:"Vertical"},InfinniUI.TabHeaderLocation={none:"None",left:"Left",top:"Top",right:"Right",bottom:"Bottom"},InfinniUI.TabHeaderOrientation={horizontal:"Horizontal",vertical:"Vertical"},_.defaults(InfinniUI.config,{lang:"ru-RU",cacheMetadata:!1,serverUrl:"http://localhost:9900",signalRServerUrl:null,configName:"InfinniUI"}),InfinniUI.VERSION="3.0.13",InfinniUI.localizations["ru-RU"].dateTimeFormatInfo={monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],abbreviatedMonthNames:["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],abbreviatedDayNames:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],dateSeparator:".",timeSeparator:":",amDesignator:"",pmDesignator:"",firstDayOfWeek:1},InfinniUI.localizations["en-US"].dateTimeFormatInfo={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dateSeparator:"/",timeSeparator:":",amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0};var localized=InfinniUI.localizations[InfinniUI.config.lang];InfinniUI.localized=localized,InfinniUI.localizations["ru-RU"].numberFormatInfo={numberDecimalDigits:2,numberDecimalSeparator:",",numberGroupSeparator:" ",numberNegativePattern:"-n",numberPositivePattern:"n",percentDecimalDigits:2,percentDecimalSeparator:",",percentGroupSeparator:" ",percentSymbol:"%",percentNegativePattern:"-p%",percentPositivePattern:"p%",currencyDecimalDigits:2,currencyDecimalSeparator:",",currencyGroupSeparator:" ",currencySymbol:"р.",currencyNegativePattern:"-c$",currencyPositivePattern:"c$",negativeInfinitySymbol:"-бесконечность",positiveInfinitySymbol:"бесконечность",NaNSymbol:"NaN"},InfinniUI.localizations["en-US"].numberFormatInfo={numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",numberNegativePattern:"-n",numberPositivePattern:"n",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentSymbol:"%",percentNegativePattern:"-p %",percentPositivePattern:"p %",currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencySymbol:"$",currencyNegativePattern:"($c)",currencyPositivePattern:"$c",negativeInfinitySymbol:"-Infinity",positiveInfinitySymbol:"Infinity",NaNSymbol:"NaN"},InfinniUI.localizations["ru-RU"].patternDateFormats={f:"dd MMMM yyyy г. HH:mm",F:"dd MMMM yyyy г. HH:mm:ss",g:"dd.MM.yyyy HH:mm",G:"dd.MM.yyyy HH:mm:ss",d:"dd.MM.yyyy",D:"dd MMMM yyyy г.",t:"H:mm",T:"HH:mm:ss",y:"MMMM yyyy",Y:"MMMM yyyy",m:"MMMM dd",M:"MMMM dd",s:"yyyy-MM-ddTHH:mm:ss",u:"yyyy-MM-dd HH:mm:ssZ"},InfinniUI.localizations["en-US"].patternDateFormats={f:"dddd, MMMM dd, yyyy h:%m tt",F:"dddd, MMMM dd, yyyy h:%m:%s tt",g:"M/%d/yyyy h:%m tt",G:"M/%d/yyyy h:%m:%s tt",d:"M/%d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:%m tt",T:"h:%m:%s tt",y:"MMMM, yyyy",Y:"MMMM, yyyy",m:"MMMM dd",M:"MMMM dd",s:"yyyy-MM-ddTHH:mm:ss",u:"yyyy-MM-dd HH:mm:ssZ"},InfinniUI.localizations["ru-RU"].strings={ImageBox:{chooseImage:"Выбрать изображение",imageSizeTooBig:"Размер выбранного файла {chosen-size}Мб больше допустимого размера {permitted-size}Мб",incorrectFormat:"Загрузка данного типа файла не разрешена"},FileBox:{noFile:"Файл не выбран...",fileSizeTooBig:"Размер выбранного файла {chosen-size}Мб больше допустимого размера {permitted-size}Мб",incorrectFormat:"Загрузка данного типа файла не разрешена"},DateTimePicker:{time:"Время",clear:"Очистить",today:"Сегодня",date:"Дата"},DeleteAction:{warnMessage:"Вы уверены, что хотите удалить?",warnMessageNoItem:"Вы не выбрали элемент который необходимо удалить",agree:"Да",disagree:"Нет",cancel:"Закрыть"},ComboBox:{noItemsMessage:'По запросу "<span class="search-message"></span>" ничего не найдено'}},InfinniUI.localizations["en-US"].strings={ImageBox:{chooseImage:"Choose photo",imageSizeTooBig:"Size of the chosen file {chosen-size}MB is more than allowed {permitted-size}MB",incorrectFormat:"Uploading of this file type is forbidden"},FileBox:{noFile:"Choose file...",fileSizeTooBig:"Size of the chosen file {chosen-size}MB is more than allowed {permitted-size}MB",incorrectFormat:"Uploading of this file type is forbidden"},DateTimePicker:{time:"Time",clear:"Clear",today:"Today",date:"Date"},DeleteAction:{warnMessage:"Are you sure to remove item?",warnMessageNoItem:"Choose item that you want to remove",agree:"Yes",disagree:"No",cancel:"Close"},ComboBox:{noItemsMessage:'"<span class="search-message"></span>" not found'}},InfinniUI.global.messageBus=new MessageBus;var messageTypes={onViewBuildError:{name:"onViewBuildError"},onViewCreated:{name:"onViewCreated"},onChangeLayout:{name:"OnChangeLayout"},onNotifyUser:{name:"onNotifyUser"},onToolTip:{name:"onToolTip"},onRemove:{name:"onRemove"},onContextMenu:{name:"onContextMenu"},onOpenContextMenu:{name:"onOpenContextMenu"},onDataLoading:{name:"onDataLoading"},onDataLoaded:{name:"onDataLoaded"},onToolTipDestroy:{name:"onToolTipDestroy"},onToolTipInit:{name:"onToolTipInit"}};InfinniUI.messageTypes=messageTypes;var ajaxRequestMixin=function(e){function t(e,t){var n;return"function"==typeof e&&(n=e.apply(null,Array.prototype.slice.call(t))),n}return{onBeforeRequest:function(n){return function(){
return e.send(messageTypes.onDataLoading,{}),t(n,arguments)}},onSuccessRequest:function(n){return function(){return e.send(messageTypes.onDataLoaded,{success:!0}),t(n,arguments)}},onErrorRequest:function(n){return function(){return e.send(messageTypes.onDataLoaded,{success:!1}),t(n,arguments)}}}}(InfinniUI.global.messageBus);InfinniUI.ajaxRequestMixin=ajaxRequestMixin;var ActionOnLoseFocus=function(e,t){var n=this;this.$el=e,this.action=t,this.checkNeedToActionBinded=_.bind(this.checkNeedToAction,this),$(document).on("mousedown",n.checkNeedToActionBinded)};ActionOnLoseFocus.prototype.checkNeedToAction=function(e){0==$(e.target).closest(this.$el).length&&(this.action(),$(document).off("mousedown",this.checkNeedToActionBinded))},InfinniUI.ActionOnLoseFocus=ActionOnLoseFocus,_.extend(AuthenticationProvider.prototype,{handlers:{onActiveRoleChanged:$.Callbacks(),onSignInInternal:$.Callbacks(),onSignOut:$.Callbacks()},getCurrentUser:function(e,t){this.sendPostRequestForServiceResult("/Auth/GetCurrentUser",{},e,t)},changePassword:function(e,t,n,i){var o={OldPassword:e,NewPassword:t};this.sendPostRequestForServiceResult("/Auth/ChangePassword",o,n,i)},changeProfile:function(e,t,n,i){var o={DisplayName:e,Description:t};this.sendPostRequestForServiceResult("/Auth/ChangeProfile",o,n,i)},signInInternal:function(e,t,n,i,o){var r={UserName:e,Password:t,Remember:n};this.sendPostRequestForServiceResult("/Auth/SignInInternal",r,i,o)},signIn:function(e,t,n,i,o){var r={UserKey:e,Password:t,Remember:n};this.sendPostRequest("/Auth/SignIn",r,i,o)},signInById:function(e,t,n,i,o){var r={Id:e,Password:t,Remember:n};this.sendPostRequest("/Auth/SignInById",r,i,o)},signInByUserName:function(e,t,n,i,o){var r={UserName:e,Password:t,Remember:n};this.sendPostRequest("/Auth/SignInByUserName",r,i,o)},signInByEmail:function(e,t,n,i,o){var r={Email:e,Password:t,Remember:n};this.sendPostRequest("/Auth/SignInByEmail",r,i,o)},signInByPhoneNumber:function(e,t,n,i,o){var r={PhoneNumber:e,Password:t,Remember:n};this.sendPostRequest("/Auth/SignInByPhoneNumber",r,i,o)},getSignInExternalForm:function(e,t,n,i){this.getExternalLoginForm("/Auth/SignInExternal",e,t,n,i)},getLinkExternalLoginForm:function(e,t,n,i){this.getExternalLoginForm("/Auth/LinkExternalLogin",e,t,n,i)},unlinkExternalLogin:function(e,t,n,i){var o={Provider:e,ProviderKey:t};this.sendPostRequest("/Auth/UnlinkExternalLogin",o,n,i)},signOut:function(e,t){this.sendPostRequestForServiceResult("/Auth/SignOut",null,function(){"undefined"!=typeof InfinniUI.user&&null!==InfinniUI.user&&(InfinniUI.user.onReadyDeferred=$.Deferred(),InfinniUI.user.onReadyDeferred.resolve(null));var t=_.toArray(arguments);e&&e.apply(this,t),this.handlers.onSignOut.fire.apply(this.handlers.onSignOut,t)}.bind(this),t)},getExternalLoginForm:function(e,t,n,i,o){var r=this.baseAddress+e;this.sendPostRequest("/Auth/GetExternalProviders",{},function(e){var o=$(document.createElement("form"));o.attr("method","POST"),o.attr("action",r);var a=$(document.createElement("input"));a.attr("type","hidden"),a.attr("name","SuccessUrl"),a.attr("value",t),o.append(a);var l=$(document.createElement("input"));if(l.attr("type","hidden"),l.attr("name","FailureUrl"),l.attr("value",n),o.append(l),null!==e&&"undefined"!=typeof e)for(var s=0;s<e.length;++s){var u=e[s],c=u.Type,d=u.Name,p=$(document.createElement("button"));p.attr("type","submit"),p.attr("name","Provider"),p.attr("value",c),p.text(d),o.append(p)}i(o)},o)},sendGetRequest:function(e,t,n){$.ajax(this.baseAddress+e,{type:"GET",xhrFields:{withCredentials:!0},beforeSend:this.onBeforeRequest(),success:this.onSuccessRequest(t),error:this.onErrorRequest(function(e){n&&n(e.responseJSON)})})},sendPostRequest:function(e,t,n,i){var o=this;null!==t&&(t=JSON.stringify(t)),$.ajax(this.baseAddress+e,{type:"POST",xhrFields:{withCredentials:!0},data:t,contentType:"application/json",beforeSend:this.onBeforeRequest(),success:this.onSuccessRequest(n),error:this.onErrorRequest(function(e){200!=e.status?i&&i(e.responseJSON):o.onSuccessRequest(n).apply(o,arguments)})})},sendPostRequestForServiceResult:function(e,t,n,i){var o=function(){var e=_.toArray(arguments),t=e[0];t.Success?(e[0]=t.Result,"function"==typeof n&&n.apply(this,e)):(e[0]=t.Error,"function"==typeof i&&i.apply(this,e))};this.sendPostRequest(e,t,o,i)},onActiveRoleChanged:function(e){this.handlers.onActiveRoleChanged.add(e)},onSignInInternal:function(e){this.handlers.onSignInInternal.add(e)},onSignOut:function(e){this.handlers.onSignOut.add(e)}}),_.extend(AuthenticationProvider.prototype,ajaxRequestMixin),InfinniUI.global.session=new AuthenticationProvider(InfinniUI.config.serverUrl),InfinniUI.BasePathOfProperty=BasePathOfProperty,_.extend(BasePathOfProperty.prototype,{resolveProperty:function(e){return"undefined"!=typeof e&&null!==e||(e=""),this.isRelativeProperty(e)?(e=this.excludeFirstChar(e),stringUtils.formatProperty(this.basePathOfProperty+e,this.indexesInParentLists)):stringUtils.formatProperty(e,this.indexesInParentLists)},resolveRelativeProperty:function(e){var t;return t=""!=this.basePathOfProperty?this.basePathOfProperty+"."+e:e,this.resolveProperty(t)},buildChild:function(e,t){return new BasePathOfProperty(e,t,this)},buildRelativeChild:function(e,t){return new BasePathOfProperty(e,t,this)},isRelativeProperty:function(e){return"@"==e.substr(0,1)},excludeFirstChar:function(e){return e.substr(1,e.length-1)}}),InfinniUI.BlobUtils=function(){function e(e){return e&&n.getContentId(e)}function t(e,t,n){return"object"==typeof t?t[e]:n}var n={isFileInfo:e,getContentId:t.bind(null,"Id"),getName:t.bind(null,"Name"),getSize:t.bind(null,"Size"),getTime:t.bind(null,"Time"),getType:t.bind(null,"Type")};return n}(),_.mixin({deepClone:function(e){return null!==e&&"undefined"!=typeof e?JSON.parse(JSON.stringify(e)):e}});var OpenedViewCollection=function(){var e=[];this.appendView=function(t,n,i){e.push({metadata:t,viewMetadata:n,view:i})},this.removeView=function(t){for(var n=0,i=e.length;n<i;n+=1)if(t===e[n].view){e.splice(n,1);break}},this.getLastView=function(){if(0!==e.length)return e[e.length-1]},this.getList=function(){return e}};InfinniUI.views=new OpenedViewCollection,InfinniUI.DateUtils=function(){function e(e){return null===e||"undefined"==typeof e?e:moment(e).toDate()}function t(e){return e instanceof Date?new Date(e.getTime()):e}function n(e,t,n){var i,o=moment(t||null),r=moment(n||null),a=moment(e);return i=o.isValid()&&a.isBefore(o)?o.toDate():r.isValid()&&a.isAfter(r)?r.toDate():e}function i(e,t,n,i){var o=!0,r=moment(t||null),a=moment(n||null),l=moment(e);return r.isValid()&&a.isValid()?o=l.isSameOrBefore(a,i)&&l.isSameOrAfter(r,i):r.isValid()?o=l.isSameOrAfter(r,i):a.isValid()&&(o=l.isSameOrBefore(a,i)),o}function o(e){var t,n=["HH:mm","HH:mm:ss","HH:mm:ss.SSS","HHmm","HHmmss","HHmmss.SSS"],i=moment(e,n);return i.isValid()&&(t=new Date(0),t.setHours(i.hours(),i.minute(),i.second(),i.millisecond())),t}function r(e){var t=moment(e),n=null;return t.isValid()&&(n=t.toDate()),n}function a(e,t){var n=e;if("undefined"!=typeof t&&e instanceof Date){var i=e.getTimezoneOffset();t!==i&&(n=new Date(e.getTime()+60*(i-t)*1e3))}return n}function l(e,t){var n=e;if("undefined"!=typeof t&&e instanceof Date){var i=e.getTimezoneOffset();t!==i&&(n=new Date(e.getTime()-60*(i-t)*1e3))}return n}function s(e,t){var n=t||{};if("undefined"==typeof e||null===e)return null;if(e.constructor!==Date)return null;var i=a(e,n.timezoneOffset),o=[h(i.getFullYear(),4),h(i.getMonth()+1,2),h(i.getDate(),2)].join("-"),r=[h(i.getHours(),2),h(i.getMinutes(),2),h(i.getSeconds(),2)].join(":"),l=h(i.getMilliseconds(),3)+"0",s=n.timezoneOffset;"undefined"!=typeof s&&null!==s||(s=e.getTimezoneOffset());var u=Math.abs(s),c=Math.sign(s)>0?"-":"+",d=[h(Math.floor(u/60),2),h(u%60,2)].join(":");return o+"T"+r+"."+l+c+d}function u(e){var t,n=null;return e&&e.constructor===String?t=new Date(e):e&&e.constructor===Date&&(t=e),t&&(t.setUTCHours(0,0,0,0),n=t.getTime()/1e3),n}function c(e){var t,n,i=null;return e&&e.constructor===String?t=new Date(e):e&&e.constructor===Date&&(t=e),t&&(n=new Date(0),n.setUTCHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),i=n.getTime()/1e3),i}function d(e){var t;return t=typeof e===Date?new Date(e.getTime()):"number"==typeof e?new Date(1e3*e):"undefined"==typeof e||null===e?null:r(e)}function p(){return m}function h(e,t){var n=""+e,i="";return n.length<t&&(i=new Array(t-n.length+1).join("0")),i+n}function f(){var e=new Date;m=e.getTimezoneOffset(),Math.sign||(Math.sign=function(e){return e?e<0?-1:1:0})}f();var m;return{toISO8601:s,dateToTimestamp:u,dateToTimestampTime:c,changeTimezoneOffset:a,restoreTimezoneOffset:l,toDate:r,createDate:d,parseTimeISO8601toDate:o,parseISO8601toDate:e,checkRangeDate:i,getNearestDate:n,cloneDate:t,getDefaultTimeZone:p}}();var domHelper={whenReady:function(e,t,n){var i=this;"undefined"==typeof n&&(n=100),e()?t():n>0&&setTimeout(function(){i.whenReady(e,t,n-1)},510)}};InfinniUI.domHelper=domHelper,InfinniUI.ObjectUtils=function(){function e(e,t){if(null!==e&&"undefined"!=typeof e&&null!==t&&"undefined"!=typeof t){for(var n=e,r=t.length,l=0;l<r;++l){if(null===n||"undefined"==typeof n)return null;var s=t[l],u=i(s);n=u>=0?o(n,u):a(n,s)}return n}return e}function t(e,t,n){for(var s=e,u=t.length-1,c=t[0],d=i(c),p=0;p<u;++p){var h=d>=0?o(s,d):a(s,c),f=t[p+1],m=i(f);m>=0?(Array.isArray(h)||(h=[]),r(s,d,h)):($.isPlainObject(h)||(h={}),l(s,c,h)),s=h,c=f,d=m}d>=0?r(s,d,n):l(s,c,n)}function n(e){return _.isEmpty(e)?null:e.split(".")}function i(e){var t=-1;if("$"===e)t=0;else{var n=parseInt(e);isNaN(n)||(t=n)}return t}function o(e,t){return null!==e&&"undefined"!=typeof e&&"[object Array]"===Object.prototype.toString.call(e)&&t>=0&&t<e.length?e[t]:null}function r(e,t,n){null!==e&&"undefined"!=typeof e&&"[object Array]"===Object.prototype.toString.call(e)&&t>=0&&t<e.length&&(e[t]=n)}function a(e,t){return null!==e&&"undefined"!=typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&null!==t&&"undefined"!=typeof t?e[t]:null}function l(e,t,n){null!==e&&"undefined"!=typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&null!==t&&"undefined"!=typeof t&&(e[t]=n)}return{getPropertyValue:function(t,i){var o,r=function(t,i){var o=n(i),r=e(t,o);return"undefined"==typeof r?null:r};if("object"==typeof i){o={};for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];o[a]=r(t,l)}}else o=r(t,i);return o},setPropertyValue:function(e,i,o){if(null!==e&&"undefined"!=typeof e&&!_.isEmpty(i)){var r=n(i);o instanceof Date?t(e,r,new Date(o)):o instanceof File?t(e,r,o):t(e,r,o)}},setPropertyValueDirect:function(e,i,o){if(null!==e&&"undefined"!=typeof e&&!_.isEmpty(i)){var r=n(i);t(e,r,o)}}}}(),InfinniUI.EventsManager=EventsManager,EventsManager.prototype.on=function(e,t){"undefined"==typeof this.handlers[e]&&(this.handlers[e]=[]);var n=this.handlers[e];return n.push(t),{off:this.off.bind(this,e,t)}},EventsManager.prototype.off=function(e,t){if("undefined"!=typeof e){var n=this.handlers[e];if(Array.isArray(n))for(var i=0;i<n.length;i+=1)if(n[i]===t){n.splice(i,1);break}}},EventsManager.prototype.trigger=function(e){var t=this.handlers[e],n=Array.prototype.slice.call(arguments,1),i=$.Deferred();if(Array.isArray(t)){var o=t.map(function(e){return e.apply(null,n)});$.when.apply($,o).done(function(){var e=Array.prototype.slice.call(arguments),t=e.some(function(e){return e===!1});t?i.reject():i.resolve(e)}).fail(function(){i.reject()})}else i.resolve();return i.promise()};var exifRotate={rotation:{1:"rotate(0deg)",3:"rotate(180deg)",6:"rotate(90deg)",8:"rotate(270deg)"},_arrayBufferToBase64:function(e){for(var t="",n=new Uint8Array(e),i=n.byteLength,o=0;o<i;o++)t+=String.fromCharCode(n[o]);return window.btoa(t)},orientation:function(e,t){var n=this,i=new FileReader;i.onloadend=function(){var o="data:"+e.type+";base64,"+n._arrayBufferToBase64(i.result),r=new DataView(i.result),a=0,l=1;if(i.result.length<2||65496!=r.getUint16(a))return void(t&&t(o,l));a+=2;for(var s=r.byteLength;a<s-2;){var u=r.getUint16(a);switch(a+=2,u){case 65505:var c=r.getUint16(a);s=c-a,a+=2;break;case 274:l=r.getUint16(a+6,!1),s=0}}t&&t(o,l)},i.readAsArrayBuffer(e)}};InfinniUI.exifRotate=exifRotate,InfinniUI=InfinniUI||{},InfinniUI.format=InfinniUI.format||{},InfinniUI.format.humanFileSize=function(e){var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]};var filterItems=function(){return function(e,t){function n(e){return"string"!=typeof e||isNaN(e)||(e=+e),e}function i(e){return"string"==typeof e&&"'"===e.slice(0,1)&&(e=e.slice(1,-1)),e}function o(e){return"true"===e?e=!0:"false"===e?e=!1:"null"===e&&(e=null),e}function r(e){if("string"==typeof e&&e.search(/\[[\'a-zA-Z0-9,]+\]/)!==-1){e=e.slice(1,-1).split(",");for(var t=0,r=e.length;t<r;t+=1)"'"===e[t].slice(-1)&&(e[t]=e[t].slice(1,-1)),e[t]=o(e[t]),e[t]=n(e[t]),e[t]=i(e[t])}return e}function a(e,t){return"match"===t.functionName&&(e=t.children[0].valueName),e}function l(e,t,s){var c,d=[];s=a(s,e);for(var p=0,h=e.children.length;p<h;p+=1)"function"===e.children[p].type&&(c=e.children[p],e.children[p].valueName=l(c,t,s),e.children[p].newType="value"),"value"!==e.children[p].type&&"value"!==e.children[p].newType||("value"===e.children[p].type&&(e.children[p].valueName=n(e.children[p].valueName),e.children[p].valueName=i(e.children[p].valueName),e.children[p].valueName=o(e.children[p].valueName),e.children[p].valueName=r(e.children[p].valueName)),d.push(e.children[p].valueName));return u[e.functionName](d,t,s)}if(!t)return e;var s=JSON.parse(JSON.stringify(e)),u=filterItems.filterMethods,c=filterItems.filterTreeBuilder.buildUpFilterTree(t);return l(c,s)}}(filterItems);InfinniUI.FilterItems=filterItems,filterItems.filterTreeBuilder=function(){var e={},t=function(e){for(var t,n,i,o,r,a=/date\(\'[\d\wа-яёА-ЯЁ\:\-\+\.\s]+\'\)/g,l=/\,[\d\wа-яёА-ЯЁ\'\,\_\.]+\)/g,s=/\[[\d\w\'\_\.]+\]/g,u=/[\w]+[(]|\[[\d\wа-яёА-ЯЁ\S]+\]|[-\']{0,1}[\d\wа-яёА-ЯЁ_\.]+[\']{0,1}[,)$]/g,c=/[)]/g,d=/\'([\d\w\S\W\D]+\s*)+\'/g,p=/\s+/g,h=/\'([\d\wа-яёА-ЯЁ\s]+\s*)+\'/g,f=[];t=a.exec(e);)n=Date.parse(t[0].slice(6,-2))/1e3+"",e=e.slice(0,t.index)+n+e.slice(t.index+t[0].length),a.lastIndex=t.index+n.length;for(;t=d.exec(e);){if(n=t[0],n.search(p)!==-1||n.search(h)!==-1)for(;i=h.exec(n);)o=i[0].replace(p,"_"),n=n.slice(0,i.index)+o+n.slice(i.index+i[0].length);else r=n.slice(1,-1),n="tmpRE";e=e.slice(0,t.index)+n+e.slice(t.index+t[0].length),d.lastIndex=t.index+n.length}for(e=e.replace(/\s+/g,"");t=l.exec(e);)n="["+t[0].slice(1,-1)+"])",e=e.slice(0,t.index+1)+n+e.slice(t.index+t[0].length),l.lastIndex=t.index+n.length;for(;t=s.exec(e);)n=t[0].slice(1,-1),e=e.slice(0,t.index)+n+e.slice(t.index+t[0].length),s.lastIndex=t.index+n.length;for(;t=u.exec(e);)t[0].length>1&&(","===t[0].slice(-1)||")"===t[0].slice(-1))&&(t[0]=t[0].slice(0,-1)),t[0].length>1&&"'"===t[0].slice(0,1)&&isNaN(t[0].slice(1,-1))&&(t[0]=t[0].slice(1,-1)),t[0].search(/tmpRE/)!==-1&&(t[0]=t[0].slice(1,-1).split(","),t[0][0]=r),f.push(t);for(;t=c.exec(e);)f.push(t);return f.sort(function(e,t){return e.index-t.index}),f},n=function(e){for(var t,n,i,o,r=[],a=[],l=[],s=0,u=0,c=e.length;u<c;u+=1)n="string"==typeof e[u][0]?e[u][0].slice(-1):"]","("===n?(t={},t.type="function",t.functionName=e[u][0].slice(0,-1),t.index=e[u].index,r.push(t)):")"===n?(l[s]=[],o=r.pop(),o.range=[],o.range.push(o.index),o.children=[],o.range.push(e[u].index),l[s]=o,s+=1):(i={},i.type="value",i.valueName=e[u][0],i.index=e[u].index,a.push(i));return[l,a]},i=function(e,t){for(var n=0,i=t.length;n<i;n+=1)for(var o=0,r=e.length;o<r;o+=1)null!==t[n]&&"undefined"!=typeof t[n]&&t[n].index>e[o].range[0]&&t[n].index<e[o].range[1]&&(e[o].children.push(t[n]),t[n]=null);return e},o=function(e){for(var t=0;t<e.length;t+=1)for(var n=0;n<e.length;n+=1)if((null!==e[n]&&"undefined"!=typeof e[n]||null!==e[t]&&"undefined"!=typeof e[t])&&e[t].range[0]>e[n].range[0]&&e[t].range[1]<e[n].range[1]){if("undefined"!=typeof e[n].children[0]&&e[n].children[0].index>e[t].range[0]){e[n].children.unshift(e[t]),e.splice(t,1),t-=1;break}e[n].children.push(e[t]),e.splice(t,1),t-=1;break}return e[0]};return e.buildUpFilterTree=function(e){var r;return r=t(e),r=n(r),r=i(r[0],r[1]),o(r)},e}(),filterItems.filterMethods=function(){var e={};return e.eq=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l=0,s=t.length;l<s;l+=1)if(n){i=[],o="undefined"==typeof t[l][n]?-1:t[l][n].length;for(var u=0,c=o;u<c;u+=1)a.getPropertyValue(t[l][n][u],e[0])===e[1]&&i.push(t[l]);o===i.length&&r.push(t[l])}else a.getPropertyValue(t[l],e[0])===e[1]&&r.push(t[l]);return r},e.and=function(e,t,n){return _.intersection.apply(_,e)},e.or=function(e,t,n){return _.union.apply(_,e)},e.not=function(e,t,n){var i=t.slice();return _.difference(i,e[0])},e.notEq=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l=0,s=t.length;l<s;l+=1)if(n){i=[],o="undefined"==typeof t[l][n]?-1:t[l][n].length;for(var u=0,c=o;u<c;u+=1)a.getPropertyValue(t[l][n][u],e[0])!==e[1]&&i.push(t[l]);o===i.length&&r.push(t[l])}else a.getPropertyValue(t[l],e[0])!==e[1]&&r.push(t[l]);return r},e.gt=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l=0,s=t.length;l<s;l+=1)if(n){i=[],o="undefined"==typeof t[l][n]?-1:t[l][n].length;for(var u=0,c=o;u<c;u+=1)a.getPropertyValue(t[l][n][u],e[0])>e[1]&&i.push(t[l]);o===i.length&&r.push(t[l])}else a.getPropertyValue(t[l],e[0])>e[1]&&r.push(t[l]);return r},e.gte=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l=0,s=t.length;l<s;l+=1)if(n){i=[],o="undefined"==typeof[l][n]?-1:t[l][n].length;for(var u=0,c=o;u<c;u+=1)a.getPropertyValue(t[l][n][u],e[0])>=e[1]&&i.push(t[l]);o===i.length&&r.push(t[l])}else a.getPropertyValue(t[l],e[0])>=e[1]&&r.push(t[l]);return r},e.lt=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l=0,s=t.length;l<s;l+=1)if(n){i=[],o="undefined"==typeof t[l][n]?-1:t[l][n].length;for(var u=0,c=o;u<c;u+=1)a.getPropertyValue(t[l][n][u],e[0])<e[1]&&i.push(t[l]);o===i.length&&r.push(t[l])}else a.getPropertyValue(t[l],e[0])<e[1]&&r.push(t[l]);return r},e.lte=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l=0,s=t.length;l<s;l+=1)if(n){i=[],o="undefined"==typeof t[l][n]?-1:t[l][n].length;for(var u=0,c=o;u<c;u+=1)a.getPropertyValue(t[l][n][u],e[0])<=e[1]&&i.push(t[l]);o===i.length&&r.push(t[l])}else a.getPropertyValue(t[l],e[0])<=e[1]&&r.push(t[l]);return r},e["in"]=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l=0,s=t.length;l<s;l+=1)if(n){i=[],o="undefined"==typeof t[l][n]?-1:t[l][n].length;for(var u=0,c=o;u<c;u+=1)_.indexOf(e[1],a.getPropertyValue(t[l][n][u],e[0]))!==-1&&i.push(t[l]);o===i.length&&r.push(t[l])}else _.indexOf(e[1],a.getPropertyValue(t[l],e[0]))!==-1&&r.push(t[l]);return r},e.notIn=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l=0,s=t.length;l<s;l+=1)if(n){i=[],o="undefined"==typeof t[l][n]?-1:t[l][n].length;for(var u=0,c=o;u<c;u+=1)_.indexOf(e[1],a.getPropertyValue(t[l][n][u],e[0]))===-1&&i.push(t[l]);o===i.length&&r.push(t[l])}else _.indexOf(e[1],a.getPropertyValue(t[l],e[0]))===-1&&r.push(t[l]);return r},e.exists=function(e,t,n){var i,o=[],r=InfinniUI.ObjectUtils;"undefined"==typeof e[1]&&(e[1]=!0);for(var a=0,l=t.length;a<l;a+=1)i=r.getPropertyValue(t[a],e[0]),e[1]===!0?"undefined"!=typeof i&&null!==i&&o.push(t[a]):"undefined"!=typeof i&&null!==i||o.push(t[a]);return o},e.match=function(e,t,n){for(var i=[],o=InfinniUI.ObjectUtils,r=0,a=e[1].length;r<a;r+=1)"undefined"!=typeof o.getPropertyValue(e[1][r],e[0])&&i.push(e[1][r]);return i},e.all=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l=0,s=t.length;l<s;l+=1){o=a.getPropertyValue(t[l],e[0]),i=0;for(var u=0,c=o.length;u<c;u+=1)_.indexOf(e[1],o[u])!==-1&&(i+=1);c===i&&r.push(t[l])}return r},e.anyIn=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1){i=r.getPropertyValue(t[a],e[0]);for(var s=0,u=i.length;s<u;s+=1)if(_.indexOf(e[1],i[s])!==-1){o.push(t[a]);break}}return o},e.anyNotIn=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l=0,s=t.length;l<s;l+=1){o=a.getPropertyValue(t[l],e[0]),i=0;for(var u=0,c=o.length;u<c;u+=1)_.indexOf(e[1],o[u])!==-1&&(i+=1);0===i&&r.push(t[l])}return r},e.anyEq=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1)i=r.getPropertyValue(t[a],e[0]),_.indexOf(i,e[1])!==-1&&o.push(t[a]);return o},e.anyNotEq=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1){i=r.getPropertyValue(t[a],e[0]);for(var s=0,u=i.length;s<u;s+=1)if(i[s]!==e[1]){o.push(t[a]);break}}return o},e.anyGt=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1){i=r.getPropertyValue(t[a],e[0]);for(var s=0,u=i.length;s<u;s+=1)if(i[s]>e[1]){o.push(t[a]);break}}return o},e.anyGte=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1){i=r.getPropertyValue(t[a],e[0]);for(var s=0,u=i.length;s<u;s+=1)if(i[s]>=e[1]){o.push(t[a]);break}}return o},e.anyLt=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1){i=r.getPropertyValue(t[a],e[0]);for(var s=0,u=i.length;s<u;s+=1)if(i[s]<e[1]){o.push(t[a]);break}}return o},e.anyLte=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1){i=r.getPropertyValue(t[a],e[0]);for(var s=0,u=i.length;s<u;s+=1)if(i[s]<=e[1]){o.push(t[a]);break}}return o},e.sizeEq=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1)i=r.getPropertyValue(t[a],e[0]),i.length===e[1]&&o.push(t[a]);return o},e.sizeNotEq=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1)i=r.getPropertyValue(t[a],e[0]),i.length!==e[1]&&o.push(t[a]);return o},e.sizeGt=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1)i=r.getPropertyValue(t[a],e[0]),i.length>e[1]&&o.push(t[a]);return o},e.sizeGte=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1)i=r.getPropertyValue(t[a],e[0]),i.length>=e[1]&&o.push(t[a]);return o},e.sizeLt=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1)i=r.getPropertyValue(t[a],e[0]),i.length<e[1]&&o.push(t[a]);return o},e.sizeLte=function(e,t,n){for(var i,o=[],r=InfinniUI.ObjectUtils,a=0,l=t.length;a<l;a+=1)i=r.getPropertyValue(t[a],e[0]),i.length<=e[1]&&o.push(t[a]);return o},e.regexp=function(e,t,n){for(var i,o,r=[],a=InfinniUI.ObjectUtils,l="",s=1,u=e[1].length;s<u;s+=1)l+=e[1][s];o=new RegExp(e[1][0],l);for(var c=0,d=t.length;c<d;c+=1)i=a.getPropertyValue(t[c],e[0]),i.search(o)!==-1&&r.push(t[c]);return r},e.text=function(e,t,n){for(var i,o=[],r=e[0].replace("_"," ").toLowerCase(),a=0,l=t.length;a<l;a+=1)i=JSON.stringify(t[a]).toLowerCase(),i.indexOf(r)!==-1&&o.push(t[a]);return o},e.startsWith=function(e,t,n){var i=e[0],o=Array.isArray(e[1])?e[1][0]:e[1],r=!Array.isArray(e[1])||e[1][1]!==!1,a="^{expectedStartValue}".replace("{expectedStartValue}",o),l=r?"i":"";return _.filter(t,function(e){return new RegExp(a,l).test(e[i])})},e.endsWith=function(e,t,n){var i=e[0],o=Array.isArray(e[1])?e[1][0]:e[1],r=!Array.isArray(e[1])||e[1][1]!==!1,a="{expectedEndValue}$".replace("{expectedEndValue}",o),l=r?"i":"";return _.filter(t,function(e){return new RegExp(a,l).test(e[i])})},e.contains=function(e,t,n){var i=e[0],o=Array.isArray(e[1])?e[1][0]:e[1]||"",r=!Array.isArray(e[1])||e[1][1]!==!1,a=r?"i":"";return _.filter(t,function(e){return new RegExp(o,a).test(e[i])})},e}(),InfinniUI.HashMap=HashMap,Object.defineProperties(HashMap.prototype,{length:{get:function(){return this._keys.length}},keys:{get:function(){return this._keys}},values:{get:function(){return this._values}}}),HashMap.prototype.add=function(e,t){var n=this._getIndexOfKey(e);n===-1?(this._keys.push(e),this._values.push(t)):this._values[n]=t},HashMap.prototype.remove=function(e){var t=this._getIndexOfKey(e);t!==-1&&(this._keys.splice(t,1),this._values.splice(t,1))},HashMap.prototype.getKeyByValue=function(e){var t,n=this._getIndexOfValue(e);return n!==-1&&(t=this._keys[n]),t},HashMap.prototype.findIndex=function(e,t){for(var n,i,o=-1,r=0;r<this._keys.length;r+=1)if(n=this._keys[r],i=this._values[r],e.call(t,n,i)){o=r;break}return o},HashMap.prototype.get=function(e){var t,n=this._getIndexOfKey(e);return n!==-1&&(t=this._values[n]),t},HashMap.prototype.forEach=function(e,t){this._keys.forEach(function(n,i){e.call(t,this._values[i],n,i)},this)},HashMap.prototype.clear=function(e){"function"==typeof e&&this.forEach(e),this._keys.length=0,this._values.length=0},HashMap.prototype._getIndexOfKey=function(e){return this._keys.indexOf(e)},HashMap.prototype._getIndexOfValue=function(e){return this._values.indexOf(e)},HiddenScreen.prototype={add:function(e){$("body").prepend(this.middleElement),this.middleElement.append(e)}},InfinniUI.HiddenScreen=HiddenScreen,_.mixin({inherit:function(e,t){var n=new Function;n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.superclass=t.prototype},superClass:function(e,t,n){var i=_.toArray(arguments);i.splice(0,2),e.superclass.constructor.apply(t,i)}}),function(){var e=_.isEqual;_.isEqual=function(t,n){return"undefined"!=typeof File&&(t instanceof File||n instanceof File)?t===n:e(t,n)}}(),InfinniUI.Keyboard={KeyCode:{ESCAPE:27,HOME:36,LEFT_ARROW:37,RIGHT_ARROW:39,END:35,UP_ARROW:38,DOWN_ARROW:40,DELETE:46,BACKSPACE:8,TAB:9,SPACE:32,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,PLUS:43,MINUS:45,ASTERISK:42,SLASH:47,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57},getCharByKeyCode:function(e){var t,n;if(e<32)t=null;else{if(e>=this.KeyCode.NUMPAD_0&&e<=this.KeyCode.NUMPAD_9)n=e-48;else switch(e){case 110:n=this.KeyCode.DELETE;break;case 107:n=this.KeyCode.PLUS;break;case 109:n=this.KeyCode.MINUS;break;case 106:n=this.KeyCode.ASTERISK;break;case 111:n=this.KeyCode.SLASH;break;case 188:n=44;break;case 173:n=45;break;case 190:n=46;break;case 191:n=47;break;case 192:n=96;break;case 219:n=91;break;case 220:n=92;break;case 221:n=93;break;case 222:n=39;break;default:n=e}t=String.fromCharCode(n)}return t}};var LOG_LEVEL={debug:1,info:2,warn:3,error:4,trace:5};_.extend(Logger.prototype,{getLevel:function(){return this.level},setLevel:function(e){this.level=e},addMessage:function(e,t){this.messages.push({type:e,message:t})},debug:function(e){this.level>LOG_LEVEL.debug||(this.showMessages&&console.debug(e.message||e),this.addMessage(LOG_LEVEL.debug,e))},info:function(e){this.level>LOG_LEVEL.info||(this.showMessages&&console.info(e.message||e),this.addMessage(LOG_LEVEL.info,e))},warn:function(e){this.level>LOG_LEVEL.warn||(this.showMessages&&console.warn(e.message||e),this.addMessage(LOG_LEVEL.warn,e))},error:function(e){this.level>LOG_LEVEL.error||(this.showMessages&&console.error(e.message||e),this.addMessage(LOG_LEVEL.error,e))},trace:function(e){this.level>LOG_LEVEL.trace||(this.showMessages&&console.error(e.message||e),this.addMessage(LOG_LEVEL.trace,e))}}),InfinniUI.global.logger=new Logger,InfinniUI.Metadata=InfinniUI.Metadata||{},InfinniUI.Metadata.isValidValue=function(e,t){var n=!1;for(var i in t)if(t[i]===e){n=!0;break}return n},InfinniUI.Metadata.isBindingMetadata=function(e){return $.isPlainObject(e)&&"Source"in e},Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},String.prototype.includes||(String.prototype.includes=function(){return String.prototype.indexOf.apply(this,arguments)!==-1});var stringUtils={format:function(e,t){return e.replace(/{(\d+)}/g,function(e,n){return"undefined"!=typeof t[n]?t[n]:e})},formatProperty:function(e,t){if(!t||0==t.length||""==e)return e;for(var n=e.split("."),i=t.length-1,o=n.length-1;o>=0;o--)"#"==n[o]&&i>=0?(n[o]=t[i],i--):("$"==n[o]||stringUtils.isNumeric(n[o]))&&i--;return n.join(".")},padLeft:function(e,t,n){"undefined"!=typeof n&&null!==n||(n=" ");var i=String(e);return i.length<t?new Array(t-i.length+1).join(n)+i:i},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},replaced:{"+":"%2B"},joinDataForQuery:function(e){var t=[],n=this;for(var i in e){var o="string"==typeof e[i]?e[i].replace(/[\+]/g,function(e){return n.replaced[e]||e}):e[i];t.push(i+"="+o)}return t.join("&")}};InfinniUI.stringUtils=stringUtils,InfinniUI.guid=guid,function(e,t,n){"use strict";function i(){this._unsubscribe=[]}function o(){this.marker=new r,this.$currentControl=null,this.clickManager=new i}function r(){this.DATA_NAME="data-pl-original-style",this.css={"box-shadow":"inset 0 0 1em #ff0000"}}function a(e,t){var n=e?[e]:[];return n.push(t),n.join(":")}var l="data-pl-name",s="data-pl-name-view",u="No name",c="["+l+"]:first",d="["+s+"]:first",p=e.location;"#test"===p.hash&&(n(function(){function e(){n.fn.tooltip.Constructor.prototype.getTitle=function(){var e=(this.$element,this.options);return e.title}}e();var i=new o;n(t).on("mouseover",function(e){i.setElement(e.target)})}),i.prototype.append=function(e,t){var n="contextmenu";if(this.clear(),"undefined"!=typeof e&&null!==e)return e.addEventListener(n,t,!0),this._unsubscribe.push(function(){e.removeEventListener(n,t,!0)}),this},i.prototype.clear=function(){return this._unsubscribe.forEach(function(e){e.call()}),this},o.prototype.setElement=function(e){function t(e){var t,n=e.attr(l);return t="undefined"!=typeof n?e:e.parents(c)}function i(e){if(e.length)return e.attr(l)}function o(e){var t=e.parents(d);if(t.length)return t.attr(s)}var r=n(e),a=t(r),p=i(a),h=o(a);this.hideInfo(),a&&this.showInfo(a,h,_.isEmpty(p)?u:p)},o.prototype.copyInfo=function(t,n){(t||n)&&e.prompt("Copy to clipboard: Ctrl+C",a(t,n))},o.prototype.showInfo=function(e,t,n){this.$currentControl&&this.$currentControl[0]!==e[0]&&(this.marker.reset(this.$currentControl),this.clickManager.clear()),this.marker.highlight(e),this.$currentControl=e,this.clickManager.append(e[0],this.copyInfo.bind(this,t,n)),e.tooltip({title:a(t,n),placement:"auto"}).tooltip("show")},o.prototype.hideInfo=function(){this.clickManager.clear(),this.$currentControl&&(this.marker.reset(this.$currentControl),this.$currentControl.tooltip("destroy"))},r.prototype.highlight=function(e){var t;if(e){if(t=e.data(this.DATA_NAME),!t){t=Object.create(null);for(var n in this.css)t[n]=e.css(n);e.data(this.DATA_NAME,t)}e.css(this.css)}return this},r.prototype.reset=function(e){var t;return e&&(t=e.data(this.DATA_NAME),e.data(this.DATA_NAME,null),t&&e.css(t)),this})}(window,document,jQuery);var TreeModel=function(e,t,n){this.context=e,this.source=t,this.dataTree=n||{},this.handlersTree={},this.mirroringFrom=null,this.mirroringTo=null};InfinniUI.TreeModel=TreeModel,_.extend(TreeModel.prototype,{counter:1,getProperty:function(e){return this.mirroringFrom&&(e=e.replace(this.mirroringFrom,this.mirroringTo)),InfinniUI.ObjectUtils.getPropertyValue(this.dataTree,e)},setProperty:function(e,t){var n=this.getProperty(e);return t!=n&&(InfinniUI.ObjectUtils.setPropertyValue(this.dataTree,e,t),this._notifyAboutPropertyChanged(e,n),!0)},onPropertyChanged:function(e,t,n){var i,o=this.counter+"-bindId";return this.counter++,"function"==typeof e?(n=t,t=e,i=this._getHandlersSubTree("*",!0)):i=this._getHandlersSubTree(e,!0),t._bindId=o,n&&"owner"in n&&(t._owner=n.owner),i[o]=t,o},offPropertyChanged:function(e,t){var n=this._getHandlersSubTree(e,!0);n[t]&&delete n[t]},_getHandlersSubTree:function(e,t){if(""==e)return this.handlersTree;for(var n=e.split("."),i=this.handlersTree,o=0,r=n.length;o<r;o++)if(i[n[o]])i=i[n[o]];else{if(!t)return{};i[n[o]]={},i=i[n[o]]}return i},_notifyAboutPropertyChanged:function(e,t){var n=this._getHandlersSubTree(e),i=null!==this.mirroringTo&&"undefined"!=typeof this.mirroringTo&&null!==this.mirroringFrom&&"undefined"!=typeof this.mirroringFrom&&0==e.indexOf(this.mirroringTo),o=e.replace(this.mirroringTo,this.mirroringFrom);this._notifyAboutPropertyChanged_bubblingAction(e,t,n),this._notifyAboutPropertyChanged_capturingAction(e,t,n),i&&(n=this._getHandlersSubTree(o),this._notifyAboutPropertyChanged_capturingAction(o,t,n))},_notifyAboutPropertyChanged_capturingAction:function(e,t,n){
var i,o,r;for(var a in n)"function"==typeof n[a]&&(r=n[a],this._isOwnerAlive(r)?this._callHandlerAboutPropertyChanged(r,e,t):delete n[a]);for(var l in n)$.isPlainObject(n[l])&&"*"!=l&&(i=$.isPlainObject(t)?t[l]:void 0,o=""==e?l:e+"."+l,this._notifyAboutPropertyChanged_capturingAction(o,i,n[l]))},_notifyAboutPropertyChanged_bubblingAction:function(e,t,n){function i(n){var i;if("*"in n)for(var o in n["*"])i=n["*"][o],l._isOwnerAlive(i)?l._callHandlerAboutPropertyChanged(i,e,t):delete n["*"][o]}var o,r=e.split("."),a=this.handlersTree,l=this;if(i(a),""!=e)for(var s=0,u=r.length;s<u&&(o=r[s],a[o]);s++)a=a[o],i(a)},_isOwnerAlive:function(e){return!(e._owner&&"isRemoved"in e._owner)||("function"==typeof e._owner.isRemoved?e._owner.isRemoved():!e._owner.isRemoved)},_callHandlerAboutPropertyChanged:function(e,t,n){var i={property:t,newValue:this.getProperty(t),oldValue:n,source:this.source};e(this.context,i)},setMirroring:function(e,t){this.mirroringFrom=e,this.mirroringTo=t}});var urlManager={getParams:function(){var e,t,n=location.search,i={};if(0==n.length)return i;n=n.substr(1),e=n.split("&");for(var o=0,r=e.length;o<r;o++)t=e[o].split("="),i[t[0]]=t[1];return i},clearUrlSearchPath:function(){var e,t,n=location.search;n.length>0&&(e=location.href.indexOf(n),e>0&&(t=location.href.substr(0,e))),t&&history.pushState(null,null,t)},setParameter:function(e,t){var n=location.search,i=_.isEmpty(n)?stringUtils.format("?{0}={1}",[e,t]):stringUtils.format("{0}&{1}={2}",[n,e,t]),o=stringUtils.format("{0}//{1}{2}{3}{4}",[location.protocol,location.host,location.pathname,i,location.hash]);history.pushState(null,null,o)},deleteParameter:function(e){function t(e){var t=[];return _.mapObject(e,function(e,n){var i=stringUtils.format("{0}={1}",[n,e]);t.push(i)}),_.isEmpty(t)?"":"?"+t.join("&")}var n=urlManager.getParams();delete n[e];var i=t(n),o=stringUtils.format("{0}//{1}{2}{3}{4}",[location.protocol,location.host,location.pathname,i,location.hash]);history.pushState(null,null,o)}};InfinniUI.urlManager=urlManager,_.extend(ValidationResult.prototype,{error:function(e,t){this.IsValid&&(this.IsValid=!1),this.Items.push({Message:e,Property:t||""})}}),InfinniUI.ValidationResult=ValidationResult,InfinniUI.Collection=Collection,Object.defineProperties(Collection.prototype,{idProperty:{get:function(){return this._idProperty},enumerable:!1},comparator:{get:function(){return this._comparator},enumerable:!1},length:{get:function(){return this._items.length},enumerable:!1},hasIdProperty:{get:function(){return"undefined"!=typeof this._idProperty},enumerable:!1}}),Collection.prototype.setProperty=function(e,t,n){var i=this._items[e];return i&&(i[t]=n),this},Collection.prototype.getProperty=function(e,t){var n=this._items[e];if(n)return n[t]},Collection.prototype.size=function(){return this.length},Collection.prototype.push=function(e){var t=this._items,n=this.createCollectionItem(e,t.length);return t.push(n),this.events.onAdd([e]),!0},Collection.prototype.add=Collection.prototype.push,Collection.prototype.addAll=function(e){if(!Array.isArray(e))return!1;var t=this._items,n=e.length>0;return e.forEach(function(e){var n=this.createCollectionItem(e,t.length);t.push(n)},this),n&&this.events.onAdd(e),n},Collection.prototype.insert=function(e,t){var n=this.createCollectionItem(t,e);return this._items.splice(e,0,n),this.events.onAdd([t],e),!0},Collection.prototype.insertAll=function(e,t){if(!Array.isArray(t))return!1;var n=this._items,i=t.length>0;return t.forEach(function(t,i){var o=e+i,r=this.createCollectionItem(t,o);n.splice(o,0,r)},this),i&&this.events.onAdd(t,e),i},Collection.prototype.reset=function(e){var t,n;return!!Array.isArray(e)&&(t=this._items!==e,n=e.map(function(e,t){return this.createCollectionItem(e,t)},this),this._items.length=0,Array.prototype.push.apply(this._items,n),t&&this.events.onReset(),t)},Collection.prototype.set=function(e,t){var n=this._items;if(!Array.isArray(e))return!1;var i=this._items!==e,o=e.slice();return o.forEach(function(e,t){t<n.length?i&&this.updateCollectionItem(n[t],e):(i=!0,n.push(this.createCollectionItem(e,n.length)))},this),e.length<n.length&&n.splice(e.length),i&&!t&&this.events.onReset(),i},Collection.prototype.replace=function(e,t){for(var n,i=!1,o=0;o<this._items.length;o+=1)if(n=this.getCollectionItemValue(o),this.isEqual(e,n)){this.updateCollectionItem(this._items[o],t),i=!0;break}return i&&this.events.onReplace([e],[t]),i},Collection.prototype.pop=function(){if(0!==this._items.length){var e=this.getCollectionItemValue(this.length-1);return this._items.pop(),this.events.onRemove([e],this._items.length),e}},Collection.prototype.remove=function(e){for(var t,n,i=!0,o=0;o<this._items.length;o+=1)if(t=this.getCollectionItemValue(o),n=o,this.isEqual(e,t)){this._items.splice(o,1),i=!0;break}return i&&this.events.onRemove([e],n),i},Collection.prototype.removeById=function(e){if(!this.hasIdProperty)return!1;for(var t,n,i=!0,o=0;o<this._items.length;o+=1)if(t=this.getCollectionItemValue(o),n=o,this.getValueId(t)===e){this._items.splice(o,1),i=!0;break}return i&&this.events.onRemove([t],n),i},Collection.prototype.removeAt=function(e){if(e>=this._items.length)return!1;var t=this.getCollectionItemValue(e);return this._items.splice(e,1),this.events.onRemove([t],e),!0},Collection.prototype.removeAll=function(e){if(!Array.isArray(e))return!1;var t,n=this._items,i=[];if(e.forEach(function(e){i=n.filter(function(t){return this.isEqual(e,this.getItemValue(t))},this),i.forEach(function(e){var t=n.indexOf(e);n.splice(t,1)})},this),t=i.length>0){var o=i.map(function(e){return this.getItemValue(e)},this);this.events.onRemove(o)}return t},Collection.prototype.removeRange=function(e,t){var n,i=this._items;if(e>=i.length)return!1;"undefined"==typeof t&&(t=i.length-e);var o=i.splice(e,t);if(n=o.length>0){var r=o.map(function(e){return this.getItemValue(e)},this);this.events.onRemove(r,e)}return n},Collection.prototype.removeEvery=function(e,t){if("function"!=typeof e)return!1;var n,i=this._items,o=i.filter(function(n,i){var o=this.getItemValue(n);return e.call(t,o,i,this)},this);if(o.forEach(function(e){var t=i.indexOf(e);i.splice(t,1)}),n=o.length>0){var r=o.map(function(e){return this.getItemValue(e)},this);this.events.onRemove(r)}return n},Collection.prototype.clear=function(){var e=this._items,t=e.length>0,n=e.map(function(e){return this.getItemValue(e)},this);return e.length=0,t&&this.events.onRemove(n,0),t},Collection.prototype.getById=function(e){if(!this.hasIdProperty)return!1;for(var t,n,i=this._items,o=0;o<i.length;o+=1)if(t=this.getCollectionItemValue(o),this.getValueId(t)===e){n=t;break}return n},Collection.prototype.getByIndex=function(e){return this.getCollectionItemValue(e)},Collection.prototype.find=function(e,t){if("function"!=typeof e)return!1;var n,i=this._items,o=i.some(function(i,o){var r=this.getItemValue(i);return n=o,e.call(t,r,o,this)},this);return o?this.getCollectionItemValue(n):void 0},Collection.prototype.indexOf=function(e,t){var n=this._items,i=-1;"undefined"==typeof t&&(t=0);for(var o=t;o<n.length;o+=1){var r=this.getItemValue(n[o]);if(this.isEqual(e,r)){i=o;break}}return i},Collection.prototype.lastIndexOf=function(e,t){var n=this._items,i=-1;if("undefined"==typeof t&&(t=n.length-1),0===n.length||t>=n.length)return-1;for(var o=t;o>0;o-=1){var r=this.getItemValue(n[o]);if(this.isEqual(e,r)){i=o;break}}return i},Collection.prototype.findIndex=function(e,t){if("function"!=typeof e)return!1;var n=this._items,i=-1,o=n.some(function(n,o){var r=this.getItemValue(n);return i=o,e.call(t,r,o,this)},this);return o?i:-1},Collection.prototype.contains=function(e,t){t=t||0;for(var n=!1,i=this._items,o=t;o<i.length;o+=1){var r=this.getItemValue(i[o]);if(n=this.isEqual(r,e))break}return n},Collection.prototype.every=function(e,t){if("function"!=typeof e)return!1;var n=this._items;return n.every(function(n,i){var o=this.getItemValue(n);return e.call(t,o,i,this)},this)},Collection.prototype.some=function(e,t){if("function"!=typeof e)return!1;var n=this._items;return n.some(function(n,i){var o=this.getItemValue(n);return e.call(t,o,i,this)},this)},Collection.prototype.forEach=function(e,t){if("function"==typeof e){var n=this._items;n.forEach(function(n,i){var o=this.getItemValue(n);e.call(t,o,i,this)},this)}},Collection.prototype.filter=function(e,t){if("function"!=typeof e)return[];var n=this._items;return n.filter(function(n,i){var o=this.getItemValue(n);return e.call(t,o,i,this)},this).map(function(e){return this.getItemValue(e)},this)},Collection.prototype.take=function(e,t){var n=this._items;return"undefined"==typeof t&&(t=n.length),n.slice(e,e+t).map(function(e){return this.getItemValue(e)},this)},Collection.prototype.toArray=function(){return this._items.map(function(e){return this.getItemValue(e)},this)},Collection.prototype.move=function(e,t){var n,i=this._items;if(e<0||e>=i.length||e===t)return!1;n=i.splice(e,1).pop(),e>t?i.splice(t,0,n):i.splice(t-1,0,n);var o=i[e]!==n;if(o){var r=this.getItemValue(n);this.events.onMove([r],[r],e,t)}return o},Collection.prototype.sort=function(e){"function"!=typeof e&&(e=this._comparator);var t=this._items,n=this,i=t.slice(),o=!1;t.sort(function(t,i){return e(n.getItemValue(t),n.getItemValue(i))});for(var r=0;r<t.length;r+=1)if(t[r]!==i[r]){o=!0;break}return o&&this.events.onReset(),o},Collection.prototype.clone=function(){return new this.constructor(this.toArray(),this._idProperty,this.comparator)},Collection.prototype.onAdd=function(e){this.events.on("add",e)},Collection.prototype.onReplace=function(e){this.events.on("replace",e)},Collection.prototype.onRemove=function(e){this.events.on("remove",e)},Collection.prototype.onMove=function(e){this.events.on("move",e)},Collection.prototype.onReset=function(e){this.events.on("reset",e)},Collection.prototype.onChange=function(e){this.events.on("change",e)},Collection.prototype.toString=function(){return this._items.map(function(e){return JSON.stringify(this.getItemValue(e))},this).join(",")},Collection.prototype.getValueId=function(e){if(this.hasIdProperty&&"undefined"!=typeof e&&null!==e)return e[this._idProperty]},Collection.prototype.isEqual=function(e,t){function n(){var e=Array.prototype.slice.call(arguments);return e.every(function(e){return"undefined"!=typeof e&&null!==e})}var i=this.idProperty;return this.hasIdProperty?!!n(e,t)&&e[i]===t[i]:e===t},Collection.prototype.createCollectionItem=function(e,t){var n=Object.create(null);return n.__value=e,n.__index=t,n},Collection.prototype.updateCollectionItem=function(e,t){return e.__value=t,e},Collection.prototype.getCollectionItemValue=function(e){var t=this._items[e];return this.getItemValue(t)},Collection.prototype.getItemValue=function(e){if(e)return e.__value},InfinniUI.CollectionEventManager=CollectionEventManager,_.extend(CollectionEventManager.prototype,Backbone.Events),CollectionEventManager.prototype.onAdd=function(e,t){var n={action:"add",newItems:e,newStartingIndex:"undefined"!=typeof t?t:-1};return this.trigger("add",n),this.trigger("change",n),this},CollectionEventManager.prototype.onReset=function(){var e={action:"reset"};return this.trigger("reset",e),this.trigger("change",e),this},CollectionEventManager.prototype.onReplace=function(e,t){var n={action:"replace",oldItems:e,newItems:t};return this.trigger("replace",n),this.trigger("change",n),this},CollectionEventManager.prototype.onRemove=function(e,t){var n={action:"remove",oldItems:e,oldStartingIndex:"undefined"!=typeof t?t:-1};return this.trigger("remove",n),this.trigger("change",n),this},CollectionEventManager.prototype.onMove=function(e,t,n,i){var o={oldItems:e,newItems:t,oldStartingIndex:n,newStartingIndex:i};return this.trigger("move",o),this.trigger("change",o),this},InfinniUI.ActionExecutor=ActionExecutor,InfinniUI.ActionFactory=ActionFactory,InfinniUI.BaseScriptExecutor=BaseScriptExecutor,InfinniUI.CompiledScriptFactory=CompiledScriptFactory,InfinniUI.Executor=Executor,InfinniUI.InlineScriptFactory=InlineScriptFactory;var bindUIElementsMixin={bindUIElements:function(){if(this.ui={},"undefined"!=typeof this.UI)for(var e in this.UI)this.UI.hasOwnProperty(e)&&(this.ui[e]=this.$(this.UI[e]))}};InfinniUI.bindUIElementsMixin=bindUIElementsMixin;var editMaskViewMixin=function(e){function t(){g||(g=!0,d().Mask.api.init({locale:InfinniUI.localized.name}))}function n(){var e=this.model.get("editMask");if(e){var t,n=Object.keys(e).pop(),i=e[n],s=l(i.Mask),u=this.editMaskStrategies[n];switch("undefined"!=typeof u&&null!==u||(console.log("Не задано преобразование значения маски ввода"),u=f),this.setEditMaskStrategy(u),n){case"DateTimeEditMask":t=o.call(this,s);break;case"NumberEditMask":t=r.call(this,s);break;case"TemplateEditMask":t=a.call(this,s,i);break;default:throw new Error("Incorrect edit mask type")}this[p]=t}}function i(){this[p]&&this[p].destroy()}function o(e){var t=this.model,n=d().Mask.dateTime(this.ui.control[0],e),i=t.get("timeZone");"undefined"!=typeof i&&null!==i||(i=InfinniUI.DateUtils.getDefaultTimeZone()),n.setTimezoneOffset(i);var o=this;return n.setValue(this.getEditMaskStrategy().valueToMask(t.getValue())),n.onChangeValue(function(e){var n=e.newValue;null!==n&&"undefined"!=typeof n?(t.set("value",o.getEditMaskStrategy().maskToValue(n)),t.isValid()&&o.setValueValidationError(null)):t.set("value",n)}),n}function r(e){var t=this.model,n=d().Mask.number(this.ui.control[0],e);return n.setValue(t.getValue()),n.onChangeValue(function(e){t.set("value",e.newValue),t.isValid()&&t.set("errorText",null)}),n}function a(e,t){var n=this.model,i=d().Mask.template(this.ui.control[0],e),o=t.MaskSaveLiteral;return"boolean"==typeof o&&i.setMaskSaveLiteral(o),i.setValue(n.getValue()),i.onChangeValue(function(e){n.set("value",e.newValue)}),i}function l(e){var t=InfinniUI.localized.patternDateFormats[e];return"undefined"!=typeof t&&(e=t),e=e.replace(/%([msd])/g,"$1")}function s(){this.valueToMask=function(e){return e},this.maskToValue=function(e){return e}}function u(){this.valueToMask=function(e){var t=null;return null!==e&&!isNaN(e)&&isFinite(e)&&(t=Math.round(1e3*e)),t},this.maskToValue=function(e){var t=null;return null!==e&&!isNaN(e)&&isFinite(e)&&(t=+(e/1e3).toFixed(3)),t}}function c(){this.valueToMask=function(e){var t=null;return null!==e&&"undefined"!=typeof e&&(t=new Date(e).getTime()),t},this.maskToValue=function(e){var t=new Date(e);return InfinniUI.DateUtils.toISO8601(t)}}function d(){var t=e[h];return t||console.error('edit-mask library "'+h+'" not loaded!'),t}var p="_mask",h="editMask",f="default",m={"default":new s,timestamp:new u,iso8601:new c},g=!1;return{editMaskStrategies:{DateTimeEditMask:"iso8601",TemplateEditMask:"default",NumberEditMask:"default"},events:{"input .pl-control":"onInputEventHandler","change .pl-control":"onChangeEventHandler","focusin .pl-control":"onFocusinEventHandler","focusout .pl-control":"onFocusoutEventHandler"},initialize:function(){t()},initHandlersForProperties:function(){this.listenTo(this.model,"change:editMode",this.onChangeEditModeHandler),this.listenTo(this.model,"invalid",this.onInvalidValueHandler)},setEditMaskStrategy:function(e){this.editMaskStrategy=m[e]},getEditMaskStrategy:function(){var e=this.editMaskStrategy;return e||(e=m[f]),e},setValueValidationError:function(e){this.model.set("errorText",e)},getTimeZone:function(){return this.model.get("timeZone")},setEditMode:function(e){this.model.set("editMode",e)},onInvalidValueHandler:function(e,t){this.setValueValidationError(t)},onFocusinEventHandler:function(){var e=this.ui.control[0],t=this;setTimeout(function(){var n=e.selectionStart;t.setEditMode(!0),e.setSelectionRange&&/text|search|password|tel|url/i.test(e.type||"")&&e.setSelectionRange(n,n)},4)},onFocusoutEventHandler:function(){this.setEditMode(!1)},onInputEventHandler:function(){this.updateModelValue()},onChangeEventHandler:function(){this.updateModelValue()},updateModelValue:function(){if(this[p]);else{var e=this.ui.control.val();this.model.set({value:e,rawValue:e})}},onChangeEditModeHandler:function(e,t){t?n.call(this):(i.call(this),editorBaseViewMixin.updateValueState.call(this),this.ui.control.val(this.getDisplayValue()))}}}(window),eventHandlerMixin={addEventHandler:function(e,t){if(this.initEventHandlerMixin(),null===e||"undefined"==typeof e)return!1;if(null===t||"undefined"==typeof t)return!1;"undefined"==typeof this.eventHandlers[e]&&(this.eventHandlers[e]=[]);var n=this.eventHandlers[e];n.indexOf(t)===-1&&n.push(t)},callEventHandler:function(e){if("undefined"!=typeof this.eventHandlers&&null!==e&&"undefined"!=typeof e){var t=this.eventHandlers[e];if("undefined"!=typeof t){var n,i=Array.prototype.slice.call(arguments,1),o=i.pop();"function"==typeof o&&(n=o),o=i.pop(),_.each(t,function(e){var t=e.apply(void 0,o);"undefined"!=typeof n&&n(t)})}}},initEventHandlerMixin:function(){"undefined"==typeof this.eventHandlers&&(this.eventHandlers={})}};InfinniUI.eventHandlerMixin=eventHandlerMixin;var Control=function(e){this.controlModel=this.createControlModel(),this.controlView=this.createControlView(this.controlModel,e),this.initHandlers()};_.extend(Control.prototype,{createControlModel:function(){throw new Error("Не перегружен абстрактный метод Control.createControlModel()")},createControlView:function(e,t){throw new Error("Не перегружен абстрактный метод Control.createControlView()")},initHandlers:function(){this.controlView.on("onLoaded",function(){this.controlModel.set("isLoaded",!0)},this)},set:function(e,t){this.controlModel.set(e,t)},get:function(e){return this.controlModel.get(e)},on:function(e,t){return this.controlModel.on(e,t)},render:function(){return this.controlView.render().$el},getChildElements:function(){return[]},onLoaded:function(e){this.controlModel.on("change:isLoaded",function(t){t&&e()})},isLoaded:function(){return this.controlModel.get("isLoaded")},onBeforeClick:function(e){this.controlView.on("beforeClick",e)},onClick:function(e){this.controlView.$el.on("click",e)},onDoubleClick:function(e){this.controlView.$el.on("dblclick",e)},onMouseDown:function(e){this.controlView.$el.on("mousedown",e)},onMouseUp:function(e){this.controlView.$el.on("mouseup",e)},onMouseEnter:function(e){this.controlView.$el.on("mouseenter",e)},onMouseLeave:function(e){this.controlView.$el.on("mouseleave",e)},onMouseMove:function(e){this.controlView.$el.on("mousemove",e)},onMouseWheel:function(e){this.controlView.$el.on("mousewheel DOMMouseScroll",e)},onKeyDown:function(e){this.controlView.$el.on("keydown",e)},onKeyUp:function(e){this.controlView.$el.on("keyup",e)},onRemove:function(e){this.controlView.on(messageTypes.onRemove.name,e)},remove:function(){this.controlView.remove()},setFocus:function(){this.controlView.setFocus()}}),InfinniUI.Control=Control;var ControlModel=Backbone.Model.extend({defaults:{text:null,name:null,enabled:!0,parentEnabled:!0,visible:!0,textHorizontalAlignment:InfinniUI.TextHorizontalAlignment.left,horizontalAlignment:"Stretch",textStyle:null,background:null,foreground:null,isLoaded:!1,validationState:"success",validationMessage:"",focusable:!0,focused:!1},initialize:function(){this.set("guid",guid(),{silent:!0}),this.on("change:focused",function(e,t){this.trigger(t?"OnGotFocus":"OnLostFocus")})},set:function(e,t,n){var i,o=this.defaults;if(null===e||"undefined"==typeof e)return this;"object"==typeof e?(i=e,n=t):(i={})[e]=t;for(var r in i)"undefined"!=typeof i[r]&&null!==i[r]||r in o&&(i[r]=o[r]);return Backbone.Model.prototype.set.call(this,i,n)}});InfinniUI.ControlModel=ControlModel;var ControlView=Backbone.View.extend({initialize:function(){this.wasRendered=!1,this.once("render",this.initHandlersForProperties,this),this._initDomHandlers()},classNameFocused:"pl-focused",_initDomHandlers:function(){var e=this,t=this.$el;t[0].addEventListener("click",function(t){e.trigger("beforeClick",null,{value:t})},!0)},initHandlersForProperties:function(){this.listenTo(this.model,"change:visible",this.updateVisible),this.listenTo(this.model,"change:horizontalAlignment",this.updateHorizontalAlignment),this.listenTo(this.model,"change:textHorizontalAlignment",this.updateTextHorizontalAlignment),this.listenTo(this.model,"change:enabled",this.updateEnabled),this.listenTo(this.model,"change:name",this.updateName),this.listenTo(this.model,"change:style",this.updateStyle),this.listenTo(this.model,"change:text",this.updateText),this.listenTo(this.model,"change:textStyle",this.updateTextStyle),this.listenTo(this.model,"change:background",this.updateBackground),this.listenTo(this.model,"change:foreground",this.updateForeground),this.listenTo(this.model,"change:validationState",this.updateValidationState),this.listenTo(this.model,"change:focusable",this.updateFocusable),this.listenTo(this.model,"change:focused",this.updateFocused),this.initFocusHandlers()},initFocusHandlers:function(){function e(e){o.set("focused",!0)}function t(e){i.isControlElement(e.relatedTarget)?o.set("focused",!0):o.set("focused",!1)}var n=this.$el,i=this,o=this.model;n.on("focusin",e).on("focusout",t)},isControlElement:function(e){return this.el===e||$.contains(this.el,e)},updateProperties:function(){this.updateVisible(),this.updateTextHorizontalAlignment(),this.updateHorizontalAlignment(),this.updateEnabled(),this.updateName(),this.updateText(),this.updateStyle(),this.updateTextStyle(),this.updateBackground(),this.updateForeground(),this.updateValidationState(),this.updateFocusable(),this.updateFocused(),this.updateViewMode()},updateFocusable:function(){},getElementForFocus:function(){return this.$el},updateFocused:function(){var e=this.model.get("focused");if(e){var t=this.getElementForFocus();t&&t.length}this.$el.toggleClass(this.classNameFocused,e)},onFocusHandler:function(e){},updateVisible:function(){var e=this.model.get("visible");this.$el.toggleClass("hidden",!e),this.onUpdateVisible()},onUpdateVisible:function(){this.updateLayout()},updateLayout:function(){var e=InfinniUI.global.messageBus;e.send("OnChangeLayout",{})},updateEnabled:function(){var e=this.model.get("enabled");this.$el.toggleClass("pl-disabled",!e)},updateTextHorizontalAlignment:function(){this.switchClass("pl-text-horizontal",this.model.get("textHorizontalAlignment"))},updateHorizontalAlignment:function(){this.switchClass("pl-horizontal",this.model.get("horizontalAlignment"))},updateName:function(){var e=this.model.get("name"),t=this.$el.attr("data-pl-name");e!==t&&"string"==typeof e&&this.$el.attr("data-pl-name",e)},updateText:function(){},updateTextStyle:function(){var e=this.model.get("textStyle");this.changeElementClass(this.valueToTextClassName(this.currentTextStyle),this.valueToTextClassName(e)),this.currentTextStyle=e},updateBackground:function(){var e=this.model.get("background");this.changeElementClass(this.valueToBackgroundClassName(this.currentBackground),this.valueToBackgroundClassName(e)),this.currentBackground=e},updateForeground:function(){var e=this.model.get("foreground");this.changeElementClass(this.valueToForegroundClassName(this.currentForeground),this.valueToForegroundClassName(e)),this.currentForeground=e},updateStyle:function(){var e=this.model.get("style");this.changeElementClass(this.currentStyle,e),this.currentStyle=e},changeElementClass:function(e,t){e&&this.$el.removeClass(e),t&&this.$el.addClass(t)},updateViewMode:function(){"FormGroup"==this.viewMode&&this.$el.addClass("pl-form-group")},updateValidationState:function(){var e=this.model.get("validationState"),t=this.model.get("validationMessage");switch(e){case"success":this.$el.removeClass("has-warning has-error"),this.hideErrorMessage();break;case"warning":this.$el.removeClass("has-error").addClass("has-warning"),this.showErrorMessage(t);break;case"error":this.$el.removeClass("has-warning").addClass("has-error"),this.showErrorMessage(t)}},showErrorMessage:function(e){var t=$(_.template('<i class="2 error-icn fa fa-warning" data-placement="left" title="<%-message%>"></i>')({message:e}));this.hideErrorMessage(),this.$el.find(".form-control:first").before(t),t.tooltip({container:"body"})},hideErrorMessage:function(){this.$el.find(".error-icn").remove()},rerender:function(){this.wasRendered&&this.render()},prerenderingActions:function(){this.wasRendered=!0},postrenderingActions:function(e){this.delegateEvents(),e=void 0===e||e,e&&this.trigger("onLoaded")},remove:function(){this.trigger(messageTypes.onRemove.name),Backbone.View.prototype.remove.apply(this,Array.prototype.slice.call(arguments))},switchClass:function(e,t,n,i){"undefined"==typeof i?i="-":i===!1&&(i="");var o=e+i,r=new RegExp("(^|\\s)"+o+"\\S+","ig"),a=n||this.$el;a.removeClass(function(e,t){return(t.match(r)||[]).join(" ")}).addClass(o+t)},valueToBackgroundClassName:function(e){return e?"pl-"+e.toLowerCase()+"-bg":""},valueToForegroundClassName:function(e){return e?"pl-"+e.toLowerCase()+"-fg":""},valueToTextClassName:function(e){return e?"pl-"+e.toLowerCase():""},renderTemplate:function(e){var t=this.getData();this.$el.html(e(t)),this.bindUIElements()},getData:function(){var e=this.model;return{name:e.get("name"),text:e.get("text"),focusable:e.get("focusable"),focused:e.get("focused"),enabled:e.get("enabled"),visible:e.get("visible"),horizontalAlignment:e.get("horizontalAlignment"),textHorizontalAlignment:e.get("textHorizontalAlignment"),textVerticalAlignment:e.get("textVerticalAlignment"),textStyle:e.get("textStyle"),foreground:e.get("foreground"),background:e.get("background")}},setFocus:function(){this.$el.focus()}});_.extend(ControlView.prototype,bindUIElementsMixin,eventHandlerMixin),InfinniUI.ControlView=ControlView;var buttonControlMixin={click:function(){this.controlView.$el.click()}};InfinniUI.buttonControlMixin=buttonControlMixin,_.inherit(ContainerControl,Control),_.extend(ContainerControl.prototype,{}),InfinniUI.ContainerControl=ContainerControl;var ContainerModel=ControlModel.extend({defaults:_.defaults({itemTemplate:null},ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments)),this.set("items",new Collection)}});InfinniUI.ContainerModel=ContainerModel;var ContainerView=ControlView.extend({initialize:function(e){ControlView.prototype.initialize.call(this,e),this.childElements=[],this.listenTo(this.model,"change:groupValueSelector",this.updateGrouping),this.updateGrouping()},updateGrouping:function(){throw new Error("ContainerView.updateGrouping В потомке ContainerView не реализовано обновление группировок.")},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this);var e=this;this.model.get("items").onChange(function(t){switch(t.action){case"replace":break;default:e.rerender()}})},removeChildElements:function(){for(var e=0,t=this.childElements.length;e<t;e++)this.childElements[e].remove();this.childElements=[]},addChildElement:function(e){this.childElements.push(e)}});InfinniUI.ContainerView=ContainerView;var editorBaseControlMixin={initialize_editorBaseControl:function(){},setValue:function(e){this.controlModel.set("value",e)},getValue:function(){return this.controlModel.get("value")},onValueChanging:function(e){this.controlModel.onValueChanging(e)},onValueChanged:function(e){this.controlModel.onValueChanged(e)},getRawValue:function(){return this.controlView.getRawValue()}};InfinniUI.editorBaseControlMixin=editorBaseControlMixin;var editorBaseModelMixin={defaults_editorBaseModel:{value:null,hintText:null,errorText:null,warningText:null,labelFloating:!1,editMode:!1},initialize_editorBaseModel:function(){this.eventManager=new EventManager,this.isInited=!0},transformValue:function(e){return e},_applyDefaultValue:function(e){var t=_.result(this,"defaults");return"undefined"==typeof e?t.value:e},_setValue:function(e,t){e=this.transformValue(e),e=this._applyDefaultValue(e);var n=this.get("value"),i={oldValue:n,newValue:e};e!==n&&(this.isInited?this.eventManager.trigger("onValueChanging",i)&&(ContainerModel.prototype.set.call(this,"value",e,t||{}),this.trigger("onValueChanged",i)):ContainerModel.prototype.set.call(this,"value",e,t||{}))},set:function(e,t,n){var i;if(null===e||"undefined"==typeof e)return this;"object"==typeof e?(i=e,n=t):(i={})[e]=t,n=n||{},"value"in i&&(this._setValue(i.value,n),delete i.value);var o=!1;for(var r in i){o=!0;break}return!!o&&ContainerModel.prototype.set.call(this,i,n)},getValue:function(){return this.get("value")},isSetValue:function(e){return null!==e&&"undefined"!=typeof e&&""!==e},onValueChanging:function(e){this.eventManager.on("onValueChanging",e)},onValueChanged:function(e){this.on("onValueChanged",e)}};InfinniUI.editorBaseModelMixin=editorBaseModelMixin;var editorBaseViewMixin={UI:{hintText:".pl-control-hint-text",warningText:".pl-control-warning-text",errorText:".pl-control-error-text"},getData:function(){return{guid:this.model.get("guid")}},initHandlersForProperties:function(){this.listenTo(this.model,"onValueChanged",this.updateValue),this.listenTo(this.model,"change:hintText",this.updateHintText),this.listenTo(this.model,"change:errorText",this.updateErrorText),this.listenTo(this.model,"change:warningText",this.updateWarningText),this.listenTo(this.model,"change:labelFloating",this.updateLabelFloating)},updateProperties:function(){this.updateValue(),this.updateLabelFloating(),this.updateHintText(),this.updateErrorText(),this.updateWarningText()},updateValue:function(){throw new Error("editorBaseViewMixin.updateValue В потомке editorBaseViewMixin не реализовано обновление данных.")},updateValueState:function(){var e=this.model.get("value"),t=_.isEmpty(e)&&"number"!=typeof e;this.$el.toggleClass("pl-empty-text-editor",t)},updateLabelFloating:function(){var e=this.model.get("labelFloating");this.$el.toggleClass("pl-label-floating",e===!0)},updateHintText:function(){this.toggleHintText(this.ui.hintText,this.model.get("hintText"))},updateErrorText:function(){this.toggleHintText(this.ui.errorText,this.model.get("errorText"),InfinniUI.Theme["default"].classes.inputError)},updateWarningText:function(){this.toggleHintText(this.ui.warningText,this.model.get("warningText"),InfinniUI.Theme["default"].classes.inputWarning)},updateEnabled:function(){if(ControlView.prototype.updateEnabled.call(this),this.ui.control){var e=this.model.get("enabled");this.ui.control.prop("disabled",!e)}},onInvalidHandler:function(e,t){},toggleHintText:function(e,t,n){var i=!t;e.text(i?"":t).toggleClass(InfinniUI.Theme["default"].classes.hidden,i),n&&this.$el.toggleClass(n,!i)}};InfinniUI.editorBaseViewMixin=editorBaseViewMixin,_.inherit(ListEditorBaseControl,ContainerControl),_.extend(ListEditorBaseControl.prototype,{onSelectedItemChanged:function(e){this.controlModel.onSelectedItemChanged(e)}},editorBaseControlMixin),InfinniUI.ListEditorBaseControl=ListEditorBaseControl;var ListEditorBaseModel=ContainerModel.extend(_.extend({defaults:_.defaults({multiSelect:!1,disabledItemCondition:null},ContainerModel.prototype.defaults),initialize:function(){var e=this;this.hashValueByItem=new HashMap,ContainerModel.prototype.initialize.apply(this,arguments),this.initialize_editorBaseModel(),this.bindSelectedItemsWithValue(),this.get("items").onChange(function(){e.hashValueByItem.clear()})},onSelectedItemChanged:function(e){this.on("change:selectedItem",function(t,n){e({value:n})})},toggleValue:function(e,t){var n=this.get("value"),i=this.get("multiSelect");if(i){n=Array.isArray(n)?n:[];var o=JSON.stringify(e),r=n.filter(function(e){return JSON.stringify(e)!==o});"undefined"!=typeof t&&t!==!0||r.length===n.length&&r.push(e),this.set("value",r)}else e!=n&&this.set("value",e)},bindSelectedItemsWithValue:function(){},valueByItem:function(e){var t=this.get("valueSelector");return t?t(void 0,{value:e}):e},itemInfoByValue:function(e){0===this.hashValueByItem.length&&this.updateHashValueByItem();var t,n,i=this.hashValueByItem.getKeyByValue(e);if("undefined"!=typeof i)t={item:i,index:this.hashValueByItem.keys.indexOf(i)};else{var o=JSON.stringify(e);n=this.hashValueByItem.findIndex(function(e,t){return JSON.stringify(t)===o}),n!==-1&&(t={index:n,item:this.hashValueByItem.keys[n]})}return t},itemByValue:function(e){
var t=this.itemInfoByValue(e);return t?t.item:void 0},itemIndexByValue:function(e){var t=this.itemInfoByValue(e);return t?t.index:-1},itemIndexByItem:function(e){var t=this.valueByItem(e);return this.itemIndexByValue(t)},isDisabledItem:function(e){var t=this.get("disabledItemCondition");return null!==t&&"undefined"!=typeof t&&t(void 0,{value:e})},updateHashValueByItem:function(){var e,t=this.get("items");this.hashValueByItem.clear(),t.forEach(function(t){e=this.valueByItem(t),this.hashValueByItem.add(t,e)},this)}},editorBaseModelMixin));InfinniUI.ListEditorBaseModel=ListEditorBaseModel;var ListEditorBaseView=ContainerView.extend(_.extend({},editorBaseViewMixin,{initHandlersForProperties:function(){ContainerView.prototype.initHandlersForProperties.call(this),editorBaseViewMixin.initHandlersForProperties.call(this),this.listenTo(this.model,"change:selectedItem",this.updateSelectedItem),this.listenTo(this.model,"change:multiSelect",this.updateMultiSelect),this.listenTo(this.model,"change:disabledItemCondition",this.updateDisabledItem)},updateProperties:function(){ContainerView.prototype.updateProperties.call(this),editorBaseViewMixin.updateProperties.call(this),this.updateSelectedItem(),this.updateMultiSelect(),this.updateDisabledItem()},updateMultiSelect:function(){}}));InfinniUI.ListEditorBaseView=ListEditorBaseView,_.inherit(TextEditorBaseControl,Control),_.extend(TextEditorBaseControl.prototype,editorBaseControlMixin),InfinniUI.TextEditorBaseControl=TextEditorBaseControl;var TextEditorBaseModel=ControlModel.extend({defaults:_.defaults({labelText:null,displayFormat:null,editMask:null},editorBaseModelMixin.defaults_editorBaseModel,ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments),this.initialize_editorBaseModel()}});_.extend(TextEditorBaseModel.prototype,editorBaseModelMixin),InfinniUI.TextEditorBaseControl=TextEditorBaseControl;var TextEditorBaseView=ControlView.extend(_.extend({},editorBaseViewMixin,editMaskViewMixin,{UI:_.extend({},editorBaseViewMixin.UI,{control:".pl-control",editor:".pl-editor",label:".pl-control-label",textbox:".pl-text-box-input"}),events:_.extend({},ControlView.prototype.events,editMaskViewMixin.events),initialize:function(){ControlView.prototype.initialize.apply(this,Array.prototype.slice.call(arguments)),editMaskViewMixin.initialize.call(this)},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),editorBaseViewMixin.initHandlersForProperties.call(this),editMaskViewMixin.initHandlersForProperties.call(this),this.listenTo(this.model,"change:labelText",this.updateLabelText),this.listenTo(this.model,"change:displayFormat",this.updateDisplayFormat),this.listenTo(this.model,"change:editMask",this.updateEditMask),this.listenTo(this.model,"change:inputType",this.updateInputType)},updateProperties:function(){ControlView.prototype.updateProperties.call(this),editorBaseViewMixin.updateProperties.call(this),this.updateLabelText(),this.updateInputType()},updateFocusable:function(){var e=this.model.get("focusable");e?this.ui.editor.removeAttr("tabindex"):this.ui.editor.attr("tabindex",-1)},updateInputType:function(){var e=this.model.get("inputType");this.ui.editor.attr("type",e)},updateEditMask:function(){},setFocus:function(){this.ui.editor.focus()},updateValue:function(){editorBaseViewMixin.updateValueState.call(this),this.ui.control.val(this.getDisplayValue())},updateLabelText:function(){var e=this.model.get("labelText");e?this.ui.label.text(e).removeClass("hidden"):this.ui.label.text("").addClass("hidden")},updateDisplayFormat:function(){this.updateValue()},getData:function(){var e=this.model;return _.extend({},ControlView.prototype.getData.call(this),editorBaseViewMixin.getData.call(this),{labelText:e.get("labelText"),labelFloating:e.get("labelFloating"),value:this.getDisplayValue()})},getDisplayValue:function(){var e=this.model,t=e.get("value"),n=e.get("displayFormat");return n?n(null,{value:t}):t},getRawValue:function(){return this.ui.editor.val()}}));InfinniUI.TextEditorBaseView=TextEditorBaseView,EventManager.prototype.on=function(e,t){return"undefined"==typeof this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e].push(t),this},EventManager.prototype.trigger=function(e,t,n){var i=this.handlers[e],o=!0;return Array.isArray(i)&&(o=i.map(function(e){return e.call(n,t)}).every(function(e){return e!==!1})),o},InfinniUI.EventManager=EventManager;var highlightMixin={attributeName:"_highlight",highlightClassName:"active",control:{setHighlight:function(e){this.controlModel.set(highlightMixin.attributeName,e)},getHighlight:function(){return this.controlModel.get(highlightMixin.attributeName)}},controlView:{initHighlightMixin:function(){this.listenTo(this.model,"change:"+highlightMixin.attributeName,function(){var e=this.model;this.$el.toggleClass(highlightMixin.highlightClassName,e.get(highlightMixin.attributeName)),this.$el.parent().toggleClass(highlightMixin.highlightClassName,e.get(highlightMixin.attributeName))})}}};InfinniUI.highlightMixin=highlightMixin,_.inherit(TextBoxControl,TextEditorBaseControl),_.extend(TextBoxControl.prototype,{createControlModel:function(){return new TextBoxModel},createControlView:function(e){return new TextBoxView({model:e})}}),InfinniUI.TextBoxControl=TextBoxControl;var TextBoxModel=TextEditorBaseModel.extend({defaults:_.extend({},TextEditorBaseModel.prototype.defaults,{multiline:!1,inputType:"text"}),initialize:function(){TextEditorBaseModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.TextBoxModel=TextBoxModel;var TextBoxView=TextEditorBaseView.extend({template:{oneline:InfinniUI.Template["controls/textBox/template/oneline.tpl.html"],multiline:InfinniUI.Template["controls/textBox/template/multiline.tpl.html"]},className:"pl-textbox form-group",UI:_.extend({},TextEditorBaseView.prototype.UI),events:_.extend({},TextEditorBaseView.prototype.events,{}),initHandlersForProperties:function(){TextEditorBaseView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:multiline",this.updateMultiline),this.listenTo(this.model,"change:lineCount",this.updateLineCount)},updateProperties:function(){TextEditorBaseView.prototype.updateProperties.call(this),this.updateLineCount()},updateMultiline:function(){this.rerender()},updateLineCount:function(){var e=this.model.get("lineCount");this.ui.editor.attr("rows",e)},render:function(){this.prerenderingActions();var e=this.model,t=e.get("multiline")?this.template.multiline:this.template.oneline;return this.renderTemplate(t),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},getData:function(){var e=TextEditorBaseView.prototype.getData.call(this),t=this.model;return _.extend(e,{multiline:t.get("multiline"),lineCount:t.get("lineCount")})}});InfinniUI.TextBoxView=TextBoxView;var dateTimePickerModeDate={getTemplate:function(){return InfinniUI.Template["controls/dateTimePicker/template/date.tpl.html"]},onClickDropdownHandler:function(){var e=this.model,t=new SelectDate({model:e});t.render(),$("body").append(t.$el),t.updatePosition(this.el),this.listenTo(t,"date",function(t){e.set("value",this.convertValue(t))})},convertValue:function(e){return InfinniUI.DateUtils.dateToTimestamp(InfinniUI.DateUtils.changeTimezoneOffset(e))}};InfinniUI.dateTimePickerModeDate=dateTimePickerModeDate;var dateTimePickerModeDateTime={getTemplate:function(){return InfinniUI.Template["controls/dateTimePicker/template/dateTime.tpl.html"]},onClickDropdownHandler:function(){var e=this.model,t=new SelectDateTime({model:e});t.render(),$("body").append(t.$el),t.updatePosition(this.el),this.listenTo(t,"date",function(t){e.set("value",this.convertValue(t))})},convertValue:function(e){return InfinniUI.DateUtils.toISO8601(e,{timezoneOffset:this.model.get("timeZone")})}};InfinniUI.dateTimePickerModeDateTime=dateTimePickerModeDateTime;var dateTimePickerModeTime={getTemplate:function(){return InfinniUI.Template["controls/dateTimePicker/template/time.tpl.html"]},onClickDropdownHandler:function(){var e=this.model,t=new SelectTime({model:e});t.render(),$("body").append(t.$el),t.updatePosition(this.el),this.listenTo(t,"date",function(t){e.set("value",this.convertValue(t))})},convertValue:function(e){return InfinniUI.DateUtils.dateToTimestamp(InfinniUI.DateUtils.changeTimezoneOffset(e,this.model.get("timeZone")))}};InfinniUI.dateTimePickerModeTime=dateTimePickerModeTime;var SelectComponent=Backbone.View.extend({modelClass:Backbone.Model,initialize:function(e){var t=this.modelClass;return this.model=new t({today:e.today||new Date,value:e.value,date:e.value||e.today,max:e.max,min:e.min}),this.render(),this},show:function(){this.$el.css("display","block")},hide:function(){this.$el.css("display","none")},setDate:function(e){this.model.setDate(e)}});_.extend(SelectComponent.prototype,bindUIElementsMixin),InfinniUI.SelectComponent=SelectComponent;var SelectComponentModel=Backbone.Model.extend({defaults:function(){var e=new Date;return{today:e,todayMonth:e.getMonth(),todayDay:e.getDate(),todayYear:e.getFullYear(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}},initialize:function(){this.updateDateParts(),this.on("change:date",this.onChangeDateHandler,this)},updateDateParts:function(){var e=this.get("date");e instanceof Date?this.set({year:e.getFullYear(),month:e.getMonth(),day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}):this.set({year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null})},onChangeDateHandler:function(e,t){"undefined"!=typeof t&&null!==t?e.set({year:moment(t).year(),month:moment(t).month(),day:moment(t).date(),hour:moment(t).hour(),minute:moment(t).minute(),second:moment(t).second(),millisecond:moment(t).millisecond()}):e.set({year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null})},updateDatePart:function(e,t,n){var i=this.get("date"),o=InfinniUI.DateUtils.createDate(i)||this.get("today"),r=this.toJSON();switch(e){case"hour":case"minute":case"second":o.setHours(r.hour,r.minute,r.second);break;case"year":case"month":case"day":o.setFullYear(r.year,r.month,r.day)}this.set("date",o)},checkRange:function(e,t){var n=this.get("min"),i=this.get("max");return InfinniUI.DateUtils.checkRangeDate(e,n,i,t)},keepDateInRange:function(){if(!this.isValid()){var e=InfinniUI.DateUtils.getNearestDate(this.get("date"),this.get("min"),this.get("max"));this.set("date",e)}},setDate:function(e){if("undefined"==typeof e||null===e){var t=this.get("value"),n=this.get("date");e=t||n}e instanceof Date&&(e=new Date(e.getTime())),this.set("date",e)}});InfinniUI.SelectComponentModel=SelectComponentModel;var SelectDaysModel=SelectComponentModel.extend({initialize:function(){SelectComponentModel.prototype.initialize.call(this),this.on("change:year",this.updateDatePart.bind(this,"year")),this.on("change:month",this.updateDatePart.bind(this,"month")),this.on("change:day",this.updateDatePart.bind(this,"day"))},today:function(){this.set({year:this.get("todayYear"),month:this.get("todayMonth")})},nextMonth:function(){var e=this.get("month"),t=this.get("year");this.set({month:11===e?0:e+1,year:11===e?t+1:t}),this.keepDateInRange()},prevMonth:function(){var e=this.get("month"),t=this.get("year");this.set({month:0===e?11:e-1,year:0===e?t-1:t}),this.keepDateInRange()}});InfinniUI.SelectDaysModel=SelectDaysModel;var SelectDays=SelectComponent.extend({modelClass:SelectDaysModel,template:InfinniUI.Template["controls/dateTimePicker/template/date/days.tpl.html"],UI:{headerDays:".weekdays-head .day",calendarDays:".day-calendar",year:".years-year",month:".years-month"},events:{"click .years":"onYearsClickHandler","click .btn-month-prev":"prevMonth","click .btn-month-next":"nextMonth","click .today-date":"showToday",'click .day-calendar:not(".day-unavailable")':"useDay","click .time":"showTime"},render:function(){var e=this.template();this.$el.html(e),this.bindUIElements(),this.fillLegend(),this.fillCalendar(),this.renderMonth(),this.renderYear(),this.initOnChangeHandlers()},initOnChangeHandlers:function(){this.listenTo(this.model,"change:month",this.onChangeMonthHandler),this.listenTo(this.model,"change:year",this.onChangeYearHandler),this.listenTo(this.model,"change:day",this.onChangeDayHandler)},renderMonth:function(){var e=this.model.get("month"),t=localized.dateTimeFormatInfo;this.ui.month.text(t.monthNames[e])},renderYear:function(){var e=this.model.get("year");this.ui.year.text(e)},onChangeMonthHandler:function(e,t){this.renderMonth(),this.fillCalendar()},onChangeYearHandler:function(e,t){this.renderYear(),this.fillCalendar()},fillLegend:function(){function e(e,t){e.toggleClass("day-weekend",0===t||6===t)}var t=localized.dateTimeFormatInfo,n=t.firstDayOfWeek,i=t.abbreviatedDayNames.map(function(e,t){return t});n>0&&(i=i.splice(n).concat(i)),this.ui.headerDays.each(function(n,o){var r=$(o),a=i[n];r.text(t.abbreviatedDayNames[a]),e(r,a)}),this.ui.calendarDays.each(function(t,n){var o=$(n),r=i[t%7];e(o,r)})},fillCalendar:function(){function e(e,t){e.toggleClass("day-inactive",!t)}function t(e,t){var n=t.getMonth()===o.get("todayMonth")&&t.getFullYear()===o.get("todayYear")&&t.getDate()===o.get("todayDay");e.toggleClass("day-today",n)}function n(e,t){var n=!1;r&&(n=moment(r).isSame(t,"day")),e.toggleClass("day-selected",n)}function i(e,t){e.toggleClass("day-unavailable",!o.checkRange(t,"day"))}var o=this.model,r=o.get("value"),a=o.get("month"),l=o.get("year"),s=(o.get("day"),o.get("min"),o.get("max"),new Date(l,a)),u=s.getDay(),c=localized.dateTimeFormatInfo,d=c.firstDayOfWeek,p=[0,1,2,3,4,5,6];Array.prototype.push.apply(p,p.splice(0,d));var h=new Date(l,a,1-p.indexOf(u)),f=h.getFullYear(),m=h.getMonth(),g=h.getDate();this.ui.calendarDays.each(function(o,r){var l=$(r),s=new Date(f,m,g+o);l.text(s.getDate()),l.attr("data-date",s),e(l,s.getMonth()===a),t(l,s),n(l,s),i(l,s)})},onYearsClickHandler:function(){var e=this.model.get("date");this.trigger("year",e)},prevMonth:function(){this.model.prevMonth()},nextMonth:function(){this.model.nextMonth()},showToday:function(){this.today()},today:function(){this.model.today()},showTime:function(){this.trigger("time",this.model.get("date"))},useDay:function(e){var t=$(e.target),n=new Date(t.attr("data-date"));this.model.set({year:n.getFullYear(),month:n.getMonth(),day:n.getDate()}),this.trigger("date",this.model.get("date"))}});InfinniUI.SelectDays=SelectDays;var SelectHoursModel=SelectComponentModel.extend({initialize:function(){SelectComponentModel.prototype.initialize.call(this),this.on("change:hour",this.updateDatePart.bind(this,"hour"))}});InfinniUI.SelectHoursModel=SelectHoursModel;var SelectHours=SelectComponent.extend({modelClass:SelectHoursModel,template:InfinniUI.Template["controls/dateTimePicker/template/time/hours.tpl.html"],events:{"click .hour:not('.hour-unavailable')":"useHour"},UI:{hour:".hour"},render:function(){var e=this.template();this.$el.html(e),this.bindUIElements(),this.fillHoursTable(),this.initOnChangeHandlers()},fillHoursTable:function(){function e(e,t){e.toggleClass("hour-selected",o.getHours()===t)}function t(e,t){var n=moment(r).isSame(t,"hour");e.toggleClass("hour-today",n)}function n(e,t){var n=moment(i.get("date")).hour(t);e.toggleClass("hour-unavailable",!i.checkRange(n,"hour"))}var i=this.model,o=i.get("date")||i.get("today"),r=new Date;this.ui.hour.each(function(i,o){var r=$(o),a=stringUtils.padLeft(i,2,"0");r.attr("data-hour",i),r.text(a),t(r,i),e(r,i),n(r,i)})},initOnChangeHandlers:function(){this.listenTo(this.model,"change:date",this.fillHoursTable)},useHour:function(e){var t=$(e.target),n=this.model,i=n.get("date"),o=parseInt(t.attr("data-hour"),10),r=InfinniUI.DateUtils.cloneDate(i);r.setHours(o),n.set("date",r),this.trigger("hour",r)}});InfinniUI.SelectHours=SelectHours;var SelectMinutesModel=SelectComponentModel.extend({initialize:function(){SelectComponentModel.prototype.initialize.call(this),this.on("change:minute",this.updateDatePart.bind(this,"minute"))}});InfinniUI.SelectMinutesModel=SelectMinutesModel;var SelectMinutes=SelectComponent.extend({modelClass:SelectMinutesModel,template:InfinniUI.Template["controls/dateTimePicker/template/time/minutes.tpl.html"],events:{"click .minute:not('.minute-unavailable')":"useMinute"},UI:{minute:".minute"},render:function(){var e=this.template();this.$el.html(e),this.bindUIElements(),this.fillMinutesTable(),this.initOnChangeHandlers()},fillMinutesTable:function(){function e(e,t){e.toggleClass("minute-selected",t===i)}function t(e,t){var i=moment(n.get("date")).minute(t);e.toggleClass("minute-unavailable",!n.checkRange(i,"minute"))}var n=this.model,i=n.get("minute");this.ui.minute.each(function(n,i){var o=$(i),r=o.attr("data-minute");e(o,parseInt(r,10)),t(o,parseInt(r,10))})},initOnChangeHandlers:function(){this.listenTo(this.model,"change:date",this.fillMinutesTable)},useMinute:function(e){var t=$(e.target),n=this.model,i=n.get("date"),o=parseInt(t.attr("data-minute"),10),r=InfinniUI.DateUtils.cloneDate(i);r.setMinutes(o),this.trigger("minute",r)}});InfinniUI.SelectMinutes=SelectMinutes;var SelectMonthsModel=SelectComponentModel.extend({initialize:function(){SelectComponentModel.prototype.initialize.call(this),this.on("change:month",this.updateDatePart.bind(this,"month")),this.on("change:year",this.updateDatePart.bind(this,"year"))},nextYear:function(){var e=this.get("year");this.set("year",e+1),this.keepDateInRange()},prevYear:function(){var e=this.get("year");this.set("year",e-1),this.keepDateInRange()},today:function(){this.set({month:this.get("todayMonth"),year:this.get("todayYear")})}});InfinniUI.SelectMonthsModel=SelectMonthsModel;var SelectMonths=SelectComponent.extend({modelClass:SelectMonthsModel,template:InfinniUI.Template["controls/dateTimePicker/template/date/months.tpl.html"],events:{"click .btn-year-prev":"prevYear","click .btn-year-next":"nextYear","click .month:not('.month-unavailable')":"useMonth","click .year":"selectYear","click .today-month":"showToday"},UI:{month:".month",year:".year"},render:function(){var e=this.template();this.$el.html(e),this.bindUIElements(),this.fillMonthsTable(),this.initOnChangeHandlers()},fillMonthsTable:function(){function e(e,t){var n=moment([i.get("year"),t]),o=i.get("today");e.toggleClass("month-today",moment(n).isSame(o,"month"))}function t(e,t){var n=moment([i.get("year"),t]),o=i.get("value");e.toggleClass("month-selected",moment(n).isSame(o,"month"))}function n(e,t){var n=moment([i.get("year"),t]);e.toggleClass("month-unavailable",!i.checkRange(n,"month"))}this.ui.year.text(this.model.get("year"));var i=this.model,o=localized.dateTimeFormatInfo;i.get("todayMonth"),i.get("month");this.ui.month.each(function(i,r){var a=$(r);a.text(o.abbreviatedMonthNames[i]),a.attr("data-month",i),e(a,i),t(a,i),n(a,i)})},initOnChangeHandlers:function(){this.listenTo(this.model,"change:year",this.fillMonthsTable)},prevYear:function(){this.model.prevYear()},nextYear:function(){this.model.nextYear()},useMonth:function(e){var t=$(e.target),n=this.model;n.set({year:parseInt(n.get("year"),10),month:parseInt(t.attr("data-month"),10)}),this.trigger("month",n.get("date"))},selectYear:function(){this.trigger("year",this.model.get("data"))},showToday:function(){this.today()},today:function(){this.model.today()}});InfinniUI.SelectMonths=SelectMonths;var SelectSecondsModel=SelectComponentModel.extend({initialize:function(){SelectComponentModel.prototype.initialize.call(this),this.on("change:second",this.updateDatePart.bind(this,"second"))}});InfinniUI.SelectSecondsModel=SelectSecondsModel;var SelectSeconds=SelectComponent.extend({modelClass:SelectSecondsModel,template:InfinniUI.Template["controls/dateTimePicker/template/time/seconds.tpl.html"],events:{"click .second:not('.second-unavailable')":"useSecond"},UI:{second:".second"},render:function(){var e=this.template();this.$el.html(e),this.bindUIElements(),this.fillSecondsTable(),this.initOnChangeHandlers()},fillSecondsTable:function(){function e(e,t){e.toggleClass("second-selected",t===i)}function t(e,t){var i=moment(n.get("date")).seconds(t);e.toggleClass("second-unavailable",!n.checkRange(i))}var n=this.model,i=n.get("second");this.ui.second.each(function(n,i){var o=$(i),r=o.attr("data-second");e(o,parseInt(r,10)),t(o,parseInt(r,10))})},initOnChangeHandlers:function(){this.listenTo(this.model,"change:date",this.fillSecondsTable)},useSecond:function(e){var t=$(e.target),n=this.model,i=n.get("date"),o=parseInt(t.attr("data-second"),10),r=InfinniUI.DateUtils.cloneDate(i);r.setSeconds(o),this.trigger("second",r)}});InfinniUI.SelectSeconds=SelectSeconds;var SelectTimesModel=SelectComponentModel.extend({initialize:function(){SelectComponentModel.prototype.initialize.call(this),this.on("change:hour",this.updateDatePart.bind(this,"hour")),this.on("change:minute",this.updateDatePart.bind(this,"minute")),this.on("change:second",this.updateDatePart.bind(this,"second")),this.on("change:millisecond",this.updateDatePart.bind(this,"millisecond"))},nextHour:function(){var e=this.get("hour");e+=1,e>23||(this.set("hour",e),this.keepDateInRange())},prevHour:function(){var e=this.get("hour");e-=1,e<0||(this.set("hour",e),this.keepDateInRange())},nextMinute:function(){var e=this.get("minute");e+=1,e>=60||(this.set("minute",e),this.keepDateInRange())},prevMinute:function(){var e=this.get("minute");e-=1,e<0||(this.set("minute",e),this.keepDateInRange())},nextSecond:function(){var e=this.get("second");e+=1,e>=60||(this.set("second",e),this.keepDateInRange())},prevSecond:function(){var e=this.get("second");e-=1,e<0||(this.set("second",e),this.keepDateInRange())},validate:function(e){var t=InfinniUI.DateUtils.cloneDate(e.date);if(t.setHours(e.hour,e.minute,e.second,e.millisecond),!this.checkRange(t))return"Out of range"}});InfinniUI.SelectTimesModel=SelectTimesModel;var SelectTimes=SelectComponent.extend({modelClass:SelectTimesModel,template:InfinniUI.Template["controls/dateTimePicker/template/time/time.tpl.html"],events:{"click .time-spin-down.time-spin-hour":"prevHour","click .time-spin-up.time-spin-hour":"nextHour","click .time-spin-down.time-spin-minute":"prevMinute","click .time-spin-up.time-spin-minute":"nextMinute","click .time-spin-down.time-spin-second":"prevSecond","click .time-spin-up.time-spin-second":"nextSecond","click .time-segment-hour":"selectHour","click .time-segment-minute":"selectMinute","click .time-segment-second":"selectSecond","click .days":"selectDay"},UI:{month:".month",year:".year",hour:".time-segment-hour",minute:".time-segment-minute",second:".time-segment-second"},render:function(){var e=this.template();this.$el.html(e),this.bindUIElements(),this.updateHour(),this.updateMinute(),this.updateSecond(),this.initOnChangeHandlers()},selectHour:function(){var e=this.model,t=e.get("date"),n=e.get("hour"),i=e.get("minute"),o=e.get("second");t.setHours(n,i,o),this.trigger("hour",t)},selectMinute:function(){var e=this.model,t=e.get("date"),n=e.get("hour"),i=e.get("minute"),o=e.get("second");t.setHours(n,i,o),this.trigger("minute",t)},selectSecond:function(){var e=this.model,t=e.get("date"),n=e.get("hour"),i=e.get("minute"),o=e.get("second");t.setHours(n,i,o),this.trigger("second",t)},initOnChangeHandlers:function(){this.listenTo(this.model,"change:hour",this.updateHour),this.listenTo(this.model,"change:minute",this.updateMinute),this.listenTo(this.model,"change:second",this.updateSecond),this.listenTo(this.model,"change:date",this.useTime)},updateHour:function(){var e=this.model.get("hour");this.ui.hour.text(stringUtils.padLeft(e,2,"0"))},updateMinute:function(){var e=this.model.get("minute");this.ui.minute.text(stringUtils.padLeft(e,2,"0"))},updateSecond:function(){var e=this.model.get("second");this.ui.second.text(stringUtils.padLeft(e,2,"0"))},prevHour:function(){this.model.prevHour()},nextHour:function(){this.model.nextHour()},prevMinute:function(){this.model.prevMinute()},nextMinute:function(){this.model.nextMinute()},prevSecond:function(){this.model.prevSecond()},nextSecond:function(){this.model.nextSecond()},useTime:function(){var e=this.model.get("date");this.trigger("date",e)},selectDay:function(){var e=this.model.get("date");this.trigger("day",e)}});InfinniUI.SelectTimes=SelectTimes;var SelectYearsModel=SelectComponentModel.extend({defaults:function(){var e=SelectComponentModel.prototype.defaults.call(this);return _.defaults({pageSize:20,page:0},e)},initialize:function(){SelectComponentModel.prototype.initialize.call(this),this.on("change:year",this.updateDatePart.bind(this,"year")),this.on("change:year",this.onChangeYearHandler)},prevPage:function(){var e=this.get("page");this.set("page",e-1)},nextPage:function(){var e=this.get("page");this.set("page",e+1)},resetPage:function(){this.set("page",0)},onChangeYearHandler:function(e){this.keepDateInRange(),e.set("page",0)}});InfinniUI.SelectYearsModel=SelectYearsModel;var SelectYears=SelectComponent.extend({modelClass:SelectYearsModel,template:InfinniUI.Template["controls/dateTimePicker/template/date/years.tpl.html"],events:{"click .btn-year-prev":"prevPage","click .btn-year-next":"nextPage","click .today-year":"showTodayYear",'click .year:not(".year-unavailable")':"useYear"},UI:{years:".year",yearBegin:".year-begin",yearEnd:".year-end"},initOnChangeHandlers:function(){this.listenTo(this.model,"change:page",this.fillYearsTable),this.listenTo(this.model,"change:year",this.fillYearsTable)},render:function(){var e=this.template();this.$el.html(e),this.bindUIElements(),this.fillYearsTable(),this.initOnChangeHandlers()},fillYearsTable:function(){function e(e,t){e.toggleClass("year-today",t===l)}function t(e,t){e.toggleClass("year-selected",t===a)}function n(e,t){var n=moment([t]);e.toggleClass("year-unavailable",!i.checkRange(n,"year"))}var i=this.model,o=i.get("page"),r=i.get("pageSize"),a=i.get("year"),l=i.get("todayYear"),s=Math.ceil(a-r/2)+o*r;this.ui.years.each(function(i,o){var r=$(o),a=s+i;r.text(a),r.attr("data-year",a),e(r,a),t(r,a),n(r,a)}),this.ui.yearBegin.text(s),this.ui.yearEnd.text(s+r-1)},prevPage:function(){this.model.prevPage()},nextPage:function(){this.model.nextPage()},showTodayYear:function(){this.today()},today:function(){this.model.resetPage()},useYear:function(e){var t=$(e.target),n=this.model;n.set({year:parseInt(t.attr("data-year"),10)}),this.trigger("year",n.get("date"))}});InfinniUI.SelectYears=SelectYears,InfinniUI.DateTimePickerControl=DateTimePickerControl,_.inherit(DateTimePickerControl,TextEditorBaseControl),_.extend(DateTimePickerControl.prototype,{createControlModel:function(){return new DateTimePickerModel},createControlView:function(e){return new DateTimePickerView({model:e})}}),InfinniUI.DateTimePickerControl=DateTimePickerControl;var DateTimePickerModel=TextEditorBaseModel.extend({defaults:_.extend({},TextEditorBaseModel.prototype.defaults,{mode:"Date"}),initialize:function(){TextEditorBaseModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments)),this.set("today",new Date),this.set("timeZone",InfinniUI.DateUtils.getDefaultTimeZone())},validate:function(e){var t=InfinniUI.DateUtils.checkRangeDate(e.value,e.minValue,e.maxValue);if(!t)return"Значение выходит за пределы допустимого диапазона"}});InfinniUI.DateTimePickerModel=DateTimePickerModel;var dateTimePickerStrategy=function(){return{Date:dateTimePickerModeDate,DateTime:dateTimePickerModeDateTime,Time:dateTimePickerModeTime}}();InfinniUI.dateTimePickerStrategy=dateTimePickerStrategy;var DateTimePickerView=TextEditorBaseView.extend({className:"pl-datepicker form-group",template:InfinniUI.Template["controls/dateTimePicker/template/date.tpl.html"],UI:_.extend({},TextEditorBaseView.prototype.UI,{dropdownButton:".pl-datepicker-calendar",controlWrap:".control-wrap",editorWrap:".editor-wrap"}),events:_.extend({},TextEditorBaseView.prototype.events,{"click .pl-datepicker-calendar":"onClickDropdownHandler"}),editMaskStrategies:{DateTimeEditMask:"iso8601"},initialize:function(){TextEditorBaseView.prototype.initialize.apply(this,Array.prototype.slice.call(arguments)),this.updateMode(),this.listenTo(this.model,"change:mode",this.updateMode)},initHandlersForProperties:function(){TextEditorBaseView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:minValue",this.updateMinValue),this.listenTo(this.model,"change:maxValue",this.updateMaxValue)},updateProperties:function(){TextEditorBaseView.prototype.updateProperties.call(this)},updateMode:function(){var e=this.model.get("mode");_.extend(this,dateTimePickerStrategy[e]),this.rerender()},updateMinValue:function(){var e=this.model.get("mode");_.extend(this,dateTimePickerStrategy[e]),this.rerender()},updateMaxValue:function(){var e=this.model.get("mode");_.extend(this,dateTimePickerStrategy[e]),this.rerender()},updateEnabled:function(){TextEditorBaseView.prototype.updateEnabled.call(this);var e=this.model.get("enabled");this.ui.dropdownButton.prop("disabled",!e)},render:function(){return this.prerenderingActions(),this.renderTemplate(this.getTemplate()),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},getData:function(){var e=this.model;return _.extend({},TextEditorBaseView.prototype.getData.call(this),{minValue:e.get("minValue"),maxValue:e.get("maxValue"),mode:e.get("mode")})},getTemplate:function(){throw new Error("Не перекрыт getTemplate")},onClickDropdownHandler:function(){}});InfinniUI.DateTimePickerView=DateTimePickerView;var SelectDate=Backbone.View.extend({className:"pl-datepicker-dropdown pl-dropdown-container",template:InfinniUI.Template["controls/dateTimePicker/template/select.date.tpl.html"],UI:{days:".days",months:".months",years:".years"},events:{"click .backdrop":"onClickBackdropHandler","click .datepicker-clear":"onClickClearValueHandler","click .today-date":"onClickTodayHandler"},render:function(){var e=this.template();this.$el.html(e),this.bindUIElements(),this.renderComponents()},renderComponents:function(){var e=this.model,t=InfinniUI.DateUtils.createDate(e.get("value")),n=InfinniUI.DateUtils.createDate(e.get("today")),i=e.get("timeZone"),o=moment(t);t=o.isValid()?o.toDate():null,t=InfinniUI.DateUtils.changeTimezoneOffset(t,i);var r={value:t,today:n||new Date,max:e.get("maxValue"),min:e.get("minValue")};r.el=this.ui.months;var a=new SelectMonths(r);r.el=this.ui.years;var l=new SelectYears(r);r.el=this.ui.days;var s=new SelectDays(r);this.months=a,this.years=l,this.days=s,this.workflow(s,a,l,t)(t)},onClickBackdropHandler:function(){this.remove()},onClickClearValueHandler:function(){this.clearValue()},clearValue:function(){this.useValue(null)},useValue:function(e){var t=this.model,n=t.get("timeZone"),i=t.get("minValue"),o=t.get("maxValue");InfinniUI.DateUtils.checkRangeDate(e,i,o)||(e=InfinniUI.DateUtils.getNearestDate(e,i,o)),this.trigger("date",InfinniUI.DateUtils.restoreTimezoneOffset(e,n)),this.remove()},workflow:function(e,t,n){function i(i){e.setDate(i),n.hide(),t.hide(),e.show()}function o(i){t.setDate(i),e.hide(),n.hide(),t.show()}function r(i){n.setDate(i),e.hide(),t.hide(),n.show()}return this.listenTo(e,"date",this.useValue).listenTo(e,"year",function(e){r(e)}).listenTo(n,"year",function(e){o(e)}).listenTo(t,"year",function(e){r(e)}).listenTo(t,"month",function(e){i(e)}),i},onClickTodayHandler:function(){this.useValue(new Date)},updatePosition:function(e){var t=this.getDropdownDirection(e);this.setPositionFor(e,t)},setPositionFor:function(e,t){clearInterval(this._intervalId),this.applyStyle(e,t),this._intervalId=setInterval(this.applyStyle.bind(this,e,t),100)},remove:function(){return clearInterval(this._intervalId),Backbone.View.prototype.remove.apply(this,arguments)},getDropdownDirection:function(e){var t=$(window).height(),n=e.getBoundingClientRect(),i=this.$el.height(),o="bottom";return n.bottom+i+30>t&&n.bottom>t/2&&n.top>i&&(o="top"),o},applyStyle:function(e,t){var n=e.getBoundingClientRect(),i=this.el.getBoundingClientRect(),o={position:"absolute",left:window.pageXOffset+n.right-Math.round(i.width)
};"bottom"===t?o.top=window.pageYOffset+n.bottom:o.top=window.pageYOffset+n.top-this.$el.height(),this.$el.css(o)}});_.extend(SelectDate.prototype,bindUIElementsMixin),InfinniUI.SelectDate=SelectDate;var SelectDateTime=SelectDate.extend({className:"pl-datepicker-dropdown pl-dropdown-container",template:InfinniUI.Template["controls/dateTimePicker/template/select.dateTime.tpl.html"],UI:{days:".days",months:".months",years:".years",times:".times",hours:".hours",minutes:".minutes"},onClickToggleDateHandler:function(){this.trigger("days")},onClickToggleTimeHandler:function(){this.trigger("time")},renderComponents:function(){var e=this.model,t=InfinniUI.DateUtils.createDate(e.get("value")),n=InfinniUI.DateUtils.createDate(e.get("today")),i=e.get("timeZone"),o=moment(t);t=o.isValid()?o.toDate():null,t=InfinniUI.DateUtils.changeTimezoneOffset(t,i);var r={value:t,today:n||new Date,max:e.get("maxValue"),min:e.get("minValue")};r.el=this.ui.months;var a=new SelectMonths(r);r.el=this.ui.years;var l=new SelectYears(r);r.el=this.ui.days;var s=new SelectDays(r);r.el=this.ui.times;var u=new SelectTimes(r);r.el=this.ui.hours;var c=new SelectHours(r);r.el=this.ui.minutes;var d=new SelectMinutes(r);this.workflow(s,a,l,u,c,d)(t)},useTime:function(e){var t=this.model,n=t.get("timeZone"),i=t.get("minValue"),o=t.get("maxValue");return InfinniUI.DateUtils.checkRangeDate(e,i,o)||(e=InfinniUI.DateUtils.getNearestDate(e,i,o)),this.trigger("date",InfinniUI.DateUtils.restoreTimezoneOffset(e,n)),e},workflow:function(e,t,n,i,o,r){function a(e){f.forEach(function(t){t!==e&&t.hide()}),e.show()}function l(t){e.setDate(t),a(e)}function s(e){t.setDate(e),a(t)}function u(e){n.setDate(e),a(n)}function c(e){o.setDate(e),a(o)}function d(e){r.setDate(e),a(r)}function p(e){i.setDate(e),a(i)}var h=this.useTime.bind(this),f=Array.prototype.slice.call(arguments);return this.listenTo(e,"date",this.useValue).listenTo(e,"year",function(e){u(e)}).listenTo(e,"time",function(e){p(e)}).listenTo(n,"year",function(e){s(e)}).listenTo(t,"year",function(e){u(e)}).listenTo(t,"month",function(e){l(e)}),this.listenTo(i,"hour",function(e){c(e)}).listenTo(i,"minute",function(e){d(e)}).listenTo(i,"day",function(e){l(e)}).listenTo(i,"date",function(e){h(e)}).listenTo(o,"hour",function(e){var t=h(e);p(t)}).listenTo(r,"minute",function(e){var t=h(e);p(t)}),this.on("days",function(e){l(e)}).on("time",function(e){p(e)}),l}});InfinniUI.SelectDateTime=SelectDateTime;var SelectTime=SelectDate.extend({className:"pl-timepicker-dropdown pl-dropdown-container",template:InfinniUI.Template["controls/dateTimePicker/template/select.time.tpl.html"],UI:{times:".times",hours:".hours",minutes:".minutes",seconds:".seconds"},renderComponents:function(){var e=this.model,t=InfinniUI.DateUtils.createDate(e.get("value")),n=InfinniUI.DateUtils.createDate(e.get("today")),i=e.get("timeZone"),o=moment(t);t=o.isValid()?o.toDate():null,t=InfinniUI.DateUtils.changeTimezoneOffset(t,i);var r={value:t,today:n,max:e.get("maxValue"),min:e.get("minValue")};r.el=this.ui.times;var a=new SelectTimes(r);r.el=this.ui.hours;var l=new SelectHours(r);r.el=this.ui.minutes;var s=new SelectMinutes(r);r.el=this.ui.seconds;var u=new SelectSeconds(r);this.workflow(a,l,s,u)(t)},useTime:function(e){var t=this.model,n=t.get("timeZone"),i=t.get("minValue"),o=t.get("maxValue");return InfinniUI.DateUtils.checkRangeDate(e,i,o)||(e=InfinniUI.DateUtils.getNearestDate(e,i,o)),this.trigger("date",InfinniUI.DateUtils.restoreTimezoneOffset(e,n)),e},workflow:function(e,t,n,i){function o(e){c.forEach(function(t){t!==e&&t.hide()}),e.show()}function r(e){t.setDate(e),o(t)}function a(e){n.setDate(e),o(n)}function l(e){i.setDate(e),o(i)}function s(t){e.setDate(t),o(e)}var u=this.useTime.bind(this),c=Array.prototype.slice.call(arguments);return this.listenTo(e,"hour",function(e){r(e)}).listenTo(e,"minute",function(e){a(e)}).listenTo(e,"second",function(e){l(e)}).listenTo(e,"date",function(e){u(e)}).listenTo(t,"hour",function(e){var t=u(e);s(t)}).listenTo(n,"minute",function(e){var t=u(e);s(t)}).listenTo(i,"second",function(e){var t=u(e);s(t)}),s}});InfinniUI.SelectTime=SelectTime,_.inherit(DatePickerControl,DateTimePickerControl),_.extend(DatePickerControl.prototype,{createControlModel:function(){return new DatePickerModel},createControlView:function(e){return new DatePickerView({model:e})}}),InfinniUI.DatePickerControl=DatePickerControl;var DatePickerModel=DateTimePickerModel.extend({initialize:function(){DateTimePickerModel.prototype.initialize.apply(this,arguments)}});InfinniUI.DatePickerModel=DatePickerModel;var DatePickerView=DateTimePickerView.extend({editMaskStrategies:{DateTimeEditMask:"timestamp"},initialize:function(){DateTimePickerView.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.DatePickerView=DatePickerView,console.assert(dateTimePickerModeDate,"dateTimePickerModeDate is undefined");var dateTimePickerModeDatePicker=_.extend({},dateTimePickerModeDate,{convertValue:function(e){var t=null;return e&&e.constructor===Date&&(t=InfinniUI.DateUtils.dateToTimestamp(e)),t}});dateTimePickerStrategy.DatePicker=dateTimePickerModeDatePicker,InfinniUI.dateTimePickerModeDatePicker=dateTimePickerModeDatePicker,console.assert(dateTimePickerModeTime,"dateTimePickerModeTime is undefined");var dateTimePickerModeTimePicker=_.extend({},dateTimePickerModeTime,{convertValue:function(e){var t=null;return e&&e.constructor===Date&&(t=InfinniUI.DateUtils.dateToTimestampTime(e)),t}});dateTimePickerStrategy.TimePicker=dateTimePickerModeTimePicker,InfinniUI.dateTimePickerModeTimePicker=dateTimePickerModeTimePicker,_.inherit(TimePickerControl,DateTimePickerControl),_.extend(TimePickerControl.prototype,{createControlModel:function(){return new TimePickerModel},createControlView:function(e){return new TimePickerView({model:e})}}),InfinniUI.TimePickerControl=TimePickerControl;var TimePickerModel=DateTimePickerModel.extend({initialize:function(){DateTimePickerModel.prototype.initialize.apply(this,arguments);var e=new Date;e.setFullYear(1970,0,1),this.set("today",e)}});InfinniUI.TimePickerModel=TimePickerModel;var TimePickerView=DateTimePickerView.extend({className:"pl-datepicker pl-timepicker form-group",editMaskStrategies:{DateTimeEditMask:"timestamp"},initialize:function(){DateTimePickerView.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.TimePickerView=TimePickerView;var CommonButtonView=ControlView.extend({className:"pl-button",template:InfinniUI.Template["controls/button/commonView/template/button.tpl.html"],UI:{button:"button"},events:{"click button":"onClickHandler"},initialize:function(){ControlView.prototype.initialize.apply(this,arguments),this.initHighlightMixin()},updateProperties:function(){ControlView.prototype.updateProperties.call(this),this.updateContent(),this.updateType()},updateType:function(){var e=this.model.get("type");this.getButtonElement().attr("type",e)},updateContent:function(){var e,t=this.model.get("contentTemplate"),n=this.model.get("content"),i={content:n},o=this.getButtonElement();t?(e=t(null,i),o.html(e.render())):"undefined"!=typeof n&&null!==n&&o.html(n)},updateText:function(){var e=this.model.get("text"),t=this.getButtonElement();t&&t.html(e)},updateFocusable:function(){var e=this.model.get("focusable");e?this.getButtonElement().removeAttr("tabindex"):this.getButtonElement().attr("tabindex",-1)},updateEnabled:function(){ControlView.prototype.updateEnabled.call(this);var e=this.model.get("enabled");this.getButtonElement().prop("disabled",!e)},updateBackground:function(){var e=this.model.get("background");this.currentBackground&&this.getButtonElement().removeClass(this.valueToBackgroundClassName(this.currentBackground)),e&&this.getButtonElement().addClass(this.valueToBackgroundClassName(e)),this.currentBackground=e},render:function(){return this.prerenderingActions(),this.renderTemplate(this.template),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},getButtonElement:function(){return this.ui.button},setFocus:function(){this.getButtonElement().focus()}});_.extend(CommonButtonView.prototype,highlightMixin.controlView),InfinniUI.ObjectUtils.setPropertyValueDirect(InfinniUI,"viewModes.Button.common",CommonButtonView);var LinkButtonView=CommonButtonView.extend({tagName:"a",className:"pl-button",attributes:{href:"javascript:;"},events:{click:"onClickHandler"},template:function(){return""},UI:{},getButtonElement:function(){return this.$el}});InfinniUI.ObjectUtils.setPropertyValueDirect(InfinniUI,"viewModes.Button.link",LinkButtonView),_.inherit(ButtonControl,Control),_.extend(ButtonControl.prototype,highlightMixin.control,{createControlModel:function(){return new ButtonModel},createControlView:function(e,t){(!t||!t in InfinniUI.viewModes.Button)&&(t="common");var n=InfinniUI.viewModes.Button[t];return new n({model:e})},setType:function(e){this.controlModel.set("type",e)},getType:function(){return this.controlModel.get("type")}},buttonControlMixin),InfinniUI.ButtonControl=ButtonControl;var ButtonModel=ControlModel.extend({defaults:_.defaults({content:null,contentTemplate:null,horizontalAlignment:"Left",type:"button"},ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments)}});InfinniUI.ButtonModel=ButtonModel;var MenuItemButtonView=LinkButtonView.extend({updateHorizontalAlignment:function(){var e,t=this.model.get("horizontalAlignment"),n=this;domHelper.whenReady(function(){return e=n.$el.parent().parent(),e.length>0},function(){"Right"==t?e.addClass("pull-right"):e.removeClass("pull-right")})}});InfinniUI.ObjectUtils.setPropertyValueDirect(InfinniUI,"viewModes.Button.menuItem",MenuItemButtonView),_.inherit(ButtonEditControl,TextBoxControl),_.extend(ButtonEditControl.prototype,{createControlModel:function(){return new ButtonEditModel},createControlView:function(e){return new ButtonEditView({model:e})},onButtonClick:function(e){this.controlView.on("buttonClick",e)}}),InfinniUI.ButtonEditControl=ButtonEditControl;var ButtonEditModel=TextBoxModel.extend({defaults:_.defaults({showClear:!0,readOnly:!0},TextBoxModel.prototype.defaults),initialize:function(){TextBoxModel.prototype.initialize.apply(this,arguments)},clearValue:function(){var e=this.get("enabled");e&&this.set("value",null)}});InfinniUI.ButtonEditModel=ButtonEditModel;var ButtonEditView=TextBoxView.extend({template:{oneline:InfinniUI.Template["controls/buttonEdit/template/textBoxInput.tpl.html"],multiline:InfinniUI.Template["controls/buttonEdit/template/textBoxArea.tpl.html"]},className:"pl-button-edit form-group",UI:_.extend({},TextBoxView.prototype.UI,{iconAction:".pl-button-edit-button__icon_action",buttonClear:".pl-button-edit-button_clear",buttons:".pl-button-edit-button"}),events:_.extend({},TextBoxView.prototype.events,{"click .pl-button-edit-button_action":"onClickButtonHandler","click .pl-button-edit-button_clear":"onClickClearHandler"}),initHandlersForProperties:function(){TextBoxView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:icon",this.updateIcon),this.listenTo(this.model,"change:showClear",this.updateShowClear),this.listenTo(this.model,"change:readOnly",this.updateReadOnly)},updateProperties:function(){TextBoxView.prototype.updateProperties.call(this),this.updateIcon(),this.updateShowClear(),this.updateReadOnly()},updateIcon:function(){var e=this.model.get("icon");this.switchClass("fa",e,this.ui.iconAction)},updateShowClear:function(){var e=this.model.get("showClear"),t=this.model.get("value");this.ui.buttonClear.toggleClass("hidden",!e||_.isEmpty(t))},updateReadOnly:function(){var e=this.model.get("readOnly");this.ui.control.prop("readonly",e)},updateEnabled:function(){var e=this.model.get("enabled");TextBoxView.prototype.updateEnabled.call(this),this.ui.buttons.toggleClass("pl-button-edit-button_disabled",!e)},updateValue:function(){TextBoxView.prototype.updateValue.call(this),this.updateShowClear()},onClickButtonHandler:function(e){var t=this.model.get("enabled");t&&this.trigger("buttonClick",e)},onClickClearHandler:function(){this.model.clearValue()}});InfinniUI.ButtonEditView=ButtonEditView;var ComboBoxDropdownView=Backbone.View.extend({className:"pl-dropdown-container",events:{"click .backdrop":"onClickBackdropHandler","keyup .pl-combobox-filter-text":"onKeyUpHandler","keydown .pl-combobox-filter-text":"onFilterKeyDownHandler"},UI:{items:".pl-combobox-items",filter:".pl-combobox-filter",text:".pl-combobox-filter-text",noItems:".pl-combobox-items-empty"},initialize:function(){var e=this.model.get("groupValueSelector"),t=null!==e&&"undefined"!=typeof e;t?this.strategy=new ComboBoxGroupViewStrategy(this):this.strategy=new ComboBoxPlainViewStrategy(this),this.listenTo(this.model,"change:noItemsMessage",this.updateNoItemsMessage),this.listenTo(this.model,"change:dropdown",this.onChangeDropdownHandler),this.listenTo(this.model,"change:autocompleteValue",this.onChangeSearchHandler),this.listenTo(this.model,"change:autocomplete",this.updateAutocomplete),this.listenTo(this.model,"change:selectedItem",this.onChangeSelectedItem),this.listenTo(this.strategy,"click",this.onClickItemHandler),this.listenTo(this.strategy,"mouseenter",this.onMouseEnterItemHandler),this.model.onValueChanged(this.onChangeValueHandler.bind(this));var n=this.model.get("items"),i=this;n.onChange(function(){i.renderItems()})},updateProperties:function(){this.updateAutocomplete(),this.updateNoItemsMessage()},updateNoItemsMessage:function(){var e=this.model,t=e.get("noItemsMessage")||localized.strings.ComboBox.noItemsMessage;this.ui.noItems.html(t)},render:function(){var e=this.strategy.getTemplate();return this.$el.html(e({multiSelect:this.model.get("multiSelect")})),this.bindUIElements(),this.updateProperties(),this.renderItems(),this.$el},renderItems:function(){this.$el.hide(),this.$items=this.strategy.renderItems();var e=this.model.get("items"),t=this.model.get("isInitialized"),n=t&&e&&0==e.length;this.ui.noItems.toggleClass("hidden",!n),this.markSelectedItems(),this.markCheckedItems(),this.trigger("itemsRendered2"),this.$el.show()},setItemsContent:function(e){var t=this.ui.items;t.empty(),t.append(e)},close:function(){this.model.set("dropdown",!1)},setSearchFocus:function(){this.ui.text.focus()},onClickBackdropHandler:function(){this.close()},onChangeValueHandler:function(){this.markCheckedItems()},markSelectedItems:function(){var e=this.model;if(Array.isArray(this.$items)){var t=this.$items,n=e.getSelectedItem();t.forEach(function(e){var t=n===e.data("pl-data-item");e.toggleClass("pl-combobox-selected",t)}),this.ensureVisibleSelectedItem()}},ensureVisibleSelectedItem:function(){function e(e,t){var n,i=e.scrollTop(),o=t.position().top,r=t.outerHeight(),a=e.innerHeight();o+r>a?n=i+o+r-a:o<0&&(n=i+o),"undefined"!=typeof n&&e.scrollTop(n)}if(Array.isArray(this.$items)){var t=this.ui.items,n=this.$items,i=this.model.getSelectedItem();n.some(function(n){var o=i===n.data("pl-data-item");return o&&e(t,n),o})}},markCheckedItems:function(){var e=this.model,t=e.getValue();if(Array.isArray(this.$items)){var n=this.$items,i=!!e.get("multiSelect"),o=[];o=i&&Array.isArray(t)?t.map(function(t){return e.itemByValue(t)}):[e.itemByValue(t)],n.forEach(function(e){var t=o.indexOf(e.data("pl-data-item"))!==-1;e.toggleClass("pl-combobox-checked",t)})}},onChangeDropdownHandler:function(e,t){t||this.remove()},updateAutocomplete:function(){var e=this.model.get("autocomplete");this.ui.filter.toggleClass("hidden",!e)},onMouseEnterItemHandler:function(e){this.model.setSelectedItem(e)},onClickItemHandler:function(e){var t=!this.model.isDisabledItem(e);t&&(this.model.toggleItem(e),this.close())},onKeyUpHandler:function(){var e=this.ui.text.val();this.trigger("search",e)},onKeyDownHandler:function(e){this.model;e.preventDefault(),this.onFilterKeyDownHandler(e)},onFilterKeyDownHandler:function(e){var t=this.model;switch(e.which){case 36:t.selectFirstItem();break;case 35:t.selectLastItem();break;case 38:t.selectPrevItem();break;case 40:t.selectNextItem();break;case 13:this.onClickItemHandler(t.getSelectedItem());break;case 9:this.close();break;case 27:this.close(),e.stopPropagation()}},onChangeSearchHandler:function(e,t){var n=this.ui.noItems.find(".search-message");n.length&&n.text(t),this.model.set("isInitialized",!1),this.renderItems()},onChangeSelectedItem:function(){this.markSelectedItems()},updatePosition:function(e,t){var n=this.getDropdownDirection(e);this.setPositionFor(e,t,n)},setPositionFor:function(e,t,n){clearInterval(this._intervalId),this.applyStyle(e,t,n),this._intervalId=setInterval(this.applyStyle.bind(this,e,t,n),100)},remove:function(){return clearInterval(this._intervalId),Backbone.View.prototype.remove.apply(this,arguments)},getDropdownDirection:function(e){var t=$(window).height(),n=e.getBoundingClientRect(),i=this.$el.height(),o="bottom";return n.bottom+i+30>t&&n.bottom>t/2&&(o="top"),o},applyStyle:function(e,t,n){var i=e.getBoundingClientRect(),o=t.getBoundingClientRect(),r={left:window.pageXOffset+o.left,width:Math.round(i.width)};"bottom"===n?r.top=window.pageYOffset+o.bottom:r.top=window.pageYOffset+o.top-this.$el.height(),this.$el.css(r)}});_.extend(ComboBoxDropdownView.prototype,bindUIElementsMixin),InfinniUI.ComboBoxDropdownView=ComboBoxDropdownView,ComboBoxBaseViewStrategy.prototype.getModelAttribute=function(e){var t=this.dropdownView.model;return t.get(e)},ComboBoxBaseViewStrategy.prototype.isEnabledItem=function(e){return!this.dropdownView.model.isDisabledItem(e)},ComboBoxBaseViewStrategy.prototype.renderItems=function(){throw new Error("Method renderItems not implemented")},ComboBoxBaseViewStrategy.prototype.getTemplate=function(){},ComboBoxBaseViewStrategy.prototype._renderItems=function(e){var t,n=this.getModelAttribute("items"),i=this.getModelAttribute("itemTemplate");return t=e.map(function(e){var t=i(void 0,{value:e,index:n.indexOf(e)}),o=t.render();return"undefined"!=typeof e&&o.data("pl-data-item",e),this.addOnClickEventListener(o,e),this.addOnHoverEventListener(o,e),t.setEnabled(this.isEnabledItem(e)),o},this)},ComboBoxBaseViewStrategy.prototype.addOnClickEventListener=function(e){var t=e[0],n=Array.prototype.slice.call(arguments,1),i=this.trigger.bind(this,"click");t.addEventListener("click",function(){i.apply(this,n)})},ComboBoxBaseViewStrategy.prototype.addOnHoverEventListener=function(e){var t=Array.prototype.slice.call(arguments,1),n=this.trigger.bind(this,"mouseenter");e.on("mouseenter",function(){n.apply(this,t)})},_.extend(ComboBoxBaseViewStrategy.prototype,Backbone.Events),InfinniUI.ComboBoxBaseViewStrategy=ComboBoxBaseViewStrategy,ComboBoxGroupViewStrategy.prototype=Object.create(ComboBoxBaseViewStrategy.prototype),ComboBoxGroupViewStrategy.prototype.constructor=ComboBoxGroupViewStrategy,ComboBoxGroupViewStrategy.prototype.template=InfinniUI.Template["controls/comboBox/dropdown/template/group/template.tpl.html"],ComboBoxGroupViewStrategy.prototype.renderItems=function(){var e,t=this.getModelAttribute("items"),n=this.getModelAttribute("groupValueSelector"),i={};return t.forEach(function(e,t){var o=n(void 0,{value:e,index:t});o in i||(i[o]=[]),i[o].push(e)}),e=this.renderGroups(i)},ComboBoxGroupViewStrategy.prototype.renderGroups=function(e){var t,n=this.getModelAttribute("groupItemTemplate"),i=this.getModelAttribute("items"),o=[],r=[];for(var a in e){var l=e[a],s=n(void 0,{index:i.indexOf(l[0]),item:l[0]});t=this._renderItems(l);var u=new ComboBoxGroupView({header:s.render(),items:t});Array.prototype.push.apply(o,t),r.push(u.render())}return this.dropdownView.setItemsContent(r),o},ComboBoxGroupViewStrategy.prototype.getTemplate=function(){return this.template},InfinniUI.ComboBoxGroupViewStrategy=ComboBoxGroupViewStrategy,ComboBoxPlainViewStrategy.prototype=Object.create(ComboBoxBaseViewStrategy.prototype),ComboBoxPlainViewStrategy.prototype.constructor=ComboBoxPlainViewStrategy,ComboBoxPlainViewStrategy.prototype.renderItems=function(){var e=[],t=this.getModelAttribute("items");return t&&(e=this._renderItems(t.toArray())),this.dropdownView.setItemsContent(e),e},ComboBoxPlainViewStrategy.prototype.template=InfinniUI.Template["controls/comboBox/dropdown/template/plain/template.tpl.html"],ComboBoxPlainViewStrategy.prototype.getTemplate=function(){return this.template},InfinniUI.ComboBoxPlainViewStrategy=ComboBoxPlainViewStrategy;var ComboBoxGroupView=Backbone.View.extend({template:InfinniUI.Template["controls/comboBox/dropdown/group/template/template.tpl.html"],UI:{header:".pl-combobox-group__header",items:".pl-combobox-group__items"},initialize:function(e){this.options={header:e.header,items:e.items}},render:function(){var e=this.options;return this.$el.html(this.template()),this.bindUIElements(),this.ui.header.append(e.header),this.ui.items.append(e.items),this.$el}});_.extend(ComboBoxGroupView.prototype,bindUIElementsMixin),InfinniUI.ComboBoxGroupView=ComboBoxGroupView;var ComboBoxValueModel=Backbone.Model.extend({});InfinniUI.ComboBoxValueModel=ComboBoxValueModel;var ComboBoxValue=Backbone.View.extend({template:InfinniUI.Template["controls/comboBox/values/template/value.tpl.html"],tagName:"li",className:"pl-combobox-value",events:{"click .pl-combobox-value-remove":"onClickRemoveHandler"},UI:{item:".pl-combobox-value-item"},initialize:function(e){this.model=new ComboBoxValueModel(e)},render:function(){this.$el.html(this.template()),this.bindUIElements();var e=this.model.get("$value");return this.ui.item.append(e),this.$el},onClickRemoveHandler:function(){var e=this.model.get("value");this.trigger("remove",e)}});_.extend(ComboBoxValue.prototype,bindUIElementsMixin),InfinniUI.ComboBoxValue=ComboBoxValue;var ComboBoxValuesModel=Backbone.Model.extend({defaults:{enabled:!0},initialize:function(){this.items=[]}});InfinniUI.ComboBoxValuesModel=ComboBoxValuesModel;var ComboBoxValues=Backbone.View.extend({tagName:"ul",className:"pl-combobox-values",template:InfinniUI.Template["controls/comboBox/values/template/values.tpl.html"],events:{"keypress .pl-combobox-search-text":"onKeyPressHandler","keydown .pl-combobox-search-text":"onKeyDownHandler","keyup .pl-combobox-search-text":"onKeyUpHandler",click:"onClickHandler"},UI:{search:".pl-combobox-search",text:".pl-combobox-search-text"},initialize:function(e){this.model=new ComboBoxValuesModel(e)},render:function(){this.$el.empty(),this.$el.html(this.template()),this.bindUIElements();var e=this.model,t=e.get("items").map(function(e){var t=new ComboBoxValue({$value:e.$value,value:e.value});return this.listenTo(t,"remove",this.onRemoveValueHandler),t.render()},this);return this.ui.search.before(t),this.$el},KeyCode:{enter:13,backspace:8,left:37,right:39,home:36,end:35,tab:9},setFocus:function(){this.ui.text.focus()},onKeyPressHandler:function(e){var t=e.which;t===this.KeyCode.enter,console.log("onKeyPressHandler",e.which,this.ui.text.val())},onKeyDownHandler:function(e){var t=e.which;t===this.KeyCode.left,console.log("onKeyDownHandler",e.which,this.ui.text.val())},onKeyUpHandler:function(){var e=this.ui.text.val();this.trigger("search",e)},onRemoveValueHandler:function(e){this.trigger("remove",e)},onClickHandler:function(){this.setFocus()}});_.extend(ComboBoxValues.prototype,bindUIElementsMixin),InfinniUI.ComboBoxValues=ComboBoxValues,_.inherit(DataGridControl,ListEditorBaseControl),_.extend(DataGridControl.prototype,{createControlModel:function(){return new DataGridModel},createControlView:function(e){return new DataGridView({model:e})},onCheckAllChanged:function(e){this.controlModel.onCheckAllChanged(e)},setEnabled:function(e){this.controlModel.set("enabled",e)},onRowClick:function(e){this.controlView.$el.on("click","tbody .pl-datagrid-row",e)},onRowDoubleClick:function(e){this.controlView.$el.on("dblclick","tbody .pl-datagrid-row",e)}}),InfinniUI.DataGridControl=DataGridControl;var DataGridModel=ListEditorBaseModel.extend({defaults:_.defaults({showSelectors:!0,checkAllVisible:!1,checkAll:!1,focusable:!1,verticalAlignment:"Top",sortedColumn:null,scroll:!0},ListEditorBaseModel.prototype.defaults),initialize:function(){ListEditorBaseModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments)),this.initColumns()},toggleCheckAll:function(){this.set("checkAll",!this.get("checkAll"))},onCheckAllChanged:function(e){this.on("change:checkAll",function(t,n){e.call(null,{value:n})})},initColumns:function(){this.set("columns",new Collection)}});InfinniUI.DataGridModel=DataGridModel;var DataGridView=ListEditorBaseView.extend({template:{grid:InfinniUI.Template["controls/dataGrid/template/dataGrid.tpl.html"],gridWithoutScroll:InfinniUI.Template["controls/dataGrid/template/dataGridWithoutScroll.tpl.html"],headerCell:InfinniUI.Template["controls/dataGrid/template/headerCell.tpl.html"],sizeCell:InfinniUI.Template["controls/dataGrid/template/sizeCell.tpl.html"]},className:"pl-datagrid",events:_.extend({},ListEditorBaseView.prototype.events,{"click .pl-datagrid-toggle_all":"onClickCheckAllHandler","click thead .pl-datagrid-row__cell":"onClickToHeaderCellHandler"}),UI:_.defaults({body:".pl-datagrid__body",head:".pl-datagrid__head",headContainer:".pl-datagrid-container_head",header:".pl-datagrid-row_header",firstRows:".pl-datagrid-row_first",toggleCell:".pl-toggle-cell",checkAll:".pl-datagrid-toggle__button",items:"tbody"},ListEditorBaseView.prototype.UI),initialize:function(e){ListEditorBaseView.prototype.initialize.call(this,e),this.rowElements=new HashMap},initHandlersForProperties:function(){ListEditorBaseView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:showSelectors",this.updateShowSelectors),this.listenTo(this.model,"change:checkAllVisible",this.updateCheckAllVisible),this.listenTo(this.model,"change:checkAll",this.updateCheckAll),this.listenTo(this.model,"change:verticalAlignment",this.updateVerticalAlignment),this.listenTo(this.model,"change:scroll",this.updateScroll);var e=this.rowElements;this.model.get("items").onChange(function(t){"replace"===t.action&&t.oldItems.forEach(function(n,i){e.add(t.newItems[i],e.get(n)),e.remove(n)})})},updateScroll:function(){var e=this.model,t=e.get("scroll"),n="pl-datagrid-scrollable",i="pl-adaptable-by-height",o=this.ui.head;t?(this.$el.addClass(n),this.ui.body.addClass(i),o.css("padding-right",this.getHorizontalScrollBarWidth()+"px")):(this.$el.removeClass(n),this.ui.body.removeClass(i),o.css("padding-right",""))},updateProperties:function(){ListEditorBaseView.prototype.updateProperties.call(this),this.updateShowSelectors(),this.updateCheckAllVisible(),this.updateCheckAll(),this.updateDisabledItem(),this.updateVerticalAlignment(),this.updateScroll()},updateShowSelectors:function(){var e=this.model.get("showSelectors");this.$el.toggleClass("pl-datagrid_selectors_show",e),this.$el.toggleClass("pl-datagrid_selectors_hide",!e)},updateGrouping:function(){},updateVerticalAlignment:function(){this.switchClass("verticalAlignment",this.model.get("verticalAlignment"),this.$el,!1),this.switchClass("verticalAlignment",this.model.get("verticalAlignment"),this.ui.body,!1)},updateCheckAll:function(){var e=this.model.get("checkAll");this.ui.checkAll.prop("checked",e)},getHorizontalScrollBarWidth:function(){if("undefined"==typeof DataGridView.scrollbarWidth){var e=document.createElement("div"),t=document.body;e.className="modal-scrollbar-measure";var n={position:"absolute",top:"-9999px",width:"50px",height:"50px",overflow:"scroll"};for(var i in n)e.style[i]=n[i];t.appendChild(e),DataGridView.scrollbarWidth=e.offsetWidth-e.clientWidth,t.removeChild(e)}return DataGridView.scrollbarWidth},updateCheckAllVisible:function(){var e=this.model.get("checkAllVisible");this.ui.checkAll.toggleClass("hidden",!e)},updateMultiSelect:function(){ListEditorBaseView.prototype.updateMultiSelect.call(this);var e=this.model.get("multiSelect");this.$el.toggleClass("pl-datagrid_select_multi",e===!0),this.$el.toggleClass("pl-datagrid_select_single",e!==!0)},updateValue:function(){var e=this.model,t=e.get("value"),n=[],i=e.get("items");e.get("multiSelect")||"undefined"==typeof t||null===t||(t=[t]),Array.isArray(t)&&(n=t.map(function(t){return e.itemIndexByValue(t)}).filter(function(e){return e!==-1})),this.rowElements.forEach(function(e,t){var o=i.indexOf(t),r=n.indexOf(o)!==-1;e.toggle(r)})},updateSelectedItem:function(){var e=this.model,t=e.get("selectedItem");this.rowElements.forEach(function(e,n){e.setSelected(n===t)})},updateDisabledItem:function(){var e,t=this.model,n=t.get("disabledItemCondition");null!==n&&"undefined"!=typeof n?this.rowElements.forEach(function(i,o){e=!n(void 0,{value:o}),i.getSelected()===o&&e===!1&&t.set("selectedItem",null),i.setEnabled(e)}):this.rowElements.forEach(function(e,t){e.setEnabled(!0)})},updateEnabled:function(){var e=this.model.get("enabled");e?this.updateDisabledItem():this.disableDataGridItems()},disableDataGridItems:function(){this.model.set("selectedItem",null),this.rowElements.forEach(function(e,t){e.setEnabled(!1)})},render:function(){var e=this;this.prerenderingActions();var t=(this.model.get("verticalAlignment"),this.model.get("scroll")),n=this.template.grid;return t||(n=this.template.gridWithoutScroll),this.$el.html(n()),this.bindUIElements(),this.renderHeaders(),this.renderItems(),this.trigger("render"),this.applyColumnWidth(),this.syncBodyAndHead(),this.postrenderingActions(),setTimeout(function(){e.updateProperties()},0),this},applyColumnWidth:function(){var e=this.model.get("columns"),t=!1;this.ui.firstRows.children().each(function(n,i){var o=n%(e.length+1);if(0!==o){var r=e.getByIndex(o-1),a=r&&r.getWidth();a&&($(i).css("width",a),t=!0)}}),this.$el.toggleClass("pl-datagrid_layout_fixed",t)},syncBodyAndHead:function(){var e=this.ui.head;e.css("padding-right",this.getHorizontalScrollBarWidth()+"px"),this.ui.body.off("scroll").on("scroll",this.onScrollBodyHandler.bind(this))},onScrollBodyHandler:function(){this.ui.headContainer.scrollLeft(this.ui.body.scrollLeft())},renderHeaders:function(){var e=this,t=this.model.get("columns"),n=[],i=this.template.sizeCell(),o=t.toArray().map(function(t){n.push(i);var o=$('<th class="pl-datagrid-row__cell"></th>'),r=t.getHeaderTemplate(),a=t.getHeader();o.data("pl-column",t),t.getSortable()&&(o.addClass("sortable"),t.getSortDirection()&&setTimeout(function(){e.setUpColumnSort(t,o,t.getSortDirection(),!1)},0));var l;return r?(l=r(null,{value:a}),o.append(l.render())):o.append(a),o});this.ui.header.append(o),this.ui.firstRows.append(n)},renderItems:function(){var e=this.model,t=e.get("valueSelector"),n=e.get("itemTemplate"),i=e.get("items"),o=this.ui.items,r=this;this.removeRowElements(),i.forEach(function(i,a){setTimeout(function(){var l=n(void 0,{index:a,item:i});l.onBeforeClick(function(){var t=e.get("items"),n=t.getByIndex(a),i=r.rowElements.get(n);i.getEnabled()!==!1&&e.set("selectedItem",n)}),l.onToggle(function(){var n=e.get("enabled"),i=e.get("items");n&&e.toggleValue(t(void 0,{value:i.getByIndex(a)}))}),r.addRowElement(i,l);var s=l.render();o.append(s)},0)},this)},updateFocusable:function(){var e=this.model.get("focusable");this.rowElements.values.forEach(function(t){e?t.control.controlView.$el.attr("tabindex",0):t.control.controlView.$el.removeAttr("tabindex")})},addRowElement:function(e,t){this.addChildElement(t),this.rowElements.add(e,t)},removeRowElements:function(){this.removeChildElements(),this.rowElements.clear()},onClickCheckAllHandler:function(){this.model.toggleCheckAll()},onClickToHeaderCellHandler:function(e){var t=$(e.currentTarget),n=t.data("pl-column");n&&n.isSortable()&&(null===n.getSortDirection()?(this.resetSort(),this.setUpColumnSort(n,t,"asc")):"asc"===n.getSortDirection()?(this.resetSort("asc"),this.setUpColumnSort(n,t,"desc")):"desc"===n.getSortDirection()&&(this.resetSort("desc"),this.setUpColumnSort(n,t,"asc")))},setUpColumnSort:function(e,t,n,i){e.setSortDirection(n),this.model.set("sortedColumn",e),e.getIsHeaderTemplateEmpty()?t.addClass("sorted sorted-"+n):t.addClass("sorted headerTemplate-sorted-"+n),i!==!1&&e.trigger("onSort",{sortDirection:n})},resetSort:function(e){var t;
if(e)t=this.$el.find(".sorted"),t.removeClass("headerTemplate-sorted-"+e+" sorted-"+e);else{t=this.$el.find(".sorted"),t.removeClass("sorted headerTemplate-sorted-asc headerTemplate-sorted-desc sorted-asc sorted-desc");var n=this.model.get("sortedColumn");n&&n.setSortDirection(null)}}});InfinniUI.DataGridView=DataGridView,_.inherit(DataGridRowControl,Control),_.extend(DataGridRowControl.prototype,{onToggle:function(e){this.controlView.on("toggle",e)},createControlModel:function(){return new DataGridRowModel},createControlView:function(e){return new DataGridRowView({model:e})}}),InfinniUI.DataGridRowControl=DataGridRowControl;var DataGridRowModel=ControlModel.extend({});InfinniUI.DataGridRowModel=DataGridRowModel;var DataGridRowView=ControlView.extend({className:"pl-datagrid-row pl-datagrid-row_data",classNameSelected:"info",tagName:"tr",events:{},template:{singleSelect:InfinniUI.Template["controls/dataGrid/dataGridRow/template/singleSelect.tpl.html"],multiSelect:InfinniUI.Template["controls/dataGrid/dataGridRow/template/multiSelect.tpl.html"],dataCell:InfinniUI.Template["controls/dataGrid/dataGridRow/template/dataCell.tpl.html"]},UI:{toggleCell:".pl-datagrid-row__cell_toggle",toggle:".pl-datagrid-toggle",toggleControl:".pl-datagrid-toggle input"},initialize:function(){ControlView.prototype.initialize.call(this),this.on("render",function(){this.ui.toggleCell.on("click",this.onToggleHandler.bind(this))},this)},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:toggle",this.updateToggle),this.listenTo(this.model,"change:selected",this.updateSelected)},updateProperties:function(){ControlView.prototype.updateProperties.call(this),this.updateToggle(),this.updateSelected(),this.updateShowSelectors()},updateVerticalAlignment:function(){},render:function(){this.prerenderingActions();var e=this.$el,t=this.model.get("multiSelect")?"multiSelect":"singleSelect",n=this.template[t];e.html(n()),this.bindUIElements();var i=this.model.get("cellElements");return Array.isArray(i)&&i.forEach(function(t,n){var i=$('<td class="pl-datagrid-row__cell"></td>');i.append(t.render()),e.append(i)}),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},updateShowSelectors:function(){var e=this.model.get("showSelectors");this.ui.toggleCell.toggleClass("hidden",!e)},updateToggle:function(){var e=this.model.get("toggle");this.ui.toggleControl.prop("checked",!!e)},updateSelected:function(){var e=this.model.get("selected");this.$el.toggleClass(this.classNameSelected,!!e)},updateEnabled:function(){ControlView.prototype.updateEnabled.call(this);var e=this.model.get("enabled");this.ui.toggleControl.attr("disabled",e?null:"disabled")},onToggleHandler:function(){this.trigger("toggle")}});InfinniUI.DataGridRowView=DataGridRowView;var DataNavigationBaseButtonModel=Backbone.Model.extend({initialize:function(){this.on("change:parent",this.subscribeToParent,this)},subscribeToParent:function(){}});InfinniUI.DataNavigationBaseButtonModel=DataNavigationBaseButtonModel;var DataNavigationBaseButton=Backbone.View.extend({tagName:"li",initialize:function(e){Backbone.View.prototype.initialize.call(this,e),this.once("render",function(){this.initHandlersForProperties()},this)},initHandlersForProperties:function(){},updateProperties:function(){},getData:function(){return this.model.toJSON()},setParent:function(e){this.model.set("parent",e),this.subscribeForParent(e)},render:function(){var e=this.template(this.getData());return this.$el.html(e),this.trigger("render"),this.updateProperties(),this},subscribeForParent:function(){}});InfinniUI.DataNavigationBaseButton=DataNavigationBaseButton;var DataNavigationNextButton=DataNavigationBaseButton.extend({template:InfinniUI.Template["controls/dataNavigation/buttons/template/next.tpl.html"],events:{click:"onClickHandler"},initialize:function(e){this.model=new DataNavigationBaseButtonModel,DataNavigationBaseButton.prototype.initialize.call(this,e)},onClickHandler:function(){this.trigger("command","next")}});InfinniUI.DataNavigationNextButton=DataNavigationNextButton;var DataNavigationPageButton=DataNavigationBaseButton.extend({template:InfinniUI.Template["controls/dataNavigation/buttons/template/page.tpl.html"],events:{click:"onClickHandler"},initialize:function(e){this.model=new DataNavigationPageButtonModel,DataNavigationBaseButton.prototype.initialize.call(this,e),this.model.set("pageNumber",e.pageNumber)},initHandlersForProperties:function(){DataNavigationBaseButton.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:isCurrent",this.updateIsCurrent)},updateProperties:function(){DataNavigationBaseButton.prototype.updateProperties.call(this),this.updateIsCurrent()},updateIsCurrent:function(){this.$el.toggleClass("active",this.model.get("isCurrent"))},onClickHandler:function(){this.trigger("command","page",{pageNumber:this.model.get("pageNumber")})}});InfinniUI.DataNavigationPageButton=DataNavigationPageButton;var DataNavigationPageButtonModel=DataNavigationBaseButtonModel.extend({defaults:{isCurrent:!1},subscribeToParent:function(){DataNavigationBaseButtonModel.prototype.subscribeToParent.call(this);var e=this.get("parent");this.listenTo(e.model,"change:pageNumber",function(){this.updateIsCurrent()}),this.updateIsCurrent()},updateIsCurrent:function(){var e=this.get("parent"),t=e.model.get("pageNumber")===this.get("pageNumber");this.set("isCurrent",t)}});InfinniUI.DataNavigationPageButtonModel=DataNavigationPageButtonModel;var DataNavigationPrevButton=DataNavigationBaseButton.extend({template:InfinniUI.Template["controls/dataNavigation/buttons/template/prev.tpl.html"],events:{click:"onClickHandler"},initialize:function(e){this.model=new DataNavigationBaseButtonModel,DataNavigationBaseButton.prototype.initialize.call(this,e)},onClickHandler:function(){this.trigger("command","prev")}});InfinniUI.DataNavigationPrevButton=DataNavigationPrevButton,DataNavigationButtonFactory.prototype.buttons={prev:DataNavigationPrevButton,page:DataNavigationPageButton,next:DataNavigationNextButton},DataNavigationButtonFactory.prototype.createButton=function(e,t){var n=this.buttons[e];if("function"!=typeof n)return void console.error("Wrong button type: "+e);var i=new n(t);return i.setParent(this._dataNavigation),i},InfinniUI.DataNavigationButtonFactory=DataNavigationButtonFactory,_.inherit(DataNavigationControl,Control),_.extend(DataNavigationControl.prototype,{createControlModel:function(){return new DataNavigationModel},createControlView:function(e){return new DataNavigationView({model:e})},onPageNumberChanged:function(e){this.controlModel.onPageNumberChanged(e)},onPageSizeChanged:function(e){this.controlModel.onPageSizeChanged(e)}}),InfinniUI.DataNavigationControl=DataNavigationControl;var DataNavigationModel=ControlModel.extend({defaults:_.defaults({pageNumber:0,pageStart:0,_buttonsCount:5,_buttonsTemplate:["prev","page","next"],pageCount:null,isDataReady:!1},ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments),this.set("availablePageSizes",new Collection),this.on("change:pageNumber",this.updatePageStart,this),this.on("change:pageSize",this.updatePageSize,this)},updatePageStart:function(){var e=this.get("pageNumber"),t=this.get("pageStart"),n=this.get("_buttonsCount");e+1>=t+n?t+=Math.floor(n/2):e===t?t=Math.max(0,t-Math.floor(n/2)):e+1<t&&(t=Math.max(0,e-1)),this.set("pageStart",t)},updatePageSize:function(){this.set("pageNumber",0)},nextPage:function(){var e=this.get("pageNumber");this.set("pageNumber",e+1)},prevPage:function(){var e=this.get("pageNumber");e>0&&this.set("pageNumber",e-1)},onPageNumberChanged:function(e){this.on("change:pageNumber",function(t,n){e.call(null,{value:n})})},onPageSizeChanged:function(e){this.on("change:pageSize",function(t,n){e.call(null,{value:n})})}});InfinniUI.DataNavigationModel=DataNavigationModel;var DataNavigationView=ControlView.extend({template:InfinniUI.Template["controls/dataNavigation/template/dataNavigation.tpl.html"],className:"pl-data-navigation",UI:{buttons:"ul",sizes:".pl-page-size"},initialize:function(e){ControlView.prototype.initialize.call(this,e),this._childViews=[],this.buttonsFactory=new DataNavigationButtonFactory(this),this._pageSizes=new DataNavigationPageSizes,this._pageSizes.setParent(this)},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:pageStart",this.updateButtons),this.listenTo(this.model,"change:pageCount",this.updateButtons),this.listenTo(this.model,"change:isDataReady",this.updateButtons)},updateProperties:function(){ControlView.prototype.updateProperties.call(this),this.updateButtons()},render:function(){return this.prerenderingActions(),this.renderTemplate(this.template),this.updateProperties(),this.trigger("render"),this.renderPageSizes(),this.postrenderingActions(),this},renderPageSizes:function(){this.ui.sizes.append(this._pageSizes.render().$el)},renderButtons:function(){var e,t,n=this.model,i=n.get("_buttonsTemplate"),o=n.get("_buttonsCount"),r=n.get("pageCount"),a=(n.get("pageNumber"),n.get("pageStart")),l=n.get("isDataReady");if(this._removeChildViews(),l){var s=this.buttonsFactory;e=i.reduce(function(e,t){var n;if("page"===t)for(var i=0;i<o;i+=1)n=s.createButton(t,{pageNumber:a+i}),e.push(n);else n=s.createButton(t),e.push(n);return e},[]),"number"==typeof r&&a+o>=r&&(t=a+o-r+1,0==r&&(t+=1),e.splice(e.length-t,100));var u=e.map(function(e){return this.listenTo(e,"command",this.onCommandHandler),this._appendChildView(e),e.render().$el},this);this.ui.buttons.append(u)}},updateButtons:function(){this.renderButtons()},onCommandHandler:function(e,t){switch(e){case"prev":this.model.prevPage();break;case"next":this.model.nextPage();break;case"page":this.model.set("pageNumber",t.pageNumber)}},_removeChildViews:function(){this._childViews.forEach(function(e){this.stopListening(e),e.remove()},this),this._childViews.length=0},_appendChildView:function(e){this._childViews.push(e)}});InfinniUI.DataNavigationView=DataNavigationView;var DataNavigationPageSizes=Backbone.View.extend({className:"btn-group",template:InfinniUI.Template["controls/dataNavigation/pageSizes/template/pageSizes.tpl.html"],events:{"click button":"onClickButtonHandler"},setParent:function(e){this.model=e.model;var t=this.model.get("availablePageSizes");t.onChange(this.onAvailablePageSizesChanged.bind(this)),this.model.on("change:pageSize",this.renderButtons,this)},render:function(){return this.renderButtons(),this},renderButtons:function(){var e=this.model.get("availablePageSizes"),t=this.model.get("pageSize"),n=e.toArray().map(function(e){return this.template({size:e,active:t===e})},this);this.$el.html(n)},onAvailablePageSizesChanged:function(){this.renderButtons()},onClickButtonHandler:function(e){var t=$(e.target),n=parseInt(t.attr("data-size"),10);this.model.set("pageSize",n)}});InfinniUI.DataNavigationPageSizes=DataNavigationPageSizes;var CommonLabelView=ControlView.extend(_.extend({},editorBaseViewMixin,{className:"pl-label",template:InfinniUI.Template["controls/label/commonView/template/label.tpl.html"],UI:_.extend({},editorBaseViewMixin.UI,{control:".label-control"}),initialize:function(){ControlView.prototype.initialize.apply(this)},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),editorBaseViewMixin.initHandlersForProperties.call(this),this.listenTo(this.model,"change:displayFormat",this.updateDisplayFormat),this.listenTo(this.model,"change:textWrapping",this.updateTextWrapping),this.listenTo(this.model,"change:textTrimming",this.updateTextTrimming)},updateProperties:function(){ControlView.prototype.updateProperties.call(this),editorBaseViewMixin.updateProperties.call(this),this.updateDisplayFormat(),this.updateTextWrapping(),this.updateTextTrimming()},updateFocusable:function(){var e=this.model.get("focusable");e?this.ui.control.attr("tabindex",0):this.ui.control.removeAttr("tabindex")},updateValue:function(){var e=this.model.get("escapeHtml"),t=e?"text":"html",n=this.getLabelText(),i=this.getLabelElement();i[t](n);var o=String(n);i.attr("title",o.replace(/<\/?[^>]+>/g,""))},updateDisplayFormat:function(){this.updateValue()},updateTextWrapping:function(){var e=this.model.get("textWrapping");this.getLabelElement().toggleClass("pl-text-wrapping",e)},updateTextTrimming:function(){var e=this.model.get("textTrimming");this.getLabelElement().toggleClass("pl-text-trimming",e)},updateText:function(){this.updateValue()},getData:function(){return _.extend({},ControlView.prototype.getData.call(this),editorBaseViewMixin.getData.call(this),{text:this.getLabelText()})},render:function(){return this.prerenderingActions(),this.renderTemplate(this.template),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},getLabelText:function(){var e,t=this.model,n=t.get("value"),i=t.get("displayFormat");return"undefined"!=typeof n&&null!==n?e="function"==typeof i?i(null,{value:n}):n:(e=this.model.get("text"),"undefined"!=typeof e&&null!==e||(e="")),e},getLabelElement:function(){return this.ui.control}}));InfinniUI.ObjectUtils.setPropertyValueDirect(InfinniUI,"viewModes.Label.common",CommonLabelView);var LabelControl=function(e){_.superClass(LabelControl,this,e),this.initialize_editorBaseControl()};_.inherit(LabelControl,Control),_.extend(LabelControl.prototype,{createControlModel:function(){return new LabelModel},createControlView:function(e,t){t&&t in InfinniUI.viewModes.Label||(t="simple");var n=InfinniUI.viewModes.Label[t];return new n({model:e})},getDisplayValue:function(){return this.controlView.getLabelText()}},editorBaseControlMixin),InfinniUI.LabelControl=LabelControl;var LabelModel=ControlModel.extend(_.extend({defaults:_.defaults({horizontalTextAlignment:"Left",textWrapping:!0,textTrimming:!0,escapeHtml:!0,focusable:!1},ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments),this.initialize_editorBaseModel()}},editorBaseModelMixin));InfinniUI.LabelModel=LabelModel;var SimpleLabelView=CommonLabelView.extend({tagName:"span",template:function(){return""},UI:_.extend({},editorBaseViewMixin.UI,{}),updateFocusable:function(){var e=this.model.get("focusable");e?this.$el.attr("tabindex",0):this.$el.removeAttr("tabindex")},getLabelElement:function(){return this.$el}});InfinniUI.ObjectUtils.setPropertyValueDirect(InfinniUI,"viewModes.Label.simple",SimpleLabelView);var BaseListBoxView=ListEditorBaseView.extend({template:{plain:InfinniUI.Template["controls/listBox/baseView/template/listBox.tpl.html"],grouped:InfinniUI.Template["controls/listBox/baseView/template/listBoxGrouped.tpl.html"]},className:"pl-listbox",events:{"change .pl-listbox-input":"onChangeHandler"},UI:_.defaults({items:".pl-listbox-i",checkingInputs:".pl-listbox-input input"},ListEditorBaseView.prototype.UI),initialize:function(e){ListEditorBaseView.prototype.initialize.call(this,e)},updateGrouping:function(){var e=this.model.get("groupValueSelector"),t=null!==e&&"undefined"!=typeof e;t?this.strategy=new ListBoxViewGroupStrategy(this):this.strategy=new ListBoxViewPlainStrategy(this)},updateValue:function(){this.ui.items.removeClass("pl-listbox-i-chosen"),this.ui.checkingInputs.prop("checked",!1);var e,t,n=this.model.get("value");if(this.isMultiselect()||"undefined"==typeof n||null===n||(n=[n]),Array.isArray(n))for(var i=0,o=n.length;i<o;i++)e=this.model.itemByValue(n[i]),t=this._getElementByItem(e),t&&(t.addClass("pl-listbox-i-chosen"),t.find(".pl-listbox-input input").prop("checked",!0))},updateSelectedItem:function(e){if(this.wasRendered||1==e){this.ui.items.removeClass("pl-listbox-i-selected");var t=this.model.get("selectedItem"),n=this._getElementByItem(t);n&&!n.hasClass("pl-disabled-list-item")&&n.addClass("pl-listbox-i-selected")}},render:function(){this.prerenderingActions();var e=this.strategy.prepareItemsForRendering(),t=this.strategy.getTemplate();return this.removeChildElements(),this.$el.html(t(e)),this.bindUIElements(),this.strategy.appendItemsContent(e),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},getItems:function(){return this.model.get("items")},getItemTemplate:function(){return this.model.get("itemTemplate")},getGroupValueSelector:function(){return this.model.get("groupValueSelector")},isMultiselect:function(){return this.model.get("multiSelect")},isFocusable:function(){return this.model.get("focusable")},getGroupItemTemplate:function(){return this.model.get("groupItemTemplate")},onChangeHandler:function(){var e,t=this.ui.checkingInputs.filter(":checked").parent().parent(),n=null,i=this.model;this.isMultiselect()?(n=[],t.each(function(t,o){e=$(o).data("pl-data-item"),n.push(i.valueByItem(e))})):t.length>0&&(n=i.valueByItem(t.data("pl-data-item"))),this.model.set("value",n)},updateDisabledItem:function(){var e=this.model,t=e.get("enabled"),n=e.get("disabledItemCondition");if(this.ui.items.removeClass("pl-disabled-list-item"),this.ui.checkingInputs.attr("disabled",null),t||(n=function(){return!0}),null!==n&&"undefined"!=typeof n){var i=this;this.ui.items.each(function(e,o){var r=$(o),a=r.data("pl-data-item"),l=n(void 0,{value:a});!l&&t||(r.hasClass("pl-listbox-i-selected")&&i.model.set("selectedItem",null),r.toggleClass("pl-disabled-list-item",!0),r.find("input").attr("disabled","disabled"),r.find("button").attr("disabled","disabled"))})}},_getElementByItem:function(e){var t=_.find(this.ui.items,function(t){return $(t).data("pl-data-item")==e});return $(t)}});InfinniUI.ObjectUtils.setPropertyValueDirect(InfinniUI,"viewModes.ListBox.base",BaseListBoxView),_.extend(ListBoxViewGroupStrategy.prototype,{prepareItemsForRendering:function(){var e=this.listbox.getItems(),t="listbox-"+guid(),n={isMultiselect:this.listbox.isMultiselect(),focusable:this.listbox.isFocusable(),inputName:t,groups:[]},i={},o=this.listbox.getGroupValueSelector();e.forEach(function(e,t){var n=o(void 0,{value:e});n in i||(i[n]=[]),i[n].push({index:t,item:e})});for(var r in i)n.groups.push({items:i[r]});return n},getTemplate:function(){return this.listbox.template.grouped},appendItemsContent:function(e){var t,n,i,o,r,a=this.listbox.$el,l=this.listbox.getItemTemplate(),s=this.listbox.getGroupItemTemplate(),u=e.groups,c=this.listbox;a.find(".pl-listbox-group-i").each(function(e,a){r=u[e],i=s(void 0,{index:r.items[0].index,item:r}),c.addChildElement(i),o=$(a),o.find(".pl-listbox-group-title").append(i.render()),o.find(".pl-listbox-body").each(function(e,i){t=r.items[e].item,n=l(void 0,{index:r.items[e].index,item:t}),c.addChildElement(n),$(i).append(n.render()),$(i).parent().data("pl-data-item",t)})})}}),InfinniUI.ListBoxViewGroupStrategy=ListBoxViewGroupStrategy,_.extend(ListBoxViewPlainStrategy.prototype,{prepareItemsForRendering:function(){var e=this.listbox.getItems(),t="listbox-"+guid(),n={isMultiselect:this.listbox.isMultiselect(),focusable:this.listbox.isFocusable(),inputName:t,items:e.toArray()};return n},getTemplate:function(){return this.listbox.template.plain},appendItemsContent:function(e){var t,n,i=this.listbox.$el,o=this.listbox.getItemTemplate(),r=e.items,a=this.listbox;i.find(".pl-listbox-body").each(function(e,i){n=$(i),t=o(void 0,{index:e,item:r[e]}),a.addChildElement(t),n.append(t.render()),n.parent().data("pl-data-item",r[e])})}}),InfinniUI.ListBoxViewPlainStrategy=ListBoxViewPlainStrategy,_.inherit(ListBoxControl,ListEditorBaseControl),_.extend(ListBoxControl.prototype,{createControlModel:function(){return new ListBoxModel},createControlView:function(e,t){(!t||!t in InfinniUI.viewModes.ListBox)&&(t="common");var n=InfinniUI.viewModes.ListBox[t];return new n({model:e})}}),InfinniUI.ListBoxControl=ListBoxControl;var ListBoxModel=ListEditorBaseModel.extend({initialize:function(){ListEditorBaseModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.ListBoxModel=ListBoxModel;var CheckingListBoxView=BaseListBoxView.extend({className:"pl-listbox",template:{plain:InfinniUI.Template["controls/listBox/checkingView/template/listBox.tpl.html"],grouped:InfinniUI.Template["controls/listBox/checkingView/template/listBoxGrouped.tpl.html"]},events:_.extend({},BaseListBoxView.prototype.events),initialize:function(e){BaseListBoxView.prototype.initialize.call(this,e),this.initDomHandlers()},updateEnabled:function(){ListEditorBaseView.prototype.updateEnabled.call(this);var e=this.model.get("enabled");this.ui.checkingInputs.attr("disabled",!e)},initDomHandlers:function(){var e=this.$el,t=this;e.get(0).addEventListener("click",function(n){n=$.event.fix(n);var i,o,r,a=$(n.target);if(t.model.get("enabled")){for(;a.get(0)!=e.get(0);)a.hasClass("pl-listbox-i")&&(i=a),a=a.parent();i&&i.length>0&&(o=i.data("pl-data-item"),r=t.model.isDisabledItem(o),r||t.model.toggleValue(o),t.model.set("selectedItem",o))}},!0)}});InfinniUI.ObjectUtils.setPropertyValueDirect(InfinniUI,"viewModes.ListBox.checking",CheckingListBoxView);var CommonListBoxView=BaseListBoxView.extend({className:"pl-listbox pl-listbox-common-mode",events:_.extend({},BaseListBoxView.prototype.events),initialize:function(e){BaseListBoxView.prototype.initialize.call(this,e),this.initDomHandlers()},initDomHandlers:function(){var e=this.$el,t=this;e.get(0).addEventListener("click",function(n){n=$.event.fix(n);for(var i,o,r,a=$(n.target);a.get(0)!=e.get(0);)a.hasClass("pl-listbox-i")&&(i=a),a=a.parent();i.length>0&&(o=i.data("pl-data-item"),r=t.model.isDisabledItem(o),r||t.model.toggleValue(o),t.model.set("selectedItem",o))},!0)}});InfinniUI.ObjectUtils.setPropertyValueDirect(InfinniUI,"viewModes.ListBox.common",CommonListBoxView);var CommonPopupButtonView=ContainerView.extend({className:"pl-popup-button",template:InfinniUI.Template["controls/popupButton/commonView/template/popupButton.tpl.html"],dropdownTemplate:InfinniUI.Template["controls/popupButton/commonView/template/popupButton.dropdown.tpl.html"],events:{click:"onClickHandler"},UI:{button:".pl-popup-button__button",grip:".pl-popup-button__grip"},updateProperties:function(){ContainerView.prototype.updateProperties.call(this),this.updateContent()},updateContent:CommonButtonView.prototype.updateContent,updateText:CommonButtonView.prototype.updateText,updateBackground:function(){var e=this.model.get("background"),t=this.valueToBackgroundClassName(e),n=this.valueToBackgroundClassName(this.currentBackground);""!==t&&(this.ui.button.removeClass(n).addClass(t),this.ui.grip.removeClass(n).addClass(t)),this.currentBackground=e},getButtonElement:function(){return this.ui.button},render:function(){this.prerenderingActions();var e=this.model.get("items").toArray(),t=this.template;return this.removeChildElements(),this.$el.html(t({items:e})),this.bindUIElements(),this.$dropdown=this.renderDropdown(),this.$dropdown.on("click",this.close.bind(this)),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderDropdown:function(){var e=this.dropdownTemplate,t=this.model.get("items").toArray(),n=$(e({items:t}));return this.appendItemsContent(n,t),n},appendItemsContent:function(e,t){var n,i,o=this,r=this.model.get("itemTemplate");e.find(".pl-popup-button__item").each(function(e,a){i=$(a),n=r(void 0,{index:e,item:t[e]}),o.addChildElement(n),i.append(n.render())})},open:function(){$("body").append(this.$dropdown),this.$dropdown.addClass("open"),this.alignDropdown();this.$dropdown.add(this.ui.grip)},close:function(){this.$dropdown.removeClass("open"),this.$dropdown.detach()},alignDropdown:function(){var e=this.$el.offset(),t=this.$el.height(),n=this.$el.width(),i=this.$dropdown.find(".pl-popup-button__items")[0],o=i.offsetHeight,r=i.offsetWidth,a=e.left,l=e.top+t;e.left+r>=window.innerWidth&&(a+=n-r),l+o>=window.innerHeight&&(l-=t+o+2),this.$dropdown.offset({top:l,left:a})},toggle:function(){this.$dropdown.hasClass("open")?this.close():this.open()},onClickHandler:function(){this.toggle()},updateGrouping:function(){}});InfinniUI.ObjectUtils.setPropertyValueDirect(InfinniUI,"viewModes.PopupButton.common",CommonPopupButtonView),_.inherit(PopupButtonControl,ContainerControl),_.extend(PopupButtonControl.prototype,{createControlModel:function(){return new PopupButtonModel},createControlView:function(e,t){(!t||!t in InfinniUI.viewModes.PopupButton)&&(t="common");var n=InfinniUI.viewModes.PopupButton[t];return new n({model:e})}},buttonControlMixin),InfinniUI.PopupButtonControl=PopupButtonControl;var PopupButtonModel=ContainerModel.extend({});InfinniUI.PopupButtonModel=PopupButtonModel;var ForMenuPopupButtonView=CommonPopupButtonView.extend({tagName:"a",className:"pl-popup-button",attributes:{href:"javascript:;"},template:InfinniUI.Template["controls/popupButton/forMenuView/template/popupButton.tpl.html"],dropdownTemplate:InfinniUI.Template["controls/popupButton/commonView/template/popupButton.dropdown.tpl.html"],events:{click:"onClickGripHandler"},UI:{button:".pl-popup-button__button",grip:".pl-popup-button__grip"},updateProperties:function(){ContainerView.prototype.updateProperties.call(this),this.updateContent()},updateContent:CommonButtonView.prototype.updateContent,updateText:CommonButtonView.prototype.updateText,updateHorizontalAlignment:function(){var e,t=this.model.get("horizontalAlignment"),n=this;this.whenReady(function(){return e=n.$el.parent().parent(),e.length>0},function(){"Right"==t?e.addClass("pull-right"):e.removeClass("pull-right")})},updateBackground:function(){var e=this.model.get("background"),t=this.valueToBackgroundClassName(e),n=this.valueToBackgroundClassName(this.currentBackground);""!==t&&this.$el.removeClass(n).addClass(t),this.currentBackground=e},getButtonElement:function(){return this.ui.button},render:function(){this.prerenderingActions();var e=this.model.get("items").toArray(),t=this.template;return this.removeChildElements(),this.$el.html(t({items:e})),this.bindUIElements(),this.$dropdown=this.renderDropdown(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderDropdown:function(){var e=this.dropdownTemplate,t=this.model.get("items").toArray(),n=$(e({items:t}));return this.appendItemsContent(n,t),n.on("click",function(){this.close()}.bind(this)),n},appendItemsContent:function(e,t){var n,i,o=this,r=this.model.get("itemTemplate");e.find(".pl-popup-button__item").each(function(e,a){i=$(a),n=r(void 0,{index:e,item:t[e]}),o.addChildElement(n),i.append(n.render())})},open:function(){var e=this,t=this.$el.parent();$("body").append(this.$dropdown),this.$dropdown.addClass("open"),t.addClass("open"),this.alignDropdown();var n=this.$dropdown.add(this.$el);new ActionOnLoseFocus(n,function(){e.close()})},close:function(){this.$dropdown.removeClass("open"),this.$el.parent().removeClass("open"),this.$dropdown.detach()},alignDropdown:function(){var e,t=this.model.get("horizontalAlignment"),n=this.$el.parent(),i=n.offset(),o=i.top+n.height()-2,r=this.$dropdown.find(".dropdown-menu");e="Right"==t?i.left-(r.width()-n.width()):i.left,this.$dropdown.offset({top:o,left:e})},onClickGripHandler:function(){this.toggle()},updateGrouping:function(){},whenReady:function(e,t,n){var i=this;null!==n&&"undefined"!=typeof n||(n=100),e()?t():n>0&&setTimeout(function(){i.whenReady(e,t,n-1)},10)}});InfinniUI.ObjectUtils.setPropertyValueDirect(InfinniUI,"viewModes.PopupButton.forMenu",ForMenuPopupButtonView),_.inherit(StackPanelControl,ContainerControl),_.extend(StackPanelControl.prototype,{createControlModel:function(){return new StackPanelModel},createControlView:function(e,t){var n=new StackPanelView({model:e});return n.viewMode=t,n}}),InfinniUI.StackPanelControl=StackPanelControl;var StackPanelModel=ContainerModel.extend({initialize:function(){ContainerModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.StackPanelModel=StackPanelModel;var StackPanelView=ContainerView.extend({tagName:"ul",className:"pl-stack-panel pl-clearfix",template:{plain:InfinniUI.Template["controls/stackPanel/baseView/template/stackPanel.tpl.html"],grouped:InfinniUI.Template["controls/stackPanel/baseView/template/stackPanelGrouped.tpl.html"]},UI:{items:".stackpanel-items"},initialize:function(e){ContainerView.prototype.initialize.call(this,e),this.initOrientation()},updateGrouping:function(){var e=this.model.get("groupValueSelector"),t=null!==e&&"undefined"!=typeof e;t?this.strategy=new StackPanelViewGroupStrategy(this):this.strategy=new StackPanelViewPlainStrategy(this)},render:function(){this.prerenderingActions(),this.removeChildElements();var e=this.strategy.prepareItemsForRendering(),t=this.strategy.getTemplate();return this.$el.html(t(e)),this.strategy.appendItemsContent(e),this.bindUIElements(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},initOrientation:function(){this.listenTo(this.model,"change:orientation",this.updateOrientation),this.updateOrientation()},updateOrientation:function(){var e=this.model.get("orientation");this.$el.toggleClass("horizontal-orientation","Horizontal"==e),this.$el.toggleClass("pl-stack-panel_horizontal","Horizontal"==e)},getItems:function(){return this.model.get("items")},getItemTemplate:function(){return this.model.get("itemTemplate")},getGroupValueSelector:function(){return this.model.get("groupValueSelector")},getGroupItemTemplate:function(){return this.model.get("groupItemTemplate")}});InfinniUI.StackPanelView=StackPanelView,_.extend(StackPanelViewGroupStrategy.prototype,{groupTemplate:InfinniUI.Template["controls/stackPanel/baseView/template/stackPanelGroup.tpl.html"],prepareItemsForRendering:function(){var e=this.stackPanel.getItems(),t="listbox-"+guid(),n={inputName:t,groups:[]},i={},o=this.stackPanel.getGroupValueSelector();e.forEach(function(e,t){var n=o(void 0,{value:e});n in i||(i[n]=[]),i[n].push(e)});for(var r in i)i.hasOwnProperty(r)&&n.groups.push({items:i[r],indices:i[r].map(function(t){return e.indexOf(t)})});return n},getTemplate:function(){return this.stackPanel.template.grouped},appendItemsContent:function(e){var t,n=this.stackPanel,i=n.$el,o=this.groupTemplate,r=this.stackPanel.getGroupItemTemplate(),a=this.stackPanel.getItemTemplate(),l=e.groups;t=l.map(function(e,t){var i,l=e.items||[],s=e.indices||[],u=$(o({items:l})),c=r(null,{index:s[0],item:e});return n.addChildElement(c),i=l.map(function(e,t){var i=a(null,{index:s[t],item:e});return n.addChildElement(i),i.render()}),$(".pl-stack-panel-group__header",u).append(c.render()),$(".pl-stack-panel-list__item",u).each(function(e,t){$(t).append(i[e])}),u}),i.append(t)}}),InfinniUI.StackPanelViewGroupStrategy=StackPanelViewGroupStrategy,_.extend(StackPanelViewPlainStrategy.prototype,{prepareItemsForRendering:function(){var e=this.stackPanel.getItems(),t={items:e.toArray()};return t},getTemplate:function(){return this.stackPanel.template.plain},appendItemsContent:function(e,t){var n,i,o=this.stackPanel.$el,r=this.stackPanel.getItemTemplate(),a=e.items,l=this.stackPanel;t=t||".pl-stack-panel-i",o.find(t).each(function(e,t){i=$(t),n=r(void 0,{index:e,item:a[e]}),l.addChildElement(n),i.append(n.render()),i.parent().data("pl-data-item",a[e])})}}),InfinniUI.StackPanelViewPlainStrategy=StackPanelViewPlainStrategy,_.inherit(TablePanelControl,ContainerControl),_.extend(TablePanelControl.prototype,{createControlModel:function(){return new TablePanelModel},createControlView:function(e){return new TablePanelView({model:e})}}),InfinniUI.TablePanelControl=TablePanelControl;var TablePanelModel=ContainerModel.extend({initialize:function(){ContainerModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.TablePanelModel=TablePanelModel;var TablePanelView=ContainerView.extend({className:"pl-table-panel",initialize:function(e){ContainerView.prototype.initialize.call(this,e)},render:function(){return this.prerenderingActions(),this.removeChildElements(),this.renderItemsContents(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderItemsContents:function(){var e,t=this.model.get("items"),n=this.model.get("itemTemplate"),i=this;
t.forEach(function(t,o){e=n(void 0,{item:t,index:o}),i.addChildElement(e),i.$el.append(e.render())})},updateGrouping:function(){}});InfinniUI.TablePanelView=TablePanelView,_.inherit(CellControl,ContainerControl),_.extend(CellControl.prototype,{createControlModel:function(){return new CellModel},createControlView:function(e){return new CellView({model:e})}}),InfinniUI.CellControl=CellControl;var CellModel=ContainerModel.extend({defaults:_.defaults({columnSpan:1},ContainerModel.prototype.defaults),initialize:function(){ContainerModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.CellModel=CellModel;var CellView=ContainerView.extend({className:"pl-cell",initialize:function(e){ContainerView.prototype.initialize.call(this,e),this.initColumnSpan()},render:function(){return this.prerenderingActions(),this.removeChildElements(),this.renderItemsContents(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderItemsContents:function(){var e,t=this.model.get("items"),n=this.model.get("itemTemplate"),i=this;t.forEach(function(t,o){e=n(void 0,{item:t,index:o}),i.addChildElement(e),i.$el.append(e.render())})},initColumnSpan:function(){this.listenTo(this.model,"change:columnSpan",this.updateColumnSpan),this.updateColumnSpan()},updateColumnSpan:function(){var e=this.model.get("columnSpan"),t=this.columnSpan;e!=t&&(t&&this.$el.removeClass("col-xs-"+t),this.$el.addClass("col-xs-"+e),this.columnSpan=e)},updateGrouping:function(){}});InfinniUI.CellView=CellView,_.inherit(RowControl,ContainerControl),_.extend(RowControl.prototype,{createControlModel:function(){return new RowModel},createControlView:function(e){return new RowView({model:e})}}),InfinniUI.RowControl=RowControl;var RowModel=ContainerModel.extend({initialize:function(){ContainerModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.RowModel=RowModel;var RowView=ContainerView.extend({className:"pl-row row",initialize:function(e){ContainerView.prototype.initialize.call(this,e)},render:function(){return this.prerenderingActions(),this.removeChildElements(),this.renderItemsContents(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderItemsContents:function(){var e,t=this.model.get("items"),n=this.model.get("itemTemplate"),i=this;t.forEach(function(t,o){e=n(void 0,{item:t,index:o}),i.addChildElement(e),i.$el.append(e.render())})},updateGrouping:function(){}});InfinniUI.RowView=RowView,_.inherit(TabPanelControl,ContainerControl),_.extend(TabPanelControl.prototype,{setSelectedItem:function(e){var t=null,n=this.controlModel,i=this.controlView.childElements,o=n.get("items");if(e instanceof TabPage)n.set("selectedItem",e);else if(Array.isArray(i)){var r=o.indexOf(e);r!==-1&&(t=i[r]),this.controlModel.set("selectedItem",t)}},createControlModel:function(){return new TabPanelModel},createControlView:function(e){return new TabPanelView({model:e})}}),InfinniUI.TabPanelControl=TabPanelControl;var TabPanelModel=ContainerModel.extend({initialize:function(){ContainerModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))},defaults:_.defaults({headerLocation:InfinniUI.TabHeaderLocation.top,headerOrientation:InfinniUI.TabHeaderOrientation.horizontal},ContainerModel.prototype.defaults)});InfinniUI.TabPanelModel=TabPanelModel;var TabPanelView=ContainerView.extend({className:"pl-tabpanel",template:{top:InfinniUI.Template["controls/tabPanel/template/tabPanel.top.tpl.html"],right:InfinniUI.Template["controls/tabPanel/template/tabPanel.right.tpl.html"],bottom:InfinniUI.Template["controls/tabPanel/template/tabPanel.bottom.tpl.html"],left:InfinniUI.Template["controls/tabPanel/template/tabPanel.left.tpl.html"],none:InfinniUI.Template["controls/tabPanel/template/tabPanel.none.tpl.html"]},UI:{header:".pl-tabpanel-header",content:".pl-tabpanel-content"},initHandlersForProperties:function(){ContainerView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:headerLocation",this.onChangeHeaderLocation),this.listenTo(this.model,"change:headerOrientation",this.updateHeaderOrientation),this.listenTo(this.model,"change:selectedItem",this.updateSelectedItem)},render:function(){return this.prerenderingActions(),this.renderTemplate(this.getTemplate()),this.renderItemsContents(),this.initSelectedItem(),this.postrenderingActions(),this.trigger("render"),this.updateProperties(),this},renderItemsContents:function(){var e=this.model.get("items");this.removeChildElements(),this.ui.content.empty(),this.model.set("selectedItemIndex",-1);var t=[];e.forEach(function(e,n){t.push({tabElement:this.renderTabContent(e,n),item:e,index:n})},this),this.renderTabHeaders(t)},renderTabHeaders:function(e){var t,n=this.model,i=n.get("items");n.get("selectedItem");if(Array.isArray(this.tabHeaders))for(;t=this.tabHeaders.pop();)this.stopListening(t),t.remove();this.tabHeaders=e.map(function(e){var t=i.indexOf(e.item)!==-1,o=this.renderTabHeader(e.tabElement,t);return this.listenTo(o,"selected",function(){var t=e.tabElement.getEnabled();t&&n.set("selectedItem",e.tabElement)}),this.listenTo(o,"close",function(){var t=e.tabElement.getEnabled();t&&e.tabElement.close()}),o},this)},renderTabHeader:function(e,t){var n=this,i=new TabHeaderView({text:e.getText(),canClose:e.getCanClose(),enabled:e.getEnabled(),selected:t});return e.onPropertyChanged("text",function(){i.setText(e.getText())}),e.onPropertyChanged("canClose",function(){i.setCanClose(e.getCanClose())}),e.onPropertyChanged("enabled",function(){i.setEnabled(e.getEnabled());var t=n.model.get("selectedItem");e==t&&n.resetDefaultSelectedItem()}),this.ui.header.append(i.render().$el),i},renderTabContent:function(e,t){var n=this.model.get("itemTemplate"),i=n(void 0,{item:e,index:t});return this.addChildElement(i),this.ui.content.append(i.render()),i},getTemplate:function(){var e,t=this.model.get("headerLocation");switch(t){case InfinniUI.TabHeaderLocation.top:e=this.template.top;break;case InfinniUI.TabHeaderLocation.right:e=this.template.right;break;case InfinniUI.TabHeaderLocation.bottom:e=this.template.bottom;break;case InfinniUI.TabHeaderLocation.left:e=this.template.left;break;case InfinniUI.TabHeaderLocation.none:default:e=this.template.none}return e},updateProperties:function(){ContainerView.prototype.updateProperties.call(this),this.updateHeaderOrientation(),this.updateSelectedItem()},onChangeHeaderLocation:function(){this.rerender()},updateHeaderOrientation:function(){},initSelectedItem:function(){var e=this.model,t=this.childElements,n=e.get("selectedItem");if(Array.isArray(t)&&0!=t.length){if(t.indexOf(n)===-1){var i=this._getFirstEnabledPageIndex();i!=-1&&e.set("selectedItem",t[i])}}else e.set("selectedItem",null)},resetDefaultSelectedItem:function(){this.model.set("selectedItem",null),this.initSelectedItem()},_getFirstEnabledPageIndex:function(){for(var e=this.childElements,t=0;t<e.length;++t)if(e[t].getEnabled())return t;return-1},updateSelectedItem:function(){if(this.wasRendered){var e=this.childElements,t=this.tabHeaders,n=this.model.get("selectedItem"),i=e.indexOf(n);Array.isArray(e)&&(e.forEach(function(e){e.setSelected(!1)}),i!==-1&&e[i].setSelected(!0)),Array.isArray(t)&&(t.forEach(function(e){e.setSelected(!1)}),i!==-1&&t[i].setSelected(!0))}},updateGrouping:function(){}});InfinniUI.TabPanelView=TabPanelView;var TabHeaderModel=Backbone.Model.extend({defaults:{text:"",enabled:!0,canClose:!1}});InfinniUI.TabHeaderModel=TabHeaderModel;var TabHeaderView=Backbone.View.extend({className:"pl-tabheader",tagName:"li",template:InfinniUI.Template["controls/tabPanel/tabHeader/template/tabHeader.tpl.html"],events:{click:"onClickHandler","click .pl-close":"onClickCloseHandler"},UI:{label:".pl-tabheader-text",close:".pl-close"},initialize:function(e){this.model=new TabHeaderModel(e),this.on("rendered",this.onRenderedHandler)},render:function(){return this.$el.html(this.template),this.bindUIElements(),this.trigger("rendered"),this},setText:function(e){this.model.set("text",e)},setCanClose:function(e){this.model.set("canClose",e)},setSelected:function(e){this.model.set("selected",e)},setEnabled:function(e){this.model.set("enabled",e)},updateProperties:function(){this.updateTextHandler(),this.updateCanClose(),this.updateSelectedHandler(),this.updateEnabled()},onRenderedHandler:function(){this.updateProperties(),this.listenTo(this.model,"change:text",this.updateTextHandler),this.listenTo(this.model,"change:selected",this.updateSelectedHandler),this.listenTo(this.model,"change:canClose",this.updateCanClose),this.listenTo(this.model,"change:enabled",this.updateProperties)},updateTextHandler:function(){var e=this.model.get("text");this.ui.label.text(e)},updateCanClose:function(){var e=this.model.get("canClose");this.ui.close.toggleClass("hidden",!e)},updateSelectedHandler:function(){var e=this.model.get("selected");this.$el.toggleClass("pl-active active",e)},updateEnabled:function(){var e=this.model.get("enabled");this.$el.toggleClass("pl-disabled",!e)},onClickHandler:function(e){this.trigger("selected")},onClickCloseHandler:function(e){e.stopPropagation(),this.trigger("close")}});_.extend(TabHeaderView.prototype,bindUIElementsMixin),InfinniUI.TabHeaderView=TabHeaderView,_.inherit(TabPageControl,ContainerControl),_.extend(TabPageControl.prototype,{createControlModel:function(){return new TabPageModel},createControlView:function(e){return new TabPageView({model:e})}}),InfinniUI.TabPageControl=TabPageControl;var TabPageModel=ContainerModel.extend({initialize:function(){ContainerModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))},defaults:_.defaults({canClose:!1,selected:!1},ContainerModel.prototype.defaults)});InfinniUI.TabPageModel=TabPageModel;var TabPageView=ContainerView.extend({className:"pl-tabpage hidden",template:InfinniUI.Template["controls/tabPanel/tabPage/template/tabPage.tpl.html"],UI:{},initHandlersForProperties:function(){ContainerView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:selected",this.updateSelected)},updateProperties:function(){ContainerView.prototype.updateProperties.call(this),this.updateSelected()},render:function(){return this.prerenderingActions(),this.removeChildElements(),this.$el.html(this.template({items:this.model.get("items")})),this.renderItemsContents(),this.bindUIElements(),this.postrenderingActions(),this.trigger("render"),this.updateProperties(),this},renderItemsContents:function(){var e,t,n=this.$el.find(".pl-tabpage-i"),i=this.model.get("items"),o=this.model.get("itemTemplate"),r=this;n.each(function(n,a){t=i.getByIndex(n),e=o(void 0,{item:t,index:n}),r.addChildElement(e),$(a).append(e.render())})},updateSelected:function(){var e=this.model.get("selected");this.$el.toggleClass("hidden",!e)},updateGrouping:function(){}});InfinniUI.TabPageView=TabPageView,_.inherit(TreeViewControl,ListEditorBaseControl),_.extend(TreeViewControl.prototype,{createControlModel:function(){return new TreeViewModel},createControlView:function(e){return new TreeViewView({model:e})},expand:function(e){this.controlView.expandNode(e)},collapse:function(e){this.controlView.collapseNode(e)},toggle:function(e){this.controlView.toggleNode(e)}}),InfinniUI.TreeViewControl=TreeViewControl;var TreeViewModel=ListEditorBaseModel.extend({defaults:_.defaults({onExpand:null,onCollapse:null},ListEditorBaseModel.prototype.defaults),initialize:function(){ListEditorBaseModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))},toggleItem:function(e,t){var n=this.valueByItem(e);this.toggleValue(n,t),this.trigger("toggle")}});InfinniUI.TreeViewModel=TreeViewModel;var TreeViewView=ListEditorBaseView.extend({className:"pl-treeview",classNameMultiSelect:"pl-treeview_multi-select",classNameSingleSelect:"pl-treeview_single-select",template:InfinniUI.Template["controls/treeView/template/treeview.tpl.html"],events:{},UI:_.defaults({},ListEditorBaseView.prototype.UI),initialize:function(e){ListEditorBaseView.prototype.initialize.call(this,e),this.itemsMap=new HashMap,this.nodesMap=new HashMap},addChildElement:function(e,t){this.nodesMap.add(t,e),ListEditorBaseView.prototype.addChildElement.call(this,e)},removeChildElements:function(){this.nodesMap.clear(),this.itemsMap.clear(),ListEditorBaseView.prototype.removeChildElements.call(this)},render:function(){return this.prerenderingActions(),this.removeChildElements(),this.renderTemplate(this.getTemplate()),this.renderItems(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderItems:function(e){function t(e){return a.toArray().filter(function(t){var i=l(null,{value:t});return n(e)?n(i):i===e}).map(function(e){function n(t){return r.itemByValue(t)===e}var i=(new u).render(),l=i.$el,p=c(null,{value:e,index:a.indexOf(e)}).render();l.data("pl-data-item",e),i.listenTo(r,"change:selectedItem",function(t,n){i.setSelected(n===e)}),i.listenTo(r,"change:value",function(e,t){var o,r=e.get("multiSelect");o=r?!!Array.isArray(t)&&t.some(n):n(t),i.setChecked(o)}),o.listenTo(i,"select",o.onSelectNodeHandler.bind(o,e,i)),o.listenTo(i,"check",o.onCheckNodeHandler.bind(o,e,i)),o.listenTo(i,"expand",o.onExpandNodeHandler.bind(o,e)),o.listenTo(i,"collapse",o.onCollapseNodeHandler.bind(o,e)),i.setItemContent(p);var h=s(null,{value:e}),f=t(h);return i.setItemsContent(f),o.addChildElement(i,e),d.add(h,e),l})}function n(e){return null===e||"undefined"==typeof e}var i,o=this,r=this.model,a=r.get("items"),l=r.get("parentSelector"),s=r.get("keySelector"),u=this.getNodeConstructor(),c=r.get("itemTemplate"),d=this.itemsMap;i=t(),this.$el.append(i)},getNodeConstructor:function(){var e=this.model.get("multiSelect");return e===!0?TreeViewNodeCheckbox:TreeViewNodeRadio},onSelectNodeHandler:function(e,t){var n=this.model,i=n.get("multiSelect");n.set("selectedItem",e),i||this.tryToggleValue(e)},onCheckNodeHandler:function(e,t){var n=this.model,i=n.get("multiSelect");this.tryToggleValue(e),i||n.set("selectedItem",e)},tryToggleValue:function(e){var t=this.model,n=this.isDisabledItem(e);if(!n){var i=t.valueByItem(e);t.toggleValue(i)}},isDisabledItem:function(e){return null!==e&&"undefined"!=typeof e&&(this.model.isDisabledItem(e)||this.isDisabledItem(this.getParent(e)))},getParent:function(e){var t=this.model.get("parentSelector"),n=t(null,{value:e});return n&&this.itemsMap.get(n)},getTemplate:function(){return this.template},updateProperties:function(){ListEditorBaseView.prototype.updateProperties.call(this),this.updateMultiSelect()},updateMultiSelect:function(){var e=this.model.get("multiSelect");this.$el.toggleClass(this.classNameMultiSelect,!!e),this.$el.toggleClass(this.classNameSingleSelect,!e)},updateEnabled:function(){ListEditorBaseView.prototype.updateEnabled.call(this)},updateValue:function(){},updateSelectedItem:function(){},updateGrouping:function(){},updateDisabledItem:function(){var e=this.model,t=e.get("disabledItemCondition"),n=this.$el.find(".pl-treeview-node");n.removeClass("pl-disabled-list-item"),null!==t&&"undefined"!=typeof t&&n.each(function(t,n){var i=$(n),o=i.data("pl-data-item");e.isDisabledItem(o)&&i.addClass("pl-disabled-list-item")})},collapseNode:function(e){var t=this.itemsMap.get(e);if(t){var n=this.nodesMap.get(t);n&&n.collapse()}},toggleNode:function(e){var t=this.itemsMap.get(e);if(t){var n=this.nodesMap.get(t);if(n){var i=n.getCollapsed(),o=i?this.expandNode:this.collapseNode;o.call(this,e)}}},expandNode:function(e){var t=this.model,n=this.itemsMap.get(e);if(n){for(var i,o=this.nodesMap.get(n),r=t.get("parentSelector"),a=(t.get("keySelector"),[o]);(i=r(null,{value:n}))&&i;)n=this.itemsMap.get(i),o=this.nodesMap.get(n),a.push(o);a.reverse().forEach(function(e){e.expand()})}},onExpandNodeHandler:function(e){var t=this.model,n=t.get("onExpand");n&&n(e)},onCollapseNodeHandler:function(e){var t=this.model,n=t.get("onCollapse");n&&n(e)}});InfinniUI.TreeViewView=TreeViewView;var TreeViewNodeBase=Backbone.View.extend({className:"pl-treeview-node",classNameCheckerChecked:"pl-treeview-item__checker_checked",classNameCheckerUnchecked:"pl-treeview-item__checker_unchecked",classNameContentSelected:"pl-treeview-item__content_selected",classNameItemsExpanded:"pl-treeview-node__items_expanded",classNameItemsCollapsed:"pl-treeview-node__items_collapsed",classNameButtonCollapse:"pl-treeview-node__button_collapse",classNameButtonExpand:"pl-treeview-node__button_expand",classNameButtonNone:"pl-treeview-node__button_none",classNameIsLeaf:"pl-treeview-node_is-leaf",UI:{checker:".pl-treeview-item__checker",content:".pl-treeview-item__content",items:".pl-treeview-node__items",button:".pl-treeview-node__button"},initialize:function(){var e=new Backbone.Model({collapsed:!0,isLeaf:!0});this.model=e,this.listenTo(e,"change:selected",this.updateSelected),this.listenTo(e,"change:checked",this.updateChecked),this.listenTo(e,"change:collapsed",this.updateCollapsed),this.listenTo(e,"change:isLeaf",this.updateCollapsed)},updateChecked:function(){var e=this.model.get("checked");this.ui.checker.toggleClass(this.classNameCheckerChecked,e===!0),this.ui.checker.toggleClass(this.classNameCheckerUnchecked,e!==!0)},updateSelected:function(){var e=this.model.get("selected");this.ui.content.toggleClass(this.classNameContentSelected,e===!0)},updateCollapsed:function(){var e=this.model.get("isLeaf"),t=!!this.model.get("collapsed");this.ui.items.toggleClass(this.classNameItemsExpanded,!t&&!e),this.ui.items.toggleClass(this.classNameItemsCollapsed,t&&!e),this.ui.button.toggleClass(this.classNameButtonCollapse,!t&&!e),this.ui.button.toggleClass(this.classNameButtonExpand,t&&!e),this.$el.toggleClass(this.classNameIsLeaf,e),this.ui.button.toggleClass(this.classNameButtonNone,e)},updateState:function(){this.updateCollapsed(),this.updateSelected(),this.updateChecked()},render:function(){return this.$el.html(this.template),this.bindUIElements(),this.updateState(),this.initDomEventsHandlers(),this},initDomEventsHandlers:function(){this.ui.button.on("click",this.onClickEventHandler.bind(this)),this.ui.content[0].addEventListener("click",this.onClickItemHandler.bind(this),!0),this.ui.checker[0].addEventListener("click",this.onClickCheckHandler.bind(this),!0)},onClickItemHandler:function(e){this.trigger("select")},onClickCheckHandler:function(e){this.trigger("check")},toggle:function(){var e=this.model,t=e.get("collapsed");t?this.expand():this.collapse()},expand:function(){this.model.set("collapsed",!1),this.trigger("expand")},collapse:function(){this.model.set("collapsed",!0),this.trigger("collapse")},getCollapsed:function(){return this.model.get("collapsed")},setItemContent:function(e){this.ui.content.empty(),this.ui.content.append(e)},setItemsContent:function(e){this.ui.items.empty(),this.model.set("isLeaf",!e.length),this.ui.items.append(e)},onClickEventHandler:function(e){this.toggle()},setSelected:function(e){this.model.set("selected",e)},setChecked:function(e){this.model.set("checked",e)}});_.extend(TreeViewNodeBase.prototype,bindUIElementsMixin),InfinniUI.TreeViewNodeBase=TreeViewNodeBase;var TreeViewNodeCheckbox=TreeViewNodeBase.extend({template:InfinniUI.Template["controls/treeView/template/node-checkbox.tpl.html"]});InfinniUI.TreeViewNodeCheckbox=TreeViewNodeCheckbox;var TreeViewNodeRadio=TreeViewNodeBase.extend({template:InfinniUI.Template["controls/treeView/template/node-radio.tpl.html"]});InfinniUI.TreeViewNodeRadio=TreeViewNodeRadio,_.inherit(CheckBoxControl,Control),_.extend(CheckBoxControl.prototype,{createControlModel:function(){return new CheckBoxModel},createControlView:function(e){return new CheckBoxView({model:e})}},editorBaseControlMixin),InfinniUI.CheckBoxControl=CheckBoxControl;var CheckBoxModel=ControlModel.extend(_.extend({defaults:_.defaults({value:!1},ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments),this.initialize_editorBaseModel()}},editorBaseModelMixin));InfinniUI.CheckBoxModel=CheckBoxModel;var CheckBoxView=ControlView.extend(_.extend({},editorBaseViewMixin,{template:InfinniUI.Template["controls/checkBox/template/checkBox.tpl.html"],UI:_.extend({},editorBaseViewMixin.UI,{text:".checkbox-label",input:"input"}),events:{"click input":"onClickHandler"},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),editorBaseViewMixin.initHandlersForProperties.call(this)},updateProperties:function(){ControlView.prototype.updateProperties.call(this),editorBaseViewMixin.updateProperties.call(this)},updateFocusable:function(){var e=this.model.get("focusable");e?this.ui.input.removeAttr("tabindex"):this.ui.input.attr("tabindex",-1)},updateText:function(){var e=this.model.get("text");this.ui.text.text(e?e:"")},updateEnabled:function(){ControlView.prototype.updateEnabled.call(this);var e=this.model.get("enabled");this.ui.input.prop("disabled",!e)},render:function(){return this.prerenderingActions(),this.renderTemplate(this.template),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},onClickHandler:function(){var e=this.model,t=e.get("enabled");t&&e.set("value",!e.get("value"))},updateValue:function(){var e=this.model.get("value");this.ui.input.prop("checked",!!e)},setFocus:function(){this.ui.input.focus()}}));InfinniUI.CheckBoxView=CheckBoxView,_.inherit(ComboBoxControl,ListEditorBaseControl),_.extend(ComboBoxControl.prototype,{createControlModel:function(){return new ComboBoxModel},createControlView:function(e){return new ComboBoxView({model:e})},setNoItemsMessage:function(e){this.controlModel.setNoItemsMessage(e)}}),InfinniUI.ComboBoxControl=ComboBoxControl;var ComboBoxModel=ListEditorBaseModel.extend({defaults:_.defaults({noItemsMessage:null,showClear:!0,autocomplete:!1,autocompleteValue:"",isInitialized:!1,valueTemplate:function(e,t){return{render:function(){return t.value}}}},ListEditorBaseModel.prototype.defaults),initialize:function(){var e=this;ListEditorBaseModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments)),this.on("change:value",this.syncSelectedItem),this.get("items").onChange(function(){e.set("isInitialized",!0)})},setSelectedItemToValue:function(){var e=this.get("autocomplete"),t=this.get("multiSelect");if(!e&&!t){var n=this.getSelectedItem(),i=this.valueByItem(n);this.set("value",i)}},syncSelectedItem:function(e,t){var n=this.itemByValue(t);this.setSelectedItem(n)},getSelectedItem:function(){var e=this.get("selectedItem");return e},setSelectedItem:function(e){this.set("selectedItem",e)},selectNextItem:function(){var e=this.get("items"),t=this.getSelectedItem();if(e.length>0){var n=0;t&&(n=e.indexOf(t),n=n===-1?0:Math.min(e.length-1,n+1)),t=e.getByIndex(n)}else t=null;this.setSelectedItem(t),this.setSelectedItemToValue()},selectPrevItem:function(){var e=this.get("items"),t=this.getSelectedItem();if(e.length>0){var n=0;t&&(n=e.indexOf(t),n=n===-1?0:Math.max(0,n-1)),t=e.getByIndex(n)}this.setSelectedItem(t),this.setSelectedItemToValue()},selectFirstItem:function(){var e=this.get("items"),t=null;e.length>0&&(t=e.getByIndex(0)),this.setSelectedItem(t),this.setSelectedItemToValue()},selectLastItem:function(){var e=this.get("items"),t=null;e.length>0&&(t=e.getByIndex(e.length-1)),this.setSelectedItem(t),this.setSelectedItemToValue()},toggleItem:function(e,t){var n=this.valueByItem(e);this.toggleValue(n,t),this.trigger("toggle")},setNoItemsMessage:function(e){this.set("noItemsMessage",e)}});InfinniUI.ComboBoxModel=ComboBoxModel;var ComboBoxView=ListEditorBaseView.extend({className:"pl-combobox form-group",template:InfinniUI.Template["controls/comboBox/template/combobox.tpl.html"],events:{"click .pl-combobox__grip":"onClickGripHandler","click .pl-combobox__value":"onClickValueHandler","click .pl-combobox__clear":"onClickClearHandler","click .pl-control":"onClickValueHandler","keydown .pl-control":"onKeyDownControlHandler"},UI:_.defaults({control:".pl-control",label:".pl-control-label",value:".pl-combobox__value",clear:".pl-combobox__clear"},ListEditorBaseView.prototype.UI),isControlElement:function(e){var t=ListEditorBaseView.prototype.isControlElement.call(this,e);return t?t:!!this.dropDownView&&$.contains(this.dropDownView.el,e)},updateFocusable:function(){var e=this.model.get("focusable"),t=this.model.get("enabled");e&&t?this.ui.control.attr("tabindex",0):this.ui.control.removeAttr("tabindex")},initialize:function(e){ListEditorBaseView.prototype.initialize.call(this,e);var t=this.model,n=this;this.on("render",function(){n.renderValue(),t.on("change:dropdown",function(e,t){if(t){e.set("autocompleteValue",""),e.set("focused",!0),n.dropDownView&&n.dropDownView.remove();var i=new ComboBoxDropdownView({model:e});n.dropDownView=i,this.listenTo(i,"search",_.debounce(n.onSearchValueHandler.bind(n),300));var o=i.render();$("body").append(o);var r=n.el,a=n.ui.control.get(0);i.updatePosition(r,a),n.dropDownView.on("itemsRendered2",function(){i.updatePosition(r,a)}),e.get("autocomplete")?i.setSearchFocus():n.ui.control.focus(),setTimeout(i.ensureVisibleSelectedItem.bind(i),0)}else n.ui.control.focus()}),t.onValueChanged(this.onChangeValueHandler.bind(this))},this)},initHandlersForProperties:function(){ListEditorBaseView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:showClear",this.updateShowClear),this.listenTo(this.model,"change:labelText",this.updateLabelText)},render:function(){return this.prerenderingActions(),this.renderTemplate(this.getTemplate()),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},getTemplate:function(){return this.template},onKeyDownControlHandler:function(e){var t=this.model.get("enabled");if(!t)return void e.preventDefault();if(!e.ctrlKey&&!e.altKey){if(this.isDropdown())return this.dropDownView.onKeyDownHandler.call(this.dropDownView,e);switch(e.which){case 40:case 13:e.preventDefault(),this.toggleDropdown()}}},onClickClearHandler:function(){var e=this.model.get("enabled");e&&(this.model.set("value",null),this.ui.control.focus())},onClickGripHandler:function(){var e=this.model.get("enabled");e&&this.toggleDropdown()},updateProperties:function(){ListEditorBaseView.prototype.updateProperties.call(this),this.updateLabelText(),this.updateShowClear()},updateGrouping:function(){this.toggleDropdown(!1)},updateLabelText:function(){var e=this.model.get("labelText");e&&""!==e?this.ui.label.toggleClass("hidden",!1):this.ui.label.toggleClass("hidden",!0),this.ui.label.text(e)},updateEnabled:function(){ListEditorBaseView.prototype.updateEnabled.call(this);var e=this.model.get("enabled");e?this.updateFocusable():this.ui.control.removeAttr("tabindex")},updateValue:function(){this.updateShowClear()},updateShowClear:function(){var e=this.model,t=e.get("showClear"),n=e.get("value"),i=null===n||"undefined"==typeof n;this.ui.clear.toggleClass("hidden",!t||i)},updateSelectedItem:function(){},updateDisabledItem:function(){this.toggleDropdown(!1)},isDropdown:function(){var e=this.model;return!!e.get("dropdown")},toggleDropdown:function(e){var t=this.model;"undefined"==typeof e&&(e=!t.get("dropdown")),t.set("dropdown",e)},onChangeValueHandler:function(){this.renderValue()},rerender:function(){},renderValue:function(){var e=this.model,t=e.get("multiSelect"),n=this.model.get("value"),i=[],o=this.model.get("valueTemplate");if(t&&Array.isArray(n)){var r=new ComboBoxValues({items:n.map(function(e,t){return{$value:o(null,{value:e,index:t}).render(),value:e,index:t}})});r.listenTo(e,"toggle",r.setFocus),this.listenTo(r,"remove",this.onRemoveValueHandler),this.listenTo(r,"search",_.debounce(this.onSearchValueHandler.bind(this),300)),i=r.render()}else i=o(null,{value:n}).render();this.ui.value.empty(),this.ui.value.append(i),editorBaseViewMixin.updateValueState.call(this)},onRemoveValueHandler:function(e){this.model.toggleValue(e,!1)},onSearchValueHandler:function(e){this.toggleDropdown(!0),this.model.set("autocompleteValue",e)},onClickValueHandler:function(e){var t=this.model.get("enabled");t&&this.toggleDropdown(!0)}});InfinniUI.ComboBoxView=ComboBoxView,_.inherit(ContextMenuControl,ContainerControl),_.extend(ContextMenuControl.prototype,{createControlModel:function(){return new ContextMenuModel},createControlView:function(e){return new ContextMenuView({model:e})}}),InfinniUI.ContextMenuControl=ContextMenuControl;var ContextMenuModel=ContainerModel.extend({});InfinniUI.ContextMenuModel=ContextMenuModel;var ContextMenuView=ContainerView.extend({contextMenuTemplate:InfinniUI.Template["controls/contextMenu/template/contextMenu.tpl.html"],updateHorizontalAlignment:function(){var e,t=this.model.get("horizontalAlignment"),n=this;this.whenReady(function(){return e=n.$el.parent().parent(),e.length>0},function(){"Right"==t?e.addClass("pull-right"):e.removeClass("pull-right")})},render:function(){var e=InfinniUI.global.messageBus,t=this;return this.prerenderingActions(),this.removeChildElements(),this.$el=this.renderDropdown(),this.bindUIElements(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),e.subscribe(messageTypes.onOpenContextMenu.name,function(e,n){t.open(n.value)}),this},renderDropdown:function(){var e=this.contextMenuTemplate,t=this.model.get("items").toArray(),n=$(e({items:t}));return this.appendItemsContent(n,t),n.on("click",function(){this.close()}.bind(this)),n.on("contextmenu",function(e){e.preventDefault()}.bind(this)),n},appendItemsContent:function(e,t){var n,i,o=this,r=this.model.get("itemTemplate");e.find(".pl-popup-button__item").each(function(e,a){i=$(a),n=r(void 0,{index:e,item:t[e]}),o.addChildElement(n),i.append(n.render())})},open:function(e){var t=this;$("body").append(this.$el);var n=this.$el.parent();this.$el.addClass("open"),n.addClass("open"),this.alignDropdown(e);var i=this.$el;new ActionOnLoseFocus(i,function(){t.close()})},close:function(){this.$el.removeClass("open"),this.$el.parent().removeClass("open"),this.$el.detach()},alignDropdown:function(e){var t=(this.model.get("horizontalAlignment"),this.$el.parent()),n={width:t.width(),height:t.height()},i={width:this.$el[0].children[0].clientWidth,height:this.$el[0].children[0].clientHeight};e.x+i.width>n.width&&(e.x-=i.width),e.y+i.height>n.height&&(e.y-=i.height),this.$el.offset({top:e.y,left:e.x})},updateGrouping:function(){},whenReady:function(e,t,n){var i=this;"undefined"==typeof n&&(n=100),e()?t():n>0&&setTimeout(function(){i.whenReady(e,t,n-1)},10)}});InfinniUI.ContextMenuView=ContextMenuView,_.inherit(DividerControl,Control),_.extend(DividerControl.prototype,{createControlModel:function(){return new DividerModel},createControlView:function(e){return new DividerView({model:e})}}),InfinniUI.DividerControl=DividerControl;var DividerModel=ControlModel.extend({initialize:function(){ControlModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.DividerModel=DividerModel;var DividerView=ControlView.extend({tagName:"hr",className:"pl-divider",initialize:function(e){ControlView.prototype.initialize.call(this,e)},render:function(){return this.prerenderingActions(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this}});InfinniUI.DividerView=DividerView;var ExtensionPanelControl=function(){_.superClass(ExtensionPanelControl,this)};_.inherit(ExtensionPanelControl,ContainerControl),_.extend(ExtensionPanelControl.prototype,{createControlModel:function(){return new ExtensionPanelModel},createControlView:function(e){return new ExtensionPanelView({model:e})}}),InfinniUI.ExtensionPanelControl=ExtensionPanelControl;var ExtensionPanelModel=ContainerModel.extend({defaults:_.defaults({extensionName:null,context:null},ContainerModel.prototype.defaults),initialize:function(){ContainerModel.prototype.initialize.apply(this)}});InfinniUI.ExtensionPanelModel=ExtensionPanelModel;var ExtensionPanelView=ContainerView.extend({className:"pl-extension-panel",initialize:function(){ContainerView.prototype.initialize.apply(this),this.extensionObject=null},render:function(){return this.prerenderingActions(),this.extensionObject||this.initExtensionObject(),
this.extensionObject.render(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},updateGrouping:function(){},initExtensionObject:function(){var e=this.model.get("extensionName"),t=this.model.get("context"),n=this.model.get("itemTemplate"),i=this.model.get("parameters"),o=this.model.get("items"),r=this.model.get("builder"),a=InfinniUI.extensionPanels.getByName(e)||window[e];if(!_.isFunction(a))throw new Error("invalid extensionPanel name");this.extensionObject=new a(t,{$el:this.$el,parameters:i,itemTemplate:n,items:o,builder:r})}});InfinniUI.ExtensionPanelView=ExtensionPanelView,_.inherit(FileBoxControl,Control),_.extend(FileBoxControl.prototype,{createControlModel:function(){return new FileBoxModel},createControlView:function(e){return new FileBoxView({model:e})}},editorBaseControlMixin),InfinniUI.FileBoxControl=FileBoxControl;var FileBoxModel=ControlModel.extend(_.extend({defaults:_.defaults({},editorBaseModelMixin.defaults_editorBaseModel,ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments),this.initialize_editorBaseModel(),this.set("acceptTypes",new Collection),this.on("change:file",this.onChangeFileHandler),this.on("change:value",function(e,t){t instanceof File&&e.set("fileName",t.name)}),this.on("invalid",function(e,t){this.set("errorText",t)})},validate:function(e,t){var n=e.file,i=this.get("maxSize"),o=this.get("acceptTypes");if(n){if(i&&n.size>i)return localized.strings.FileBox.fileSizeTooBig.replace(/\{chosen-size\}/g,(n.size/1048576).toFixed(1)).replace(/\{permitted-size\}/g,(i/1048576).toFixed(1));if(o.length){var r=o.contains(n.type),a=n.name.toLowerCase();if(!r){var l=a.length;r=o.some(function(e){return a.lastIndexOf(e.toLowerCase())===l-e.length})}if(!r)return localized.strings.FileBox.incorrectFormat}}},setFile:function(e){this.set("file",e,{validate:!0})&&this.set("errorText","")},removeFile:function(){this.setFile(null)},onChangeFileHandler:function(e,t){t?(e.set("fileName",t.name),e.set("fileSize",t.size)):(e.set("fileName",null),e.set("fileSize",null)),e.set("value",t)}},editorBaseModelMixin));InfinniUI.FileBoxModel=FileBoxModel;var FileBoxView=ControlView.extend(_.extend({},editorBaseViewMixin,{template:InfinniUI.Template["controls/fileBox/template/template.tpl.html"],className:"pl-file-box",UI:_.extend({},editorBaseViewMixin.UI,{label:".pl-control-label",btnRemove:".pl-filebox-btn-remove",btnPick:".pl-filebox-btn-pick",fileEmpty:".pl-filebox-file-empty",fileUpload:".pl-filebox-file-upload",fileDownload:".pl-filebox-file-download",fileDownloadUrl:".pl-filebox-file-download-url",edit:".pl-filebox-edit",control:".form-control",input:"input"}),events:{"change input":"onChangeFileHandler","click .pl-filebox-btn-remove":"onClickRemoveImageHandler"},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:labelText",this.updateLabelText),this.listenTo(this.model,"change:fileName",this.updateFileName),this.listenTo(this.model,"change:fileSize",this.updateFileSize),this.listenTo(this.model,"change:fileTime",this.updateFileTime),this.listenTo(this.model,"change:fileType",this.updateFileType),this.listenTo(this.model,"change:value",this.updateValue),this.listenTo(this.model,"change:hintText",this.updateHintText),this.listenTo(this.model,"change:errorText",this.updateErrorText),this.listenTo(this.model,"change:warningText",this.updateWarningText),this.listenTo(this.model,"invalid",this.onInvalidHandler);var e=this.model.get("acceptTypes");e.onChange(this.updateAcceptTypes.bind(this))},updateProperties:function(){ControlView.prototype.updateProperties.call(this),this.updateLabelText(),this.updateFileName(),this.updateFileSize(),this.updateFileType(),this.updateFileTime(),this.updateAcceptTypes(),this.updateValue(),this.updateHintText(),this.updateErrorText(),this.updateWarningText()},updateLabelText:function(){var e=this.model.get("labelText");""!=e?this.ui.label.css({display:"inline-block"}).text(e):this.ui.label.css({display:"none"})},updateAcceptTypes:function(){var e=this.model.get("acceptTypes");if(0===e.length)this.ui.input.removeAttr("accept");else{var t=e.toArray().join(",");this.ui.input.attr("accept",t)}},updateFocusable:function(){var e=this.model.get("focusable");e?this.ui.control.attr("tabindex",0):this.ui.control.removeAttr("tabindex")},updateText:function(){var e=this.model.get("text");this.ui.btnPick.attr("title",e)},updateHintText:function(){var e=this.model.get("hintText");e?this.ui.hintText.text(e).removeClass("hidden"):this.ui.hintText.text("").addClass("hidden")},updateErrorText:function(){var e=this.model.get("errorText");e?this.ui.errorText.text(e).removeClass("hidden"):this.ui.errorText.text("").addClass("hidden")},updateWarningText:function(){var e=this.model.get("warningText");e?this.ui.warningText.text(e).removeClass("hidden"):this.ui.warningText.text("").addClass("hidden")},updateEnabled:function(){ControlView.prototype.updateEnabled.call(this);var e=this.model.get("enabled");this.ui.input.prop("disabled",!e),this.ui.btnRemove.prop("disabled",!e),this.ui.btnPick.toggleClass("disabled",!e)},updateFileName:function(){var e=this.model.get("fileName");this.ui.fileUpload.text(e),this.ui.fileDownloadUrl.text(e)},updateFileSize:function(){},updateFileInfo:function(){},updateFileTime:function(){},updateFileType:function(){},updateValue:function(){var e=this.model,t=e.get("value"),n=!1,i=!1,o=!1;null===t||"undefined"==typeof t?(n=null===t||"undefined"==typeof t,this.ui.input.val(null),this.updateUrl(null)):t&&"object"==typeof t?(i=t&&"object"==typeof t,this.updateUrl(null)):(o=!0,this.updateUrl(t)),this.ui.fileEmpty.toggleClass("hidden",!n),this.ui.fileUpload.toggleClass("hidden",!i),this.ui.fileDownload.toggleClass("hidden",!o),this.ui.btnRemove.toggleClass("hidden",n),this.ui.btnPick.toggleClass("hidden",!n)},updateUrl:function(e){this.ui.fileDownloadUrl.attr("href",e);var t=null===e||"undefined"==typeof e;this.$el.toggleClass("pl-empty",t),this.updateFileInfo()},onClickRemoveImageHandler:function(){this.model.removeFile(),this.ui.input.val("")},onChangeFileHandler:function(){var e=null,t=this.ui.input[0].files;t&&t[0]&&(e=t[0]),this.model.setFile(e)},render:function(){return this.prerenderingActions(),this.renderTemplate(this.template),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},onInvalidHandler:function(){this.ui.input.val(null)}}));InfinniUI.FileBoxView=FileBoxView,_.inherit(FormControl,StackPanelControl),_.extend(FormControl.prototype,{createControlModel:function(){return new FormModel},createControlView:function(e){return new FormView({model:e})},onSubmit:function(e){this.controlView.$el.on("submit",e)},setSubmitFunction:function(e){this.controlModel.set("submitFunction",e)},getSubmitFunction:function(){return this.controlModel.get("submitFunction")},setMethod:function(e){this.controlModel.set("method",e)},getMethod:function(){return this.controlModel.get("method")},setAction:function(e){this.controlModel.set("action",e)},getAction:function(){return this.controlModel.get("action")}}),InfinniUI.FormControl=FormControl;var FormModel=StackPanelModel.extend({defaults:_.defaults({submitFunction:null,method:"",action:""},StackPanelModel.prototype.defaults)});InfinniUI.FormModel=FormModel;var FormView=StackPanelView.extend({className:"pl-form",tagName:"form",template:{plain:InfinniUI.Template["controls/form/template/form.tpl.html"]},events:{submit:"onSubmit"},onSubmit:function(e){e.preventDefault()},initialize:function(e){StackPanelView.prototype.initialize.call(this,e),this.listenTo(this.model,"change:method",this.updateMethod),this.listenTo(this.model,"change:action",this.updateAction)},updateGrouping:function(){this.strategy=new StackPanelViewPlainStrategy(this)},render:function(){this.prerenderingActions(),this.removeChildElements();var e=this.strategy.prepareItemsForRendering(),t=this.strategy.getTemplate();return this.$el.html(t(e)),this.strategy.appendItemsContent(e,".pl-form-i"),this.bindUIElements(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},updateProperties:function(){StackPanelView.prototype.updateProperties.call(this),this.updateMethod(),this.updateAction()},updateMethod:function(){var e=this.model.get("method");this.$el.attr("method",e)},updateAction:function(){var e=this.model.get("action");this.$el.attr("action",e)}});InfinniUI.FormView=FormView;var FrameControl=function(){_.superClass(FrameControl,this),this.initialize_editorBaseControl()};_.inherit(FrameControl,Control),_.extend(FrameControl.prototype,{createControlModel:function(){return new FrameModel},createControlView:function(e){return new FrameView({model:e})}},editorBaseControlMixin),InfinniUI.FrameControl=FrameControl;var FrameModel=ControlModel.extend(_.extend({defaults:_.defaults({},editorBaseModelMixin.defaults_editorBaseModel,ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments),this.initialize_editorBaseModel()}},editorBaseModelMixin));InfinniUI.FrameModel=FrameModel;var FrameView=ControlView.extend(_.extend({},editorBaseViewMixin,{className:"pl-frame",template:InfinniUI.Template["controls/frame/template/frame.tpl.html"],UI:_.extend({},editorBaseViewMixin.UI,{iframe:"iframe"}),initialize:function(){ControlView.prototype.initialize.apply(this)},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),editorBaseViewMixin.initHandlersForProperties.call(this)},updateProperties:function(){ControlView.prototype.updateProperties.call(this),editorBaseViewMixin.updateProperties.call(this)},updateValue:function(){var e=this.model.get("value");this.ui.iframe.attr("src",e)},getData:function(){return _.extend({},ControlView.prototype.getData.call(this),editorBaseViewMixin.getData.call(this),{})},render:function(){this.model;return this.prerenderingActions(),this.renderTemplate(this.template),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this}}));InfinniUI.FrameView=FrameView,_.inherit(GridPanelControl,ContainerControl),_.extend(GridPanelControl.prototype,{createControlModel:function(){return new GridPanelModel},createControlView:function(e){return new GridPanelView({model:e})}}),InfinniUI.GridPanelControl=GridPanelControl;var GridPanelModel=ContainerModel.extend({initialize:function(){ContainerModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.GridPanelModel=GridPanelModel;var GridPanelView=ContainerView.extend({className:"pl-grid-panel pl-clearfix",columnCount:12,template:{row:InfinniUI.Template["controls/gridPanel/template/row.tpl.html"]},initialize:function(e){ContainerView.prototype.initialize.call(this,e)},render:function(){return this.prerenderingActions(),this.removeChildElements(),this.renderItemsContents(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderItemsContents:function(){var e,t=this.model.get("items"),n=this.model.get("itemTemplate"),i=this,o=[],r=0;t.forEach(function(t,a){e=n(void 0,{item:t,index:a});var l=e.getColumnSpan();r+l>i.columnCount&&(i.renderRow(o),o.length=0,r=0),o.push(e),r+=l}),o.length&&i.renderRow(o)},renderRow:function(e){var t=this,n=$('<div class="pl-clearfix"></div>');n.append(e.map(function(e){return t.addChildElement(e),e.render()})),this.$el.append(n)},updateGrouping:function(){}});InfinniUI.GridPanelView=GridPanelView,_.inherit(IconControl,Control),_.extend(IconControl.prototype,{createControlModel:function(){return new IconModel},createControlView:function(e){return new IconView({model:e})}}),InfinniUI.IconControl=IconControl;var IconModel=ControlModel.extend({defaults:_.defaults({value:null,size:"",focusable:!1},ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments)}});InfinniUI.IconModel=IconModel;var IconView=ControlView.extend({className:"pl-icon fa",tagName:"i",render:function(){return this.prerenderingActions(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderIcon:function(){var e=this.model.get("value");this.switchClass("fa",e)},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:value",this.updateValue),this.listenTo(this.model,"change:size",this.updateSize)},updateSize:function(){var e=this.model.get("size");this.changeElementClass(this.valueToSizeClassName(this.currentSize),this.valueToSizeClassName(e)),this.currentSize=e},valueToSizeClassName:function(e){return e?"pl-iconSize-"+e.toLowerCase():""},updateProperties:function(){ControlView.prototype.updateProperties.call(this),this.updateValue(),this.updateSize()},updateFocusable:function(){var e=this.model.get("focusable");e?this.$el.attr("tabindex",0):this.$el.removeAttr("tabindex")},updateValue:function(){this.renderIcon()},updateTextStyle:function(){}});InfinniUI.IconView=IconView,_.inherit(ImageBoxControl,Control),_.extend(ImageBoxControl.prototype,{createControlModel:function(){return new ImageBoxModel},createControlView:function(e){return new ImageBoxView({model:e})}},editorBaseControlMixin),InfinniUI.ImageBoxControl=ImageBoxControl;var ImageBoxModel=ControlModel.extend(_.extend({defaults:_.defaults({text:localized.strings.ImageBox.chooseImage,currentWideSide:null},editorBaseModelMixin.defaults_editorBaseModel,ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments),this.initialize_editorBaseModel(),this.set("acceptTypes",new Collection),this.on("invalid",function(e,t){this.set("errorText",t)})},validate:function(e,t){var n=e.file,i=this.get("maxSize"),o=this.get("acceptTypes");if(n){if(i&&n.size>i)return localized.strings.ImageBox.imageSizeTooBig.replace(/\{chosen-size\}/g,(n.size/1048576).toFixed(1)).replace(/\{permitted-size\}/g,(i/1048576).toFixed(1));if(o.length&&!o.contains(n.type))return localized.strings.ImageBox.incorrectFormat}},setFile:function(e){this.set("file",e,{validate:!0})&&this.set("errorText","")},removeFile:function(){this.setFile(null)}},editorBaseModelMixin));InfinniUI.ImageBoxModel=ImageBoxModel;var ImageBoxView=ControlView.extend(_.extend({},editorBaseViewMixin,exifRotate,{className:"pl-imagebox",template:InfinniUI.Template["controls/imageBox/template/imageBox.tpl.html"],UI:_.extend({},editorBaseViewMixin.UI,{input:"input",img:"img",file:".pl-image-file",remove:".pl-image-remove",uploadButton:".pl-image-file-upload-button"}),events:{"change input":"onChangeFileHandler","click .pl-image-remove":"onClickRemoveImageHandler"},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:value",this.updateValue),this.listenTo(this.model,"change:hintText",this.updateHintText),this.listenTo(this.model,"change:errorText",this.updateErrorText),this.listenTo(this.model,"change:warningText",this.updateWarningText)},updateProperties:function(){ControlView.prototype.updateProperties.call(this),this.updateValue(),this.updateHintText(),this.updateErrorText(),this.updateWarningText()},updateFocusable:function(){var e=this.model.get("focusable");e?this.ui.file.attr("tabindex",0):this.ui.file.removeAttr("tabindex")},updateText:function(){var e=this.model.get("text");this.ui.uploadButton.text(e)},updateEnabled:function(){ControlView.prototype.updateEnabled.call(this);var e=this.model.get("enabled");this.ui.input.prop("disabled",!e)},updateValue:function(){var e=this,t=this.model,n=t.get("value");if(n&&"object"==typeof n){this.stopLoadingFile();var i=this.loadPreview(n);this.fileLoader=i,i.then(function(t,n){e.updateUrl(n)}.bind(this),function(e){console.log(e)})}else this.updateUrl(n)},rotate:function(e){this.ui.img.css("transform",this.rotation[e])},updateUrl:function(e){var t=this;this.ui.img.get(0).onload=function(){t.updateRotation(function(){t.setPerfectPosition()})},this.ui.img.attr("src",e);var n=null===e||"undefined"==typeof e;this.$el.toggleClass("pl-empty",n)},updateRotation:function(e){var t=this,n=this.model.get("file");n?this.orientation(n,function(n,i){t.rotate(i),e()}):(this.rotate(1),e())},setPerfectPosition:function(){var e=this.ui.img,t=e.get(0).naturalWidth,n=e.get(0).naturalHeight,i="limit-width",o=this.model.get("currentWideSide");t>=n&&(i="limit-height"),this.$el.removeClass(o),this.$el.addClass(i),this.model.set("currentWideSide",i)},stopLoadingFile:function(){var e=this.fileLoader;e&&"pending"===e.state()&&e.reject()},loadPreview:function(e){var t=$.Deferred(),n=new FileReader;return n.onload=function(e){return function(n){t.resolve(e,n.target.result)}}(e),n.onerror=function(e){t.reject(e)},n.readAsDataURL(e),t.promise()},onClickRemoveImageHandler:function(){this.model.removeFile(),this.ui.input.val("")},onChangeFileHandler:function(){var e=null,t=this.ui.input[0].files;t&&t[0]&&(e=t[0]),this.model.setFile(e)},render:function(){return this.prerenderingActions(),this.renderTemplate(this.template),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this}}));InfinniUI.ImageBoxView=ImageBoxView,_.inherit(IndeterminateCheckBoxControl,CheckBoxControl),_.extend(IndeterminateCheckBoxControl.prototype,{createControlModel:function(){return new IndeterminateCheckBoxModel},createControlView:function(e){return new IndeterminateCheckBoxView({model:e})}},editorBaseControlMixin),InfinniUI.IndeterminateCheckBoxControl=IndeterminateCheckBoxControl;var IndeterminateCheckBoxModel=CheckBoxModel.extend({defaults:_.defaults({value:"unchecked"},CheckBoxModel.prototype.defaults)});InfinniUI.IndeterminateCheckBoxModel=IndeterminateCheckBoxModel;var IndeterminateCheckBoxView=CheckBoxView.extend({className:"pl-indeterminate-checkbox",onClickHandler:function(){var e=this.model,t=e.get("enabled");if(t){var n=e.get("value");n="indeterminate"===n?"unchecked":"unchecked"===n?"checked":"unchecked",e.set("value",n)}},updateValue:function(){var e=this.model.get("value");"checked"===e?(this.ui.input.prop("indeterminate",!1),this.ui.input.prop("checked",!0)):"unchecked"===e?(this.ui.input.prop("indeterminate",!1),this.ui.input.prop("checked",!1)):"indeterminate"===e&&(this.ui.input.prop("checked",!1),this.ui.input.prop("indeterminate",!0))}});InfinniUI.IndeterminateCheckBoxView=IndeterminateCheckBoxView,_.inherit(LinkElementControl,ButtonControl),_.extend(LinkElementControl.prototype,{createControlModel:function(){return new LinkElementModel},createControlView:function(e){return new LinkElementView({model:e})}}),InfinniUI.LinkElementControl=LinkElementControl;var LinkElementModel=ButtonModel.extend({defaults:_.defaults({href:"javascript:;",target:"self"},ButtonModel.prototype.defaults),initialize:function(){ButtonModel.prototype.initialize.apply(this,arguments)}});InfinniUI.LinkElementModel=LinkElementModel;var LinkElementView=CommonButtonView.extend({tagName:"a",className:"pl-link",events:{click:"onClickHandler"},template:function(){return""},updateProperties:function(){CommonButtonView.prototype.updateProperties.call(this),this.updateHref(),this.updateTarget()},getButtonElement:function(){return this.$el},initHandlersForProperties:function(){CommonButtonView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:href",this.updateHref),this.listenTo(this.model,"change:target",this.updateTarget)},updateHref:function(){var e=this.model.get("href"),t=this.getButtonElement();t.attr("href",e)},updateTarget:function(){var e=this.model.get("target"),t=this.getButtonElement();t.attr("target","_"+e)},onClickHandler:function(e){var t=this.model.get("href");t.indexOf("http://")===-1&&(InfinniUI.AppRouter.navigate(t,{trigger:!0}),2!==e.which&&e.preventDefault())}});InfinniUI.LinkElementView=LinkElementView,function(){var e=InfinniUI.Template["controls/loaderIndicator/template.tpl.html"];InfinniUI.loaderIndicator={show:function(){$.blockUI({message:$(e()),ignoreIfBlocked:!0,baseZ:99999})},hide:function(){$.unblockUI()}},InfinniUI.config.useLoaderIndicator&&jQuery(function(){var t=$(e());$("body").append(t),$.blockUI.defaults.css={},$(document).ajaxStart(function(){$.blockUI({message:t,ignoreIfBlocked:!0,baseZ:99999})}).ajaxStop(function(){$.unblockUI()}).ajaxError(function(){$.unblockUI()})})}(),_.inherit(MenuBarControl,ContainerControl),_.extend(MenuBarControl.prototype,{createControlModel:function(){return new MenuBarModel},createControlView:function(e){return new MenuBarView({model:e})}}),InfinniUI.MenuBarControl=MenuBarControl;var MenuBarModel=ContainerModel.extend({initialize:function(){ContainerModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.MenuBarModel=MenuBarModel;var MenuBarView=ContainerView.extend({tagName:"nav",className:"pl-menu-bar navbar navbar-default",template:InfinniUI.Template["controls/menuBar/template/menuBar.tpl.html"],UI:{},render:function(){return this.prerenderingActions(),this.removeChildElements(),this.$el.html(this.template({items:this.model.get("items")})),this.renderItemsContents(),this.bindUIElements(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderItemsContents:function(){var e,t,n=this.$el.find(".pl-menu-bar-item"),i=this.model.get("items"),o=this.model.get("itemTemplate"),r=this;n.each(function(n,a){t=i.getByIndex(n),e=o(void 0,{item:t,index:n}),r.addChildElement(e),$(a).append(e.render())})},updateGrouping:function(){}});InfinniUI.MenuBarView=MenuBarView,_.inherit(NumericBoxControl,TextEditorBaseControl),_.extend(NumericBoxControl.prototype,{createControlModel:function(){return new NumericBoxModel},createControlView:function(e){return new NumericBoxView({model:e})}}),InfinniUI.NumericBoxControl=NumericBoxControl;var NumericBoxModel=TextEditorBaseModel.extend({defaults:_.defaults({increment:1,inputType:"number"},TextEditorBaseModel.prototype.defaults),incValue:function(){var e=this.get("increment");this.addToValue(e)},decValue:function(){var e=this.get("increment");this.addToValue(-e)},transformValue:function(e){return"string"==typeof e?+e:e},addToValue:function(e){var t=this.get("value"),n=this.get("startValue"),i=this.get("minValue"),o=this.get("maxValue"),r="number"==typeof t?t:+t;this.isSetValue(t)&&"number"==typeof t?r+=e:r="number"==typeof n?n:0,"number"==typeof i&&r<i?r=i:"number"==typeof o&&r>o&&(r=o),this.set("value",r)},initialize:function(){TextEditorBaseModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))},validate:function(e){var t,n=e.value,i=e.minValue,o=e.maxValue;return null!==n&&"undefined"!=typeof n&&("number"==typeof i&&"number"==typeof o?(n<i||n>o)&&(t="Значение должно быть в диапазоне от "+i+" до "+o+"."):"number"==typeof i&&n<i?t="Значение должно быть не меньше "+i+".":"number"==typeof o&&n>o&&(t="Значение должно быть не больше "+o+".")),t}});InfinniUI.NumericBoxModel=NumericBoxModel;var NumericBoxView=TextEditorBaseView.extend({className:"pl-numericbox form-group",template:InfinniUI.Template["controls/numericBox/template/numericBox.tpl.html"],UI:_.extend({},TextEditorBaseView.prototype.UI,{min:".pl-numeric-box-min",max:".pl-numeric-box-max"}),events:_.extend({},TextEditorBaseView.prototype.events,{"click .pl-numeric-box-min":"onClickMinControlHandler","click .pl-numeric-box-max":"onClickMaxControlHandler","mousedown .pl-numeric-box-min":"onMousedownMinControlHandler","mousedown .pl-numeric-box-max":"onMousedownMaxControlHandler"}),editMaskStrategies:{NumberEditMask:"default"},render:function(){return this.prerenderingActions(),this.renderTemplate(this.template),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},getData:function(){var e=this.model;return _.extend({},TextEditorBaseView.prototype.getData.call(this),{minValue:e.get("minValue"),maxValue:e.get("maxValue"),increment:e.get("increment")})},onChangeEnabledHandler:function(e,t){this.ui.control.prop("disabled",!t),this.ui.min.prop("disabled",!t),this.ui.max.prop("disabled",!t)},onClickMinControlHandler:function(){this.canChangeValue()&&this.model.decValue()},onClickMaxControlHandler:function(){this.canChangeValue()&&this.model.incValue()},onMousedownMinControlHandler:function(e){this.canChangeValue()&&this.repeatUpdateValue(this.model.decValue.bind(this.model))},onMousedownMaxControlHandler:function(e){this.canChangeValue()&&this.repeatUpdateValue(this.model.incValue.bind(this.model))},repeatUpdateValue:function(e){function t(){n&&(clearInterval(n),n=null),window.document.removeEventListener("mouseup",t)}var n;window.document.addEventListener("mouseup",t),n=setInterval(e,200)},canChangeValue:function(){var e=this.model,t=e.get("enabled");return t===!0}});InfinniUI.NumericBoxView=NumericBoxView,_.inherit(PanelControl,ContainerControl),_.extend(PanelControl.prototype,{createControlModel:function(){return new PanelModel},createControlView:function(e){return new PanelView({model:e})}}),InfinniUI.PanelControl=PanelControl;var PanelModel=ContainerModel.extend({initialize:function(){ContainerModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments)),this.on("change:collapsed",function(e,t){e.trigger(t?"collapsed":"expanded",null,{})})},defaults:_.defaults({collapsible:!1,collapsed:!1,collapseChanger:""},ContainerModel.prototype.defaults),set:function(e,t,n){if(null===e||"undefined"==typeof e)return this;var i;"object"==typeof e?(i=e,n=t):(i={})[e]=t;var o,r;if("collapsed"in i){o=this.get("collapsed"),r=i.collapsed;var a;r&&!o?a=this.set("_collapsing",!0,{validate:!1}).trigger("collapsing",null,{}).get("_collapsing"):!r&&o&&(a=this.set("_expanding",!0,{validate:!1}).trigger("expanding",null,{}).get("_expanding")),a===!1&&delete i.collapsed}return ContainerModel.prototype.set.call(this,i,n)},on:function(e,t,n){var i,o=this;switch(e){case"collapsing":i=function(){var e=t(null,{});e===!1&&o.set("_collapsing",!1)};break;case"expanding":i=function(){var e=t(null,{});e===!1&&o.set("_expanding",!1)};break;default:i=t}ContainerModel.prototype.on.call(this,e,i,n)}});InfinniUI.PanelModel=PanelModel;var PanelView=ContainerView.extend({className:"pl-panel panel panel-default",template:InfinniUI.Template["controls/panel/template/panel.tpl.html"],UI:{header:".pl-panel-header",items:".panel-items"},events:{"click >.pl-panel-header":"onClickHeaderHandler"},initialize:function(e){ContainerView.prototype.initialize.call(this,e)},render:function(){return this.prerenderingActions(),this.removeChildElements(),this.$el.html(this.template({items:this.model.get("items")})),this.bindUIElements(),this.renderItemsContents(),this.trigger("render"),this.updateProperties(),this.postrenderingActions(),this},initHandlersForProperties:function(){ContainerView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:collapsed",this.updateCollapsed),this.listenTo(this.model,"change:collapsible",this.updateCollapsible),this.listenTo(this.model,"change:header",this.updateHeader),this.listenTo(this.model,"change:headerTemplate",this.updateHeader)},updateProperties:function(){ContainerView.prototype.updateProperties.call(this),this.updateCollapsed(),this.updateCollapsible(),this.updateHeader()},updateCollapsed:function(){this.ui.header.toggleClass("pl-collapsed",this.model.get("collapsed"))},updateCollapsible:function(e,t){this.ui.header.toggleClass("pl-collapsible",this.model.get("collapsible"))},updateHeader:function(){var e=this.model;this.ui.header.empty();var t=e.get("headerTemplate");if("function"==typeof t){var n=e.get("header"),i=t(null,{value:n}).render();this.ui.header.show(),this.ui.header.append(i)}else this.ui.header.hide()},renderItemsContents:function(){var e,t,n=this.$el.find(".pl-panel-i"),i=this.model.get("items"),o=this.model.get("itemTemplate"),r=this;n.each(function(n,a){t=i.getByIndex(n),e=o(void 0,{item:t,index:n}),r.addChildElement(e),$(a).append(e.render())})},updateGrouping:function(){},onEventCallback:function(){var e=this.model.get("collapsible");if(e){var t=this.model.get("collapsed");this.model.set("collapsed",!t),this.updateLayout()}},onClickHeaderHandler:function(e){var t=this.model.get("collapseChanger");""!==t?$(e.target).closest("[data-pl-name="+t+"]").length&&this.onEventCallback():this.onEventCallback()}});InfinniUI.PanelView=PanelView;var PasswordBoxControl=function(){_.superClass(PasswordBoxControl,this),this.initialize_editorBaseControl()};_.inherit(PasswordBoxControl,Control),_.extend(PasswordBoxControl.prototype,{createControlModel:function(){return new PasswordBoxModel},createControlView:function(e){return new PasswordBoxView({model:e})}},editorBaseControlMixin),InfinniUI.PasswordBoxControl=PasswordBoxControl;var PasswordBoxModel=ControlModel.extend(_.extend({defaults:_.defaults({autocomplete:!0},editorBaseModelMixin.defaults_editorBaseModel,ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments),this.initialize_editorBaseModel()}},editorBaseModelMixin));InfinniUI.PasswordBoxModel=PasswordBoxModel;var PasswordBoxView=ControlView.extend(_.extend({},editorBaseViewMixin,{className:"pl-password-box form-group",template:{autocomplete:InfinniUI.Template["controls/passwordBox/template/passwordBox.on.tpl.html"],noautocomplete:InfinniUI.Template["controls/passwordBox/template/passwordBox.off.tpl.html"]},UI:_.extend({},editorBaseViewMixin.UI,{label:".pl-control-label",input:".pl-control"}),events:{"blur .pl-control":"onBlurHandler","input .pl-control":"onInputHandler","change .pl-control":"onChangeHandler"},initialize:function(){ControlView.prototype.initialize.apply(this)},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),editorBaseViewMixin.initHandlersForProperties.call(this),this.listenTo(this.model,"change:labelText",this.updateLabelText),this.listenTo(this.model,"change:labelFloating",this.updateLabelFloating),this.listenTo(this.model,"change:autocomplete",this.updateAutocomplete)},updateProperties:function(){ControlView.prototype.updateProperties.call(this),editorBaseViewMixin.updateProperties.call(this),this.updateLabelText()},updateLabelText:function(){var e=this.model.get("labelText");this.ui.label.text(e)},updateAutocomplete:function(){this.rerender()},updateValue:function(){editorBaseViewMixin.updateValueState.call(this);var e=this.model.get("value");this.ui.input.val(e)},updateEnabled:function(){ControlView.prototype.updateEnabled.call(this);var e=this.model.get("enabled");this.ui.input.prop("disabled",!e)},getData:function(){return _.extend({},ControlView.prototype.getData.call(this),editorBaseViewMixin.getData.call(this))},render:function(){this.model;return this.prerenderingActions(),this.renderTemplate(this.getTemplate()),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},remove:function(){ControlView.prototype.remove.call(this)},getTemplate:function(){var e=this.model;return e.get("autocomplete")?this.template.autocomplete:this.template.noautocomplete},updateModelValue:function(){var e=this.ui.input.val(),t=this.model;t.set("value",e),t.set("rawValue",e)},onBlurHandler:function(){this.updateModelValue()},onChangeHandler:function(){this.updateModelValue()},onInputHandler:function(){this.updateModelValue()}}));InfinniUI.PasswordBoxView=PasswordBoxView,_.inherit(ScrollPanelControl,ContainerControl),_.extend(ScrollPanelControl.prototype,{createControlModel:function(){return new ScrollPanelModel},createControlView:function(e){return new ScrollPanelView({model:e})}}),InfinniUI.ScrollPanelControl=ScrollPanelControl;var ScrollPanelModel=ContainerModel.extend({defaults:_.defaults({horizontalScroll:InfinniUI.ScrollVisibility.auto,verticalScroll:InfinniUI.ScrollVisibility.auto},ContainerModel.prototype.defaults),initialize:function(){ContainerModel.prototype.initialize.apply(this,Array.prototype.slice.call(arguments))}});InfinniUI.ScrollPanelModel=ScrollPanelModel;var ScrollPanelView=ContainerView.extend({className:"pl-scrollpanel panel panel-default",
template:InfinniUI.Template["controls/scrollPanel/template/scrollPanel.tpl.html"],UI:{},initialize:function(e){ContainerView.prototype.initialize.call(this,e)},render:function(){return this.prerenderingActions(),this.removeChildElements(),this.$el.html(this.template({items:this.model.get("items")})),this.renderItemsContents(),this.bindUIElements(),this.postrenderingActions(),this.trigger("render"),this.updateProperties(),function(e){setTimeout(function(){e.scrollTop(0)},0)}(this.$el),this},initHandlersForProperties:function(){ContainerView.prototype.initHandlersForProperties.call(this),this.listenTo(this.model,"change:horizontalScroll",this.updateHorizontalScroll),this.listenTo(this.model,"change:verticalScroll",this.updateVerticalScroll)},updateProperties:function(){ContainerView.prototype.updateProperties.call(this),this.updateHorizontalScroll(),this.initVerticalScroll()},updateHorizontalScroll:function(){var e="";switch(this.model.get("horizontalScroll")){case InfinniUI.ScrollVisibility.visible:e="visible";break;case InfinniUI.ScrollVisibility.hidden:e="hidden";break;case InfinniUI.ScrollVisibility.auto:default:e="auto"}this.switchClass("pl-horizontal-scroll",e,this.$el)},initVerticalScroll:function(){var e=this.model.get("verticalScroll");e!==InfinniUI.ScrollVisibility.hidden&&this.$el.addClass("pl-adaptable-by-height"),this.switchClass("pl-vertical-scroll",e.toLowerCase(),this.$el)},updateVerticalScroll:function(){this.$el.height(""),this.$el.removeClass("pl-adaptable-by-height"),this.initVerticalScroll();var e=this.$el.closest(".pl-view");InfinniUI.AutoHeightService.recalculation(e)},renderItemsContents:function(){var e,t,n=this.$el.find(".pl-scrollpanel-i"),i=this.model.get("items"),o=this.model.get("itemTemplate"),r=this;n.each(function(n,a){t=i.getByIndex(n),e=o(void 0,{item:t,index:n}),r.addChildElement(e),$(a).append(e.render())})},updateGrouping:function(){}});InfinniUI.ScrollPanelView=ScrollPanelView,_.inherit(ToggleButtonControl,Control),_.extend(ToggleButtonControl.prototype,{createControlModel:function(){return new ToggleButtonModel},createControlView:function(e){return new ToggleButtonView({model:e})}},editorBaseControlMixin),InfinniUI.ToggleButtonControl=ToggleButtonControl;var ToggleButtonModel=ControlModel.extend(_.extend({defaults:_.defaults({value:!1,textOn:"ON",textOff:"OFF",horizontalAlignment:"Left"},ControlModel.prototype.defaults),initialize:function(){ControlModel.prototype.initialize.apply(this,arguments),this.initialize_editorBaseModel()}},editorBaseModelMixin));InfinniUI.ToggleButtonModel=ToggleButtonModel;var ToggleButtonView=ControlView.extend(_.extend({},editorBaseViewMixin,{template:InfinniUI.Template["controls/toggleButton/template/toggleButton.tpl.html"],UI:_.extend({},editorBaseViewMixin.UI,{textOn:".togglebutton-handle-on",textOff:".togglebutton-handle-off",container:".togglebutton-container"}),events:{"click .togglebutton-box":"onClickHandler"},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.call(this),editorBaseViewMixin.initHandlersForProperties.call(this),this.listenTo(this.model,"change:textOn",this.updateTextOn),this.listenTo(this.model,"change:textOff",this.updateTextOff)},updateProperties:function(){ControlView.prototype.updateProperties.call(this),editorBaseViewMixin.updateProperties.call(this),this.updateTextOn(),this.updateTextOff()},updateFocusable:function(){var e=this.model.get("focusable");e?this.ui.container.attr("tabindex",0):this.ui.container.removeAttr("tabindex")},updateTextOn:function(){var e=this.model.get("textOn");this.ui.textOn.html(e||"&nbsp;")},updateTextOff:function(){var e=this.model.get("textOff");this.ui.textOff.html(e||"&nbsp;")},render:function(){return this.prerenderingActions(),this.renderTemplate(this.template),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},getData:function(){var e=this.model;return _.extend({},ControlView.prototype.getData.call(this),editorBaseViewMixin.getData.call(this),{textOn:e.get("textOn"),textOff:e.get("textOff")})},onClickHandler:function(e){var t=this.model;t.set("value",!t.get("value"))},updateValue:function(){var e=this.model.get("value");this.switchClass("toggle",e?"on":"off",this.$el)}}));InfinniUI.ToggleButtonView=ToggleButtonView,_.inherit(ToolBarControl,ContainerControl),_.extend(ToolBarControl.prototype,{createControlModel:function(){return new ToolBarModel},createControlView:function(e){return new ToolBarView({model:e})}}),InfinniUI.ToolBarControl=ToolBarControl;var ToolBarModel=ContainerModel.extend({});InfinniUI.ToolBarModel=ToolBarModel;var ToolBarView=ContainerView.extend({className:"pl-tool-bar",template:InfinniUI.Template["controls/toolBar/template/toolBar.tpl.html"],itemTemplate:InfinniUI.Template["controls/toolBar/template/toolBarItem.tpl.html"],UI:{container:".pl-tool-bar__container"},render:function(){return this.prerenderingActions(),this.renderTemplate(this.template),this.ui.container.append(this.renderItems()),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderItems:function(){var e=this.model,t=e.get("items"),n=e.get("itemTemplate");this.removeChildElements();var i=[];return t.forEach(function(e,t){var o=this.itemTemplate(),r=$(o),a=n(null,{index:t,item:e});this.addChildElement(a),r.append(a.render()),i.push(r)},this),i},updateGrouping:function(){}});InfinniUI.ToolBarView=ToolBarView;var TooltipControl=function(){_.superClass(TooltipControl,this)};_.inherit(TooltipControl,Control),_.extend(TooltipControl.prototype,{createControlModel:function(){return new TooltipModel},createControlView:function(e){return new TooltipView({model:e})}}),InfinniUI.TooltipControl=TooltipControl;var TooltipModel=ControlModel.extend({});InfinniUI.TooltipModel=TooltipModel;var TooltipView=ControlView.extend({render:function(){return this.prerenderingActions(),this.renderContent(),this.trigger("render"),this.postrenderingActions(),this},initHandlersForProperties:function(){ControlView.prototype.initHandlersForProperties.apply(this,Array.prototype.slice.call(arguments)),this.listenTo(this.model,"change:content",this.updateContent)},updateContent:function(){this.renderContent()},renderContent:function(){var e=this.model,t=e.get("content");this.$el.html(t.render())}});InfinniUI.TooltipView=TooltipView,_.inherit(ViewControl,ContainerControl),_.extend(ViewControl.prototype,{createControlModel:function(){return new ViewModel},createControlView:function(e){return new ViewView({model:e})}}),InfinniUI.ViewControl=ViewControl;var DialogResult={none:0,accepted:1,canceled:2};InfinniUI.DialogResult=DialogResult;var ViewModel=ContainerModel.extend({defaults:_.defaults({dialogResult:DialogResult.none,isApplication:!1,closeButtonVisibility:!0},ContainerModel.prototype.defaults),initialize:function(){ContainerModel.prototype.initialize.apply(this),this.set("scripts",new Collection([],"name")),this.set("parameters",new Collection([],"name")),this.set("dataSources",new Collection([],"name"))}});InfinniUI.ViewModel=ViewModel;var ViewView=ContainerView.extend({className:"pl-view",initialize:function(e){ContainerView.prototype.initialize.call(this,e)},render:function(){return this.prerenderingActions(),this.$el.empty(),this.renderItemsContents(),this.updateProperties(),this.trigger("render"),this.postrenderingActions(),this},renderItemsContents:function(){var e,t=this,n=this.model.get("items"),i=this.model.get("itemTemplate");n.forEach(function(n,o){e=i(void 0,{item:n,index:o}),e&&t.$el.append(e.render())})},updateGrouping:function(){}});InfinniUI.ViewView=ViewView;var ViewPanelControl=function(){_.superClass(ViewPanelControl,this)};_.inherit(ViewPanelControl,Control),ViewPanelControl.prototype.createControlModel=function(){return new ViewPanelModel},ViewPanelControl.prototype.createControlView=function(e){return new ViewPanelView({model:e})},InfinniUI.ViewPanelControl=ViewPanelControl;var ViewPanelModel=ControlModel.extend({defaults:_.defaults({layout:null},ControlModel.prototype.defaults),initialize:function(){var e=this;ControlModel.prototype.initialize.apply(this),this.once("change:layout",function(t,n){n&&n.onLoaded&&e.subscribeOnLoaded()})},subscribeOnLoaded:function(){var e=this,t=this.get("layout");t.onLoaded(function(){e.set("isLoaded",!0)})}});InfinniUI.ViewPanelModel=ViewPanelModel;var ViewPanelView=ControlView.extend({className:"pl-view-panel",initialize:function(){ControlView.prototype.initialize.apply(this),this.listenTo(this.model,"change:layout",this.onChangeLayoutHandler)},onChangeLayoutHandler:function(e,t){this.$el.empty(),t&&this.$el.append(t.render())},render:function(){this.prerenderingActions();var e=this.model.get("layout");return e&&this.$el.append(e.render()),this.updateProperties(),this.trigger("render"),this.postrenderingActions(!1),this}});InfinniUI.ViewPanelView=ViewPanelView,InfinniUI.extensionPanels=new ExtensionPanelsRegister;var dataSourceValidationNotifierMixin={initNotifyValidation:function(e){e.onErrorValidator(this.notifyOnValidationError.bind(this))},notifyOnValidationError:function(e,t){var n=t.value;"undefined"!=typeof n&&null!==n&&!n.IsValid&&Array.isArray(n.Items)&&n.Items.forEach(function(e){var t=InfinniUI.global.messageBus;t.send(messageTypes.onNotifyUser,{item:e,messageText:e.Message,messageType:"error"})})}};InfinniUI.dataSourceValidationNotifierMixin=dataSourceValidationNotifierMixin;var BaseDataSource=Backbone.Model.extend({defaults:{name:null,idProperty:"_id",identifyingMode:"byId",view:null,isDataReady:!1,dataProvider:null,model:null,modifiedItems:{},itemsById:{},fillCreatedItem:!0,suspendingList:null,waitingOnUpdateItemsHandlers:null,errorValidator:null,isRequestInProcess:!1,isLazy:!0,isWaiting:!1,resolvePriority:0,newItemsHandler:null,isNumRegEx:/^\d/},initialize:function(){var e=this.get("view"),t={items:null,selectedItem:null};if(this.initDataProvider(),!e)throw new Error("BaseDataSource.initialize: При создании объекта не была задана view.");this.set("suspendingList",[]),this.set("waitingOnUpdateItemsHandlers",[]),this.set("model",new TreeModel(e.getContext(),this,t)),_.extend(this,BaseDataSource.identifyingStrategy.byId)},initDataProvider:function(){throw new Error("BaseDataSource.initDataProvider В потомке BaseDataSource не задан провайдер данных.")},getSearch:function(){return this.get("model").getProperty("search")},setSearch:function(e){this.get("model").setProperty("search",e)},getFilter:function(){return this.get("model").getProperty("filter")},setFilter:function(e){this.get("model").setProperty("filter",e)},getFilterParams:function(e){return e=0===arguments.length?"filterParams":""==e?"filterParams":"filterParams."+e,this.get("model").getProperty(e)},setFilterParams:function(e,t){1===arguments.length?(t=e,e="filterParams"):e=""==e?"filterParams":"filterParams."+e,this.get("model").setProperty(e,t)},onPropertyChanged:function(e,t,n){return"function"==typeof e&&(n=t,t=e,e="*"),e="."==e.charAt(0)?e.substr(1):""==e?"items":"items."+e,this.get("model").onPropertyChanged(e,function(e,n){var i=n.property;i="items."===i.substr(0,6)?i.substr(6):"items"===i?"":"."+i,n.property=i,t(e,n)},n)},offPropertyChanged:function(e,t){e="."===e.charAt(0)?e.substr(1):""==e?"items":"items."+e,this.get("model").offPropertyChanged(e,t)},remove:function(){this.off(),this.clear()},onSelectedItemChanged:function(e,t){var n=this;this.get("model").onPropertyChanged("selectedItem",function(t,i){var o=n._getArgumentTemplate();o.value=i.newValue,e(t,o)},t)},onErrorValidator:function(e,t){this.on("onErrorValidator",e,t)},offErrorValidator:function(e){this.off(null,null,e)},onItemSaved:function(e){this.on("onItemSaved",e)},onItemCreated:function(e){this.on("onItemCreated",e)},onItemsUpdated:function(e){this.on("onItemsUpdated",e)},onItemsUpdatedOnce:function(e){this.once("onItemsUpdated",e)},onItemDeleted:function(e){this.on("onItemDeleted",e)},onProviderError:function(e){this.off("onProviderError"),this.on("onProviderError",e),this.onProviderErrorHandler=e},getName:function(){return this.get("name")},setName:function(e){this.set("name",e),this.name=e},getView:function(){return this.get("view")},getProperty:function(e){var t,n=e.charAt(0);if(this.get("isNumRegEx").test(n))e="items."+e;else if(""==n)e="items";else if("$"===n){if(t=this._indexOfSelectedItem(),t==-1)return;e="items."+t+e.substr(1)}else if("."===n)e=e.substr(1);else{if(t=this._indexOfSelectedItem(),t==-1)return;e="items."+t+"."+e}return this.get("model").getProperty(e)},setProperty:function(e,t){var n,i,o,r=e.split(".");if("$"===r[0]){if(i=this._indexOfSelectedItem(),i===-1)return;e=i+e.substr(1),r[0]=i.toString()}if(n=e.charAt(0),1===r.length)if(""===r[0])this._setItems(t);else if(this.get("isNumRegEx").test(r[0]))this._changeItem(r[0],t);else{if(i=this._indexOfSelectedItem(),i===-1)return;e="items."+i+"."+e,o=this.get("model").setProperty(e,t),o&&this._includeItemToModifiedSetByIndex(i)}else if("."===n)e=e.substr(1),this.get("model").setProperty(e,t);else if(this.get("isNumRegEx").test(n))e="items."+e,o=this.get("model").setProperty(e,t),o&&this._includeItemToModifiedSetByIndex(parseInt(r[0]));else{if(i=this._indexOfSelectedItem(),i===-1)return;e="items."+i+"."+e,o=this.get("model").setProperty(e,t),o&&this._includeItemToModifiedSetByIndex(i)}},_setItems:function(e){this._detectIdentifyingMode(e);var t;this.set("isDataReady",!0),this.get("model").setProperty("items",e),this._clearModifiedSet(),e&&e.length>0?(t=this._indexItemsById(e),this.set("itemsById",t),this._restoreSelectedItem()||this.setSelectedItem(e[0])):this.setSelectedItem(null)},_restoreSelectedItem:function(){var e=InfinniUI.global.logger;e.warn({message:"BaseDataSource._restoreSelectedItem: not overrided by strategy",source:this})},getSelectedItem:function(){return this.get("model").getProperty("selectedItem")},setSelectedItem:function(e,t,n){var i=InfinniUI.global.logger;i.warn({message:"BaseDataSource.setSelectedItem: not overrided by strategy",source:this})},_notifyAboutSelectedItem:function(e,t){var n=this.getContext(),i=this._getArgumentTemplate();i.value=e,t&&t(n,i)},_tuneMirroringOfModel:function(e){e!==-1?this.get("model").setMirroring("items.$","items."+e):this.get("model").setMirroring(null,null)},getIdProperty:function(){return this.get("idProperty")},setIdProperty:function(e){this.set("idProperty",e)},getFillCreatedItem:function(){return this.get("fillCreatedItem")},setFillCreatedItem:function(e){this.set("fillCreatedItem",e)},suspendUpdate:function(e){var t=e||"default",n=this.get("suspendingList");n.indexOf(t)===-1&&(n=n.slice(0),n.push(t),this.set("suspendingList",n))},resumeUpdate:function(e){var t=e||"default",n=this.get("suspendingList"),i=n.indexOf(t);i!==-1&&(n=n.slice(0),n.splice(i,1),this.set("suspendingList",n),!this.isUpdateSuspended()&&this.get("waitingOnUpdateItemsHandlers").length>0&&this.updateItems())},isUpdateSuspended:function(){var e=this.get("suspendingList");return e.length>0},isModifiedItems:function(){return this.isModified()},isModified:function(e){if(0===arguments.length)return _.size(this.get("modifiedItems"))>0;if(null===e||"undefined"==typeof e)return!1;var t=this.idOfItem(e);return t in this.get("modifiedItems")},_includeItemToModifiedSetByIndex:function(e){var t;t=this.getItems()[e],this._includeItemToModifiedSet(t)},_includeItemToModifiedSet:function(e){var t=InfinniUI.global.logger;t.warn({message:"BaseDataSource._includeItemToModifiedSet: not overrided by strategy",source:this})},_excludeItemFromModifiedSet:function(e){var t=InfinniUI.global.logger;t.warn({message:"BaseDataSource._excludeItemFromModifiedSet: not overrided by strategy",source:this})},_clearModifiedSet:function(){this.set("modifiedItems",{})},_checkPropertyName:function(e){var t=!0;try{if(e&&e.length>0&&(t=e.match(/^[\$#@\d]+/)),!t)throw new Error('Wrong property name "'+e+'"')}catch(n){console.debug(n)}},_changeItem:function(e,t){var n=this.get("model").getProperty("items."+e),i=n==this.getSelectedItem(),o=this.get("idProperty"),r=this.get("itemsById");t!=n&&(this._excludeItemFromModifiedSet(n),delete r[n[o]],this.get("model").setProperty("items."+e,t),this._includeItemToModifiedSet(t),r[t[o]]=t,this.set("itemsById",r),i&&this.get("model").setProperty("selectedItem",t))},tryInitData:function(){this.get("isDataReady")||this.get("isRequestInProcess")||this.updateItems()},saveItem:function(e,t,n){var i,o=this.get("dataProvider"),r=this;return this.isModified(e)?(i=this.getValidationResult(e),i.IsValid?void o.saveItem(e,function(n){r._excludeItemFromModifiedSet(e),r._notifyAboutItemSaved({item:e,result:n.data},"modified"),r._executeCallback(t,{item:e,validationResult:r._extractValidationResult(n),originalResponse:n})},function(t){var i=r._extractValidationResult(t);r._executeCallback(n,{item:e,validationResult:i,originalResponse:t}),r._onServerErrorHandler({response:t,validationResult:i,item:e})}):(this._notifyAboutValidation(i),void this._executeCallback(n,{item:e,validationResult:i}))):(this._notifyAboutItemSaved({item:e,result:null},"notModified"),void r._executeCallback(t,{item:e,validationResult:new ValidationResult}))},_extractValidationResult:function(e){return e.data&&e.data.responseJSON&&e.data.responseJSON.Result?e.data.responseJSON.Result.ValidationResult:e.data&&e.data.Result&&e.data.Result.ValidationResult},_executeCallback:function(e,t){e&&e(this.getContext(),t)},_notifyAboutItemSaved:function(e,t){var n=this.getContext(),i=this._getArgumentTemplate();i.value=e,i.result=t,this.trigger("onItemSaved",n,i)},deleteItem:function(e,t,n){var i=this.get("dataProvider"),o=this,r=this.idOfItem(e),a="undefined"!=typeof this.get("itemsById")[r];return null===e||"undefined"==typeof e||"undefined"!=typeof r&&!a?void this._notifyAboutMissingDeletedItem(e,n):(this.beforeDeleteItem(e),void i.deleteItem(e,function(n){o._handleDeletedItem(e),o._executeCallback(t,{item:e,validationResult:o._extractValidationResult(n),originalResponse:n})},function(t){var i=o._extractValidationResult(t);o._executeCallback(n,{item:e,validationResult:i,originalResponse:t}),o._onServerErrorHandler({response:t,validationResult:i,item:e})}))},_onServerErrorHandler:function(e){var t=e.validationResult,n=this.getContext();t&&t.Items?this._notifyAboutValidation(t):this.trigger("onProviderError",n,{item:e.item,data:e.response})},beforeDeleteItem:function(e){},_handleDeletedItem:function(e){var t=InfinniUI.global.logger;t.warn({message:"BaseDataSource._handleDeletedItem: not overrided by strategy",source:this})},_notifyAboutItemDeleted:function(e,t){var n=this.getContext(),i=this._getArgumentTemplate();i.value=e,this.trigger("onItemDeleted",n,i)},_notifyAboutMissingDeletedItem:function(e,t){var n=this.getContext(),i=this._getArgumentTemplate();i.value=e,i.error={message:"Нельзя удалить элемент, которого нет текущем наборе источника данных"},t&&t(n,i)},isDataReady:function(){return this.get("isDataReady")},getItems:function(){var e=InfinniUI.global.logger;return this.isDataReady()||e.warn({message:"BaseDataSource: Попытка получить данные источника данных ("+this.get("name")+"), до того как он был проинициализирован данными",source:this}),this.get("model").getProperty("items")},updateItems:function(e,t){if(this.isUpdateSuspended()){var n=this.get("waitingOnUpdateItemsHandlers");n.push({onSuccess:e,onError:t})}else{var i=this.get("dataProvider"),o=this;this.set("isRequestInProcess",!0),i.getItems(function(t){o._handleSuccessUpdateItemsInProvider(t,e)},function(e){var n=o.getContext();o._onErrorProviderUpdateItemsHandle(e,t),o.trigger("onProviderError",n,{data:e})})}},_handleSuccessUpdateItemsInProvider:function(e,t){var n=this,i=n.get("isWaiting"),o=function(){n.set("isRequestInProcess",!1),n._handleUpdatedItemsData(e.data,t)};i?n.once("change:isWaiting",function(){o()}):o()},_onErrorProviderUpdateItemsHandle:function(e,t){for(var n=this.get("waitingOnUpdateItemsHandlers"),i=this.getContext(),o=0,r=n.length;o<r;o++)n[o].onError&&n[o].onError(i,e);this.set("waitingOnUpdateItemsHandlers",[]),"function"==typeof t&&t(i,e)},setIsWaiting:function(e){this.set("isWaiting",e)},_handleUpdatedItemsData:function(e,t){this.get("newItemsHandler")&&(e=this.get("newItemsHandler")(e)),this._setItems(e),this._notifyAboutItemsUpdated(e,t)},_notifyAboutItemsUpdated:function(e,t){for(var n=this.getContext(),i={value:e,source:this},o=this.get("waitingOnUpdateItemsHandlers"),r=0,a=o.length;r<a;r++)o[r].onSuccess&&o[r].onSuccess(n,i);this.set("waitingOnUpdateItemsHandlers",[]),t&&t(n,i),this.trigger("onItemsUpdated",n,i)},_notifyAboutItemsUpdatedAsPropertyChanged:function(e){var t=this.getContext(),n=this._getArgumentTemplate();n.property="",n.newValue=e,n.oldValue=null,this.trigger("onPropertyChanged",t,n),this.trigger("onPropertyChanged:",t,n)},createItem:function(e,t){var n,i=this.get("dataProvider"),o=this.get("idProperty"),r=this;this.get("fillCreatedItem")?i.createItem(function(t){r._handleDataForCreatingItem(t,e)},o):(n=i.createLocalItem(o),this._handleDataForCreatingItem(n,e))},_handleDataForCreatingItem:function(e,t){var n=this.getItems();n?(n=n.slice(),n.push(e)):n=[e],this._setItems(n),this._includeItemToModifiedSet(e),this.setSelectedItem(e),this._notifyAboutItemCreated(e,t)},_notifyAboutItemCreated:function(e,t){var n=this.getContext(),i={value:e};t&&t(n,i),this.trigger("onItemCreated",n,i)},_setCriteriaList:function(e,t,n){this.set("criteriaList",e),this.updateItems(t,n)},setIdFilter:function(e){var t=this.get("dataProvider"),n=t.createIdFilter(e);this.setFilter(n)},setNewItemsHandler:function(e){this.set("newItemsHandler",e)},getErrorValidator:function(){return this.get("errorValidator")},setErrorValidator:function(e){this.set("errorValidator",e)},getValidationResult:function(e){var t,n,i=this.getErrorValidator(),o=new ValidationResult,r=!!e,a=this.getContext();if(i)if(r)o=i(a,e);else{t=this.getItems();for(var l=0,s=t.length;l<s;l++)n=i(a,t[l]),n.IsValid||(this._addIndexToPropertiesOfValidationMessage(n.Items,l),o.IsValid=!1,o.Items=_.union(o.Items,n.Items))}return o},setFileProvider:function(e){this.set("fileProvider",e)},getFileProvider:function(){return this.get("fileProvider")},_addIndexToPropertiesOfValidationMessage:function(e,t){for(var n=0,i=e.length;n<i;n++)e[n].property=t+"."+e[n].property},_notifyAboutValidation:function(e){if(e){var t=this.getContext(),n={value:e};this.trigger("onErrorValidator",t,n)}},getContext:function(){return this.getView().getContext()},_indexItemsById:function(e){for(var t,n=this.get("idProperty"),i={},o=0,r=e.length;o<r;o++)t=e[o][n],i[t]=e[o];return i},_indexOfItem:function(e){var t=this.getItems();return t?t.indexOf(e):-1},_indexOfSelectedItem:function(){var e=this.getSelectedItem();return this._indexOfItem(e)},idOfItem:function(e){var t=this.get("idProperty");if(e)return e[t]},getCurrentRequestPromise:function(){var e=$.Deferred(),t=InfinniUI.global.logger;return this.get("isRequestInProcess")?this.onItemsUpdatedOnce(function(){this.isDataReady()?e.resolve():t.warn({message:"BaseDataSource: strange, expected other dataReady status",source:this})}):e.resolve(),e},getNearestRequestPromise:function(){var e=$.Deferred();return this.onItemsUpdatedOnce(function(){this.isDataReady()?e.resolve():logger.warn({message:"BaseDataSource: strange, expected other dataReady status",source:this})}),e},setIsLazy:function(e){this.set("isLazy",e)},isLazy:function(){return this.get("isLazy")},setResolvePriority:function(e){this.set("resolvePriority",e)},getResolvePriority:function(){return this.get("resolvePriority")},_copyObject:function(e){return JSON.parse(JSON.stringify(e))},_getArgumentTemplate:function(){return{source:this}},_detectIdentifyingMode:function(e){Array.isArray(e)&&e.length>0?!$.isPlainObject(e[0])||this.getIdProperty()in e[0]?(this.set("identifyingMode","byId"),_.extend(this,BaseDataSource.identifyingStrategy.byId)):(this.set("identifyingMode","byLink"),_.extend(this,BaseDataSource.identifyingStrategy.byLink)):(this.set("identifyingMode","byId"),_.extend(this,BaseDataSource.identifyingStrategy.byId))},_getIdentifyingMode:function(){return this.get("identifyingMode")}});BaseDataSource.identifyingStrategy={byId:{_restoreSelectedItem:function(){var e=this.getSelectedItem(),t=this.idOfItem(e);if(null!==t&&"undefined"!=typeof t){var n=this.get("itemsById"),i=n[t];if(null!==i&&"undefined"!=typeof i)return this.setSelectedItem(i),!0}return!1},setSelectedItem:function(e,t,n){var i,o=this.getSelectedItem(),r=this.get("itemsById"),a=this.idOfItem(e);if("undefined"==typeof e&&(e=null),e!=o){if(null!==e&&!r[a]){if(n)return void n(this.getContext(),{error:"BaseDataSource.setSelectedItem() Попытка выбрать элемент в источнике, которого нет среди элементов этого источника."});throw new Error("BaseDataSource.setSelectedItem() Попытка выбрать элемент в источнике, которого нет среди элементов этого источника.")}this.get("model").setProperty("selectedItem",e),i=this._indexOfItem(r[a]),this._tuneMirroringOfModel(i),this._notifyAboutSelectedItem(e,t)}},_includeItemToModifiedSet:function(e){var t=this.idOfItem(e);this.get("modifiedItems")[t]=e},_excludeItemFromModifiedSet:function(e){var t=this.idOfItem(e);delete this.get("modifiedItems")[t]},_handleDeletedItem:function(e){for(var t=this.getItems(),n=this.get("idProperty"),i=this.idOfItem(e),o=this.getSelectedItem(),r=0,a=t.length,l=!1;r<a&&!l;r++)t[r][n]==i&&(t.splice(r,1),l=!0);delete this.get("itemsById")[i],this._excludeItemFromModifiedSet(e),o&&o[n]==i&&this.setSelectedItem(null),this._notifyAboutItemDeleted(e)}},byLink:{_restoreSelectedItem:function(){var e=this.getSelectedItem(),t=this.getItems();return t.indexOf(e)!==-1},setSelectedItem:function(e,t,n){var i=this.getSelectedItem(),o=this._indexOfItem(e);if("undefined"==typeof e&&(e=null),e!=i){if(null!==e&&o==-1){if(n)return void n(this.getContext(),{error:"BaseDataSource.setSelectedItem() Попытка выбрать элемент в источнике, которого нет среди элементов этого источника."});throw new Error("BaseDataSource.setSelectedItem() Попытка выбрать элемент в источнике, которого нет среди элементов этого источника.")}this.get("model").setProperty("selectedItem",e),this._tuneMirroringOfModel(o),this._notifyAboutSelectedItem(e,t)}},_includeItemToModifiedSet:function(e){this.get("modifiedItems")["-"]=e},_excludeItemFromModifiedSet:function(e){delete this.get("modifiedItems")["-"]},_handleDeletedItem:function(e){var t=this.getItems(),n=this.getSelectedItem(),i=t.indexOf(e);i>=0&&(t.splice(i,1),this._excludeItemFromModifiedSet(e),n&&n==e&&this.setSelectedItem(null)),this._notifyAboutItemDeleted(e)}}},InfinniUI.BaseDataSource=BaseDataSource;var RestDataSource=BaseDataSource.extend({defaults:_.defaults({updatingItemsConverter:null},BaseDataSource.prototype.defaults),initialize:function(){BaseDataSource.prototype.initialize.apply(this,Array.prototype.slice.call(arguments));var e=this.get("model");e.urlParams={get:{method:"get",origin:null,path:"",data:{},params:{}},set:{method:"post",origin:null,path:"",data:{},params:{}},"delete":{method:"delete",origin:null,path:"",data:{},params:{}}},this.initUrlParamsHandlers()},initDataProvider:function(){var e=InfinniUI.providerRegister.build("RestDataSource");this.set("dataProvider",e)},getGettingUrlParams:function(e){return e=0==arguments.length?"urlParams.get":""==e?"urlParams.get":"urlParams.get."+e,this.get("model").getProperty(e)},setGettingUrlParams:function(e,t){1==arguments.length?(t=e,e="urlParams.get"):e=""==e?"urlParams.get":"urlParams.get."+e,this.get("model").setProperty(e,t)},initUrlParamsHandlers:function(){var e=this;this.get("model").onPropertyChanged("urlParams.get.*",function(t,n){var i,o=e.get("dataProvider"),r=e.getGettingUrlParams();o.setOrigin("get",r.origin),i=e._templateParamsInStr(r.path,r.params),o.setPath("get",i),i=e._templateParamsInObject(r.data,r.params),o.setData("get",i),o.setMethod("get",r.method),(e.get("isDataReady")||e.get("isRequestInProcess")||e.get("waitingOnUpdateItemsHandlers").length>0)&&e.updateItems()}),this.get("model").onPropertyChanged("urlParams.set.*",function(t,n){var i,o=e.get("dataProvider"),r=e.getSettingUrlParams();o.setOrigin("set",r.origin),i=e._templateParamsInStr(r.path,r.params),o.setPath("set",i),i=e._templateParamsInObject(r.data,r.params),o.setData("set",i),o.setMethod("set",r.method)}),this.get("model").onPropertyChanged("urlParams.delete.*",function(t,n){var i,o=e.get("dataProvider"),r=e.getDeletingUrlParams();o.setOrigin("delete",r.origin),i=e._templateParamsInStr(r.path,r.params),o.setPath("delete",i),i=e._templateParamsInObject(r.data,r.params),o.setData("delete",i),o.setMethod("delete",r.method)})},updateItems:function(){this._checkGettingUrlParamsReady()?(BaseDataSource.prototype.updateItems.apply(this,Array.prototype.slice.call(arguments)),this.resumeUpdate("urlGettingParamsNotReady")):(this.suspendUpdate("urlGettingParamsNotReady"),BaseDataSource.prototype.updateItems.apply(this,Array.prototype.slice.call(arguments)))},getSettingUrlParams:function(e){return e=0==arguments.length?"urlParams.set":""==e?"urlParams.set":"urlParams.set."+e,this.get("model").getProperty(e)},setSettingUrlParams:function(e,t){1==arguments.length?(t=e,e="urlParams.set"):e=""==e?"urlParams.set":"urlParams.set."+e,this.get("model").setProperty(e,t)},getDeletingUrlParams:function(e){return e=0==arguments.length?"urlParams.delete":""==e?"urlParams.delete":"urlParams.delete."+e,this.get("model").getProperty(e)},setDeletingUrlParams:function(e,t){1==arguments.length?(t=e,e="urlParams.delete"):e=""==e?"urlParams.delete":"urlParams.delete."+e,this.get("model").setProperty(e,t)},_checkGettingUrlParamsReady:function(){var e,t,n,i,o,r=[];if(!this._checkUrlParamsReady(this.getGettingUrlParams()))return!1;e=this.getGettingUrlParams("path"),t=this._findSubstitutionParams(e),r=r.concat(t),n=this.getGettingUrlParams("data"),e=JSON.stringify(n),t=this._findSubstitutionParams(e),r=r.concat(t),i=this.getGettingUrlParams("params");for(var a=0,l=r.length;a<l;a++)if(o=r[a],void 0===i[o])return!1;return!0},_checkUrlParamsReady:function(e){return e&&"string"==typeof e.origin&&"string"==typeof e.path&&"object"==typeof e.data&&"object"==typeof e.params},_findSubstitutionParams:function(e){if(!e)return[];var t=[];return e.replace(/<%([\s\S]+?)%>/g,function(e,n){return t.push(n),e}),t},_templateParamsInStr:function(e,t){return e&&t?e.replace(/<%([\s\S]+?)%>/g,function(e,n){return t[n]}):e},_templateParamsInObject:function(e,t){if(!e||!t)return e;var n=JSON.stringify(e),i=this._templateParamsInStr(n,t);return JSON.parse(i)},getUpdatingItemsConverter:function(){return this.get("updatingItemsConverter")},setUpdatingItemsConverter:function(e){this.set("updatingItemsConverter",e)},_handleUpdatedItemsData:function(e,t,n){var i,o=this.getUpdatingItemsConverter();i=o?o(e):e,BaseDataSource.prototype._handleUpdatedItemsData.call(this,i,t,n)}});InfinniUI.RestDataSource=RestDataSource;var DocumentDataSource=RestDataSource.extend({defaults:_.defaults({documentId:null},RestDataSource.prototype.defaults),initialize:function(){RestDataSource.prototype.initialize.apply(this,Array.prototype.slice.call(arguments));var e=this.get("model");e.setProperty("pageNumber",0),e.setProperty("pageSize",15),this.setUpdatingItemsConverter(function(t){return e.setProperty("totalCount",t.Result.Count),e.setProperty("additionalResult",t.Result.AdditionalResult),t.Result.Items}),this.initHandlers()},initHandlers:function(){var e=this.get("model"),t=this,n=_.bind(this.updateGettingUrlParams,this),i=function(){t.suspendUpdate("updateGettingUrlParams"),t.get("model").setProperty("pageNumber",0),t.updateGettingUrlParams(),t.resumeUpdate("updateGettingUrlParams")};e.onPropertyChanged("documentId",function(){t.updateGettingUrlParams(),t.updateSettingUrlParams(),t.updateDeletingUrlParams()}),e.onPropertyChanged("filter",i),e.onPropertyChanged("filterParams.*",i),e.onPropertyChanged("pageNumber",n),e.onPropertyChanged("pageSize",i),e.onPropertyChanged("search",i),e.onPropertyChanged("select",n),e.onPropertyChanged("order",i),e.onPropertyChanged("needTotalCount",n),
this.updateGettingUrlParams(),this.updateSettingUrlParams(),this.updateDeletingUrlParams()},updateGettingUrlParamsWithReset:function(){this.suspendUpdate("updateGettingUrlParams"),this.get("model").setProperty("pageNumber",0),this.updateGettingUrlParams(),this.resumeUpdate("updateGettingUrlParams")},updateGettingUrlParams:function(){var e=this.get("model"),t={method:"get",origin:InfinniUI.config.serverUrl,path:"/documents/"+this.get("model").getProperty("documentId"),data:{},params:{}},n=e.getProperty("filter"),i=e.getProperty("filterParams"),o=e.getProperty("pageNumber"),r=e.getProperty("pageSize"),a=e.getProperty("search"),l=e.getProperty("select"),s=e.getProperty("order"),u=e.getProperty("needTotalCount");n&&(t.data.filter=n,i&&_.extend(t.params,i)),r&&(o=o||0,t.data.skip=o*r,t.data.take=r),a&&(t.data.search=a),l&&(t.data.select=l),s&&(t.data.order=s),u&&(t.data.count=u),this.setGettingUrlParams(t)},updateSettingUrlParams:function(){var e=(this.get("model"),{method:"post",origin:InfinniUI.config.serverUrl,path:"/documents/"+this.get("model").getProperty("documentId"),data:{},params:{}});this.setSettingUrlParams(e)},updateDeletingUrlParams:function(){var e=(this.get("model"),{method:"delete",origin:InfinniUI.config.serverUrl,path:"/documents/"+this.get("model").getProperty("documentId")+"/<%id%>",data:{},params:{}});this.setDeletingUrlParams(e)},initDataProvider:function(){var e=InfinniUI.providerRegister.build("DocumentDataSource");this.set("dataProvider",e)},getDocumentId:function(){return this.get("model").getProperty("documentId")},setDocumentId:function(e){this.get("model").setProperty("documentId",e)},getPageNumber:function(){return this.get("model").getProperty("pageNumber")},setPageNumber:function(e){this.get("model").setProperty("pageNumber",e)},getPageSize:function(){return this.get("model").getProperty("pageSize")},setPageSize:function(e){this.get("model").setProperty("pageSize",e)},getSelect:function(){return this.get("model").getProperty("select")},setSelect:function(e){this.get("model").setProperty("select",e)},getOrder:function(){return this.get("model").getProperty("order")},setOrder:function(e){this.get("model").setProperty("order",e)},getTotalCount:function(){return this.get("model").getProperty("totalCount")},getNeedTotalCount:function(){return this.get("model").getProperty("needTotalCount")},setNeedTotalCount:function(e){this.get("model").setProperty("needTotalCount",e)},beforeDeleteItem:function(e){var t=this.idOfItem(e);"undefined"!=typeof t&&this.setDeletingUrlParams("params.id",t)},setIdFilter:function(e){this.setFilter("eq("+this.getIdProperty()+","+this.quoteValue(e)+")")},quoteValue:function(e){var t="'";return"string"==typeof e?t+e+t:e}});InfinniUI.DocumentDataSource=DocumentDataSource;var BaseDataSourceBuilder=function(){};_.extend(BaseDataSourceBuilder.prototype,{build:function(e,t){var n=this.createDataSource(t.parentView);return n.suspendUpdate("tuningInSourceBuilder"),this.applyMetadata(t.builder,t.parentView,t.metadata,n),this.applySuspended(n,t.suspended),n.resumeUpdate("tuningInSourceBuilder"),n},applySuspended:function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&e.getName()===n&&e.suspendUpdate(t[n])},applyMetadata:function(e,t,n,i){var o=n.IdProperty;if(o&&i.setIdProperty(o),"SuspendUpdate"in n&&i.suspendUpdate(n.SuspendUpdate),i.setName(n.Name),i.setFillCreatedItem(n.FillCreatedItem),"IsLazy"in n&&i.setIsLazy(n.IsLazy),"Search"in n&&i.setSearch(n.Search),"Filter"in n&&i.setFilter(n.Filter),"FilterParams"in n){var r=n.FilterParams;for(var a in r)this.initBindingToProperty(r[a],i,t,".filterParams."+a,e)}"IsLazy"in n&&i.setIsLazy(n.IsLazy),"ResolvePriority"in n&&i.setResolvePriority(n.ResolvePriority),"object"==typeof n.CustomProperties&&this.initCustomProperties(i,n.CustomProperties),this.initValidation(t,i,n),this.initNotifyValidation(i),this.initScriptsHandlers(t,n,i),this.initFileProvider(i)},createDataSource:function(e){return new BaseDataSource({view:e})},initCustomProperties:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];e.setProperty("."+n,i)}},initValidation:function(e,t,n){n.ValidationErrors&&t.setErrorValidator(function(t,i){return new ScriptExecutor(e).executeScript(n.ValidationErrors,i)})},initScriptsHandlers:function(e,t,n){e&&(t.OnSelectedItemChanged&&n.onSelectedItemChanged(function(n,i){new ScriptExecutor(e).executeScript(t.OnSelectedItemChanged,i)}),t.OnItemsUpdated&&n.onItemsUpdated(function(n,i){new ScriptExecutor(e).executeScript(t.OnItemsUpdated,i)}),t.OnPropertyChanged&&n.onPropertyChanged(function(n,i){new ScriptExecutor(e).executeScript(t.OnPropertyChanged,i)}),t.OnItemDeleted&&n.onItemDeleted(function(n,i){new ScriptExecutor(e).executeScript(t.OnItemDeleted,i)}),t.OnErrorValidator&&n.onErrorValidator(function(n,i){new ScriptExecutor(e).executeScript(t.OnErrorValidator,i)}),t.OnProviderError&&n.onProviderError(function(n,i){new ScriptExecutor(e).executeScript(t.OnProviderError,i)}))},buildBindingBuilder:function(e){return function(t){return e.builder.buildBinding(t,{parentView:e.parentView,basePathOfProperty:e.basePathOfProperty})}},initFileProvider:function(e){var t=InfinniUI.config.serverUrl,n=new DocumentUploadQueryConstructor(t),i=new DocumentFileProvider(n);e.setFileProvider(i)},initBindingToProperty:function(e,t,n,i,o){if("object"!=typeof e)"undefined"!=typeof e&&t.setProperty(i,e);else{var r={parent:n,parentView:n},a=o.buildBinding(e,r);a.setMode(InfinniUI.BindingModes.toElement),a.bindElement(t,i)}}}),_.extend(BaseDataSourceBuilder.prototype,dataSourceValidationNotifierMixin),InfinniUI.BaseDataSourceBuilder=BaseDataSourceBuilder;var RestDataSourceBuilder=function(){_.superClass(RestDataSourceBuilder,this)};_.inherit(RestDataSourceBuilder,BaseDataSourceBuilder),_.extend(RestDataSourceBuilder.prototype,{createDataSource:function(e){return new RestDataSource({view:e})},applyMetadata:function(e,t,n,i){BaseDataSourceBuilder.prototype.applyMetadata.call(this,e,t,n,i);var o;null!==n.OnProviderError&&"undefined"!=typeof n.OnProviderError||i.onProviderError(this._getCompensateProviderErrorHandler()),"GettingParams"in n&&(o=this.extractUrlParams(n.GettingParams,".urlParams.get.params"),i.setGettingUrlParams(o),this.bindParams(n.GettingParams,i,t,".urlParams.get.params",e)),"SettingParams"in n&&(o=this.extractUrlParams(n.SettingParams,".urlParams.set.params"),i.setSettingUrlParams(o),this.bindParams(n.SettingParams,i,t,".urlParams.set.params",e)),"DeletingParams"in n&&(o=this.extractUrlParams(n.DeletingParams,".urlParams.delet.params"),i.setDeletingUrlParams(o),this.bindParams(n.DeletingParams,i,t,".urlParams.delet.params",e)),"UpdatingItemsConverter"in n&&i.setUpdatingItemsConverter(function(e){return new ScriptExecutor(t).executeScript(n.UpdatingItemsConverter,{value:e,source:i})})},extractUrlParams:function(e,t){var n={};return"Origin"in e?n.origin=e.Origin:n.origin=InfinniUI.config.serverUrl,"Path"in e&&(n.path=e.Path),"Data"in e&&(n.data=e.Data),"Method"in e&&(n.method=e.Method),n.params={},n},bindParams:function(e,t,n,i,o){if("Params"in e){var r=e.Params;for(var a in r)this.initBindingToProperty(r[a],t,n,i+"."+a,o)}},_getCompensateProviderErrorHandler:function(e){return function(e,t){var n=InfinniUI.global.messageBus;n.send(messageTypes.onNotifyUser,{messageText:"Ошибка на сервере",messageType:"error"})}}}),InfinniUI.RestDataSourceBuilder=RestDataSourceBuilder;var DocumentDataSourceBuilder=function(){_.superClass(DocumentDataSourceBuilder,this)};_.inherit(DocumentDataSourceBuilder,BaseDataSourceBuilder),_.extend(DocumentDataSourceBuilder.prototype,{applyMetadata:function(e,t,n,i){BaseDataSourceBuilder.prototype.applyMetadata.call(this,e,t,n,i),i.setDocumentId(n.DocumentId),"Select"in n&&i.setSelect(n.Select),"Order"in n&&i.setOrder(n.Order),"NeedTotalCount"in n&&i.setNeedTotalCount(n.NeedTotalCount),"PageSize"in n&&i.setPageSize(n.PageSize),"PageNumber"in n&&i.setPageNumber(n.PageNumber)},createDataSource:function(e){return new DocumentDataSource({view:e})}}),InfinniUI.DocumentDataSourceBuilder=DocumentDataSourceBuilder;var ObjectDataSource=BaseDataSource.extend({initDataProvider:function(){var e=InfinniUI.providerRegister.build("ObjectDataSource");this.set("dataProvider",e)},initialize:function(){BaseDataSource.prototype.initialize.apply(this,Array.prototype.slice.call(arguments)),this.initHandlers()},initHandlers:function(){var e=this.get("model"),t=_.bind(this.updateFilter,this);e.setProperty("filterParams",{}),e.onPropertyChanged("filter",t),e.onPropertyChanged("filterParams.*",t)},updateFilter:function(){var e=this.get("dataProvider"),t=this.getFilter(),n=this.getFilterParams();e.setFilter(t,n)},setItems:function(e){this.get("dataProvider").setItems(e),this.updateItems()}});InfinniUI.ObjectDataSource=ObjectDataSource;var Element=function(e,t){this.parent=e,this.control=this.createControl(t),this.state={Enabled:!0},this.childElements=[]};Object.defineProperties(Element.prototype,{name:{get:function(){return this.getName()}}}),_.extend(Element.prototype,{createControl:function(e){throw new Error("Не перегружен абстрактный метод Element.createControl")},setParent:function(e){this.parent=e},getParent:function(){return this.parent},getChildElements:function(){return this.childElements},findAllChildrenByType:function(e){function t(){return this.constructor.name===e}function n(t){return t.findAllChildrenByType(e)}return this._findAllChildren(t,n)},findAllChildrenByName:function(e){function t(){return this.getName()===e}function n(t){return t.findAllChildrenByName(e)}return this._findAllChildren(t,n)},_findAllChildren:function(e,t){var n=this.getChildElements(),i=[];return Array.isArray(n)&&n.forEach(function(n){e.call(n)&&i.push(n),Array.prototype.push.apply(i,t(n))}),i},getView:function(){return this.parentView||(this.parent&&this.parent.isView?this.parentView=this.parent:this.parent&&this.parent.getView?this.parentView=this.parent.getView():this.parentView=null),this.parentView},getName:function(){return this.control.get("name")},setName:function(e){if(this.getName())throw new Error("name already exists");"string"==typeof e&&this.control.set("name",e)},getProperty:function(e){var t="get"+this._upperFirstSymbol(e);if("function"==typeof this[t])return this[t]();throw new Error("expect that "+t+" is getter function")},setProperty:function(e,t){var n,i="set"+this._upperFirstSymbol(e);if("function"==typeof this[i])this[i](t);else{if(!this._isCollectionProperty(e))throw new Error("expect that "+i+" is setter function");n="get"+this._upperFirstSymbol(e),this[n]().set(t)}},_isCollectionProperty:function(e){var t="get"+this._upperFirstSymbol(e);return"function"==typeof this[t]&&this[t]()instanceof Collection},onPropertyChanged:function(e,t){var n="on"+this._upperFirstSymbol(e)+"Changed";"function"==typeof this[n]?this[n](t):this.control.on("change:"+e,function(n,i){var o=this.getView(),r=o?o.getContext():void 0,a={property:e,oldValue:n.previous(e),newValue:i};t(r,a)}.bind(this))},getText:function(){return this.control.get("text")},setText:function(e){"undefined"!=typeof e&&this.control.set("text",e)},getEnabled:function(){return this.control.get("enabled")},setEnabled:function(e){if("boolean"==typeof e){this.setState("Enabled",e);var t=this.control.get("parentEnabled"),n=this.control.get("enabled");e=t&&e,e!==n&&(this.control.set("enabled",e),this.setParentEnabledOnChild(e))}},setParentEnabledOnChild:function(e){var t=this.getChildElements();if(_.isEmpty(t)===!1)for(var n=0,i=t.length;n<i;n+=1)"undefined"!=typeof t[n].setParentEnabled&&t[n].setParentEnabled(e)},setParentEnabled:function(e){if("boolean"==typeof e){var t=this.control.get("parentEnabled");if(this.control.set("parentEnabled",e),t!==e){var n=e&&this.getState("Enabled");this.control.set("enabled",n),this.setParentEnabled(n),this.setParentEnabledOnChild(n)}}},getVisible:function(){return this.control.get("visible")},setVisible:function(e){"boolean"==typeof e&&this.control.set("visible",e)},getStyle:function(){return this.control.get("style")},setStyle:function(e){"string"==typeof e&&this.control.set("style",e)},getTextHorizontalAlignment:function(){return this.control.get("textHorizontalAlignment")},setTextHorizontalAlignment:function(e){InfinniUI.Metadata.isValidValue(e,InfinniUI.TextHorizontalAlignment)&&this.control.set("textHorizontalAlignment",e)},getHorizontalAlignment:function(){return this.control.get("horizontalAlignment")},setHorizontalAlignment:function(e){"string"==typeof e&&this.control.set("horizontalAlignment",e)},getTextStyle:function(){return this.control.get("textStyle")},setTextStyle:function(e){"string"==typeof e&&this.control.set("textStyle",e)},getBackground:function(){return this.control.get("background")},setBackground:function(e){"string"==typeof e&&this.control.set("background",e)},getForeground:function(){return this.control.get("foreground")},setForeground:function(e){"string"==typeof e&&this.control.set("foreground",e)},onLoaded:function(e){this.control.onLoaded(e)},isLoaded:function(){return this.control.isLoaded()},getFocusable:function(){return this.control.get("focusable")},setFocusable:function(e){"boolean"==typeof e&&this.control.set("focusable",e)},getFocused:function(){return this.control.get("focused")},setFocused:function(e){return this.control.setFocus()},onLostFocus:function(e){this.control.on("OnLostFocus",e)},onGotFocus:function(e){this.control.on("OnGotFocus",e)},setToolTip:function(e){this.control.set("toolTip",e)},getToolTip:function(){return this.control.get("toolTip")},setContextMenu:function(e){this.control.set("contextMenu",e)},getContextMenu:function(e){return this.control.get("contextMenu")},getIsLoaded:function(){return this.control.get("isLoaded")},setIsLoaded:function(){this.control.set("isLoaded",!0)},setTag:function(e){this.control.set("tag",e)},getTag:function(){return this.control.get("tag")},render:function(){return this.control.render()},getWidth:function(){},getHeight:function(){},getScriptsStorage:function(){return this.getView()},setValidationState:function(e,t){this.control.set("validationMessage",t),this.control.set("validationState",e)},getValidationState:function(){return this.control.get("validationState")},getState:function(e){return this.state[e]},setState:function(e,t){this.state[e]=t},onBeforeClick:function(e){return this.control.onBeforeClick(e)},onKeyDown:function(e){var t=this,n=function(n){var i=t._getHandlingKeyEventData(n);e(i)};return this.control.onKeyDown(n)},onKeyUp:function(e){var t=this,n=function(n){var i=t._getHandlingKeyEventData(n);e(i)};return this.control.onKeyUp(n)},onClick:function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onClick(n)},onDoubleClick:function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onDoubleClick(n)},onMouseDown:function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onMouseDown(n)},onMouseUp:function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onMouseUp(n)},onMouseEnter:function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onMouseEnter(n)},onMouseLeave:function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onMouseLeave(n)},onMouseMove:function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onMouseMove(n)},onMouseWheel:function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onMouseWheel(n)},onRemove:function(e){return this.control.onRemove(this.createControlEventHandler(this,e))},remove:function(e,t){var n=InfinniUI.global.logger;if(this.isRemoved)return void n.warn("Element.remove: Попытка удалить элемент, который уже был удален");for(var i=this.childElements,o=0,r=i.length;o<r;o++)i[o].remove(!0,this);this.control.remove(),this.parent&&this.parent.removeChild&&!e&&(this.parent.isRemoved?n.warn("Element.remove: Попытка удалить элемент из родителя, который помечен как удаленный"):this.parent.removeChild(this)),t&&this.parent&&this.parent.removeChild&&e&&t!==this.parent&&this.parent.removeChild(this),this.isRemoved=!0,this.childElements=void 0},removeChild:function(e){var t=this.childElements.indexOf(e);t!==-1&&this.childElements.splice(t,1)},addChild:function(e){if(this.isRemoved){var t=InfinniUI.global.logger;t.warn("Element.addChild: Попытка добавить потомка в удаленный элемент")}else this.childElements.push(e)},createControlEventHandler:function(e,t,n){var i,o=e.getView();return n=n||{},o&&(i=o.context),function(o){return o=o||{},_.extend(o,n),o.source=e,t.call(void 0,i,o)}},_getHandlingKeyEventData:function(e){return{source:this,key:e.which,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,nativeEventData:e}},_getHandlingMouseEventData:function(e){return{source:this,button:e.which,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,nativeEventData:e}},_upperFirstSymbol:function(e){return e[0].toUpperCase()+e.substr(1)},setFocus:function(){this.control.setFocus()},renderTree:function(e){var t=e||"";if(console.log(t+"Name: "+this.getName(),this),"undefined"!=typeof this.childElements){t+="_____";for(var n=0,i=this.childElements.length;n<i;n+=1)this.renderTree.call(this.childElements[n],t)}},renderFullTree:function(){for(var e=this.parent;e.parent&&"undefined"!=typeof e.parent.parent;)e=e.parent;this.renderTree.call(e)}}),InfinniUI.Element=Element;var ElementBuilder=function(){};_.extend(ElementBuilder.prototype,{build:function(e,t){t=t||{};var n=this.createElement(t),i=_.extend(t,{element:n});return this.applyMetadata(i),t.parentView&&t.parentView.registerElement&&t.parentView.registerElement(n),t.parent&&t.parent.addChild&&t.parent.addChild(n),n},createElement:function(e){throw new Error("Не перегружен абстрактный метод ElementBuilder.createElement()")},applyMetadata:function(e){var t=e.metadata,n=e.element;this.initBindingToProperty(e,"Text"),this.resolveExpressionInText(e,"Text"),this.initBindingToProperty(e,"Visible",!0),this.initBindingToProperty(e,"Enabled",!0),this.initBindingToProperty(e,"HorizontalAlignment"),this.initBindingToProperty(e,"TextHorizontalAlignment"),this.initBindingToProperty(e,"TextStyle"),this.initBindingToProperty(e,"Foreground"),this.initBindingToProperty(e,"Background"),this.initBindingToProperty(e,"Style"),this.initBindingToProperty(e,"Tag"),this.initBindingToProperty(e,"Focusable",!0),t.ToolTip&&this.initToolTip(e),t.ContextMenu&&this.initContextMenu(e),"Name"in t&&n.setName(t.Name);var i={parentView:e.parentView,parent:n,basePathOfProperty:e.basePathOfProperty};if(t.OnLoaded){var o=Executor(t.OnLoaded,e.builder,i);n.onLoaded(o.bind(null,{source:n}))}if(t.OnGotFocus){var r=Executor(t.OnGotFocus,e.builder,i);n.onGotFocus(r.bind(null,{source:n}))}if(t.OnLostFocus){var a=Executor(t.OnLostFocus,e.builder,i);n.onLostFocus(a.bind(null,{source:n}))}if(t.OnDoubleClick){var l=Executor(t.OnDoubleClick,e.builder,i);n.onDoubleClick(l)}if(t.OnClick){var s=Executor(t.OnClick,e.builder,i);n.onClick(s)}if(t.OnMouseEnter){var u=Executor(t.OnMouseEnter,e.builder,i);n.onMouseEnter(u)}if(t.OnMouseLeave){var c=Executor(t.OnMouseLeave,e.builder,i);n.onMouseLeave(c)}if(t.OnMouseMove){var d=Executor(t.OnMouseMove,e.builder,i);n.onMouseMove(d)}if(t.OnKeyDown){var p=Executor(t.OnKeyDown,e.builder,i);n.onKeyDown(p)}if(t.OnKeyUp){var h=Executor(t.OnKeyUp,e.builder,i);n.onKeyUp(h)}if(t.OnMouseDown){var f=Executor(t.OnMouseDown,e.builder,i);n.onMouseDown(f)}if(t.OnMouseUp){var m=Executor(t.OnMouseUp,e.builder,i);n.onMouseUp(m)}if(t.OnMouseWheel){var g=Executor(t.OnMouseWheel,e.builder,i);n.onMouseWheel(g)}},initBindingToProperty:function(e,t,n){var i,o=e.metadata,r=o[t],a=e.element,l=this.lowerFirstSymbol(t);if(r&&"object"==typeof r){var s,u={parent:e.parent,parentView:e.parentView,basePathOfProperty:e.basePathOfProperty},c=e.builder.buildBinding(o[t],u);return n&&(c.setMode(InfinniUI.BindingModes.toElement),i=c.getConverter(),i||(i={}),i.toElement?(s=i.toElement,i.toElement=function(e,t){var n=s(e,t);return!!n}):i.toElement=function(e,t){return!!t.value},c.setConverter(i)),c.bindElement(a,l),c}return"undefined"!=typeof r&&e.element["set"+t](r),null},resolveExpressionInText:function(e,t){var n=e.metadata[t];if(n&&"string"==typeof n&&"{="===n.slice(0,2)&&"}"===n.slice(-1)){var i={parent:e.parent,parentView:e.parentView,basePathOfProperty:e.basePathOfProperty},o="{return "+n.slice(2,-1)+";}",r=new ScriptExecutor(e.element.getScriptsStorage()).executeScript(o,i);"undefined"!=typeof r&&e.element["set"+t](r)}},initToolTip:function(e){var t=e.builder,n=e.element,i=e.metadata,o={basePathOfProperty:e.basePathOfProperty,parent:n,parentView:e.parentView};n.setToolTip(t.buildType("ToolTip",i.ToolTip,o))},initContextMenu:function(e){var t,n=InfinniUI.global.messageBus,i=e.builder,o=e.element,r=e.metadata,a={parent:o,parentView:e.parentView,basePathOfProperty:e.basePathOfProperty};t=i.buildType("ContextMenu",{Items:r.ContextMenu.Items},a),o.setContextMenu(t),n.send(messageTypes.onContextMenu.name,{source:o,content:t.render()})},lowerFirstSymbol:function(e){return e[0].toLowerCase()+e.substr(1)}}),InfinniUI.ElementBuilder=ElementBuilder;var builderValuePropertyMixin={initValueProperty:function(e,t){var n=e.metadata;if("undefined"==typeof t&&(t=!1),void 0!==n.Value){var i=e.builder.build(e.view,n.Value,e.collectionProperty);if(i.setElement(e.element),null!==i){i.onPropertyValueChanged(function(t,n){e.element.setValue(i.getPropertyValue())});var o=i.getPropertyValue();null!==o&&"undefined"!=typeof o&&e.element.setValue(o),e.element.onValueChanged(function(e,t){i.setPropertyValue(t)})}return t&&i&&e.element.onLostFocus(function(){i.validate()}),i}}};InfinniUI.builderValuePropertyMixin=builderValuePropertyMixin;var buttonBuilderMixin={applyButtonMetadata:function(e){var t=e.element,n=e.metadata,i=e.builder;if(this.initTemplatingContent(e),n.Action){var o={parentView:e.parentView,parent:t,basePathOfProperty:e.basePathOfProperty},r=Executor(n.Action,i,o);t.onClick(r)}},initTemplatingContent:function(e){var t,n,i=e.element,o=e.metadata,r=e.builder;"ContentTemplate"in o&&(t=this.buildContentTemplate(o.ContentTemplate,e),i.setContentTemplate(t)),"Content"in o&&(n=r.buildBinding(o.Content,{parentView:e.parentView,basePathOfProperty:e.basePathOfProperty}),n.bindElement(i,"content"))},buildContentTemplate:function(e,t){var n=(t.element,t.builder),i=t.basePathOfProperty;return function(o,r){var a={parent:t.element,parentView:t.parentView,basePathOfProperty:i};return n.build(e,a)}}};InfinniUI.buttonBuilderMixin=buttonBuilderMixin;var buttonMixin={buttonInit:function(){this.isFirstAction=!0},getContent:function(){return this.control.get("content")},setContent:function(e){this.control.set("content",e)},getContentTemplate:function(){return this.control.get("contentTemplate")},setContentTemplate:function(e){this.control.set("contentTemplate",e)},setAction:function(e){var t=this.control;t.set("action",e),this.isFirstAction&&(this.isFirstAction=!1,this.onClick(function(){var e=t.get("action");e&&e.execute()}))},getAction:function(){return this.control.get("action")},click:function(){this.control.click()},onClick:function(e){function t(t){var i=n.getEnabled();i&&e(t)}var n=this;Element.prototype.onClick.call(this,t)}};InfinniUI.buttonMixin=buttonMixin;var displayFormatBuilderMixin={buildDisplayFormat:function(e,t){function n(e,t){return t=t||{},t.value}var i,o=t.formatOptions,r=t.builder,a=n;return"string"==typeof e?(i=r.buildType("ObjectFormat",{Format:e}),a=function(e,t){return t=t||{},i.format(t.value)}):e&&"object"==typeof e&&(i=r.build(e),a=function(e,t){return t=t||{},i.format(t.value)}),i&&i.setOptions(o),a}};InfinniUI.displayFormatBuilderMixin=displayFormatBuilderMixin;var labelTextElementMixin={getLabelText:function(){return this.control.get("labelText")},setLabelText:function(e){this.control.set("labelText",e)}};InfinniUI.labelTextElementMixin=labelTextElementMixin;var routerServiceMixin={replaceParamsInHref:function(e,t,n,i){if(i){var o=i.split("?")[0],r=i.split("?")[1],a=o.split("/"),l=a.indexOf(":"+t);if(l===-1)throw new Error("Different param names in metadata and InfinniUI.config.routes");return a=e.split("/"),a[l]=n,a=a.join("/"),r&&(a+="?"+r),a}return e.replace(":"+t,n)},replaceParamsInQuery:function(e,t,n,i){if(i){for(var o=e.split("?")[0],r=e.split("?")[1],a=i.split("?")[1],l=a.split("&"),s=-1,u=0,c=l.length;u<c;u+=1)l[u].indexOf(":"+t)!==-1&&(s=u);if(s===-1)throw new Error("Different query names in metadata and InfinniUI.config.routes");l=r.split("&");var d=l[s].split("=");d[1]=n,l[s]=d.join("=");var p=o+"?"+l.join("&");return p}return e.replace(":"+t,n)},bindParams:function(e,t,n,i){var o=e.element,r=e.builder,a=this,l={parent:e.parent,parentView:e.parentView,basePathOfProperty:e.basePathOfProperty},s=r.buildBinding(n,l);s.bindElement({onPropertyChanged:function(){},setProperty:function(e,n){var r=o.getHref(),l=a.replaceParamsInHref(r,t,n,i);o.setHref(l)},getProperty:function(){}},"")},bindQuery:function(e,t,n,i){var o=e.element,r=e.builder,a=this,l={parent:e.parent,parentView:e.parentView,basePathOfProperty:e.basePathOfProperty},s=r.buildBinding(n,l);s.bindElement({onPropertyChanged:function(){},setProperty:function(e,n){var r=o.getHref(),l=a.replaceParamsInQuery(r,t,n,i);o.setHref(l)},getProperty:function(){}},"")}};InfinniUI.routerServiceMixin=routerServiceMixin;var valuePropertyMixin={getValue:function(){return this.control.get("value")},setValue:function(e){return this.control.set("value",e)},onValueChanged:function(e){this.control.onValueChanged(e)}};InfinniUI.valuePropertyMixin=valuePropertyMixin;var viewBuilderHeaderTemplateMixin={buildHeaderTemplate:function(e,t){var n,i=t.builder,o=t.metadata;return n=o.HeaderTemplate?function(n,r){var a={parent:e,parentView:e,basePathOfProperty:t.basePathOfProperty};return i.build(o.HeaderTemplate,a)}:function(t,n){var i=new Label;return i.setValue(e.getText()),e.onPropertyChanged("text",function(e,t){i.setValue(t.newValue)}),i}}};InfinniUI.viewBuilderHeaderTemplateMixin=viewBuilderHeaderTemplateMixin,InfinniUI.Container=Container,_.inherit(Container,Element),Container.prototype.getItemTemplate=function(){return this.control.get("itemTemplate")},Container.prototype.setItemTemplate=function(e){if("function"!=typeof e)throw new Error("Function expected");this.control.set("itemTemplate",e)},Container.prototype.getItems=function(){return this.control.get("items")},Container.prototype.getGroupValueSelector=function(){return this.control.get("groupValueSelector")},Container.prototype.setGroupValueSelector=function(e){this.control.set("groupValueSelector",e)},Container.prototype.getGroupItemTemplate=function(){return this.control.get("groupItemTemplate")},Container.prototype.setGroupItemTemplate=function(e){this.control.set("groupItemTemplate",e)},Container.prototype.getGroupItemComparator=function(){return this.control.get("groupItemComparator")},Container.prototype.setGroupItemComparator=function(e){this.control.set("groupItemComparator",e)},InfinniUI.ContainerBuilder=ContainerBuilder,_.inherit(ContainerBuilder,ElementBuilder),_.extend(ContainerBuilder.prototype,{applyMetadata:function(e){var t;return ElementBuilder.prototype.applyMetadata.call(this,e),t=this.initItems(e),this.initGroup(e,t),{itemsBinding:t}},initItems:function(e){var t=e.metadata,n=null;return Array.isArray(t.Items)?this.initNotTemplatingItems(e):t.Items&&(n=this.initTemplatingItems(e)),n},initTemplatingItems:function(e){var t,n,i,o=e.metadata,r=e.element;return n=e.builder.buildBinding(o.Items,{parentView:e.parentView,basePathOfProperty:e.basePathOfProperty}),n.setMode(InfinniUI.BindingModes.toElement),this.bindElementItemsWithSorting(n,e),"ItemTemplate"in o?t=this.buildItemTemplate(o.ItemTemplate,e):"ItemFormat"in o?t=this.buildItemFormat(n,o.ItemFormat,e):"ItemSelector"in o?t=this.buildItemSelector(n,o.ItemSelector,e):(i="ItemProperty"in o?o.ItemProperty:"",t=this.buildItemProperty(n,i,e)),r.setItemTemplate(t),n},initNotTemplatingItems:function(e){var t=e.metadata.Items,n=e.element,i=t.slice(0);n.getItems().set(i);var o=this.buildItemTemplateForUniqueItem(i,e);n.setItemTemplate(o)},tuneItemsBinding:function(e){var t=e.getSource();"function"==typeof t.tryInitData&&t.tryInitData()},initGroup:function(e,t){this.hasGrouping(e)&&(this.initGroupValueSelector(e),this.initGroupItemTemplate(e,t))},hasGrouping:function(e){return e.metadata.GroupValueSelector||e.metadata.GroupValueProperty},initGroupValueSelector:function(e){var t,n=e.metadata,i=e.element;t=n.GroupValueSelector?function(e,t){var o=new ScriptExecutor(i.getScriptsStorage());return o.executeScript(n.GroupValueSelector,t)}:n.GroupValueProperty?function(e,t){return InfinniUI.ObjectUtils.getPropertyValue(t.value,n.GroupValueProperty)}:null,i.setGroupValueSelector(t)},initGroupItemTemplate:function(e,t){var n,i=e.metadata,o=e.element;i.GroupItemTemplate?n=this.buildItemTemplate(i.GroupItemTemplate,e):i.GroupItemFormat?n=this.buildItemFormat(t,i.GroupItemFormat,e):i.GroupItemSelector?n=this.buildItemSelector(t,i.GroupItemSelector,e):i.GroupItemProperty&&(n=this.buildItemProperty(t,i.GroupItemProperty,e)),n&&o.setGroupItemTemplate(n)},buildItemProperty:function(e,t,n){return function(n,i){var o,r=i.index,a=new Label(this),l=e.getSource(),s=new DataBinding;return o=r.toString(),""!=e.getSourceProperty()&&(o=e.getSourceProperty()+"."+o),""!=t&&(o=o+"."+t),s.bindSource(l,o),s.bindElement(a,"value"),a}},buildItemFormat:function(e,t,n){var i=this.buildDisplayFormat(t,n);return function(t,n){var o=n.index,r=new Label(this),a=e.getSourceProperty(),l=e.getSource(),s=new DataBinding;return a=o.toString(),""!=e.getSourceProperty()&&(a=e.getSourceProperty()+"."+a),r.setDisplayFormat(i),s.bindSource(l,a),s.bindElement(r,"value"),r}},buildItemSelector:function(e,t,n){return function(i,o){var r=o.index,a=new Label(this),l=new ScriptExecutor(n.parentView),s=e.getSourceProperty(),u=e.getSource(),c=new DataBinding;return c.setMode(InfinniUI.BindingModes.toElement),s=r.toString(),""!=e.getSourceProperty()&&(s=e.getSourceProperty()+"."+s),c.setConverter({toElement:function(e,n){return l.executeScript(t,n)}}),c.bindSource(u,s),c.bindElement(a,"value"),a}},buildItemTemplate:function(e,t){var n=t.builder,i=t.basePathOfProperty||new BasePathOfProperty(""),o=t.metadata.Items.Property||"",r=this;return function(a,l){var s,u=l.index,c={parent:t.element,parentView:t.parentView};return"undefined"!=typeof u&&null!==u&&(s=r.bindingIndexByItemsIndex(u,t),"undefined"!=typeof s&&null!==s?c.basePathOfProperty=i.buildChild(o,s):c.basePathOfProperty=i.buildChild(o,u)),n.build(e,c)}},buildItemTemplateForUniqueItem:function(e,t){var n=t.element,i=t.builder,o=t.basePathOfProperty||new BasePathOfProperty("");return function(e,r){var a=r.index,l=n.getItems().getByIndex(a),s={parent:t.element,parentView:t.parentView,basePathOfProperty:o};return i.build(l,s)}},bindingIndexByItemsIndex:function(e,t){var n=t.element,i=n.getItems();return i.getProperty(e,"bindingIndex")},bindElementItemsWithSorting:function(e,t){var n,i=t.metadata,o=t.element,r=new ScriptExecutor(t.parent);i.ItemComparator&&(n=function(e,t){return r.executeScript(i.ItemComparator,{item1:e,item2:t})});var a=e.getSource();a.onPropertyChanged("*",function(e,t){var n=o.getItems();t.property&&t.property.match(/^\d+$/)&&n.replace(t.oldValue,t.newValue)}),o.onRemove(function(t,n){e.remove()}),e.bindElement({setProperty:function(e,t){var i,r=o.getItems();o.isRemoved&&console.log("if you see it, something got wrong with UI-2587"),n?(i=r.set(t||[],!0),r.forEach(function(e,t,n){n.setProperty(t,"bindingIndex",t)}),i&&r.sort(n)):(i=r.set(t||[]),r.forEach(function(e,t,n){n.setProperty(t,"bindingIndex",t)}))},onPropertyChanged:function(){}},"items")}},displayFormatBuilderMixin);var editorBaseBuilderMixin={initialize_editorBaseBuilder:function(){},applyMetadata_editorBaseBuilder:function(e,t){function n(e,t){return e=e||{},
t=t||{},!e.toElement&&t.toElement&&(e.toElement=t.toElement),!e.toSource&&t.toSource&&(e.toSource=t.toSource),!e._element&&t._element&&(e._element=t._element),_.isEmpty(e)?null:e}var i=e.metadata,o=e.element;t=t||{},t.valueProperty=t.valueProperty||"value",o.setLabelFloating(i.LabelFloating),this.initBindingToProperty(e,"HintText"),this.resolveExpressionInText(e,"HintText"),this.initBindingToProperty(e,"ErrorText"),this.resolveExpressionInText(e,"ErrorText"),this.initBindingToProperty(e,"WarningText"),this.resolveExpressionInText(e,"WarningText");var r={parentView:e.parentView,parent:o,basePathOfProperty:e.basePathOfProperty};if(i.OnValueChanging){var a=Executor(i.OnValueChanging,e.builder,r);o.onValueChanging(function(e,t){return a(t)})}if(i.OnValueChanged){var l=Executor(i.OnValueChanged,e.builder,r);o.onValueChanged(function(e,t){l(t)})}if("undefined"!=typeof i.Value)if(InfinniUI.Metadata.isBindingMetadata(i.Value)){var s={parentView:e.parentView,basePathOfProperty:e.basePathOfProperty},u=e.builder.buildBinding(i.Value,s),c=n(u.getConverter(),t.converter);c&&u.setConverter(c),t.mode&&u.setMode(t.mode),u.bindElement(e.element,t.valueProperty),this.initValidationResultText(o,u)}else e.element.setValue(i.Value);return{valueBinding:u}},initValidationResultText:function(e,t){function n(e,t){return e.filter(function(e){return o===e.Property}).map(function(e){return e.Message}).join(" ")}var i=t.getSource(),o=t.getSourceProperty();"function"==typeof i.onErrorValidator&&(i.onErrorValidator(function(t,i){var o=i.value,r="";!o.IsValid&&Array.isArray(o.Items)&&(r=n(o.Items)),e.setErrorText(r)},e),e.onRemove(function(t,n){i.offErrorValidator(e)}))}};InfinniUI.editorBaseBuilderMixin=editorBaseBuilderMixin;var editorBaseMixin={initialize_editorBase:function(){},getValue:function(){return this.control.getValue()},setValue:function(e){this.control.setValue(e)},getLabelFloating:function(){return this.control.get("labelFloating")},setLabelFloating:function(e){this.control.set("labelFloating",e)},getHintText:function(){return this.control.get("hintText")},setHintText:function(e){this.control.set("hintText",e)},getErrorText:function(){return this.control.get("errorText")},setErrorText:function(e){this.control.set("errorText",e)},getWarningText:function(){return this.control.get("warningText")},setWarningText:function(e){this.control.set("warningText",e)},convertValue:function(e){return e},onValueChanging:function(e){this.control.onValueChanging(this.createControlEventHandler(this,e,{property:"value"}))},onValueChanged:function(e){this.control.onValueChanged(this.createControlEventHandler(this,e,{property:"value"}))}};InfinniUI.editorBaseMixin=editorBaseMixin,InfinniUI.ListEditorBase=ListEditorBase,_.inherit(ListEditorBase,Container),_.extend(ListEditorBase.prototype,{getMultiSelect:function(){return this.control.get("multiSelect")},setMultiSelect:function(e){this.control.set("multiSelect",e)},getValueSelector:function(){return this.control.get("valueSelector")},setValueSelector:function(e){this.control.set("valueSelector",e)},getDisabledItemCondition:function(){return this.control.get("disabledItemCondition")},setDisabledItemCondition:function(e){this.control.set("disabledItemCondition",e)},setValueItem:function(e){var t,n=this.getMultiSelect(),i=this.getValueSelector();if(n){t=[];for(var o=0,r=e.length;o<r;o++)t[o]=i(null,{value:e[o]})}else t=i(null,{value:e});this.setValue(t)},getSelectedItem:function(){return this.control.get("selectedItem")},setSelectedItem:function(e){this.control.set("selectedItem",e)},onSelectedItemChanged:function(e){this.control.onSelectedItemChanged(this.createControlEventHandler(this,e))}},editorBaseMixin),InfinniUI.ListEditorBaseBuilder=ListEditorBaseBuilder,_.inherit(ListEditorBaseBuilder,ContainerBuilder),_.extend(ListEditorBaseBuilder.prototype,{applyMetadata:function(e){var t,n=ContainerBuilder.prototype.applyMetadata.call(this,e),i=n.itemsBinding;return this.initSelecting(e,i),this.initDisabledItemCondition(e),this.initValueFeatures(e),t=this.applyMetadata_editorBaseBuilder(e),_.extend(n,t)},initSelecting:function(e,t){var n=e.metadata,i=e.element,o=t.getSource(),r=t.getSourceProperty(),a=""==r,l=o instanceof InfinniUI.BaseDataSource;l&&a&&(o.setSelectedItem(null),o.onSelectedItemChanged(function(e,t){var n=i.getSelectedItem(),o=t.value;o!=n&&i.setSelectedItem(o)}));var s={parentView:e.parentView,parent:i,basePathOfProperty:e.basePathOfProperty},u=Executor(n.OnSelectedItemChanged,e.builder,s);i.onSelectedItemChanged(function(e,t){if(l&&a){var n=o.getSelectedItem(),i=t.value;i!=n&&o.setSelectedItem(i)}u(t)})},initValueFeatures:function(e){var t=e.metadata,n=e.element;"undefined"!=typeof t.MultiSelect&&null!==t.MultiSelect&&n.setMultiSelect(t.MultiSelect),this.initValueSelector(e)},initValueSelector:function(e){var t,n=e.metadata,i=e.element;t=n.ValueSelector?function(t,i){var o=new ScriptExecutor(e.element.getScriptsStorage());return o.executeScript(n.ValueSelector,i)}:n.ValueProperty?function(e,t){return InfinniUI.ObjectUtils.getPropertyValue(t.value,n.ValueProperty)}:function(e,t){return t.value},i.setValueSelector(t)},initDisabledItemCondition:function(e){var t,n=e.metadata,i=e.element;n.DisabledItemCondition&&(t=function(e,t){var o=new ScriptExecutor(i.getScriptsStorage());return o.executeScript(n.DisabledItemCondition,t)}),i.setDisabledItemCondition(t)}},editorBaseBuilderMixin),InfinniUI.TextEditorBase=TextEditorBase,_.inherit(TextEditorBase,Element),_.extend(TextEditorBase.prototype,{setEditor:function(e){this.control.set("editor",e)},setDisplayFormat:function(e){this.control.set("displayFormat",e)},getDisplayFormat:function(){return this.control.get("displayFormat")},setEditMask:function(e){this.control.set("editMask",e)},getEditMask:function(){return this.control.get("editMask")},getRawValue:function(){function e(e){return null!==e&&"undefined"!=typeof e}var t=this.control.getRawValue(),n=this.getEditMask();if(n){var i=n.getValue(),o=n.getText();e(i)?t=i:e(o)&&(t=o)}return t},getInputType:function(){return this.control.get("inputType")},setInputType:function(e){e&&this.control.set("inputType",e)}},editorBaseMixin,labelTextElementMixin),InfinniUI.TextEditorBaseBuilder=TextEditorBaseBuilder,_.inherit(TextEditorBaseBuilder,ElementBuilder),_.extend(TextEditorBaseBuilder.prototype,{applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e),this.applyMetadata_editorBaseBuilder(e);var t=e.element;this.initBindingToProperty(e,"LabelText"),this.resolveExpressionInText(e,"LabelText"),t.setInputType(this.getCompatibleInputType(e)),this.initDisplayFormat(e).initEditMask(e)},getCompatibleInputType:function(e){var t=e.metadata.Type,n=e.metadata.EditMask;return"undefined"==typeof t&&(t=e.element.getInputType()),n&&(t="text"),t},initDisplayFormat:function(e){var t=e.metadata,n=this.buildDisplayFormat(t.DisplayFormat,e);return e.element.setDisplayFormat(n),this},initEditMask:function(e){var t=e.metadata;return e.element.setEditMask(t.EditMask),this}},editorBaseBuilderMixin,displayFormatBuilderMixin),InfinniUI.ListBox=ListBox,_.inherit(ListBox,ListEditorBase),ListBox.prototype.createControl=function(e){return new ListBoxControl(e)},InfinniUI.ListBoxBuilder=ListBoxBuilder,_.inherit(ListBoxBuilder,ListEditorBaseBuilder),_.extend(ListBoxBuilder.prototype,{createElement:function(e){return new ListBox(e.parent,e.metadata.ViewMode)},applyMetadata:function(e){ListEditorBaseBuilder.prototype.applyMetadata.call(this,e)}}),InfinniUI.TextBox=TextBox,_.inherit(TextBox,TextEditorBase),_.extend(TextBox.prototype,{createControl:function(e){return new TextBoxControl(e)},getMultiline:function(){return this.control.get("multiline")},setMultiline:function(e){this.control.set("multiline",e)},getLineCount:function(){return this.control.get("lineCount")},setLineCount:function(e){this.control.set("lineCount",e)}}),InfinniUI.TextBoxBuilder=TextBoxBuilder,_.inherit(TextBoxBuilder,TextEditorBaseBuilder),TextBoxBuilder.prototype.createElement=function(e){return new TextBox(e.parent)},TextBoxBuilder.prototype.applyMetadata=function(e){TextEditorBaseBuilder.prototype.applyMetadata.call(this,e);var t=e.element,n=e.metadata,i=n.LineCount;t.setMultiline(n.Multiline),(n.Multiline&&null===i||"undefined"==typeof i)&&(i=2),t.setLineCount(i)},InfinniUI.DateTimePicker=DateTimePicker,_.inherit(DateTimePicker,TextEditorBase),DateTimePicker.prototype.createControl=function(e){return new DateTimePickerControl(e)},DateTimePicker.prototype.getMinValue=function(){return this.control.get("minValue")},DateTimePicker.prototype.setMinValue=function(e){this.control.set("minValue",e)},DateTimePicker.prototype.getMaxValue=function(){return this.control.get("maxValue")},DateTimePicker.prototype.setMaxValue=function(e){this.control.set("maxValue",e)},DateTimePicker.prototype.getMode=function(){return this.control.get("mode")},DateTimePicker.prototype.setMode=function(e){this.control.set("mode",e)},DateTimePicker.prototype.getTimeZone=function(){return this.control.get("timeZone")},DateTimePicker.prototype.setTimeZone=function(e){"number"==typeof e&&this.control.set("timeZone",e)},DateTimePicker.prototype.setDateFormat=function(e){this.control.set("format",e)},InfinniUI.DateTimePickerBuilder=DateTimePickerBuilder,_.inherit(DateTimePickerBuilder,TextEditorBaseBuilder),DateTimePickerBuilder.prototype.createElement=function(e){return new DateTimePicker(e.parent)},DateTimePickerBuilder.prototype.applyMetadata=function(e){var t=e.element,n=e.metadata;this.applyDefaultMetadata(e),TextEditorBaseBuilder.prototype.applyMetadata.call(this,e),t.setTimeZone(n.TimeZone),t.setMode(n.Mode),this.applyMinValue(t,n.MinValue),this.applyMaxValue(t,n.MaxValue)},DateTimePickerBuilder.prototype.applyMinValue=function(e,t){e.setMinValue(InfinniUI.DateUtils.parseISO8601toDate(t))},DateTimePickerBuilder.prototype.applyMaxValue=function(e,t){e.setMaxValue(InfinniUI.DateUtils.parseISO8601toDate(t))},DateTimePickerBuilder.prototype.applyDefaultMetadata=function(e){var t=e.metadata,n={Date:"${:d}",DateTime:"${:g}",Time:"${:T}"},i={Date:{DateTimeEditMask:{Mask:"d"}},DateTime:{DateTimeEditMask:{Mask:"g"}},Time:{DateTimeEditMask:{Mask:"T"}}};e.metadata=_.extend({},t),_.defaults(e.metadata,{Mode:"Date"}),_.defaults(e.metadata,{DisplayFormat:n[e.metadata.Mode],EditMask:i[e.metadata.Mode]})},DateTimePickerBuilder.prototype.initDisplayFormat=function(e){return TextEditorBaseBuilder.prototype.initDisplayFormat.call(this,this.applyTimeZone(e))},DateTimePickerBuilder.prototype.initEditMask=function(e){return TextEditorBaseBuilder.prototype.initEditMask.call(this,this.applyTimeZone(e))},DateTimePickerBuilder.prototype.applyTimeZone=function(e){var t=e.metadata,n={},i={};return"undefined"!=typeof t.TimeZone&&null!==t.TimeZone&&(i.TimeZone=t.TimeZone),_.defaults(n,e,{formatOptions:i}),n},InfinniUI.DatePicker=DatePicker,_.inherit(DatePicker,DateTimePicker),DatePicker.prototype.setTimeZone=function(){DateTimePicker.prototype.setTimeZone.call(this,0)},DatePicker.prototype.createControl=function(e){return new DatePickerControl(e)},DatePicker.prototype.convertValue=function(e){var t=null;return t="undefined"!=typeof e&&null!==e&&e.toString().length?InfinniUI.DateUtils.dateToTimestamp(e):null},InfinniUI.DatePickerBuilder=DatePickerBuilder,_.inherit(DatePickerBuilder,DateTimePickerBuilder),DatePickerBuilder.prototype.createElement=function(e){return new DatePicker(e.parent)},DatePickerBuilder.prototype.applyDefaultMetadata=function(e){e.metadata=_.extend({},e.metadata,{Mode:"DatePicker",TimeZone:0}),_.defaults(e.metadata,{DisplayFormat:"${:d}",EditMask:{DateTimeEditMask:{Mask:"d"}}})},InfinniUI.TimePicker=TimePicker,_.inherit(TimePicker,DateTimePicker),TimePicker.prototype.createControl=function(e){return new TimePickerControl(e)},TimePicker.prototype.setTimeZone=function(){DateTimePicker.prototype.setTimeZone.call(this,0)},TimePicker.prototype.convertValue=function(e){var t=null;return t="undefined"!=typeof e&&null!==e&&e.toString().length?InfinniUI.DateUtils.dateToTimestampTime(e):null},InfinniUI.TimePickerBuilder=TimePickerBuilder,_.inherit(TimePickerBuilder,DateTimePickerBuilder),TimePickerBuilder.prototype.createElement=function(e){return new TimePicker(e.parent)},TimePickerBuilder.prototype.applyDefaultMetadata=function(e){e.metadata=_.extend({},e.metadata,{Mode:"TimePicker",TimeZone:0}),_.defaults(e.metadata,{DisplayFormat:"${:T}",EditMask:{DateTimeEditMask:{Mask:"T"}}})},TimePickerBuilder.prototype.applyMinValue=function(e,t){var n=InfinniUI.DateUtils.parseTimeISO8601toDate(t,0);"undefined"!=typeof n&&e.setMinValue(n)},TimePickerBuilder.prototype.applyMaxValue=function(e,t){var n=InfinniUI.DateUtils.parseTimeISO8601toDate(t,0);"undefined"!=typeof n&&e.setMaxValue(n)},InfinniUI.StackPanel=StackPanel,_.inherit(StackPanel,Container),StackPanel.prototype.getOrientation=function(){return this.control.get("orientation")},StackPanel.prototype.setOrientation=function(e){InfinniUI.Metadata.isValidValue(e,InfinniUI.StackPanelOrientation)&&this.control.set("orientation",e)},StackPanel.prototype.createControl=function(e){return new StackPanelControl(e)},InfinniUI.StackPanelBuilder=StackPanelBuilder,_.inherit(StackPanelBuilder,ContainerBuilder),_.extend(StackPanelBuilder.prototype,{createElement:function(e){return new StackPanel(e.parent,e.metadata.ViewMode)},applyMetadata:function(e){var t=e.metadata,n=e.element,i=ContainerBuilder.prototype.applyMetadata.call(this,e);return n.setOrientation(t.Orientation),i}}),InfinniUI.Button=Button,_.inherit(Button,Element),_.extend(Button.prototype,{createControl:function(e){return new ButtonControl(e)},setType:function(e){this.control.setType(e)},getType:function(){return this.control.getType()}},buttonMixin),InfinniUI.ButtonBuilder=ButtonBuilder,_.inherit(ButtonBuilder,ElementBuilder),_.extend(ButtonBuilder.prototype,{createElement:function(e){var t=this.detectViewMode(e);return new Button(e.parent,t)},detectViewMode:function(e){var t=e.metadata.ViewMode,n=e.parent,i=!1;if(!t)for(;!i;)n?n instanceof PopupButton?(t="link",i=!0):n instanceof MenuBar?(t="menuItem",i=!0):n instanceof View?i=!0:n=n.parent:i=!0;return t},applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e),this.applyButtonMetadata(e),e.metadata.Type&&e.element.setType(e.metadata.Type)}},buttonBuilderMixin),InfinniUI.ButtonEdit=ButtonEdit,_.inherit(ButtonEdit,TextBox),ButtonEdit.prototype.createControl=function(e){return new ButtonEditControl(e)},ButtonEdit.prototype.setIcon=function(e){e&&e.toLowerCase&&(e=e.toLowerCase()),this.control.set("icon",e)},ButtonEdit.prototype.getIcon=function(){return this.control.get("icon")},ButtonEdit.prototype.setReadOnly=function(e){"undefined"!=typeof e&&null!==e&&this.control.set("readOnly",!!e)},ButtonEdit.prototype.getReadOnly=function(){return this.control.get("readOnly")},ButtonEdit.prototype.setShowClear=function(e){"undefined"!=typeof e&&null!==e&&this.control.set("showClear",!!e)},ButtonEdit.prototype.getShowClear=function(){return this.control.get("showClear")},ButtonEdit.prototype.onButtonClick=function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onButtonClick(n)},InfinniUI.ButtonEditBuilder=ButtonEditBuilder,_.inherit(ButtonEditBuilder,TextBoxBuilder),ButtonEditBuilder.prototype.createElement=function(e){return new ButtonEdit(e.parent)},ButtonEditBuilder.prototype.applyMetadata=function(e){TextBoxBuilder.prototype.applyMetadata.call(this,e),this.initBindingToProperty(e,"Icon"),this.initBindingToProperty(e,"ReadOnly",!0),this.initBindingToProperty(e,"ShowClear",!0),this.buildOnButtonClick(e),this.buildButtonAction(e)},ButtonEditBuilder.prototype.buildButtonAction=function(e){var t=e.element,n=e.metadata,i=e.builder;if(n.Action){var o={parentView:e.parentView,parent:t,basePathOfProperty:e.basePathOfProperty},r=i.build(n.Action,o);t.onButtonClick(function(){r.execute()})}},ButtonEditBuilder.prototype.buildOnButtonClick=function(e){var t=e.element,n=e.metadata,i=n.OnButtonClick;if(i){var o={parentView:e.parentView,parent:t,basePathOfProperty:e.basePathOfProperty},r=Executor(i,e.builder,o);t.onButtonClick(r)}},InfinniUI.CheckBox=CheckBox,_.inherit(CheckBox,Element),_.extend(CheckBox.prototype,{createControl:function(e){return new CheckBoxControl(e)}},editorBaseMixin),InfinniUI.CheckBoxBuilder=CheckBoxBuilder,_.inherit(CheckBoxBuilder,ElementBuilder),_.extend(CheckBoxBuilder.prototype,{createElement:function(e){return new CheckBox(e.parent)},applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e),this.applyMetadata_editorBaseBuilder(e)}},editorBaseBuilderMixin),InfinniUI.ComboBox=ComboBox,_.inherit(ComboBox,ListEditorBase),_.extend(ComboBox.prototype,labelTextElementMixin),ComboBox.prototype.createControl=function(){return new ComboBoxControl},ComboBox.prototype.setValueTemplate=function(e){this.control.set("valueTemplate",e)},ComboBox.prototype.getValueTemplate=function(){return this.control.get("valueTemplate")},ComboBox.prototype.getAutocomplete=function(){return this.control.get("autocomplete")},ComboBox.prototype.setAutocomplete=function(e){"boolean"==typeof e&&this.control.set("autocomplete",e)},ComboBox.prototype.setShowClear=function(e){"boolean"==typeof e&&this.control.set("showClear",e)},ComboBox.prototype.getShowClear=function(){return this.control.get("showClear")},ComboBox.prototype.getAutocompleteValue=function(){return this.control.get("autocompleteValue")},ComboBox.prototype.setAutocompleteValue=function(e){this.control.set("autocompleteValue",e)},ComboBox.prototype.setNoItemsMessage=function(e){this.control.setNoItemsMessage(e)},InfinniUI.ComboBoxBuilder=ComboBoxBuilder,_.inherit(ComboBoxBuilder,ListEditorBaseBuilder),_.extend(ComboBoxBuilder.prototype,{createElement:function(e){return new ComboBox(e.parent)},applyMetadata:function(e){var t=e.element,n=this,i=ListEditorBaseBuilder.prototype.applyMetadata.call(this,e);if(this.initValueTemplate(i.valueBinding,e),this.initBindingToProperty(e,"LabelText"),this.resolveExpressionInText(e,"LabelText"),"NoItemsMessage"in e.metadata&&(this.initBindingToProperty(e,"NoItemsMessage"),this.resolveExpressionInText(e,"NoItemsMessage")),t.setAutocomplete(e.metadata.Autocomplete),t.setShowClear(e.metadata.ShowClear),e.metadata.Autocomplete){var o=t.getName();o||(o=n.generateName(),t.setName(o))}},initValueTemplate:function(e,t){var n,i=t.metadata,o=t.element;n="ValueTemplate"in i?this.buildValueTemplate(i.ValueTemplate,t):"ValueFormat"in i?this.buildValueTemplateByFormat(e,i.ValueFormat,t):this.buildValueTemplateByDefault(e,t),o.setValueTemplate(n)},buildValueTemplate:function(e,t){var n=t.builder,i=t.basePathOfProperty||new BasePathOfProperty("");return function(o,r){var a,l=r.index,s={parent:t.element,parentView:t.parentView};return"undefined"!=typeof l&&null!==l&&(a=l,"undefined"!=typeof a&&null!==a?s.basePathOfProperty=i.buildChild("",a):s.basePathOfProperty=i.buildChild("",l)),n.build(e,s)}},buildValueTemplateByFormat:function(e,t,n){var i=this.buildDisplayFormat(t,n);return function(e,t){var n=t.value,o=new Label(this);return o.setHorizontalAlignment("Left"),o.setDisplayFormat(i),o.setValue(n),o}},buildValueTemplateByDefault:function(e,t){return function(e,t){var n=t.value,i=new Label(this);return i.setHorizontalAlignment("Left"),i.setValue(n),i}},generateName:function(){return"combobox-"+guid()}}),InfinniUI.ContextMenu=ContextMenu,_.inherit(ContextMenu,Container),_.extend(ContextMenu.prototype,{createControl:function(){return new ContextMenuControl}}),InfinniUI.ContextMenuBuilder=ContextMenuBuilder,_.inherit(ContextMenuBuilder,ContainerBuilder),_.extend(ContextMenuBuilder.prototype,{createElement:function(e){return new ContextMenu(e.parent)},applyMetadata:function(e){ContainerBuilder.prototype.applyMetadata.call(this,e)}}),InfinniUI.DataGrid=DataGrid,_.inherit(DataGrid,ListEditorBase),DataGrid.prototype.getColumns=function(){return this.control.get("columns")},DataGrid.prototype.setShowSelectors=function(e){"undefined"!=typeof e&&null!==e&&this.control.set("showSelectors",!!e)},DataGrid.prototype.getShowSelectors=function(){return this.control.get("showSelectors")},DataGrid.prototype.createRow=function(){return new DataGridRow(this)},DataGrid.prototype.setEnabled=function(e){"boolean"==typeof e&&this.control.setEnabled(e)},DataGrid.prototype.setCheckAllVisible=function(e){"boolean"==typeof e&&this.control.set("checkAllVisible",e)},DataGrid.prototype.getCheckAllVisible=function(){return this.control.get("checkAllVisible")},DataGrid.prototype.getCheckAll=function(){return this.control.get("checkAll")},DataGrid.prototype.setCheckAll=function(e){this.control.set("checkAll",e)},DataGrid.prototype.onCheckAllChanged=function(e){this.control.onCheckAllChanged(this.createControlEventHandler(this,e))},DataGrid.prototype.createControl=function(){return new DataGridControl},DataGrid.prototype.onRowClick=function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onRowClick(n)},DataGrid.prototype.onRowDoubleClick=function(e){var t=this,n=function(n){var i=t._getHandlingMouseEventData(n);e(i)};return this.control.onRowDoubleClick(n)},DataGrid.prototype.getVerticalAlignment=function(){return this.control.get("verticalAlignment")},DataGrid.prototype.setVerticalAlignment=function(e){"string"==typeof e&&this.control.set("verticalAlignment",e)},DataGrid.prototype.makeUnscrollable=function(){this.control.set("scroll",!1)},InfinniUI.DataGridBuilder=DataGridBuilder,_.inherit(DataGridBuilder,ListEditorBaseBuilder),_.extend(DataGridBuilder.prototype,{createElement:function(e){return new DataGrid(e.parent)},applyMetadata:function(e){ListEditorBaseBuilder.prototype.applyMetadata.call(this,e);var t=e.metadata,n=e.element;n.setShowSelectors(t.ShowSelectors),n.setCheckAllVisible(t.CheckAllVisible),this.initBindingToProperty(e,"VerticalAlignment");var i={parentView:e.parentView,parent:n,basePathOfProperty:e.basePathOfProperty};if(t.OnCheckAllChanged){var o=Executor(t.OnCheckAllChanged,e.builder,i);n.onCheckAllChanged(function(e,t){o(t)})}else setDefaultCheckAllBehavior(n);if(t.OnRowClick){var r=Executor(t.OnRowClick,e.builder,i);n.onRowClick(r)}if(t.OnRowDoubleClick){var a=Executor(t.OnRowDoubleClick,e.builder,i);n.onRowDoubleClick(a)}"undefined"!=typeof t.Scroll&&t.Scroll===!1&&n.makeUnscrollable(),this.applyColumnsMetadata(e)},applyColumnsMetadata:function(e){var t=e.metadata,n=e.element,i=n.getColumns();if(Array.isArray(t.Columns)){var o=t.Columns.map(function(t){return this.buildColumn(t,e)},this);i.reset(o)}},buildColumn:function(e,t){return this.columnBuilder.build(t.element,e,t)},buildItemProperty:function(e,t,n){function i(e,t,i){var a=n.basePathOfProperty||new BasePathOfProperty(""),l={element:e,parent:o,builder:n.builder,metadata:n.metadata,parentView:n.parentView};l.basePathOfProperty=a.buildChild("",t),r.initBindingToProperty(l,i)}var o=n.element,r=this;return function(t,r){var a=n.builder.buildType("DataGridRow",{},{parent:o,parentView:n.parentView,basePathOfProperty:n.basePathOfProperty});a.setGrid(o),["RowStyle","RowBackground","RowForeground","RowTextStyle"].forEach(i.bind(null,a,r.index));var l=o.getColumns(),s=l.toArray().map(function(n,i){var o=n.getCellTemplate(),l=o(e,a),s=l(t,r);return s});return a.setCellElements(s),a.setMultiSelect(o.getMultiSelect()),a.setShowSelectors(o.getShowSelectors()),a}}}),DataGridColumn.prototype.setHeader=function(e){this.setProperty("header",e)},DataGridColumn.prototype.getHeader=function(){return this.getProperty("header")},DataGridColumn.prototype.setCellTemplate=function(e){this.setProperty("cellTemplate",e)},DataGridColumn.prototype.getCellTemplate=function(){return this.getProperty("cellTemplate")},DataGridColumn.prototype.setCellSelector=function(e){this.setProperty("cellSelector",e)},DataGridColumn.prototype.getCellSelector=function(){return this.getProperty("cellSelector")},DataGridColumn.prototype.setHeaderTemplate=function(e){this.setProperty("cellHeaderTemplate",e)},DataGridColumn.prototype.getHeaderTemplate=function(){return this.getProperty("cellHeaderTemplate")},DataGridColumn.prototype.setWidth=function(e){this.setProperty("width",e)},DataGridColumn.prototype.getWidth=function(e){return this.getProperty("width")},DataGridColumn.prototype.setSortable=function(e){this.setProperty("sortable",e)},DataGridColumn.prototype.getSortable=function(){return this.getProperty("sortable")},DataGridColumn.prototype.isSortable=function(){return this.getSortable()},DataGridColumn.prototype.setSortDirection=function(e){this.setProperty("sortDirection",e)},DataGridColumn.prototype.getSortDirection=function(){return this.getProperty("sortDirection")},DataGridColumn.prototype.setSortFunction=function(e){this.setProperty("sortFunction",e)},DataGridColumn.prototype.getSortFunction=function(){return this.getProperty("sortFunction")},DataGridColumn.prototype.setIsHeaderTemplateEmpty=function(e){this.setProperty("isHeaderTemplateEmpty",e)},DataGridColumn.prototype.getIsHeaderTemplateEmpty=function(){return this.getProperty("isHeaderTemplateEmpty")},DataGridColumn.prototype.onSort=function(e){var t=function(t){e(t)};this.on("onSort",t)},DataGridColumn.prototype.onPropertyChanged=function(e,t){this.on("change:"+e,t)},DataGridColumn.prototype.setProperty=function(e,t){var n=this._values[e];this._values[e]=t,n!==t&&this.trigger("change:"+e,null,{property:e,oldValue:n,newValue:t})},DataGridColumn.prototype.getProperty=function(e){return this._values[e]},_.extend(DataGridColumn.prototype,Backbone.Events),InfinniUI.DataGridColumn=DataGridColumn,_.extend(DataGridColumnBuilder.prototype,displayFormatBuilderMixin),DataGridColumnBuilder.prototype.build=function(e,t,n){var i=new DataGridColumn;return this.buildHeader(i,t,n).buildHeaderTemplate(i,t,n).buildCellTemplate(i,t,n).buildWidth(i,t),t.Sortable&&(i.setSortable(!0),i.setSortDirection(null),!t.SortedDefault||"asc"!==t.SortedDefault&&"desc"!==t.SortedDefault||i.setSortDirection(t.SortedDefault),t.SortFunction&&i.onSort(function(n){new ScriptExecutor(e.getScriptsStorage()).executeScript(t.SortFunction,n)})),i},DataGridColumnBuilder.prototype.buildWidth=function(e,t){var n=t.Width;return null!==n&&"undefined"!=typeof n&&e.setWidth(n),this},DataGridColumnBuilder.prototype.buildHeader=function(e,t,n){if(t.Header&&"object"==typeof t.Header){var i=n.builder,o=i.buildType("PropertyBinding",t.Header,{parent:n.element,parentView:n.parentView,basePathOfProperty:n.basePathOfProperty});o.bindElement(e,"header")}else e.setHeader(t.Header);return this},DataGridColumnBuilder.prototype.buildCellTemplate=function(e,t,n){var i;if("CellTemplate"in t)i=this.buildCellTemplateByTemplate(n,t.CellTemplate);else if("CellFormat"in t)i=this.buildCellTemplateByFormat(n,t.CellFormat);else if("CellSelector"in t)i=this.buildCellTemplateBySelector(n,t.CellSelector);else{var o="CellProperty"in t?t.CellProperty:"";i=this.buildCellTemplateByDefault(n,o)}return e.setCellTemplate(i),this},DataGridColumnBuilder.prototype.buildCellTemplateByTemplate=function(e,t){var n=e.builder,i=e.basePathOfProperty||new BasePathOfProperty("");return function(o,r){return function(o,a){var l=a.index,s={parent:r,parentView:e.parentView};return s.basePathOfProperty=i.buildChild("",l),n.build(t,s)}}},DataGridColumnBuilder.prototype.buildCellTemplateByFormat=function(e,t){var n=this.buildDisplayFormat(t,e);return function(t,i){return function(o,r){var a=r.index,l=e.builder,s=t.getSourceProperty(),u=t.getSource(),c=new DataBinding;s=a.toString(),""!=t.getSourceProperty()&&(s=t.getSourceProperty()+"."+s);var d=l.buildType("Label",{},{parent:i,parentView:e.parentView,basePathOfProperty:e.basePathOfProperty});return d.setDisplayFormat(n),c.bindSource(u,s),c.bindElement(d,"value"),d}}},DataGridColumnBuilder.prototype.buildCellTemplateBySelector=function(e,t){var n=e.element,i=n.parent;return function(n,o){return function(n,r){var a=e.builder.buildType("Label",{},{parent:o,parentView:e.parentView,basePathOfProperty:e.basePathOfProperty}),l=new ScriptExecutor(i.getScriptsStorage()),s=l.executeScript(t,{value:r.item});return a.setText(s),a}}},DataGridColumnBuilder.prototype.buildCellTemplateByDefault=function(e,t){return function(n,i){return function(o,r){var a,l=r.index,s=e.builder,u=n.getSource(),c=new DataBinding;a=l.toString(),""!=n.getSourceProperty()&&(a=n.getSourceProperty()+"."+a),""!=t&&(a=a+"."+t);var d=s.buildType("Label",{},{parent:i,parentView:e.parentView,basePathOfProperty:e.basePathOfProperty});return c.bindSource(u,a),c.bindElement(d,"value"),d}}},DataGridColumnBuilder.prototype.buildCellSelector=function(e,t,n){var i;if(t.CellSelector)i=function(e,i){var o=new ScriptExecutor(n.parent);return o.executeScript(t.CellSelector,i)};else if(t.CellProperty){var o=t.CellProperty;i=function(e){return InfinniUI.ObjectUtils.getPropertyValue(e,o)}}else i=function(e){return e};return e.setCellSelector(i),this},DataGridColumnBuilder.prototype.buildHeaderTemplate=function(e,t,n){var i,o=t.HeaderTemplate;return"undefined"==typeof o||_.isEmpty(o)?(i=this.buildHeaderTemplateByDefault(n),e.setIsHeaderTemplateEmpty(!0)):(i=this.buildHeaderTemplateByMetadata(o,n),e.setIsHeaderTemplateEmpty(!1)),e.setHeaderTemplate(i),this},DataGridColumnBuilder.prototype.buildHeaderTemplateByMetadata=function(e,t){var n=t.element,i=t.builder;return function(o,r){var a={parent:n,parentView:t.parentView};return i.build(e,a)}},DataGridColumnBuilder.prototype.buildHeaderTemplateByDefault=function(e){var t=e.builder;return function(n,i){var o=t.buildType("Label",{},{parent:e.element,parentView:e.parentView,basePathOfProperty:e.basePathOfProperty});return o.setText(i.value),o}},InfinniUI.DataGridColumnBuilder=DataGridColumnBuilder,InfinniUI.DataGridRowBuilder=DataGridRowBuilder,_.inherit(DataGridRowBuilder,ElementBuilder),_.extend(DataGridRowBuilder.prototype,{createElement:function(e){return new DataGridRow(e.parent)},applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e)}}),InfinniUI.DataNavigation=DataNavigation,_.inherit(DataNavigation,Element),_.extend(DataNavigation.prototype,{createControl:function(){return new DataNavigationControl},getDataSource:function(){return this.control.get("dataSource")},setDataSource:function(e){this.control.set("dataSource",e)},getAvailablePageSizes:function(){return this.control.get("availablePageSizes")},setPageNumber:function(e){this.control.set("pageNumber",e)},getPageNumber:function(){return this.control.get("pageNumber")},onPageNumberChanged:function(e){this.control.onPageNumberChanged(this.createControlEventHandler(this,e))},setPageSize:function(e){this.control.set("pageSize",e)},getPageSize:function(){return this.control.get("pageSize")},onPageSizeChanged:function(e){this.control.onPageSizeChanged(this.createControlEventHandler(this,e))},getPageCount:function(){return this.control.get("pageCount")},setPageCount:function(e){this.control.set("pageCount",e)},getIsDataReady:function(){return this.control.get("isDataReady")},setIsDataReady:function(e){this.control.set("isDataReady",e)}}),InfinniUI.DataNavigationBuilder=DataNavigationBuilder,_.inherit(DataNavigationBuilder,ElementBuilder),_.extend(DataNavigationBuilder.prototype,{createElement:function(e){return new DataNavigation(e.parent)},applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e);var t,n=e.element,i=e.metadata,o=this;Array.isArray(i.AvailablePageSizes)&&n.getAvailablePageSizes().reset(i.AvailablePageSizes);var r=this.findDataSource(e);r?(t=r.getProperty(".pageSize"),n.setDataSource(r),n.setPageSize(t),r.onItemsUpdated(function(){o.onDataUpdated(n,r)}),r.isDataReady()&&this.onDataUpdated(n,r),n.onPageNumberChanged(function(e,t){r.setProperty(".pageNumber",t.value)}),n.onPageSizeChanged(function(e,t){r.setProperty(".pageSize",t.value)})):console.error("DataSource not found")},onDataUpdated:function(e,t){var n,i=t.getProperty(".totalCount"),o=t.getProperty(".pageSize"),r=t.getProperty(".pageNumber");"number"==typeof i&&(n=Math.ceil(i/o),
e.setPageCount(n)),e.setPageNumber(r),e.setIsDataReady(!0)},findDataSource:function(e){var t,n,i=e.metadata.DataSource,o=e.parentView;return i&&o&&(t=o.getContext(),n=t.dataSources[i]),n}}),InfinniUI.Divider=Divider,_.inherit(Divider,Element),Divider.prototype.createControl=function(e){return new DividerControl(e)},InfinniUI.DividerBuilder=DividerBuilder,_.inherit(DividerBuilder,ElementBuilder),DividerBuilder.prototype.createElement=function(e){return new Divider(e.parent)},DividerBuilder.prototype.applyMetadata=function(e){ElementBuilder.prototype.applyMetadata.call(this,e)},InfinniUI.ExtensionPanel=ExtensionPanel,_.inherit(ExtensionPanel,Container),_.extend(ExtensionPanel.prototype,{createControl:function(){var e=new ExtensionPanelControl;return e},setExtensionName:function(e){return this.control.set("extensionName",e)},setParameters:function(e){return this.control.set("parameters",e)},getParameters:function(){return this.control.get("parameters")},setContext:function(e){this.control.set("context",e)},setBuilder:function(e){this.control.set("builder",e)}}),InfinniUI.ExtensionPanelBuilder=ExtensionPanelBuilder,_.inherit(ExtensionPanelBuilder,ContainerBuilder),_.extend(ExtensionPanelBuilder.prototype,{applyMetadata:function(e){var t=e.metadata,n=e.element,i=e.parentView,o=e.builder;ContainerBuilder.prototype.applyMetadata.call(this,e),n.setExtensionName(t.ExtensionName);var r={};_.each(t.Parameters,function(t){var n=o.buildType("Parameter",t,{parentView:i,basePathOfProperty:e.basePathOfProperty});r[n.getName()]=n}),n.setParameters(r),n.setContext(i.getContext()),n.setBuilder(o)},createElement:function(e){var t=new ExtensionPanel(e.parent);return t}}),InfinniUI.FileBox=FileBox,_.inherit(FileBox,Element),_.extend(FileBox.prototype,{getFile:function(){return this.control.get("file")},createControl:function(){return new FileBoxControl},getMaxSize:function(){return this.control.get("maxSize")},setMaxSize:function(e){this.control.set("maxSize",e)},getAcceptTypes:function(){return this.control.get("acceptTypes")},setAcceptTypes:function(e){var t=this.getAcceptTypes();Array.isArray(e)&&t.set(e)},setFile:function(e){this.control.set("file",e)},setFileName:function(e){return this.control.set("fileName",e),this},setFileSize:function(e){return this.control.set("fileSize",e),this},setFileTime:function(e){return this.control.set("fileTime",e),this},setFileType:function(e){return this.control.set("fileType",e),this}},editorBaseMixin,labelTextElementMixin),InfinniUI.FileBoxBuilder=FileBoxBuilder,_.inherit(FileBoxBuilder,ElementBuilder),_.extend(FileBoxBuilder.prototype,{createElement:function(e){return new FileBox(e.parent)},applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e);var t=e.element,n=e.metadata;Array.isArray(n.AcceptTypes)&&t.setAcceptTypes(n.AcceptTypes),null!==n.MaxSize&&"undefined"!=typeof n.MaxSize&&t.setMaxSize(n.MaxSize),this.initBindingToProperty(e,"LabelText"),this.resolveExpressionInText(e,"LabelText");var i=new FileBoxValueConverter(t),o=this.applyMetadata_editorBaseBuilder(e,{mode:InfinniUI.BindingModes.toElement,converter:i}),r=o.valueBinding;if(r){var a=r.getSource();e.element.onPropertyChanged("file",function(e,t){var n=t.newValue;null===n?a.setProperty(r.getSourceProperty(),null):n instanceof File&&a.setProperty(r.getSourceProperty(),t.newValue)})}}},editorBaseBuilderMixin),InfinniUI.FileBoxValueConverter=FileBoxValueConverter,FileBoxValueConverter.prototype.toElement=function(e,t){var n=t.value,i=t.binding,o=i.getSource(),r=o.getFileProvider(),a=null;return n&&(r&&InfinniUI.BlobUtils.isFileInfo(n)?(a=r.getFileUrl(null,null,InfinniUI.BlobUtils.getContentId(n)),this._element.setFileName(InfinniUI.BlobUtils.getName(n)).setFileSize(InfinniUI.BlobUtils.getSize(n)).setFileTime(InfinniUI.BlobUtils.getTime(n)).setFileType(InfinniUI.BlobUtils.getType(n))):a="string"==typeof n?n:n),a},InfinniUI.Form=Form,_.inherit(Form,StackPanel),Form.prototype.createControl=function(e){return new FormControl(e)},Form.prototype.onSubmit=function(e){var t=function(t){e(t)};return this.control.onSubmit(t)},Form.prototype.setSubmitFunction=function(e){this.control.setSubmitFunction(e)},Form.prototype.getSubmitFunction=function(){return this.control.getSubmitFunction()},Form.prototype.setMethod=function(e){this.control.setMethod(e)},Form.prototype.getMethod=function(){return this.control.getMethod()},Form.prototype.setAction=function(e){this.control.setAction(e)},Form.prototype.getAction=function(){return this.control.getAction()},InfinniUI.FormBuilder=FormBuilder,_.inherit(FormBuilder,StackPanelBuilder),_.extend(FormBuilder.prototype,{createElement:function(e){return new Form(e.parent)},applyMetadata:function(e){var t=e.element,n=e.metadata;if(StackPanelBuilder.prototype.applyMetadata.call(this,e),n.OnSubmit){var i={parentView:e.parentView,parent:t,basePathOfProperty:e.basePathOfProperty},o=Executor(n.OnSubmit,e.builder,i);t.onSubmit(o)}n.Method&&t.setMethod(n.Method),n.Action&&t.setAction(n.Action)}}),InfinniUI.Frame=Frame,_.inherit(Frame,Element),_.extend(Frame.prototype,{createControl:function(){return new FrameControl}},editorBaseMixin),InfinniUI.FrameBuilder=FrameBuilder,_.inherit(FrameBuilder,TextEditorBaseBuilder),_.extend(FrameBuilder.prototype,{applyMetadata:function(e){e.element;ElementBuilder.prototype.applyMetadata.call(this,e),this.applyMetadata_editorBaseBuilder(e)},createElement:function(e){var t=new Frame(e.parent);return t}},editorBaseBuilderMixin),InfinniUI.GridPanel=GridPanel,_.inherit(GridPanel,Container),_.extend(GridPanel.prototype,{createControl:function(){return new GridPanelControl}}),InfinniUI.GridPanelBuilder=GridPanelBuilder,_.inherit(GridPanelBuilder,ContainerBuilder),_.extend(GridPanelBuilder.prototype,{createElement:function(e){return new GridPanel(e.parent)},applyMetadata:function(e){ContainerBuilder.prototype.applyMetadata.call(this,e)}}),InfinniUI.Icon=Icon,_.inherit(Icon,Element),_.extend(Icon.prototype,{createControl:function(){return new IconControl},setValue:function(e){this.control.set("value",e)},getValue:function(){return this.control.get("value")},getSize:function(){return this.control.get("size")},setSize:function(e){"string"==typeof e&&this.control.set("size",e)},onValueChanged:function(){}}),InfinniUI.IconBuilder=IconBuilder,_.inherit(IconBuilder,ElementBuilder),_.extend(IconBuilder.prototype,{createElement:function(e){return new Icon(e.parent)},applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e),this.initBindingToProperty(e,"Value"),this.initBindingToProperty(e,"Size")}}),InfinniUI.ImageBox=ImageBox,_.inherit(ImageBox,Element),_.extend(ImageBox.prototype,{getFile:function(){return this.control.get("file")},createControl:function(){return new ImageBoxControl},getMaxSize:function(){return this.control.get("maxSize")},setMaxSize:function(e){this.control.set("maxSize",e)},getAcceptTypes:function(){return this.control.get("acceptTypes")},setAcceptTypes:function(e){var t=this.getAcceptTypes();Array.isArray(e)&&t.set(e)}},editorBaseMixin),InfinniUI.ImageBoxBuilder=ImageBoxBuilder,_.inherit(ImageBoxBuilder,ElementBuilder),_.extend(ImageBoxBuilder.prototype,{createElement:function(e){return new ImageBox(e.parent)},applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e);var t=e.element,n=e.metadata;Array.isArray(n.AcceptTypes)&&t.setAcceptTypes(n.AcceptTypes),null!==n.MaxSize&&"undefined"!=typeof n.MaxSize&&t.setMaxSize(n.MaxSize);var i=new ImageBoxValueConverter(t),o=this.applyMetadata_editorBaseBuilder(e,{mode:InfinniUI.BindingModes.toElement,converter:i}),r=o.valueBinding;if(r){var a=r.getSource();e.element.onPropertyChanged("file",function(e,t){var n=t.newValue;(n instanceof File||null===n)&&a.setProperty(r.getSourceProperty(),t.newValue)})}}},editorBaseBuilderMixin),ImageBoxValueConverter.prototype.toElement=function(e,t){var n=t.value,i=t.binding,o=i.getSource(),r=o.getFileProvider(),a=null;return n&&(a=r&&InfinniUI.BlobUtils.isFileInfo(n)?r.getFileUrl(null,null,InfinniUI.BlobUtils.getContentId(n)):"string"==typeof n?n:n),a},InfinniUI.ImageBoxValueConverter=ImageBoxValueConverter,InfinniUI.IndeterminateCheckBox=IndeterminateCheckBox,_.inherit(IndeterminateCheckBox,CheckBox),_.extend(IndeterminateCheckBox.prototype,{createControl:function(e){return new IndeterminateCheckBoxControl(e)}},editorBaseMixin),InfinniUI.IndeterminateCheckBoxBuilder=IndeterminateCheckBoxBuilder,_.inherit(IndeterminateCheckBoxBuilder,CheckBoxBuilder),_.extend(IndeterminateCheckBoxBuilder.prototype,{createElement:function(e){return new IndeterminateCheckBox(e.parent)}}),InfinniUI.Label=Label,_.inherit(Label,Element),_.extend(Label.prototype,{createControl:function(){return new LabelControl},setTextWrapping:function(e){"boolean"==typeof e&&this.control.set("textWrapping",e)},getTextWrapping:function(){return this.control.get("textWrapping")},setTextTrimming:function(e){"boolean"==typeof e&&this.control.set("textTrimming",e)},getTextTrimming:function(){return this.control.get("textTrimming")},getDisplayFormat:function(){return this.control.get("displayFormat")},setDisplayFormat:function(e){return this.control.set("displayFormat",e)},getDisplayValue:function(){return this.control.getDisplayValue()},getEscapeHtml:function(){return this.control.get("escapeHtml")},setEscapeHtml:function(e){"boolean"==typeof e&&this.control.set("escapeHtml",e)}},editorBaseMixin),InfinniUI.LabelBuilder=LabelBuilder,_.inherit(LabelBuilder,ElementBuilder),_.extend(LabelBuilder.prototype,{applyMetadata:function(e){var t=e.element;ElementBuilder.prototype.applyMetadata.call(this,e),this.applyMetadata_editorBaseBuilder(e),t.setTextWrapping(e.metadata.TextWrapping),t.setTextTrimming(e.metadata.TextTrimming),t.setEscapeHtml(e.metadata.EscapeHtml),this.initDisplayFormat(e)},initDisplayFormat:function(e){var t=e.metadata,n=this.buildDisplayFormat(t.DisplayFormat,e);e.element.setDisplayFormat(n)},createElement:function(e){var t=new Label(e.parent,e.metadata.ViewMode);return t.getHeight=function(){return 34},t}},editorBaseBuilderMixin,displayFormatBuilderMixin),InfinniUI.Link=Link,_.inherit(Link,Button),Link.prototype.createControl=function(){return new LinkElementControl},Link.prototype.setHref=function(e){this.control.set("href",e)},Link.prototype.getHref=function(){return this.control.get("href")},Link.prototype.setTarget=function(e){this.control.set("target",e)},Link.prototype.getTarget=function(){return this.control.get("target")},InfinniUI.LinkBuilder=LinkBuilder,_.inherit(LinkBuilder,ButtonBuilder),_.extend(LinkBuilder.prototype,routerServiceMixin,{createElement:function(e){return new Link(e.parent)},applyMetadata:function(e){ButtonBuilder.prototype.applyMetadata.call(this,e);var t=e.metadata,n=e.element;if(t.Href&&"string"==typeof t.Href)n.setHref(t.Href);else if(t.Href){var i=t.Href.Name,o=t.Href.Params,r=t.Href.Query,a=routerService.getLinkByName(i,"no"),l=a;if(n.setHref(l),o)for(var s=0,u=o.length;s<u;s+=1)"string"==typeof o[s].Value?(n.getHref()!==l&&(l=n.getHref()),l=this.replaceParamsInHref(l,o[s].Name,o[s].Value),n.setHref(l)):this.bindParams(e,o[s].Name,o[s].Value,l);if(r)for(var c=0,d=r.length;c<d;c+=1)"string"==typeof r[c].Value?(n.getHref()!==l&&(l=n.getHref()),l=this.replaceParamsInQuery(l,r[c].Name,r[c].Value),n.setHref(l)):this.bindQuery(e,r[c].Name,r[c].Value,l)}t.Target&&n.setTarget(t.Target)}}),InfinniUI.MenuBar=MenuBar,_.inherit(MenuBar,Container),_.extend(MenuBar.prototype,{createControl:function(e){return new MenuBarControl(e)},highlightItem:function(e){!function(t){var n=t.getChildElements();n.forEach(function(t){var n="string"==typeof e&&t.getName()===e,i=t.control;i&&i.setHighlight(n)})}(this)}}),InfinniUI.MenuBarBuilder=MenuBarBuilder,_.inherit(MenuBarBuilder,ContainerBuilder),_.extend(MenuBarBuilder.prototype,{createElement:function(e){return new MenuBar(e.parent)}}),InfinniUI.NumericBox=NumericBox,_.inherit(NumericBox,TextEditorBase),NumericBox.prototype.createControl=function(e){return new NumericBoxControl(e)},NumericBox.prototype.getMinValue=function(){return this.control.get("minValue")},NumericBox.prototype.setMinValue=function(e){this.control.set("minValue",e)},NumericBox.prototype.getMaxValue=function(){return this.control.get("maxValue")},NumericBox.prototype.setMaxValue=function(e){this.control.set("maxValue",e)},NumericBox.prototype.getIncrement=function(){return this.control.get("increment")},NumericBox.prototype.setIncrement=function(e){this.control.set("increment",e)},NumericBox.prototype.setStartValue=function(e){this.control.set("startValue",e)},NumericBox.prototype.convertValue=function(e){var t=null===e||""===e||"undefined"==typeof e?null:+e;return"number"==typeof t?t:null},NumericBox.prototype.getStartValue=function(){return this.control.get("startValue")},InfinniUI.NumericBoxBuilder=NumericBoxBuilder,_.inherit(NumericBoxBuilder,TextEditorBaseBuilder),NumericBoxBuilder.prototype.createElement=function(e){return new NumericBox(e.parent)},NumericBoxBuilder.prototype.applyMetadata=function(e){TextEditorBaseBuilder.prototype.applyMetadata.call(this,e);var t=e.element,n=e.metadata;t.setMinValue(n.MinValue),t.setMaxValue(n.MaxValue),t.setIncrement(n.Increment),t.setStartValue(n.StartValue)},InfinniUI.Panel=Panel,_.inherit(Panel,Container),Panel.prototype.getCollapsible=function(){return this.control.get("collapsible")},Panel.prototype.setCollapsible=function(e){"undefined"!=typeof e&&this.control.set("collapsible",!!e)},Panel.prototype.getCollapsed=function(){return this.control.get("collapsed")},Panel.prototype.setCollapsed=function(e){"undefined"!=typeof e&&this.control.set("collapsed",!!e)},Panel.prototype.getHeaderTemplate=function(){return this.control.get("headerTemplate")},Panel.prototype.setHeaderTemplate=function(e){this.control.set("headerTemplate",e)},Panel.prototype.getHeader=function(){return this.control.get("header")},Panel.prototype.setHeader=function(e){this.control.set("header",e)},Panel.prototype.getCollapseChanger=function(){return this.control.get("collapseChanger")},Panel.prototype.setCollapseChanger=function(e){this.control.set("collapseChanger",e)},Panel.prototype.onExpanding=function(e){this.control.on("expanding",e)},Panel.prototype.onExpanded=function(e){this.control.on("expanded",e)},Panel.prototype.onCollapsing=function(e){this.control.on("collapsing",e)},Panel.prototype.onCollapsed=function(e){this.control.on("collapsed",e)},Panel.prototype.createControl=function(){return new PanelControl},InfinniUI.PanelBuilder=PanelBuilder,_.inherit(PanelBuilder,ContainerBuilder),_.extend(PanelBuilder.prototype,{createElement:function(e){return new Panel(e.parent)},applyMetadata:function(e){var t=e.metadata,n=e.element,i=ContainerBuilder.prototype.applyMetadata.call(this,e);if(n.setCollapsible(t.Collapsible),n.setCollapsed(t.Collapsed),n.setCollapseChanger(t.CollapseChanger),t.Header&&"object"==typeof t.Header){var o=e.builder,r=o.buildType("PropertyBinding",t.Header,{parent:n,parentView:e.parentView,basePathOfProperty:e.basePathOfProperty});r.bindElement(n,"header")}else n.setHeader(t.Header);if(t.Header||t.HeaderTemplate){var a=this.buildHeaderTemplate(t.HeaderTemplate,e);n.setHeaderTemplate(a)}else n.setHeaderTemplate(null);return this.initEventHandler(e),i},initEventHandler:function(e){var t=e.metadata,n=e.element,i={parentView:e.parentView,parent:n,basePathOfProperty:e.basePathOfProperty};if(t.OnExpanding){var o=Executor(t.OnExpanding,e.builder,i);n.onExpanding(function(e,t){return o(t)})}if(t.OnExpanded){var r=Executor(t.OnExpanded,e.builder,i);n.onExpanded(function(e,t){return r(t)})}if(t.OnCollapsing){var a=Executor(t.OnCollapsing,e.builder,i);n.onCollapsing(function(e,t){return a(t)})}if(t.OnCollapsed){var l=Executor(t.OnCollapsed,e.builder,i);n.onCollapsed(function(e,t){return l(t)})}},buildHeaderTemplate:function(e,t){var n;return n="undefined"==typeof e||_.isEmpty(e)?this.buildDefaultHeaderTemplate(t):this.buildMetadataHeaderTemplate(e,t)},buildDefaultHeaderTemplate:function(e){return function(e,t){var n=new Label(this);return n.setText(t.value),n}},buildMetadataHeaderTemplate:function(e,t){var n=t.element,i=t.builder;return function(o,r){var a={parent:n,parentView:t.parentView,basePathOfProperty:t.basePathOfProperty};return i.build(e,a)}}}),InfinniUI.PasswordBox=PasswordBox,_.inherit(PasswordBox,Element),_.extend(PasswordBox.prototype,{setAutocomplete:function(e){"undefined"!=typeof e&&null!==e&&this.control.set("autocomplete",!!e)},getAutocomplete:function(){return this.control.get("autocomplete")},createControl:function(){return new PasswordBoxControl},getRawValue:function(){return this.control.get("rawValue")}},editorBaseMixin,labelTextElementMixin),InfinniUI.PasswordBoxBuilder=PasswordBoxBuilder,_.inherit(PasswordBoxBuilder,ElementBuilder),_.extend(PasswordBoxBuilder.prototype,{applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e),this.applyMetadata_editorBaseBuilder(e);var t=e.metadata,n=e.element;this.initBindingToProperty(e,"LabelText"),this.resolveExpressionInText(e,"LabelText"),n.setAutocomplete(t.Autocomplete)},createElement:function(e){var t=new PasswordBox(e.parent);return t}},editorBaseBuilderMixin),InfinniUI.PopupButton=PopupButton,_.inherit(PopupButton,Container),_.extend(PopupButton.prototype,{createControl:function(e){return new PopupButtonControl(e)}},buttonMixin),InfinniUI.PopupButtonBuilder=PopupButtonBuilder,_.inherit(PopupButtonBuilder,ContainerBuilder),_.extend(PopupButtonBuilder.prototype,{createElement:function(e){var t=this.detectViewMode(e);return new PopupButton(e.parent,t)},detectViewMode:function(e){var t=e.metadata.ViewMode,n=e.parent,i=!1;if(!t)for(;!i;)n?n instanceof MenuBar?(t="forMenu",i=!0):n=n.parent:i=!0;return t},applyMetadata:function(e){ContainerBuilder.prototype.applyMetadata.call(this,e),this.applyButtonMetadata.call(this,e)}},buttonBuilderMixin),InfinniUI.RadioGroupBuilder=RadioGroupBuilder,_.inherit(RadioGroupBuilder,ListBoxBuilder),_.extend(RadioGroupBuilder.prototype,{createElement:function(e){var t=e.metadata.ViewMode||"checking";return new ListBox(e.parent,t)},applyMetadata:function(e){var t=e.element;ListBoxBuilder.prototype.applyMetadata.call(this,e),t.setMultiSelect(!1)}}),InfinniUI.ScrollPanel=ScrollPanel,_.inherit(ScrollPanel,Container),ScrollPanel.prototype.getHorizontalScroll=function(){return this.control.get("horizontalScroll")},ScrollPanel.prototype.setHorizontalScroll=function(e){InfinniUI.Metadata.isValidValue(e,InfinniUI.ScrollVisibility)&&this.control.set("horizontalScroll",e)},ScrollPanel.prototype.getVerticalScroll=function(){return this.control.get("verticalScroll")},ScrollPanel.prototype.setVerticalScroll=function(e){InfinniUI.Metadata.isValidValue(e,InfinniUI.ScrollVisibility)&&this.control.set("verticalScroll",e)},ScrollPanel.prototype.createControl=function(){return new ScrollPanelControl},InfinniUI.ScrollPanelBuilder=ScrollPanelBuilder,_.inherit(ScrollPanelBuilder,ContainerBuilder),_.extend(ScrollPanelBuilder.prototype,{createElement:function(e){return new ScrollPanel(e.parent)},applyMetadata:function(e){var t=e.metadata,n=e.element,i=ContainerBuilder.prototype.applyMetadata.call(this,e);return n.setHorizontalScroll(t.HorizontalScroll),n.setVerticalScroll(t.VerticalScroll),i}}),InfinniUI.TabPanel=TabPanel,_.inherit(TabPanel,Container),TabPanel.prototype.getHeaderLocation=function(){return this.control.get("headerLocation")},TabPanel.prototype.setHeaderLocation=function(e){InfinniUI.Metadata.isValidValue(e,InfinniUI.TabHeaderLocation)&&this.control.set("headerLocation",e)},TabPanel.prototype.getHeaderOrientation=function(){return this.control.get("headerOrientation")},TabPanel.prototype.setHeaderOrientation=function(e){InfinniUI.Metadata.isValidValue(e,InfinniUI.TabHeaderOrientation)&&this.control.set("headerOrientation",e)},TabPanel.prototype.setHeaderTemplate=function(e){this.control.set("headerTemplate",e)},TabPanel.prototype.getHeaderTemplate=function(){return this.control.get("headerTemplate")},TabPanel.prototype.setSelectedItem=function(e){return this.control.setSelectedItem(e)},TabPanel.prototype.getSelectedItem=function(){return this.control.get("selectedItem")},TabPanel.prototype.onSelectedItemChanged=function(e){this.control.on("change:selectedItem",e)},TabPanel.prototype.closeTab=function(e){var t=this.childElements.indexOf(e);if(t===-1)throw new Error("TabPage not found in TabPanel.childElements");this.getItems().removeAt(t)},TabPanel.prototype.createControl=function(){return new TabPanelControl},InfinniUI.TabPanelBuilder=TabPanelBuilder,_.inherit(TabPanelBuilder,ContainerBuilder),_.extend(TabPanelBuilder.prototype,{createElement:function(e){return new TabPanel(e.parent)},applyMetadata:function(e){var t=e.metadata,n=e.element,i=ContainerBuilder.prototype.applyMetadata.call(this,e);return n.setHeaderLocation(t.HeaderLocation),n.setHeaderOrientation(t.HeaderOrientation),this.initScriptHandlers(e),i},initScriptHandlers:function(e){var t=e.metadata,n=e.element;n.onSelectedItemChanged(function(e,t){var n=InfinniUI.global.messageBus;n.send("OnChangeLayout",{})});var i={parentView:e.parentView,parent:n,basePathOfProperty:e.basePathOfProperty};if(t.OnSelectedItemChanged){var o=Executor(t.OnSelectedItemChanged,e.builder,i);n.onSelectedItemChanged(function(e,t){o(t)})}}}),InfinniUI.TablePanel=TablePanel,_.inherit(TablePanel,Container),_.extend(TablePanel.prototype,{createControl:function(){return new TablePanelControl}}),InfinniUI.TablePanelBuilder=TablePanelBuilder,_.inherit(TablePanelBuilder,ContainerBuilder),_.extend(TablePanelBuilder.prototype,{createElement:function(e){return new TablePanel(e.parent)},applyMetadata:function(e){ContainerBuilder.prototype.applyMetadata.call(this,e)}}),InfinniUI.ToggleButton=ToggleButton,_.inherit(ToggleButton,Element),_.extend(ToggleButton.prototype,{createControl:function(e){return new ToggleButtonControl(e)},getTextOn:function(){return this.control.get("textOn")},setTextOn:function(e){return this.control.set("textOn",e?e:"")},getTextOff:function(){return this.control.get("textOff")},setTextOff:function(e){return this.control.set("textOff",e?e:"")}},editorBaseMixin),InfinniUI.ToggleButtonBuilder=ToggleButtonBuilder,_.inherit(ToggleButtonBuilder,ElementBuilder),_.extend(ToggleButtonBuilder.prototype,{createElement:function(e){return new ToggleButton(e.parent)},applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e),this.applyMetadata_editorBaseBuilder(e);var t=e.element,n=e.metadata;t.setTextOff(n.TextOff),t.setTextOn(n.TextOn)}},editorBaseBuilderMixin);var ToolBar=function(e){_.superClass(ToolBar,this,e)};InfinniUI.ToolBar=ToolBar,_.inherit(ToolBar,Container),ToolBar.prototype.createControl=function(){return new ToolBarControl},InfinniUI.ToolBarBuilder=ToolBarBuilder,_.inherit(ToolBarBuilder,ContainerBuilder),_.extend(ToolBarBuilder.prototype,{createElement:function(e){return new ToolBar(e.parent)}});var Tooltip=function(e){_.superClass(Icon,this,e)};_.inherit(Tooltip,Element),_.extend(Tooltip.prototype,{createControl:function(){return new InfinniUI.TooltipControl},setContent:function(e){this.control.set("content",e)}}),InfinniUI.Tooltip=Tooltip,InfinniUI.TooltipBuilder=TooltipBuilder,_.inherit(TooltipBuilder,ElementBuilder),_.extend(TooltipBuilder.prototype,{createElement:function(e){return new InfinniUI.Tooltip},normalizeMetadata:function(e){return"string"==typeof e&&(e={Text:e}),e},applyMetadata:function(e){var t=e.element;e.metadata=this.normalizeMetadata(e.metadata),ElementBuilder.prototype.applyMetadata.call(this,e),t.setContent(this.buildContent(e.metadata,e));var n=InfinniUI.global.messageBus;n.send(messageTypes.onToolTipInit,{element:e.parent,content:t}),e.parent.onRemove(function(){n.send(messageTypes.onToolTipDestroy,{element:e.parent})})},buildContent:function(e,t){var n,i=t.builder,o={parent:t.element,parentView:t.parentView,basePathOfProperty:t.basePathOfProperty};return n="Text"in e?this.buildTextContent(e.Text,i,o):this.buildElementContent(e,i,o)},buildTextContent:function(e,t,n){return t.buildType("Label",{Text:e},n)},buildElementContent:function(e,t,n){return t.build(e,n)}}),InfinniUI.TreeView=TreeView,_.inherit(TreeView,ListEditorBase),TreeView.prototype.createControl=function(){return new TreeViewControl},TreeView.prototype.getKeySelector=function(){return this.control.get("keySelector")},TreeView.prototype.setKeySelector=function(e){this.control.set("keySelector",e)},TreeView.prototype.getParentSelector=function(){return this.control.get("parentSelector")},TreeView.prototype.setParentSelector=function(e){this.control.set("parentSelector",e)},TreeView.prototype.expand=function(e){this.control.expand(e)},TreeView.prototype.collapse=function(e){this.control.collapse(e)},TreeView.prototype.toggle=function(e){this.control.toggle(e)},TreeView.prototype.getOnExpand=function(){return this.control.get("onExpand")},TreeView.prototype.setOnExpand=function(e){this.control.set("onExpand",e)},TreeView.prototype.getOnCollapse=function(){return this.control.get("onCollapse")},TreeView.prototype.setOnCollapse=function(e){this.control.set("onCollapse",e)},InfinniUI.TreeViewBuilder=TreeViewBuilder,_.inherit(TreeViewBuilder,ListEditorBaseBuilder),_.extend(TreeViewBuilder.prototype,{createElement:function(e){return new TreeView(e.parent)},applyMetadata:function(e){var t=e.element,n=e.metadata;ListEditorBaseBuilder.prototype.applyMetadata.call(this,e);if(this._initKeySelector(e),this._initParentSelector(e),n.OnExpand){var i=function(e){new ScriptExecutor(t.getScriptsStorage()).executeScript(n.OnExpand,{item:e})};t.setOnExpand(i)}if(n.OnCollapse){var o=function(e){new ScriptExecutor(t.getScriptsStorage()).executeScript(n.OnCollapse,{item:e})};t.setOnCollapse(o)}},_initKeySelector:function(e){var t,n=e.element,i=e.metadata;t=i.KeySelector?function(e,t){var o=new ScriptExecutor(n.getScriptsStorage());return o.executeScript(i.KeySelector,t)}:i.KeyProperty?function(e,t){return InfinniUI.ObjectUtils.getPropertyValue(t.value,i.KeyProperty)}:function(e,t){return t.value},n.setKeySelector(t)},_initParentSelector:function(e){var t,n=e.element,i=e.metadata;t=i.ParentSelector?function(e,t){var o=new ScriptExecutor(n.getScriptsStorage());return o.executeScript(i.ParentSelector,t)}:i.ParentProperty?function(e,t){return InfinniUI.ObjectUtils.getPropertyValue(t.value,i.ParentProperty)}:function(e,t){return t.value},n.setParentSelector(t)}}),InfinniUI.View=View,_.inherit(View,Container),_.extend(View.prototype,{isView:!0,_initDataSourceHandlers:function(){var e=this,t=this.getContext().dataSources,n=[];this.control.onLoaded(function(){for(var i in t)n.push(t[i].getCurrentRequestPromise());n.length>0?$.when.apply($,n).done(function(){e._notifyAboutDsReady()}):e._notifyAboutDsReady()})},_notifyAboutDsReady:function(){this.handlers.onBeforeLoaded.resolve(),this.handlers.onLoaded.resolve()},createControl:function(){return new ViewControl},_initContext:function(){this.context={view:this,scripts:{},parameters:{},dataSources:{},controls:{},messageBus:new MessageBus(this),global:InfinniUI.global};var e=this;this.control.get("scripts").onChange(function(){e.context.scripts={};var t=e.getScripts();t.forEach(function(t){e.context.scripts[t.name]=t.func})}),this.control.get("parameters").onChange(function(){e.context.parameters={};var t=e.getParameters();t.forEach(function(t){e.context.parameters[t.name]=t,e.registerMember(t.name,t)})}),this.control.get("dataSources").onChange(function(){e.context.dataSources={};var t=e.getDataSources();t.forEach(function(t){e.context.dataSources[t.get("name")]=t,e.registerMember(t.name,t)})})},getApplicationView:function(){var e=this.control.get("isApplication"),t=this.parent;return e?this:_.isEmpty(t)?null:t.getApplicationView()},isApplication:function(e){var t=this.control.get("isApplication");return"boolean"==typeof e&&this.control.set("isApplication",e),t},registerElement:function(e){this.context.controls[e.name]=e,this.registerMember(e.name,e)},getContext:function(){return this.context},getScripts:function(){return this.control.get("scripts")},getParameters:function(){return this.control.get("parameters")},getDataSources:function(){return this.control.get("dataSources")},getDialogResult:function(){return this.control.get("dialogResult")},setDialogResult:function(e){return this.control.set("dialogResult",e)},open:function(e,t){var n=this.getContext(),i=this._getScriptArgs();this.eventManager.trigger("onOpening",i,n)?(this.openStrategy.open(),this.eventManager.trigger("onOpened",i,n),e&&e(n,i)):t&&t(n,i)},close:function(e,t,n){if(!this.isClosing){this.isClosing=!0;var i=this.getContext(),o=this._getScriptArgs();n||this.eventManager.trigger("onClosing",o,i)?(this.eventManager.trigger("onClosed",o,i),this.openStrategy.close(),this.removeParameters(),e&&e(i,o)):t&&t(i,o)}},removeParameters:function(){var e=this.getContext(),t=this.control.get("parameters");t._items.length&&(t.forEach(function(e){e.remove()}),t.removeAll(),e.parameters={})},getScriptsStorage:function(){return this},setOpenStrategy:function(e){this.openStrategy=e},onBeforeLoaded:function(e){this.handlers.onBeforeLoaded.done(e)},onLoaded:function(e){this.handlers.onLoaded.done(e)},onOpening:function(e){this.eventManager.on("onOpening",e)},onOpened:function(e){this.eventManager.on("onOpened",e)},onClosing:function(e){this.eventManager.on("onClosing",e)},onClosed:function(e){this.eventManager.on("onClosed",e)},_getScriptArgs:function(){return{source:this}},setHeaderTemplate:function(e){this.headerTemplate=e},getHeaderTemplate:function(){return this.headerTemplate},setCloseButtonVisibility:function(e){"boolean"==typeof e&&this.control.set("closeButtonVisibility",e)},getCloseButtonVisibility:function(){return this.control.get("closeButtonVisibility")},noDataSourceOnView:function(){this._initDataSourceHandlers()},registerMember:function(e,t){this.members[e]=t,e in this.membersDeferreds&&this.membersDeferreds[e].resolve(t)},getDeferredOfMember:function(e){if("LocalStorageDS"===e)return $.Deferred().resolve(InfinniUI.localStorageDataSource);if(!(e in this.membersDeferreds)&&(this.membersDeferreds[e]=$.Deferred(),this.members[e])){var t=this.members[e];this.membersDeferreds[e].resolve(t)}return this.membersDeferreds[e]},setFocusOnControl:function(e){this.control.set("focusOnControl",e)},getFocusOnControl:function(){return this.control.get("focusOnControl")}}),InfinniUI.ViewBuilder=ViewBuilder,_.inherit(ViewBuilder,ContainerBuilder),_.extend(ViewBuilder.prototype,{createElement:function(e){return new View(e.parent)},applyMetadata:function(e){e.parentView;e=_.extend({},e),e.parentView=e.element;var t=e.metadata,n=e.element,i=e.builder,o=n.getScripts(),r=n.getParameters();if(t.Scripts)for(var a=0,l=t.Scripts.length;a<l;++a){var s=t.Scripts[a],u={name:s.Name,func:i.buildType("Script",s,{parentView:n})};o.add(u)}if(this.triggerStartCreatingEvent(e),t.Parameters)for(var c,d,p,h=e.params||{},f=0,m=t.Parameters.length;f<m;++f)if(c=t.Parameters[f].Name,p=h[c],p||(p=new Parameter({view:n}),p.setName(c),"DefaultValue"in t.Parameters[f]&&(d=t.Parameters[f].DefaultValue,p.setValue(d))),p.set("view",e.element),r.add(p),"undefined"!=typeof t.Parameters[f].OnPropertyChanged){var g=t.Parameters[f].OnPropertyChanged;p.onPropertyChanged(function(){new ScriptExecutor(n).executeScript(g)})}if(t.DataSources&&t.DataSources.length){var y=i.buildMany(t.DataSources,{parentView:n,suspended:e.suspended});n.getDataSources().set(y),this.changeDataSourcesReadinessByPriority(y);for(var v=0,b=y.length;v<b;v++)y[v].isLazy()||y[v].tryInitData()}else n.noDataSourceOnView();if(t.NotificationSubscriptions){var I=InfinniUI.global.notificationSubscription;for(var x in t.NotificationSubscriptions)!function(){var e=t.NotificationSubscriptions[x];I.subscribe(x,function(t,i){new ScriptExecutor(n).executeScript(e,{context:t,message:i.message})},this)}();n.onClosing(function(){for(var e in t.NotificationSubscriptions)I.unsubscribe(e,this)})}this.initBindingToProperty(e,"CloseButtonVisibility",!0),n.setHeaderTemplate(this.buildHeaderTemplate(n,e));
var w={parentView:n,parent:n,basePathOfProperty:e.basePathOfProperty};if(t.OnOpening){var C=Executor(t.OnOpening,e.builder,w);n.onOpening(C)}if(t.OnOpened){var P=Executor(t.OnOpened,e.builder,w);n.onOpened(P)}if(t.OnClosing){var B=Executor(t.OnClosing,e.builder,w);n.onClosing(B)}if(t.OnClosed){var T=Executor(t.OnClosed,e.builder,w);n.onClosed(T)}ContainerBuilder.prototype.applyMetadata.call(this,e),n.setFocusOnControl(t.FocusOnControl)},triggerStartCreatingEvent:function(e){var t=e.element,n=e.metadata,i=n.OnStartCreating;if(i){var o={parentView:e.parentView,parent:t,basePathOfProperty:e.basePathOfProperty},r=Executor(i,e.builder,o);r({})}},changeDataSourcesReadinessByPriority:function(e){var t=_.groupBy(e,function(e){return e.getResolvePriority()}),n=function(e){if(_.keys(e).length){var t=_.chain(e).keys().max().value(),i=e[t],o=i.length,r=_.omit(e,t),a=0;_.each(i,function(e){e.onItemsUpdatedOnce(function(e,t){++a==o&&setTimeout(function(){n(r)},0)}),e.setIsWaiting(!1)})}};_.keys(t).length>1&&(_.each(e,function(e){e.setIsWaiting(!0)}),n(t))}},viewBuilderHeaderTemplateMixin),InfinniUI.ViewPanel=ViewPanel,_.inherit(ViewPanel,Element),_.extend(ViewPanel.prototype,{setLayout:function(e){var t=this.getLayout();t&&t.close(),this.control.set("layout",e)},getLayout:function(){return this.control.get("layout")},createControl:function(){return new ViewPanelControl}}),InfinniUI.ViewPanelBuilder=ViewPanelBuilder,_.inherit(ViewPanelBuilder,ElementBuilder),_.extend(ViewPanelBuilder.prototype,{applyMetadata:function(e){ElementBuilder.prototype.applyMetadata.call(this,e);var t=e.builder,n=e.element,i=e.metadata;if(_.isEmpty(i.Name)&&(i.Name=guid(),n.setName(i.Name)),InfinniUI.global.containers[i.Name]=n,"LinkView"in i){var o=t.build(i.LinkView,{parentView:e.parentView,parent:e.element});o.setOpenMode("Container"),o.setContainer(i.Name),o.createView(function(e){e.open()})}},createElement:function(e){return new ViewPanel(e.parent)}}),InfinniUI.global.containers={},_.inherit(DataGridRow,Element),_.extend(DataGridRow.prototype,{createControl:function(){return new DataGridRowControl},setCellElements:function(e){this.control.set("cellElements",e)},toggle:function(e){this.control.set("toggle",e)},getSelected:function(){this.control.get("selected")},setSelected:function(e){this.control.set("selected",e)},setMultiSelect:function(e){this.control.set("multiSelect",e)},setShowSelectors:function(e){this.control.set("showSelectors",e)},onToggle:function(e){this.control.onToggle(e)},setRowBackground:function(e){this.control.set("rowBackground",e)},getRowBackground:function(){return this.control.get("rowBackground")},setRowForeground:function(e){this.control.set("rowForeground",e)},getRowForeground:function(){return this.control.get("rowForeground")},setRowTextStyle:function(e){this.control.set("rowTextStyle",e)},getRowTextStyle:function(){return this.control.get("rowTextStyle")},setRowStyle:function(e){this.control.set("rowStyle",e)},getRowStyle:function(){return this.control.get("rowStyle")},setGrid:function(e){this.control.set("grid",e)},_transformRowProperties:function(e){for(var t in e)e.hasOwnProperty(t)&&(this.setProperty(e[t],this.getProperty(t)),this.onPropertyChanged(t,function(e,t){return function(n,i){e.setProperty(t,i.newValue)}}(this,e[t])))}}),_.inherit(TabPage,Container),TabPage.prototype.getIcon=function(){return this.control.get("icon")},TabPage.prototype.setIcon=function(e){this.control.set("icon",e)},TabPage.prototype.getCanClose=function(){return this.control.get("canClose")},TabPage.prototype.setCanClose=function(e){this.control.set("canClose",e)},TabPage.prototype.close=function(e,t){var n=this.getCanClose(),i=this,o=this.events;n&&this.events.trigger("closing").done(function(){i.parent&&i.parent.closeTab(i),"function"==typeof e&&e(),o.trigger("closed")}).fail(function(){"function"==typeof t&&t()})},TabPage.prototype.onClosing=function(e){this.events.on("closing",e)},TabPage.prototype.onClosed=function(e){this.events.on("closed",e)},TabPage.prototype.getSelected=function(){return this.control.get("selected")},TabPage.prototype.setSelected=function(e){this.control.set("selected",e)},TabPage.prototype.createControl=function(){return new TabPageControl},InfinniUI.TabPage=TabPage,_.inherit(TabPageBuilder,ContainerBuilder),_.extend(TabPageBuilder.prototype,{createElement:function(e){return new TabPage(e.parent)},applyMetadata:function(e){var t=e.metadata,n=e.element,i=ContainerBuilder.prototype.applyMetadata.call(this,e);return n.setIcon(t.Icon),n.setCanClose(t.CanClose),this.initScriptHandlers(e),i},initScriptHandlers:function(e){var t=e.metadata,n=e.element,i={parentView:e.parentView,parent:n,basePathOfProperty:e.basePathOfProperty};if(t.OnClosing){var o=Executor(t.OnClosing,e.builder,i);n.onClosing(o.bind(null,{}))}if(t.OnClosed){var r=Executor(t.OnClosed,e.builder,i);n.onClosed(r.bind(null,{}))}}}),InfinniUI.TabPageBuilder=TabPageBuilder,_.inherit(Cell,Container),_.extend(Cell.prototype,{createControl:function(){return new CellControl},getColumnSpan:function(){return this.control.get("columnSpan")},setColumnSpan:function(e){this.control.set("columnSpan",e)}}),InfinniUI.Cell=Cell,_.inherit(CellBuilder,ContainerBuilder),_.extend(CellBuilder.prototype,{createElement:function(e){return new Cell(e.parent)},applyMetadata:function(e){var t=e.metadata,n=e.element;ContainerBuilder.prototype.applyMetadata.call(this,e),n.setColumnSpan(t.ColumnSpan)}}),InfinniUI.CellBuilder=CellBuilder,_.inherit(Row,Container),_.extend(Row.prototype,{createControl:function(){return new RowControl}}),InfinniUI.Row=Row,_.inherit(RowBuilder,ContainerBuilder),_.extend(RowBuilder.prototype,{createElement:function(e){return new Row(e.parent)},applyMetadata:function(e){ContainerBuilder.prototype.applyMetadata.call(this,e)}}),InfinniUI.RowBuilder=RowBuilder,InfinniUI.BaseAction=BaseAction,_.extend(BaseAction.prototype,{defaults:{canExecute:null},setProperty:function(e,t){var n=this._properties;n[e]!==t&&(n[e]=t,this.trigger("change:"+e,this,t))},getProperty:function(e){return this._properties[e]},initDefaultValues:function(){},onExecutedHandler:function(e){var t=this.getProperty("onExecutedHandler");"function"==typeof t&&t(e)},_isRootElementPath:function(e){return!e.includes(".")}},Backbone.Events),InfinniUI.global.executeAction=function(e,t,n){var i=new ApplicationBuilder,o=i.build(t,{parentView:e.view});o.execute(n)};var baseActionBuilderMixin={applyBaseActionMetadata:function(e,t){var n=t.metadata,i={parentView:t.parentView,parent:t.parent,basePathOfProperty:t.basePathOfProperty};if("OnExecuted"in n){var o=Executor(n.OnExecuted,t.builder,i);e.setProperty("onExecutedHandler",o)}if(n.CanExecute){var r=Executor(n.CanExecute,t.builder,i);e.setProperty("canExecute",r)}}};InfinniUI.baseActionBuilderMixin=baseActionBuilderMixin,InfinniUI.BaseEditAction=BaseEditAction,_.inherit(BaseEditAction,BaseAction),_.extend(BaseEditAction.prototype,{execute:function(e){var t=this,n=this.getProperty("linkView");this.setProperty("callback",e),n.createView(function(e){t.handleViewReady(e)})},handleViewReady:function(e){var t=this.getProperty("sourceSource"),n=e.getContext().dataSources[t],i=this.getProperty("destinationSource"),o=this.parentView.getContext().dataSources[i],r=this;this.setProperty("editDataSource",n),this.setProperty("destinationDataSource",o);var a=this.setSelectedItem();a?(e.open(),e.onClosed(function(){var t=e.getDialogResult();t==DialogResult.accepted&&r.handleClosingView()})):e.close()},handleClosingView:function(){var e=this.getProperty("callback");this.save(),this.onExecutedHandler(),"function"==typeof e&&e()},_isObjectDataSource:function(e){return"setItems"in e}});var baseEditActionBuilderMixin={applyBaseEditActionMetadata:function(e,t){var n=t.metadata,i=t.parentView,o=t.builder,r={};r[n.SourceValue.Source]="BaseEditAction";var a=o.build(n.LinkView,{parent:t.parent,parentView:i,basePathOfProperty:t.basePathOfProperty,suspended:r});if(e.setProperty("linkView",a),e.setProperty("sourceSource",n.SourceValue.Source),n.DestinationValue&&n.DestinationValue.Source){e.setProperty("destinationSource",n.DestinationValue.Source);var l=null!==t.basePathOfProperty&&"undefined"!=typeof t.basePathOfProperty?t.basePathOfProperty.resolveProperty(n.DestinationValue.Property):n.DestinationValue.Property;e.setProperty("destinationProperty",l)}}};InfinniUI.baseEditActionBuilderMixin=baseEditActionBuilderMixin;var baseFallibleActionBuilderMixin={applyBaseFallibleActionMetadata:function(e,t){var n=t.metadata,i={parentView:t.parentView,parent:t.parent,basePathOfProperty:t.basePathOfProperty};if("OnSuccess"in n){var o=Executor(n.OnSuccess,t.builder,i);e.setProperty("onSuccessHandler",o)}if("OnError"in n){var r=Executor(n.OnError,t.builder,i);e.setProperty("onErrorHandler",r)}}};InfinniUI.baseFallibleActionBuilderMixin=baseFallibleActionBuilderMixin;var baseFallibleActionMixin={onSuccessHandler:function(e){var t=this.getProperty("onSuccessHandler");"function"==typeof t&&t(e)},onErrorHandler:function(e){var t=this.getProperty("onErrorHandler");"function"==typeof t&&t(e)}};InfinniUI.baseFallibleActionMixin=baseFallibleActionMixin,_.inherit(AcceptAction,BaseAction),_.extend(AcceptAction.prototype,{execute:function(e){var t=this;this.parentView.onClosed(function(){t.onExecutedHandler(),e&&e()}),this.parentView.setDialogResult(DialogResult.accepted),this.parentView.close()}}),InfinniUI.AcceptAction=AcceptAction,_.extend(AcceptActionBuilder.prototype,baseActionBuilderMixin,{build:function(e,t){var n=new AcceptAction(t.parentView);return this.applyBaseActionMetadata(n,t),n}}),InfinniUI.AcceptActionBuilder=AcceptActionBuilder,_.inherit(AddAction,BaseEditAction),_.extend(AddAction.prototype,{setSelectedItem:function(){var e=this.getProperty("editDataSource"),t=e.getView();return t.onBeforeLoaded(function(){e.createItem()}),!0},save:function(){var e=this.getProperty("editDataSource"),t=this.getProperty("destinationDataSource"),n=this.getProperty("destinationProperty")||"";if(t)if(this._isObjectDataSource(e)){var i=e.getSelectedItem();if(this._isRootElementPath(n))t._includeItemToModifiedSet(i),t.saveItem(i,function(){t.updateItems()});else{var o=t.getProperty(n)||[];o=_.clone(o),o.push(i),t.setProperty(n,o)}}else t.updateItems()}}),InfinniUI.AddAction=AddAction,_.extend(AddActionBuilder.prototype,baseActionBuilderMixin,baseEditActionBuilderMixin,{build:function(e,t){var n=new AddAction(t.parentView);return this.applyBaseActionMetadata(n,t),this.applyBaseEditActionMetadata(n,t),n}}),InfinniUI.AddActionBuilder=AddActionBuilder,_.inherit(CancelAction,BaseAction),_.extend(CancelAction.prototype,{execute:function(e){var t=this;this.parentView.onClosed(function(){t.onExecutedHandler(),e&&e()}),this.parentView.setDialogResult(DialogResult.canceled),this.parentView.close()}}),InfinniUI.CancelAction=CancelAction,_.extend(CancelActionBuilder.prototype,baseActionBuilderMixin,{build:function(e,t){var n=new CancelAction(t.parentView);return this.applyBaseActionMetadata(n,t),n}}),InfinniUI.CancelActionBuilder=CancelActionBuilder,_.inherit(CreateItemAction,BaseAction),_.extend(CreateItemAction.prototype,{execute:function(e){var t=this.getProperty("destinationDataSource"),n=this.getProperty("destinationProperty")||"";if(t)if(!n||this._isRootElementPath(n))t.createItem(function(t,n){e&&e()});else{var i=t.getProperty(n)||[];i=_.clone(i),i.push({}),t.setProperty(n,i),e&&e()}}}),InfinniUI.CreateItemAction=CreateItemAction,_.extend(CreateItemActionBuilder.prototype,baseActionBuilderMixin,{build:function(e,t){var n=new CreateItemAction(t.parentView),i=t.metadata;if(this.applyBaseActionMetadata(n,t),i.DestinationValue&&i.DestinationValue.Source){n.setProperty("destinationSource",i.DestinationValue.Source),n.setProperty("destinationDataSource",e.dataSources[i.DestinationValue.Source]);var o=null!==t.basePathOfProperty&&"undefined"!=typeof t.basePathOfProperty?t.basePathOfProperty.resolveProperty(i.DestinationValue.Property):i.DestinationValue.Property;n.setProperty("destinationProperty",o)}return n}}),InfinniUI.CreateItemActionBuilder=CreateItemActionBuilder,_.inherit(DeleteAction,BaseAction),_.extend(DeleteAction.prototype,baseFallibleActionMixin,{execute:function(e){var t=this.getProperty("accept"),n=this,i=this.getProperty("destinationSource"),o=this.getProperty("destinationProperty"),r=this.getProperty("acceptMessage")||localized.strings.DeleteAction.warnMessage,a=this.getProperty("acceptMessageType")||"default";i.getProperty(o)?t?new MessageBox({text:r,type:a,buttons:[{name:localized.strings.DeleteAction.agree,type:"action",onClick:function(){n.remove(e)}},{name:localized.strings.DeleteAction.disagree}]}):this.remove(e):new MessageBox({text:localized.strings.DeleteAction.warnMessageNoItem,type:"error",buttons:[{name:localized.strings.DeleteAction.cancel}]})},remove:function(e){var t=this.getProperty("destinationSource"),n=this.getProperty("destinationProperty");this._isRootElementPath(n)?this._deleteDocument(t,n,e):this._deleteArrayElement(t,n,e)},_deleteDocument:function(e,t,n){var i=this,o=function(t,o){e.updateItems(),i.onExecutedHandler(o),i.onSuccessHandler(o),"function"==typeof n&&n()},r=function(e,t){i.onExecutedHandler(t),i.onErrorHandler(t),"function"==typeof n&&n()},a=e.getProperty(t);e.deleteItem(a,o,r)},_deleteArrayElement:function(e,t,n){var i=t.split("."),o=i.pop(),r=i.join("."),a=e.getProperty(r);a=_.clone(a),a.splice(o,1),e.setProperty(r,a),this.onExecutedHandler(),this.onSuccessHandler(),"function"==typeof n&&n()}}),InfinniUI.DeleteAction=DeleteAction,_.extend(DeleteActionBuilder.prototype,baseActionBuilderMixin,baseFallibleActionBuilderMixin,{build:function(e,t){var n=t.metadata,i=t.parentView,o=n.DestinationValue.Source,r=n.DestinationValue.Property||"$",a=new DeleteAction(i);this.applyBaseActionMetadata(a,t),this.applyBaseFallibleActionMetadata(a,t);var l=n.Accept!==!1,s=i.getContext().dataSources[o],u=null!==t.basePathOfProperty&&"undefined"!=typeof t.basePathOfProperty?t.basePathOfProperty.resolveProperty(r):r;return a.setProperty("accept",l),a.setProperty("acceptMessage",n.AcceptMessage),a.setProperty("acceptMessageType",n.AcceptMessageType),a.setProperty("destinationSource",s),a.setProperty("destinationProperty",u),a}}),InfinniUI.DeleteActionBuilder=DeleteActionBuilder,_.inherit(EditAction,BaseEditAction),_.extend(EditAction.prototype,{setSelectedItem:function(){var e=this.getProperty("editDataSource"),t=this.getProperty("destinationDataSource"),n=this.getProperty("destinationProperty"),i=t.getProperty(n);if(null===i||"undefined"==typeof i){if(this._isRootElementPath(n)){var o=InfinniUI.global.logger,r=stringUtils.format('EditAction: edit item has not been found. {0} does not have item by path "{1}"',[t.getName(),n]);return o.error(r),!1}i=i||{}}return this._isObjectDataSource(e)?this._setItem(e,i):this._setDocument(e,i),!0},_resumeUpdateEditDataSource:function(){var e=this.getProperty("editDataSource");e.resumeUpdate("BaseEditAction")},_setDocument:function(e,t){var n=e.idOfItem(t);e.setIdFilter(n),e.tryInitData(),this._resumeUpdateEditDataSource()},_setItem:function(e,t){var n=_.clone(t);"undefined"!=typeof n&&null!==n||(n={}),this._resumeUpdateEditDataSource(),e.setItems([n]),e.setSelectedItem(n)},save:function(){var e=this.getProperty("editDataSource"),t=this.getProperty("destinationDataSource"),n=this.getProperty("destinationProperty");if(this._isObjectDataSource(e)){var i=e.getSelectedItem(),o=t.getProperty(n);this._isRootElementPath(n)?(this._overrideOriginItem(o,i),t._includeItemToModifiedSet(o),t.saveItem(o,function(){t.updateItems()})):t.setProperty(n,i)}else t.updateItems()},_overrideOriginItem:function(e,t){var n;for(n in e)delete e[n];for(n in t)e[n]=_.clone(t[n])}}),InfinniUI.EditAction=EditAction,_.extend(EditActionBuilder.prototype,baseActionBuilderMixin,baseEditActionBuilderMixin,{build:function(e,t){var n=new EditAction(t.parentView);return this.applyBaseActionMetadata(n,t),this.applyBaseEditActionMetadata(n,t),n}}),InfinniUI.EditActionBuilder=EditActionBuilder,_.inherit(OpenAction,BaseAction),_.extend(OpenAction.prototype,{execute:function(e){var t=this.getProperty("linkView"),n=this;t.createView(function(t){t.onLoaded(function(){n.onExecutedHandler(),e&&e(t)}),t.open()})}}),InfinniUI.OpenAction=OpenAction,_.extend(OpenActionBuilder.prototype,baseActionBuilderMixin,{build:function(e,t){var n=new OpenAction(t.parentView);this.applyBaseActionMetadata(n,t);var i=t.builder.build(t.metadata.LinkView,{parent:t.parent,parentView:t.parentView,basePathOfProperty:t.basePathOfProperty});return n.setProperty("linkView",i),n}}),InfinniUI.OpenActionBuilder=OpenActionBuilder,_.inherit(RouteToAction,BaseAction),_.extend(RouteToAction.prototype,{execute:function(e){var t=InfinniUI.AppRouter,n=this.getHref(),i=this.getReplace(),o={trigger:!0};i&&(o.replace=!0),t.navigate(n,o)},getHref:function(){return this.href},setHref:function(e){this.href=e},getReplace:function(){return this.replace},setReplace:function(e){"boolean"==typeof e&&(this.replace=e)}}),InfinniUI.RouteToAction=RouteToAction,_.extend(RouteToActionBuilder.prototype,baseActionBuilderMixin,routerServiceMixin,{build:function(e,t){var n=new RouteToAction,i=InfinniUI.routerService.getLinkByName(t.metadata.Name,"no"),o=t.metadata.Params,r=t.metadata.Query,a=t.metadata.Replace;if(n.setReplace(a),n.setHref(i),t.element=n,o)for(var l=0,s=o.length;l<s;l+=1)"string"==typeof o[l].Value?(n.getHref()!==i&&(i=n.getHref()),i=this.replaceParamsInHref(i,o[l].Name,o[l].Value),n.setHref(i)):this.bindParams(t,o[l].Name,o[l].Value,i);if(r)for(var u=0,c=r.length;u<c;u+=1)"string"==typeof r[u].Value?(n.getHref()!==i&&(i=n.getHref()),i=this.replaceParamsInQuery(i,r[u].Name,r[u].Value),n.setHref(i)):this.bindQuery(t,r[u].Name,r[u].Value,i);return n}}),InfinniUI.RouteToActionBuilder=RouteToActionBuilder,_.inherit(SaveAction,BaseAction),_.extend(SaveAction.prototype,baseFallibleActionMixin,{execute:function(e){var t=this.parentView,n=this.getProperty("dataSource"),i=this.getProperty("canClose"),o=this,r=function(n,r){t.setDialogResult(DialogResult.accepted),i!==!1&&t.close(),o.onExecutedHandler(r),o.onSuccessHandler(r),"function"==typeof e&&e(n,r)},a=function(t,n){o.onExecutedHandler(n),o.onErrorHandler(n),"function"==typeof e&&e(t,n)},l=n.getSelectedItem();n.saveItem(l,r,a)}}),InfinniUI.SaveAction=SaveAction,_.extend(SaveActionBuilder.prototype,baseActionBuilderMixin,baseFallibleActionBuilderMixin,{build:function(e,t){var n=t.parentView,i=n.getContext().dataSources[t.metadata.DestinationValue.Source],o=new SaveAction(n);return this.applyBaseActionMetadata(o,t),this.applyBaseFallibleActionMetadata(o,t),o.setProperty("dataSource",i),o.setProperty("canClose",t.metadata.CanClose),o}}),InfinniUI.SaveActionBuilder=SaveActionBuilder,_.inherit(SelectAction,BaseAction),_.extend(SelectAction.prototype,{execute:function(e){var t=this,n=this.parentView,i=this.getProperty("linkView"),o=this.getProperty("sourceSource"),r=this.getProperty("sourceProperty"),a=this.getProperty("destinationSource"),l=this.getProperty("destinationProperty");i.createView(function(i){i.onClosed(function(s,u){var c=i.getDialogResult();if(c==DialogResult.accepted){var d=i.getContext().dataSources[o],p=n.getContext().dataSources[a],h=d.getProperty(r);p.setProperty(l,h)}t.onExecutedHandler(u),e&&e(s,u)}),i.open()})}}),InfinniUI.SelectAction=SelectAction,_.extend(SelectActionBuilder.prototype,baseActionBuilderMixin,{build:function(e,t){var n=t.builder,i=t.metadata,o=t.parentView,r=new SelectAction(o);this.applyBaseActionMetadata(r,t);var a=n.build(i.LinkView,{parentView:o});return r.setProperty("linkView",a),r.setProperty("sourceSource",i.SourceValue.Source),r.setProperty("sourceProperty",i.SourceValue.Property),r.setProperty("destinationSource",i.DestinationValue.Source),r.setProperty("destinationProperty",i.DestinationValue.Property),r}}),InfinniUI.SelectActionBuilder=SelectActionBuilder,InfinniUI.DownloadExecutor=DownloadExecutor,DownloadExecutor.prototype.config=function(e){_.extend(this.options,e)},DownloadExecutor.prototype.run=function(e){var t=this.cleanup.bind(this),n=function(){"function"==typeof this.resultCallback&&this.resultCallback.apply(this,arguments)}.bind(this),i=function(e){"function"==typeof this.successCallback&&this.successCallback.call(this,e),n(e)}.bind(this),o=function(e){"function"==typeof this.successCallback&&this.successCallback.call(this,data),n(e)};this.waitResponse(t).always(function(){t()}).done(i).fail(o),this.openWindow(e)},DownloadExecutor.prototype.openWindow=function(e){var t=this.getName("window"),n=document.createElement("form");this.form=n,n.setAttribute("method",e.method),n.setAttribute("action",e.requestUrl),n.setAttribute("target",t),n.setAttribute("style","display: none;");var i=document.createElement("input");i.setAttribute("name","data"),i.setAttribute("value",JSON.stringify(e.args)),n.appendChild(i);var o=document.createElement("input");o.setAttribute("name","token"),o.setAttribute("value",this.getName("token")),n.appendChild(o),document.body.appendChild(n),this.popup=window.open("about:blank",t),n.submit()},DownloadExecutor.prototype.getName=function(e){return e+this.guid},DownloadExecutor.prototype.cleanup=function(){clearInterval(this.intervalId),clearTimeout(this.timeout),$.removeCookie(this.getName("token")),this.form&&(this.form.remove(),this.form=null),this.popup&&(this.popup.close(),this.popup=null)},DownloadExecutor.prototype.waitResponse=function(e){var t=this.getName("token"),n=$.Deferred(e);return this.intervalId=setInterval(function(){var e=$.cookie(t);e===t&&n.resolve()},this.options.poll),this.timeout=setTimeout(function(){n.reject()},this.options.timeout),n.promise()},_.inherit(ServerAction,BaseAction),_.extend(ServerAction.prototype,baseFallibleActionMixin,{defaults:{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"GET",data:{}},updateContentTypeStrategy:function(){var e=this.getProperty("contentType");"string"==typeof e&&e.includes("multipart")?this.contentTypeStrategy=serverActionContentTypeStrategy.File:this.contentTypeStrategy=serverActionContentTypeStrategy.Object},execute:function(e){var t=this,n=function(n){t.onExecutedHandler(n),"function"==typeof e&&e(n)},i=function(e){t.onSuccessHandler(e)},o=function(e){t.onErrorHandler(e)};this.contentTypeStrategy.run(this.provider,this._getRequestData(),n,i,o)},setParam:function(e,t){this.setProperty("params."+e,t)},getParam:function(e){return this.getProperty("params."+e)},_getRequestData:function(){var e=this._replaceParamsInStr(this.getProperty("origin")),t=this._replaceParamsInStr(this.getProperty("path")),n=this.getProperty("method").toUpperCase(),i=this.getProperty("contentType"),o=this._replaceParamsInObject(this.getProperty("data")),r={};return r.requestUrl=e+t,r.method=n,r.contentType=i,_.isEmpty(o)||("GET"==n?r.requestUrl=r.requestUrl+"?"+stringUtils.joinDataForQuery(o):r.args="string"==typeof i&&i.includes("application/json")?JSON.stringify(o):o),r},_replaceParamsInStr:function(e,t){if(!e||"string"!=typeof e)return e;var n=this,i=e.match(/^<%([\s\S]+?)%>$/);return i?this.getParam(i[1]):e.replace(/<%([\s\S]+?)%>/g,function(e,i){var o=n.getParam(i);return t&&"string"==typeof o&&(o=o.replace(/"/g,'\\"')),o})},_compileData:function(e){var t;if(Array.isArray(e))t=Array.map(function(e){("object"==typeof e||Array.isArray(e))&&this._compileData(e)},this);else if("object"==typeof e){t={};for(var n in Object.keys(e)){var i=Object.keys(e)[n],o=this._replaceParamsInStr(i);t[o]=this._compileData(e[i])}}else t=this._replaceParamsInStr(e,!0);return t},_replaceParamsInObject:function(e){return _.isEmpty(e)?e:this._compileData(e)}}),InfinniUI.ServerAction=ServerAction,_.extend(ServerActionBuilder.prototype,baseActionBuilderMixin,baseFallibleActionBuilderMixin,{build:function(e,t){var n=t.builder,i=t.metadata,o=t.parentView,r=new ServerAction(o);if(this.applyBaseActionMetadata(r,t),this.applyBaseFallibleActionMetadata(r,t),r.setProperty("origin",i.Origin||InfinniUI.config.serverUrl.replace(/\/$/,"")),r.setProperty("path",i.Path),i.Data&&r.setProperty("data",i.Data),i.Method&&r.setProperty("method",i.Method),(i.ContentType||i.ContentType===!1)&&r.setProperty("contentType",i.ContentType),i.Params)for(var a in i.Params){var l=i.Params[a];if(Array.isArray(l)||null===l||"object"!=typeof l)void 0!==l&&r.setParam(a,l);else{var s={parent:o,parentView:o,basePathOfProperty:t.basePathOfProperty};this._initBinding(a,l,r,s,n)}}return r},_initBinding:function(e,t,n,i,o){var r=o.buildBinding(t,i);r.setMode(InfinniUI.BindingModes.toElement),r.bindElement({setProperty:function(e,t){n.setParam(e,t)},onPropertyChanged:function(){}},e)}}),InfinniUI.ServerActionBuilder=ServerActionBuilder;var serverActionContentTypeStrategy={File:{run:function(e,t,n,i,o){e.download(t,n,i,o)}},Object:{run:function(e,t,n,i,o){e.request(t,n,i,o)}}};InfinniUI.serverActionContentTypeStrategy=serverActionContentTypeStrategy,_.inherit(UpdateAction,BaseAction),_.extend(UpdateAction.prototype,baseFallibleActionMixin,{execute:function(e){var t=this,n=this.getProperty("dataSource"),i=function(n,i){t.onExecutedHandler(i),t.onSuccessHandler(i),"function"==typeof e&&e(n,i)},o=function(n,i){t.onExecutedHandler(i),t.onErrorHandler(i),"function"==typeof e&&e(n,i)};n.updateItems(i,o)}}),InfinniUI.UpdateAction=UpdateAction,_.extend(UpdateActionBuilder.prototype,baseActionBuilderMixin,baseFallibleActionBuilderMixin,{build:function(e,t){var n=t.parentView.getContext().dataSources[t.metadata.DestinationValue.Source],i=new UpdateAction(t.parentView);return this.applyBaseActionMetadata(i,t),this.applyBaseFallibleActionMetadata(i,t),i.setProperty("dataSource",n),i}}),InfinniUI.UpdateActionBuilder=UpdateActionBuilder,_.extend(ApplicationBuilder.prototype,{builder:null,registerElementBuilders:function(){var e=this.builder;e.register("View",new ViewBuilder),e.register("InlineView",new InlineViewBuilder),e.register("AutoView",new MetadataViewBuilder),e.register("StackPanel",new StackPanelBuilder),e.register("GridPanel",new GridPanelBuilder),e.register("ScrollPanel",new ScrollPanelBuilder),e.register("Panel",new PanelBuilder),e.register("ScrollPanel",new ScrollPanelBuilder),e.register("ViewPanel",new ViewPanelBuilder),e.register("TabPanel",new TabPanelBuilder),e.register("TabPage",new TabPageBuilder),e.register("TablePanel",new TablePanelBuilder),e.register("Cell",new CellBuilder),e.register("Row",new RowBuilder),e.register("MenuBar",new MenuBarBuilder),e.register("DataGrid",new DataGridBuilder),e.register("DataGridRow",new DataGridRowBuilder),e.register("DataGridColumn",new DataGridColumnBuilder),e.register("ListBox",new ListBoxBuilder),e.register("TextBox",new TextBoxBuilder),e.register("PasswordBox",new PasswordBoxBuilder),e.register("CheckBox",new CheckBoxBuilder),e.register("IndeterminateCheckBox",new IndeterminateCheckBoxBuilder),e.register("ImageBox",new ImageBoxBuilder),e.register("FileBox",new FileBoxBuilder),e.register("Label",new LabelBuilder),e.register("Link",new LinkBuilder),e.register("Form",new FormBuilder),e.register("Icon",new IconBuilder),e.register("DateTimePicker",new DateTimePickerBuilder),e.register("DatePicker",new DatePickerBuilder),e.register("TimePicker",new TimePickerBuilder),e.register("ToggleButton",new ToggleButtonBuilder),e.register("NumericBox",new NumericBoxBuilder),e.register("Button",new ButtonBuilder),e.register("ToolBar",new ToolBarBuilder),e.register("ToolBarButton",new ButtonBuilder),e.register("ComboBox",new ComboBoxBuilder),e.register("RadioGroup",new RadioGroupBuilder),e.register("ExtensionPanel",new ExtensionPanelBuilder),e.register("PopupButton",new PopupButtonBuilder),e.register("DataNavigation",new DataNavigationBuilder),e.register("TreeView",new TreeViewBuilder),e.register("Frame",new FrameBuilder),e.register("ButtonEdit",new ButtonEditBuilder),e.register("RestDataSource",new RestDataSourceBuilder),e.register("DocumentDataSource",new DocumentDataSourceBuilder),e.register("PropertyBinding",new DataBindingBuilder),e.register("ObjectDataSource",new ObjectDataSourceBuilder),e.register("Parameter",new ParameterBuilder),e.register("AcceptAction",new AcceptActionBuilder),e.register("AddAction",new AddActionBuilder),e.register("CreateItemAction",new CreateItemActionBuilder),e.register("CancelAction",new CancelActionBuilder),e.register("DeleteAction",new DeleteActionBuilder),e.register("EditAction",new EditActionBuilder),e.register("OpenAction",new OpenActionBuilder),e.register("SaveAction",new SaveActionBuilder),e.register("SelectAction",new SelectActionBuilder),e.register("UpdateAction",new UpdateActionBuilder),e.register("ServerAction",new ServerActionBuilder),e.register("RouteToAction",new RouteToActionBuilder),e.register("BooleanFormat",new BooleanFormatBuilder),e.register("DateTimeFormat",new DateTimeFormatBuilder),e.register("NumberFormat",new NumberFormatBuilder),e.register("ObjectFormat",new ObjectFormatBuilder),e.register("Script",new ScriptBuilder),e.register("Divider",new DividerBuilder),e.register("ContextMenu",new ContextMenuBuilder),e.register("ToolTip",new InfinniUI.TooltipBuilder);for(var t=ApplicationBuilder.registerQueue,n=0,i=t.length;n<i;n++)e.register(t[n].name,t[n].builder)},build:function(e,t){return this.builder.build(e,t)},buildType:function(e,t,n){return this.builder.buildType(e,t,n)},buildMany:function(e,t){return this.builder.buildMany(e,t)}}),ApplicationBuilder.registerQueue=[],ApplicationBuilder.addToRegisterQueue=function(e,t){ApplicationBuilder.registerQueue.push({name:e,builder:t})},InfinniUI.ApplicationBuilder=ApplicationBuilder,InfinniUI.Builder=Builder,InfinniUI.BindingModes={twoWay:"TwoWay",toSource:"ToSource",toElement:"ToElement"};var DataBinding=Backbone.Model.extend({defaults:{mode:InfinniUI.BindingModes.twoWay,converter:null,source:null,sourceProperty:null,element:null,elementProperty:null,defaultValue:null},getDefaultValue:function(){return this.get("defaultValue")},setDefaultValue:function(e){this.set("defaultValue",e)},setMode:function(e){this.set("mode",e)},getMode:function(){return this.get("mode")},setConverter:function(e){this.set("converter",e)},getConverter:function(){return this.get("converter")},bindSource:function(e,t){var n=InfinniUI.global.logger,i=this.getElement();if(null!==this.get("source")&&"undefined"!=typeof this.get("source")){var o=stringUtils.format("DataBinding. bindSource: повторная инициализация. {0} заменен на {1}",[this.get("source").getName(),e.getName()]);n.warn(o)}this.set("source",e),this.set("sourceProperty",t);var r=this;i&&this._initPropertyOnElement();var a=e.onPropertyChanged(t,function(e,t){r._onSourcePropertyChangedHandler(e,t)});this.set("bindId",a),this._isWorkingWithSelectedItems(e)&&this._initBehaviorWithSelectedItem()},_isWorkingWithSelectedItems:function(e){return"function"==typeof e.onSelectedItemChanged},_initBehaviorWithSelectedItem:function(){var e=this.get("sourceProperty"),t=this.get("source"),n=this;this._isRelativeProperty(e)&&t.onSelectedItemChanged(function(i,o){var r={property:e,newValue:t.getProperty(e)};n._onSourcePropertyChangedHandler(i,r)})},_isRelativeProperty:function(e){return!/^\d/.test(e)&&""!=e},getSource:function(){return this.get("source")},getSourceProperty:function(){return this.get("sourceProperty")},bindElement:function(e,t){var n=this,i=InfinniUI.global.logger;if(null!==this.get("element")&&"undefined"!=typeof this.get("element")){var o=stringUtils.format("DataBinding. bindElement: повторная инициализация. {0} заменен на {1}",[this.get("element").getName(),e.getName()]);i.warn(o)}this.set("element",e),this.set("elementProperty",t),e.onPropertyChanged(t,function(e,t){n._onElementPropertyChangedHandler(e,t)}),e.onRemove&&e.onRemove(function(e,t){var i=n.get("source"),o=n.get("bindId"),r=n.get("sourceProperty");i&&i.offPropertyChanged&&i.offPropertyChanged(r,o),n.remove()}),this._initPropertyOnElement()},remove:function(){this.off(),this.clear()},_initPropertyOnElement:function(){var e,t=this.get("sourceProperty"),n=this.get("source");if(this._shouldRefreshElement()&&n){
if("function"==typeof n.isDataReady&&!n.isDataReady())return void("function"==typeof n.tryInitData&&(null!==this.getDefaultValue()&&"undefined"!=typeof this.getDefaultValue()&&this._setValueToElement(this.getDefaultValue(),!0),n.tryInitData()));e=n.getProperty(t),this._setValueToElement(e)}},getElement:function(){return this.get("element")},getElementProperty:function(){return this.get("elementProperty")},_onElementPropertyChangedHandler:function(e,t){this._shouldRefreshSource()&&this._setValueToSource(t.newValue,e)},_setValueToSource:function(e,t){var n=this.get("element"),i=this.get("source"),o=this.get("sourceProperty"),r=this.get("converter");null!==r&&"undefined"!=typeof r&&r.hasOwnProperty("toSource")&&(e=r.toSource(t,{value:e,binding:this,source:n})),i.setProperty(o,e)},_onSourcePropertyChangedHandler:function(e,t){this._shouldRefreshElement()&&this._setValueToElement(t.newValue)},_setValueToElement:function(e,t){var n=this.get("source"),i=this.get("element"),o=this.get("elementProperty"),r=this.get("converter"),a=this._getContext();null===r||"undefined"==typeof r||null===r.toElement||"undefined"==typeof r.toElement||t||(e=r.toElement(a,{value:e,binding:this,source:n})),i.setProperty(o,e)},_getContext:function(){var e,t=this.getSource();return t.getView&&t.getView()&&(e=t.getView().getContext()),e},_shouldRefreshSource:function(){var e=this.get("mode");return e==InfinniUI.BindingModes.twoWay||e==InfinniUI.BindingModes.toSource},_shouldRefreshElement:function(){var e=this.get("mode");return e==InfinniUI.BindingModes.twoWay||e==InfinniUI.BindingModes.toElement}});InfinniUI.DataBinding=DataBinding;var DataBindingBuilder=function(){};InfinniUI.DataBindingBuilder=DataBindingBuilder,DataBindingBuilder.prototype.build=function(e,t){var n,i,o=new DataBinding,r=t.metadata,a=InfinniUI.global.logger,l={},s=this;if(null===r.Source||"undefined"==typeof r.Source)throw a.error("DataBindingBuilder: не указан источник."),new Error("DataBindingBuilder: not declared source in DataBinding metadata.");"DefaultValue"in r&&o.setDefaultValue(r.DefaultValue);var u=t.parentView.getDeferredOfMember(r.Source);return u.done(function(a){var u="undefined"==typeof r.Property||null===r.Property?"":r.Property;n=t.basePathOfProperty?t.basePathOfProperty.resolveProperty(u):u,r.Mode&&o.setMode(r.Mode),r.Converter&&(r.Converter.ToSource&&(i=r.Converter.ToSource,l.toSource=s.scriptByNameOrBody(i,e)),r.Converter.ToElement&&(i=r.Converter.ToElement,l.toElement=s.scriptByNameOrBody(i,e)),o.setConverter(l)),o.bindSource(a,n)}),o},DataBindingBuilder.prototype.isScriptBody=function(e){return e&&"{"==e.substr(0,1)},DataBindingBuilder.prototype.scriptByNameOrBody=function(e,t){if(this.isScriptBody(e)){var n=new ScriptExecutor(t.view);return n.buildScriptByBody(e)}return t.scripts[e]},InfinniUI.Providers.MetadataProviderREST=MetadataProviderREST,InfinniUI.Providers.QueryConstructorMetadata=QueryConstructorMetadata;var RequestExecutorDataStrategy=function(e){"undefined"==typeof this.strategies[e]?this.strategy=this.strategies.json:this.strategy=this.strategies[e]};InfinniUI.RequestExecutorDataStrategy=RequestExecutorDataStrategy,RequestExecutorDataStrategy.prototype.request=function(e,t,n){return this.strategy.apply(this,Array.prototype.slice.call(arguments))},RequestExecutorDataStrategy.prototype.strategies={json:function(e,t,n){return $.ajax({type:e.method||"post",url:e.requestUrl,xhrFields:{withCredentials:!0},beforeSend:this.onBeforeRequest(),success:this.onSuccessRequest(t),error:function(e){200===e.status?this.onSuccessRequest(t)():this.onErrorRequest(n)(e)}.bind(this),data:JSON.stringify(e.args),contentType:"application/json;charset=UTF-8"})},raw:function(e,t,n){var i=e.method||"post",o="GET"===i.toUpperCase();return $.ajax({type:i,url:e.requestUrl,xhrFields:{withCredentials:!0},beforeSend:this.onBeforeRequest(),success:this.onSuccessRequest(t),error:function(e){200===e.status?this.onSuccessRequest(t)():this.onErrorRequest(n)(e)}.bind(this),processData:o,contentType:!1,data:e.args})}},_.extend(RequestExecutorDataStrategy.prototype,ajaxRequestMixin),InfinniUI.providerRegister=new DataProviderRegister;var DocumentFileProvider=function(e,t,n){this.urlConstructor=e,this.successCallback=t,this.failCallback=n};InfinniUI.Providers.DocumentFileProvider=DocumentFileProvider,DocumentFileProvider.prototype.getFileUrl=function(e,t,n){return this.urlConstructor.getFileUrl(e,t,n)};var DocumentUploadQueryConstructor=function(e){this.host=e};InfinniUI.DocumentUploadQueryConstructor=DocumentUploadQueryConstructor,DocumentUploadQueryConstructor.prototype.getFileUrl=function(e,t,n){return stringUtils.format("{0}/blob/{1}",[this.host,n])};var LocalStorageDataProvider=function(e){this.idProperty=e||"_id",this.filter=""};_.extend(LocalStorageDataProvider.prototype,{setItems:function(e){localStorage.clear(),e&&e.length>0&&this.setLSItems(e)},getItems:function(e){var t=this.getLSItems(),n=this.getFilter();n&&(t=filterItems(t,n)),e({data:t})},getLSItems:function(){return JSON.parse(localStorage.getItem("items"))},setLSItems:function(e){localStorage.setItem("items",JSON.stringify(e))},setFilter:function(e,t){var n,i=!1,o=/\<\%[a-zA-Z0-9\s]+\%\>/g;if(e.search(o)===-1)i=!0;else for(;n=o.exec(e);){var r=n[0].replace(/\s+/,"").slice(2,-2),a=t[r]||"";a.length&&(i=!0),e=e.slice(0,n.index)+"'"+a+"'"+e.slice(n.index+n[0].length),n.lastIndex=n.index+a.length}i?this.filter=e:this.filter=""},getFilter:function(){return this.filter},createItem:function(e){var t=this.createLocalItem(this.idProperty);e(t)},addLSItem:function(e){var t=this.getLSItems();t.push(e),this.setLSItems(t)},updateLSItem:function(e,t){var n=this.getLSItems();n[e]=t,this.setLSItems(n)},deleteLSItem:function(e){var t=this.getLSItems();t.splice(e,1),this.setLSItems(t)},saveItem:function(e,t){if(!e[this.idProperty])throw new Error('У элемента отсутствует свойство "'+this.idProperty+'"');var n=(JSON.parse(localStorage.getItem("items")),this._getIndexOfItem(e));n==-1?this.addLSItem(e):this.updateLSItem(n,e),t({})},deleteItem:function(e,t,n){var i=(this.getLSItems(),this._getIndexOfItem(e)),o=new ValidationResult;i!=-1?(this.deleteLSItem(i),t({})):(o.error("Удаляемый элемент не найден"),n({data:{Result:{ValidationResult:o}}}))},_getIndexOfItem:function(e){for(var t=this.getLSItems(),n=0;n<t.length;n+=1)if(t[n][this.idProperty]===e[this.idProperty])return n;return-1},createIdFilter:function(e){return[{Property:"_id",Value:e,CriteriaType:1}]},createLocalItem:function(e){var t={};return t[e]=this._generateLocalId(),t},_generateLocalId:function(){return guid()}}),InfinniUI.Providers.LocalStorageDataProvider=LocalStorageDataProvider;var ObjectDataProvider=function(e,t){this.items=e||[],this.idProperty=t||"_id",this.filter=""};_.extend(ObjectDataProvider.prototype,{setItems:function(e){this.items=e},getItems:function(e){var t=this.items.slice(),n=this.getFilter();n&&(t=filterItems(t,n)),e({data:t})},setFilter:function(e,t){var n,i=!1,o=/\<\%[a-zA-Z0-9\s]+\%\>/g;if(e.search(o)===-1)i=!0;else for(;n=o.exec(e);){var r=n[0].replace(/\s+/,"").slice(2,-2),a=t[r]||"";a.length&&(i=!0),e=e.slice(0,n.index)+"'"+a+"'"+e.slice(n.index+n[0].length),n.lastIndex=n.index+a.length}i?this.filter=e:this.filter=""},getFilter:function(){return this.filter},createItem:function(e){var t=this.createLocalItem(this.idProperty);e(t)},saveItem:function(e,t){var n=this.items,i=this._getIndexOfItem(e);i===-1?n.push(e):n[i]=e,t({})},deleteItem:function(e,t,n){var i=this.items,o=this._getIndexOfItem(e),r=new ValidationResult;o!==-1?(i.splice(o,1),t({})):(r.error("Удаляемый элемент не найден"),n({data:{Result:{ValidationResult:r}}}))},createIdFilter:function(e){return[{Property:"_id",Value:e,CriteriaType:1}]},_getIndexOfItem:function(e){return _.indexOf(this.items,e)},createLocalItem:function(e){var t={};return t[e]=this._generateLocalId(),t},_generateLocalId:function(){return guid()}}),InfinniUI.Providers.ObjectDataProvider=ObjectDataProvider;var RestDataProvider=function(){this.requestParams={get:{method:"get",origin:null,path:"",data:{}},set:{method:"post",origin:null,path:"",data:{}},"delete":{method:"delete",origin:null,path:"",data:{}}}};_.extend(RestDataProvider.prototype,{getOrigin:function(e){return this.requestParams[e].origin},setOrigin:function(e,t){this.requestParams[e].origin=t},getPath:function(e){return this.requestParams[e].path},setPath:function(e,t){this.requestParams[e].path=t},getData:function(e){return this.requestParams[e].data},setData:function(e,t){this.requestParams[e].data=t},getMethod:function(e){return this.requestParams[e].method},setMethod:function(e,t){this.requestParams[e].method=t},send:function(e,t,n){var i,o=this.requestParams[e],r=o.origin+o.path,a=Math.round(1e5*Math.random()),l=this.extractFilesFromData(o.data);if(0==_.size(l.files))i={type:o.method,xhrFields:{withCredentials:!0},url:r,success:function(e){t({requestId:a,data:e})},error:function(e){return"function"!=typeof n?void InfinniUI.global.logger.error(e):void n({requestId:a,data:e})}},"get"!=o.method.toLowerCase()?(i.contentType="application/json",i.data=JSON.stringify(o.data)):_.size(o.data)>0&&(i.url=i.url+"?"+stringUtils.joinDataForQuery(o.data));else{var s=new FormData;s.append("document",JSON.stringify(l.dataWithoutFiles));for(var u in l.files)s.append(u,l.files[u]);i={type:o.method,url:r,xhrFields:{withCredentials:!0},data:s,cache:!1,contentType:!1,processData:!1,success:function(e){t({requestId:a,data:e})},error:function(e){n({requestId:a,data:e})}}}return $.ajax(i),a},getItems:function(e,t){return this.send("get",e,t)},saveItem:function(e,t,n){return this.requestParams.set.data=e,this.send("set",t,n)},deleteItem:function(e,t,n){return this.send("delete",t,n)},createItem:function(e,t){var n=this;setTimeout(function(){e(n.createLocalItem(t))},10)},createLocalItem:function(e){var t={};return t[e]=this._generateLocalId(),t},_generateLocalId:function(){return guid()},extractFilesFromData:function(e){function t(e,i){var o,r,a=Array.isArray(e)?[]:{};for(var l in e)if(e.hasOwnProperty(l))if(r=i.slice(),r.push(l),o=e[l],null!==o&&"object"==typeof o)if(o.constructor===Date)a[l]=o;else{if(o.constructor!==Object&&o.constructor!==Array){a[l]=null,n[r.join(".")]=o;continue}a[l]=t(o,r)}else a[l]=o;return a}var n=Object.create(null),i=t(e,[]);return{dataWithoutFiles:i,files:n}}}),InfinniUI.Providers.RestDataProvider=RestDataProvider;var ServerActionProvider=function(){};ServerActionProvider.prototype.request=function(e,t,n,i){var o=Math.round(1e5*Math.random());return $.ajax({type:e.method,url:e.requestUrl,xhrFields:{withCredentials:!0},data:e.args,contentType:e.contentType,success:function(e){var i={requestId:o,data:e};"function"==typeof t&&t(i),"function"==typeof n&&n(i)},error:function(e){var n={requestId:o,data:e};"function"==typeof t&&t(n),"function"==typeof i&&i(n)}}),o},ServerActionProvider.prototype.download=function(e,t,n,i){new DownloadExecutor(t,n,i).run(e)},InfinniUI.Providers.ServerActionProvider=ServerActionProvider;var LocalStorageDataSource=ObjectDataSource.extend({initDataProvider:function(){var e=InfinniUI.providerRegister.build("LocalStorageDataSource");this.set("dataProvider",e)}});InfinniUI.providerRegister.register("LocalStorageDataSource",InfinniUI.Providers.LocalStorageDataProvider),InfinniUI.LocalStorageDataSource=LocalStorageDataSource,_.inherit(ObjectDataSourceBuilder,BaseDataSourceBuilder),_.extend(ObjectDataSourceBuilder.prototype,{createDataSource:function(e){return new ObjectDataSource({view:e})},applyMetadata:function(e,t,n,i){if(BaseDataSourceBuilder.prototype.applyMetadata.call(this,e,t,n,i),!1 in n&&i.setIsLazy(!1),n.Items&&(Array.isArray(n.Items)&&i.setItems(n.Items),$.isPlainObject(n.Items))){"undefined"==typeof n.Items.Mode&&(n.Items.Mode=InfinniUI.BindingModes.toElement);var o=e.buildBinding(n.Items,{parentView:t});o.bindElement(i,"")}}}),InfinniUI.ObjectDataSourceBuilder=ObjectDataSourceBuilder;var Parameter=Backbone.Model.extend({defaults:{name:null,view:null,value:void 0},initialize:function(){},onPropertyChanged:function(e,t){"function"==typeof e?(t=e,this.on("onPropertyChanged",t)):this.on("onPropertyChanged:"+e,t)},getName:function(){return this.get("name")},setName:function(e){this.set("name",e),this.name=e},getView:function(){return this.get("view")},getValue:function(){return this.getProperty("")},setValue:function(e){this.setProperty("",e)},getProperty:function(e){var t=this.get("value");return""===e?t:this._nullToUndefined(InfinniUI.ObjectUtils.getPropertyValue(t,e))},setProperty:function(e,t){var n=this.getValue(),i=this.getProperty(e);t!=i&&(""===e?this.set("value",t):InfinniUI.ObjectUtils.setPropertyValue(n,e,t),this._notifyAboutPropertyChanged(e,t,i))},_notifyAboutPropertyChanged:function(e,t,n){var i=this._getContext(),o={};o.property=e,o.newValue=t,o.oldValue=n,this.trigger("onPropertyChanged",i,o),this.trigger("onPropertyChanged:"+e,i,o)},_getContext:function(){var e=this.getView();return e?e.getContext():void 0},_nullToUndefined:function(e){return null===e?void 0:e},createControlEventHandler:function(e,t,n){var i,o=e.getView();return n=n||{},o&&(i=o.context),function(o){return o=o||{},_.extend(o,n),o.source=e,t.call(void 0,i,o)}},onRemove:function(e){return this.on(messageTypes.onRemove.name,this.createControlEventHandler(this,e))},remove:function(){this.off(),this.clear()}});InfinniUI.Parameter=Parameter,InfinniUI.ParameterBuilder=ParameterBuilder;var formatMixin={separator:", ",setOptions:function(e){this.options=_.extend({},this.options||{},e)},getOptions:function(){return this.options||{}},format:function(e,t,n){var i;if(null!==e&&"undefined"!=typeof e&&e.constructor===Array){for(var o=[],r=0,a=e.length;r<a;r+=1)o.push(this.formatValue(e[r],t,n));i=o.join(this.separator)}else i=this.formatValue.apply(this,arguments);return i},getFormat:function(){return this.getPropertyValue("formatRule",this.defaultFormat)},setFormat:function(e){this.formatRule=e},getPropertyValue:function(e,t){var n=this[e];return"undefined"==typeof n||null===n?t:n}};InfinniUI.formatMixin=formatMixin;var BooleanFormat=function(){};InfinniUI.BooleanFormat=BooleanFormat,_.extend(BooleanFormat.prototype,{defaultTrueText:"True",defaultFalseText:"False",getFalseText:function(){return this.getPropertyValue("falseText",this.defaultFalseText)},setFalseText:function(e){this.falseText=e},getTrueText:function(){return this.getPropertyValue("trueText",this.defaultTrueText)},setTrueText:function(e){this.trueText=e},formatValue:function(e){return e===!1||null===e||"undefined"==typeof e?this.getFalseText():this.getTrueText()}},formatMixin),InfinniUI.BooleanFormatBuilder=BooleanFormatBuilder,InfinniUI.DateTimeFormat=DateTimeFormat,_.extend(DateTimeFormat.prototype,{defaultFormat:"G",formatValue:function(e,t,n){var i=this;if("undefined"==typeof e||null===e)return"";t=t||localized;var o=this.createDate(e);return n=n||this.getFormat(),"undefined"!=typeof InfinniUI.localizations[t.name].patternDateFormats[n]&&(n=InfinniUI.localizations[t.name].patternDateFormats[n]),n.replace(this.rg,function(e){if('"'==e[0]||"'"==e[0]){var n=e.length;return e.substring(1,n-1)}return i.rules[e](o,t)})},createDate:function(e){var t,n=this.getOptions();return t=InfinniUI.DateUtils.createDate(e),InfinniUI.DateUtils.changeTimezoneOffset(t,n.TimeZone)},rg:new RegExp("\"[\\s\\S]*\"|'[\\s\\S]*'|yyyy|yy|%y|y|MMMM|MMM|MM|%M|M|dddd|ddd|dd|%d|d|HH|%H|H|hh|%h|h|mm|%m|m|ss|%s|s|tt|%t|t|zzz|zz|%z|z|:|/","g"),rules:{yyyy:function(e){return e.getFullYear().toString()},yy:function(e){var t=e.getFullYear().toString();return t.substring(2)},"%y":function(e){var t=e.getFullYear().toString();return t=t.substring(2),t=parseInt(t),t.toString()},y:function(e){var t=e.getFullYear().toString();return t=t.substring(2),t=parseInt(t),t.toString()},MMMM:function(e,t){var n=e.getMonth(),i=t.dateTimeFormatInfo.monthNames[n];return i},MMM:function(e,t){var n=e.getMonth(),i=t.dateTimeFormatInfo.abbreviatedMonthNames[n];return i},MM:function(e){var t=e.getMonth()+1;return t<10?"0"+t.toString():t.toString()},"%M":function(e){var t=e.getMonth()+1;return t.toString()},M:function(e){var t=e.getMonth()+1;return t.toString()},dddd:function(e,t){var n,i=e.getDay();return i=0==i?6:i-1,n=t.dateTimeFormatInfo.dayNames[i]},ddd:function(e,t){var n,i=e.getDay();return i=0==i?6:i-1,n=t.dateTimeFormatInfo.abbreviatedDayNames[i]},dd:function(e){var t=e.getDate();return t<10?"0"+t.toString():t.toString()},"%d":function(e){var t=e.getDate();return t.toString()},d:function(e){var t=e.getDate();return t.toString()},HH:function(e){var t=e.getHours();return t<10?"0"+t.toString():t.toString()},"%H":function(e){var t=e.getHours();return t.toString()},H:function(e){var t=e.getHours();return t.toString()},hh:function(e){var t=e.getHours();return t>12&&(t-=12),t<10?"0"+t.toString():t.toString()},h:function(e){var t=e.getHours();return t>12?t-=12:0===t&&(t=12),t.toString()},mm:function(e){var t=e.getMinutes();return t<10?"0"+t.toString():t.toString()},"%m":function(e){var t=e.getMinutes();return t.toString()},m:function(e){var t=e.getMinutes();return t.toString()},ss:function(e){var t=e.getSeconds();return t<10?"0"+t.toString():t.toString()},"%s":function(e){var t=e.getSeconds();return t.toString()},s:function(e){var t=e.getSeconds();return t.toString()},tt:function(e,t){var n=e.getHours();return n<12?t.dateTimeFormatInfo.amDesignator:t.dateTimeFormatInfo.pmDesignator},"%t":function(e,t){var n=e.getHours();return n<12?t.dateTimeFormatInfo.amDesignator.substr(0,1):t.dateTimeFormatInfo.pmDesignator.substr(0,1)},t:function(e,t){var n=e.getHours();return n<12?t.dateTimeFormatInfo.amDesignator.substr(0,1):t.dateTimeFormatInfo.pmDesignator.substr(0,1)},zzz:function(e){var t,n,i=-e.getTimezoneOffset()/60;return t=100*(i-Math.floor(i)),i=Math.floor(i),i<0?(n="-",i=-i):n="+",t=t<10?"0"+t.toString():t.toString(),i<10?n+"0"+i.toString()+":"+t:n+i.toString()+":"+t},zz:function(e){var t,n=-e.getTimezoneOffset()/60;return n=Math.floor(n),n<0?(t="-",n=-n):t="+",n<10?t+"0"+n.toString():t+n.toString()},z:function(e,t){var n,i=-e.getTimezoneOffset()/60;return i=Math.floor(i),i<0?(n="-",i=-i):n="+",n+i.toString()},"%z":function(e,t){var n,i=-e.getTimezoneOffset()/60;return i=Math.floor(i),i<0?(n="-",i=-i):n="+",n+i.toString()},":":function(e,t){return t.dateTimeFormatInfo.timeSeparator},"/":function(e,t){return t.dateTimeFormatInfo.dateSeparator}}},formatMixin),InfinniUI.DateTimeFormatBuilder=DateTimeFormatBuilder,InfinniUI.NumberFormat=NumberFormat,_.extend(NumberFormat.prototype,{defaultFormat:"n",formatValue:function(e,t,n){if("undefined"==typeof e||null===e)return"";var i=this;return t=t||localized,n=n||this.getFormat(),n.replace(this.rg,function(n,o,r){return r=void 0!==r&&""!=r?parseInt(r):void 0,i.rules[o].call(i,e,r,t)})},rg:/^([pnc])(\d*)$/gi,rules:{P:function(e,t,n){t=void 0!==t?t:n.numberFormatInfo.percentDecimalDigits;var i,o=e>=0,r=this.formatNumber(Math.abs(e),t,n.numberFormatInfo.percentGroupSeparator,n.numberFormatInfo.percentDecimalSeparator);return i=o?n.numberFormatInfo.percentPositivePattern.replace("p",r):n.numberFormatInfo.percentNegativePattern.replace("p",r),i=i.replace("%",n.numberFormatInfo.percentSymbol)},p:function(e,t,n){return e*=100,this.rules.P.call(this,e,t,n)},n:function(e,t,n){t=void 0!==t?t:n.numberFormatInfo.numberDecimalDigits;var i,o=e>=0,r=this.formatNumber(Math.abs(e),t,n.numberFormatInfo.numberGroupSeparator,n.numberFormatInfo.numberDecimalSeparator);return i=o?n.numberFormatInfo.numberPositivePattern.replace("n",r):n.numberFormatInfo.numberNegativePattern.replace("n",r)},N:function(){return this.rules.n.apply(this,arguments)},c:function(e,t,n){t=void 0!==t?t:n.numberFormatInfo.currencyDecimalDigits;var i,o=e>=0,r=this.formatNumber(Math.abs(e),t,n.numberFormatInfo.currencyGroupSeparator,n.numberFormatInfo.currencyDecimalSeparator);return i=o?n.numberFormatInfo.currencyPositivePattern.replace("c",r):n.numberFormatInfo.currencyNegativePattern.replace("c",r),i=i.replace("$",n.numberFormatInfo.currencySymbol)},C:function(){return this.rules.c.apply(this,arguments)}},formatNumber:function(e,t,n,i){e=e.toFixed(t);var o=e.toString(),r=o.split("."),a=this.formatIntPath(r[0],n),l=this.formatFractPath(r[1],i,t);return a+l},formatIntPath:function(e,t){return e.replace(/(\d{1,3}(?=(\d{3})+(?:\.\d|\b)))/g,"$1"+t)},formatFractPath:function(e,t,n){var i,o=e?e:"";return 0==n?"":o.length>=n?t+o.substr(0,n):(i=Math.pow(10,n-o.length),i=i.toString().substr(1),t+o+i)}},formatMixin),InfinniUI.NumberFormatBuilder=NumberFormatBuilder,InfinniUI.ObjectFormat=ObjectFormat,_.extend(ObjectFormat.prototype,{formatValue:function(e,t,n){t=t||localized,n=n||this.getFormat();var i=/\$\{[^}]*}/g,o="";return o=n.replace(i,this.formatIterator.bind(this,e,t))},formatIterator:function(e,t,n){var i,o,r,a,l,s=/^\$\{|\}$/g;if(i=n,o=n.replace(s,""),l=o.split(":"),a="object"==typeof e?""===l[0]?e:InfinniUI.ObjectUtils.getPropertyValue(e,l[0]):e,2===l.length){for(var u=0,c=this.formatters.length;u<c;u+=1)if(r=new this.formatters[u](l[1]),r.setOptions(this.getOptions()),o=r.format(a,t),o!==l[1]){i=o;break}}else i=a;return"undefined"==typeof i||null===i?"":i}},formatMixin),InfinniUI.ObjectFormatBuilder=ObjectFormatBuilder;var openModeAutoFocusMixin={applyAutoFocus:function(){function e(){clearInterval(i)}var t=this.view,n=t&&t.getFocusOnControl();if(n){var i=setInterval(function(){var i=t.findAllChildrenByName(n);if(Array.isArray(i)&&i.length>0){var o=i[0];if(!jQuery.contains(document,o.control.controlView.el))return;o.setFocus&&o.setFocus(),e()}},1e3/3);setTimeout(e,3e3)}}};InfinniUI.openModeAutoFocusMixin=openModeAutoFocusMixin,_.extend(LinkViewBuilderBase.prototype,{build:function(e,t){var n=t.metadata,i=this.getParentViewByOpenMode(t,n.OpenMode),o=new LinkView(i),r=this.getViewTemplate(t,i);return o.setViewTemplate(r),"OpenMode"in n&&o.setOpenMode(n.OpenMode),"Container"in n&&o.setContainer(n.Container),"DialogWidth"in n&&o.setDialogWidth(n.DialogWidth),o},getViewTemplate:function(){throw new Error("LinkViewBuilderBase.getViewTemplate: В потомке LinkViewBuilderBase не переопределен метод getViewTemplate.")},buildViewByMetadata:function(e,t,n,i){var o=e.builder,r=this.buildParameters(e);if(null!==t&&"undefined"!=typeof t){var a=o.buildType("View",t,{parentView:n,parent:n,params:r,suspended:e.suspended});i(a)}else InfinniUI.global.logger.error("LinkViewBuilderBase.buildViewByMetadata: view metadata for "+e.metadata+" not found.")},buildParameters:function(e){var t,n=e.metadata.Parameters,i=e.builder,o=e.parentView,r={};if("undefined"!=typeof n&&null!==n)for(var a=0;a<n.length;a++)"undefined"!=typeof n[a].Value&&(t=i.buildType("Parameter",n[a],{parentView:o,basePathOfProperty:e.basePathOfProperty}),r[t.getName()]=t);return r},getParentViewByOpenMode:function(e,t){if(null===t||"undefined"==typeof t||"Default"==t)return e.parentView.getApplicationView();if("Container"==t){var n=e.metadata.Container,i=InfinniUI.global.containers[n];return i?i.getView():e.parentView}return e.parentView}}),InfinniUI.LinkViewBuilderBase=LinkViewBuilderBase,_.inherit(InlineViewBuilder,LinkViewBuilderBase),InfinniUI.InlineViewBuilder=InlineViewBuilder,_.extend(InlineViewBuilder.prototype,{getViewTemplate:function(e,t){var n=this;return function(i){n.buildViewByMetadata(e,e.metadata.View,t,function(e){return i.call(null,e)})}}}),InfinniUI.LinkView=LinkView,_.extend(LinkView.prototype,{setOpenMode:function(e){_.isEmpty(e)||(this.openMode=e)},getOpenMode:function(){return this.openMode},setContainer:function(e){this.containerName=e},setViewTemplate:function(e){this.viewTemplate=e},setDialogWidth:function(e){e=e.toLowerCase(),"extralarge"==e&&(e="100%"),this.dialogWidth=e},createView:function(e){function t(t){n.view=t,n._initViewHandler(t),e(t)}var n=this;this.viewTemplate(t)},_initViewHandler:function(e){var t,n,i=this,o=i.openMode;switch(e.setParent&&e.setParent(this.parent),InfinniUI.global.messageBus.send("onViewCreated",{openMode:o,view:e}),o){case"Container":n=InfinniUI.global.containers[this.containerName],t=new OpenModeContainerStrategy,t.setView(e),t.setContainer(n),e.setOpenStrategy(t);break;case"Dialog":t=new OpenModeDialogStrategy,t.setView(e),this.dialogWidth&&t.setDialogWidth(this.dialogWidth),t.setView(e),e.setOpenStrategy(t)}}}),_.inherit(MetadataViewBuilder,LinkViewBuilderBase),InfinniUI.MetadataViewBuilder=MetadataViewBuilder,_.extend(MetadataViewBuilder.prototype,{getViewTemplate:function(e,t){var n=this,i={metadata:e.metadata,applicationView:t&&t.getApplicationView()};return function(o){var r=InfinniUI.providerRegister.build("MetadataDataSource",i);r.getMetadata(function(i){if(null===i||"undefined"==typeof i)return InfinniUI.global.logger.error("view metadata not found"),void InfinniUI.global.messageBus.send(messageTypes.onViewBuildError,{error:"metadata not found",metadata:metadata});var r=function(){var e=Array.prototype.slice.call(arguments);o.apply(null,e)};n.buildViewByMetadata(e,i,t,r)})}}});var OpenModeContainerStrategy=function(){};_.extend(OpenModeContainerStrategy.prototype,{setView:function(e){this.view=e},setContainer:function(e){this.container=e},open:function(){var e=InfinniUI.global.logger;this.container||e.error("OpenModeContainerStrategy.open: не задан контейнер, в который должо быть помещено приложение"),this.container.setLayout(this.view)},close:function(){this.container.setLayout(null),this.view.remove()}}),InfinniUI.OpenModeContainerStrategy=OpenModeContainerStrategy;var OpenModeDefaultStrategy=function(){};_.extend(OpenModeDefaultStrategy.prototype,{setView:function(e){this.view=e},open:function(){var e=InfinniUI.config.$rootContainer||$("body"),t=e.data("view");t&&t.close(),e.append(this.view.render()).data("view",this.view),this.applyAutoFocus()},close:function(){this.view.remove()}},openModeAutoFocusMixin),InfinniUI.OpenModeDefaultStrategy=OpenModeDefaultStrategy;var OpenModeDialogStrategy=function(){this.dialogWidth="default"};InfinniUI.OpenModeDialogStrategy=OpenModeDialogStrategy,_.extend(OpenModeDialogStrategy.prototype,{template:InfinniUI.Template["linkView/template/dialog.tpl.html"],setView:function(e){this.view=e},setDialogWidth:function(e){this.dialogWidth=e},open:function(){$(document.activeElement).blur();var e={dialogWidth:this.dialogWidth},t=$(this.template(e)),n=$("button",t),i=$("h4",t),o=this.view,r=t.appendTo($("body"));this.$modal=r,r.on("shown.bs.modal",function(e){$(e.target).find(".first-focus-element-in-modal").focus()}),r.on("hidden.bs.modal",this.cleanup.bind(this));var a=r.find(".modal-body");a.append(this.view.render()),r.modal({show:!0,backdrop:"static",modalOverflow:!0,keyboard:o.getCloseButtonVisibility(),focus:this}),this._initBehaviorFocusingInModal(r,a);var l=function(){n.toggleClass("hidden",!o.getCloseButtonVisibility())};l(),o.control.controlView.listenTo(o.control.controlModel,"change:closeButtonVisibility",l);var s=o.getHeaderTemplate();i.append(s().render()),r.find(".pl-close-modal").on("click",function(){o.close()}),InfinniUI.ModalWindowService.modalWasOpened({modal:this.$modal,background:$(".modal-backdrop").last()})},_initBehaviorFocusingInModal:function(e,t){t.append('<div class="lastfocuselementinmodal" tabindex="0">'),e.find(".lastfocuselementinmodal").on("focusin",function(){e.find(".firstfocuselementinmodal").focus()}),e.keydown(function(t){$(document.activeElement).hasClass("lastfocuselementinmodal")&&9==(t.which||t.keyCode)&&(t.preventDefault(),e.find(".firstfocuselementinmodal").focus()),$(document.activeElement).hasClass("firstfocuselementinmodal")&&9==(t.which||t.keyCode)&&t.shiftKey&&(t.preventDefault(),e.find(".lastfocuselementinmodal").focus())})},close:function(){this.$modal&&this.$modal.modal("hide")},cleanup:function(){this.view.remove(),this.$modal.remove(),InfinniUI.ModalWindowService.modalWasClosed(this.$modal)}}),InfinniUI.AutoHeightService={windowHeight:0,clientHeight:0,exchange:null,times:[],adaptableByHeightSelector:".pl-adaptable-by-height:not(:hidden)",setOuterHeight:function(e,t,n){var i=0;["border-top-width","border-bottom-width","padding-top","padding-bottom","margin-top","margin-bottom"].forEach(function(t){i+=parseInt(e.css(t))});var o=t-i;return n&&(o+=n),e.height(o),o},getModalSelector:function(){return".modal-scrollable"},buildTree:function(e,t,n,i,o){var r=this;return e=_.where(o,{parent:t}),{isElement:_.indexOf(i,t)!==-1,element:t,$element:n,child:_.map(e,function(t){return r.buildTree(e,t.element,t.$element,i,o)})}},formTree:function(e,t,n){for(var i,o,r,a=[],l=0,s=e.length;l<s;l+=1){r=e[l],o=$(r);do{i=o.parent();var u=_.findWhere(a,{element:r});if("undefined"!=typeof u)break;a.push({element:r,$element:o,parent:i.get(0),$parent:i}),o=i,r=i.get(0)}while(r!==t)}return this.buildTree(a,t,n,e,a)},setHeight:function(e,t){var n=e.$element.attr("data-height-original");return""===n&&e.$element.attr("data-height-original",e.element.style.height),this.setOuterHeight(e.$element,t)},defineWay:function(e,t){var n=this.setHeight(e,t),i=this;e.$element.hasClass("pl-scroll-panel")||e.$element.hasClass("modal-scrollable")||(e.$element.hasClass("tab-content")?_.each(e.child,function(e){i.defineWay(e,n)}):e.child.length>0&&this.goThroughTree(e,n))},goThroughTree:function(e,t){var n=this;e.$element.parentsUntil(".modal").length&&e.$element.attr("data-height-original",e.element.style.height);var i=e.$element.children(":not(:hidden):not(.modal-scrollable):not(.modal-backdrop):not(.pl-dropdown-container)"),o=_.chain(i).filter(function(e){var t=$(e).css("position");return["absolute","fixed"].indexOf(t)===-1}).groupBy("offsetTop").value(),r=[];_.each(o,function(t,n){var i=[];_.each(t,function(t){var n=_.find(e.child,function(e){return e.element===t});n&&i.push(n)}),r.push(i.length?0:_.reduce(t,function(e,t){return Math.max(e,$(t).outerHeight(!0))},0)),o[n]=i});var a=r.reduce(function(e,t){return e+t},0),l=_.reduce(o,function(e,t){return t.length?e+1:e},0),s=Math.floor((t-a)/l);_.each(o,function(e){0!==e.length&&_.each(e,function(e){n.defineWay(e,s)},this)})},resize:function(e,t){var n=Date.now(),i=$(e),o=i.find(this.adaptableByHeightSelector);if(0!==o.length){var r=this.formTree(o,e,i);this.defineWay(r,t);var a=Date.now();this.timeWatcher(a-n)}},timeWatcher:function(e){e>=20&&this.times.push(e)},getTimes:function(){return this.times},resizeView:function(e,t){var n=$(e||document),i=this.setOuterHeight(n,t);this.resize(n.get(0),i)},resizeDialog:function(){var e=$(this.getModalSelector()).last();this._resizeDialog(e),this.resetDialogHeight(e)},resetDialogHeight:function(e){if(e.children()){var t=e.children(),n=$(".modal-header",t),i=$(".modal-body",t),o=$(this.adaptableByHeightSelector,e);o.parentsUntil(".modal",":not("+this.adaptableByHeightSelector+")").css("height","auto"),t.css("top",(this.windowHeight-n.outerHeight(!0)-i.outerHeight(!0))/2),e.children(".modal:not(.messagebox)").height(i.outerHeight(!0)+n.outerHeight(!0))}},_resizeDialog:function(e){var t=10,n=e.children();n.css("margin-top",0);var i=$(".modal-header",n),o=$(".modal-body",n),r=i.outerHeight(!0);o.css("max-height",this.windowHeight-r),n.css("margin-top",0);var a=$(this.adaptableByHeightSelector,e);if(0!==a.length){var l=this.setOuterHeight(e,this.windowHeight-2*t),s=this.setOuterHeight(n,l)-i.outerHeight();this.resize(o[0],s)}},recalculation:function(e){InfinniUI.config.enableAutoHeightService&&($(e).addClass("page-content-overflow-hidden"),this.windowHeight=$(window).height(),this.onChangeLayout(e),null===this.exchange&&(this.exchange=InfinniUI.global.messageBus,this.exchange.subscribe("OnChangeLayout",_.debounce(this.onChangeLayout.bind(this,e),42))))},slidingRecalculation:function(e){for(var t=this,n=3;n>=0;n--)setTimeout(function(){t.recalculation(e)},500+300*n)},onChangeLayout:function(e){var t=this.windowHeight;this.resizeView(e,t),this.resizeDialog()}},InfinniUI.openHomePage=function(e){var t=new ApplicationBuilder,n=new SpecialApplicationView;InfinniUI.localStorageDataSource=new InfinniUI.LocalStorageDataSource({view:n}),n.open(e),InfinniUI.AutoHeightService.slidingRecalculation(e),subscribeRecalculationOnWindowResize(e),
getHomePageLinkViewPromise().done(function(e){var i=t.buildType("OpenAction",e,{parentView:n});i.execute()})},null!==InfinniUI.config.configName&&"undefined"!=typeof InfinniUI.config.configName&&(document.title=InfinniUI.config.configName),InfinniUI.config.cacheMetadata===!1&&$.ajaxSetup({cache:!1}),moment.locale(InfinniUI.config.lang&&InfinniUI.config.lang.substr(0,2)),InfinniUI.providerRegister.register("ObjectDataSource",InfinniUI.Providers.ObjectDataProvider),InfinniUI.providerRegister.register("LocalStorageDataSource",InfinniUI.Providers.LocalStorageDataProvider),InfinniUI.providerRegister.register("MetadataDataSource",function(e){var t=e.applicationView&&e.applicationView.getContainer();return InfinniUI.AutoHeightService.slidingRecalculation(t),new InfinniUI.Providers.MetadataProviderREST(new InfinniUI.Providers.QueryConstructorMetadata(InfinniUI.config.serverUrl,e.metadata))}),InfinniUI.providerRegister.register("DocumentDataSource",InfinniUI.Providers.RestDataProvider),InfinniUI.providerRegister.register("RestDataSource",InfinniUI.Providers.RestDataProvider),InfinniUI.providerRegister.register("ServerActionProvider",function(){return new InfinniUI.Providers.ServerActionProvider}),InfinniUI.ScriptBuilder=ScriptBuilder,ScriptBuilder.prototype.build=function(e,t){var n=t.metadata,i=n.Name,o=n.Body,r=new Function("context","args",o);return function(e,t){var n;try{n=r.call(void 0,e,t)}catch(a){console.groupCollapsed("%2$s: %1$c%3$s","color: #ff0000",i,a.message),console.error(o),console.groupEnd()}return n}},InfinniUI.ScriptExecutor=ScriptExecutor,ScriptExecutor.prototype.executeScript=function(e,t){var n,i,o,r=this.parent,a=r.getContext();return"{"==e.substr(0,1)?(i=e.substr(1,e.length-2),o=this.buildScriptByBody(i)):(o=r.getScripts().getById(e),o&&(o=o.func)),a&&o&&(n=o.call(void 0,a,t)),n},ScriptExecutor.prototype.buildScriptByBody=function(e){var t=this.parent.getContext(),n={metadata:{Body:e,Name:"InlineScript"}},i=new ScriptBuilder;return i.build(t,n)},InfinniUI.ModalWindowService=function(){function e(){var e=InfinniUI.global.messageBus;e.send("OnChangeLayout",{})}var t=[];return{modalWasOpened:function(e){if(0!=t.length){var n=t[t.length-1];n.modal.addClass("invisible"),n.background.addClass("invisible")}t.push(e)},modalWasClosed:function(n){for(var i=0,o=t.length;i<o;i++)if(t[i].modal==n){if(i==o-1&&0!=i){var r=t[i-1];r.modal.removeClass("invisible"),r.background.removeClass("invisible"),e()}t.splice(i,1);break}}}}();var notificationSubscription=function(){var e,t,n,i,o,r,a={},l=!1,s=function(l,s,u){i=s||i,o=u||o,t=l||t,r=r||InfinniUI.config.signalRServerUrl||InfinniUI.config.serverUrl,n=$.hubConnection(r,InfinniUI.config.signalROptions),e=n.createHubProxy(t),_.size(a)>0&&(c("on"),h())},u=function(t,n,i){a[t]||(a[t]=[],e&&e.on(t,p(t))),a[t].push({context:i,callback:n}),!l&&e&&h()},c=function(t){for(var n in a)"on"===t?e.on(n,p(n)):e.off(n)},d=function(t,n){if(n){for(var i=a[t],o=0,r=i.lenght;o<r;o+=1)i[o].context==n&&i.splice(o,1);if(0!==i.length)return}a[t]&&(delete a[t],e&&e.off(t)),g()},p=function(e){return function(t){var n=a[e];if(n)for(var i=0,o=n.length;i<o;i+=1)n[i].callback(n[i].context,{message:t})}},h=function(){l=!0,n.start().done(function(){console.log("signalR: connection is started"),"function"==typeof i&&i()}).fail(function(){console.log("signalR: connection fail"),l=!1,"function"==typeof o&&o()})},f=function(){e&&(l=!1,c("off"),e=null,n.stop())},m=function(){n&&e&&f(),s()},g=function(){0===_.size(a)&&f()},y=function(e,t){n||console.error("Необходимо сначала установить соединение с сервером"),n[e]&&n[e](t)},v=function(){return $.connection.isDisconnecting(n)};return{startConnection:s,reconnection:m,subscribe:u,unsubscribe:d,stopConnection:f,on:y,isDisconnected:v}}();InfinniUI.global.notificationSubscription=notificationSubscription,InfinniUI.NotifyService=function(){var e=InfinniUI.global.messageBus;e.subscribe(messageTypes.onNotifyUser,function(e,t){var n,i=t.value.messageText,o=t.value.messageType||"info";switch(o){case"success":case"error":case"warning":case"info":n=o;break;default:n="info"}"undefined"!=typeof toastr&&toastr[n](i)})}(),InfinniUI.Theme["default"]={classes:{hidden:"hidden",inputError:"has-error",inputWarning:"has-warning"}};var AjaxLoaderIndicator=function(e,t){var n={delay:50},i=_.defaults({},t,n),o=new AjaxLoaderIndicatorModel({},i),r=new AjaxLoaderIndicatorView({model:o}),a=r.render().$el;e.append(a)};InfinniUI.AjaxLoaderIndicator=AjaxLoaderIndicator;var AjaxLoaderIndicatorModel=Backbone.Model.extend({defaults:{requests:0,progress:!1},initialize:function(e,t){var n=InfinniUI.global.messageBus;n.subscribe(messageTypes.onDataLoaded,this.onDataLoaded.bind(this)),n.subscribe(messageTypes.onDataLoading,this.onDataLoading.bind(this));var i=t.delay>0?_.debounce(this.onRequestsChanged.bind(this),50):this.onRequestsChanged.bind(this);this.on("change:requests",i)},onDataLoading:function(){var e=this.get("requests");this.set("requests",e+1)},onDataLoaded:function(){var e=this.get("requests");this.set("requests",e-1)},onRequestsChanged:function(e,t){this.set("progress",t>0)}});InfinniUI.AjaxLoaderIndicatorModel=AjaxLoaderIndicatorModel;var AjaxLoaderIndicatorView=Backbone.View.extend({className:"pl-ajaxloader",template:InfinniUI.Template["services/ajaxLoaderIndicator/template/template.tpl.html"],hiddenClassName:"hidden",initialize:function(){this.listenTo(this.model,"change:progress",this.updateProgress)},render:function(){return this.$el.html(this.template()),this.updateProgress(),this},updateProgress:function(){var e=this.model.get("progress");this.$el.toggleClass(this.hiddenClassName,!e)}});InfinniUI.AjaxLoaderIndicatorView=AjaxLoaderIndicatorView,InfinniUI.ContextMenuService=function(){function e(e){return e.control.controlView.$el}function t(e,t){e.on("contextmenu",function(e){e.preventDefault(),n.send(messageTypes.onOpenContextMenu.name,{x:e.pageX,y:e.pageY})})}var n=InfinniUI.global.messageBus;n.subscribe(messageTypes.onContextMenu.name,function(n,i){var o=i.value;t(e(o.source),o.content)})}();var MessageBox=Backbone.View.extend({tagName:"div",className:"modal fade messagebox",UI:{firstfocuselementinmodal:".firstfocuselementinmodal",lastfocuselementinmodal:".lastfocuselementinmodal"},events:{"click .btn":"onClickButtonHandler","focusin .lastfocuselementinmodal":"onFocusinLastElement",keydown:"onKeydownHandler"},template:InfinniUI.Template["services/messageBox/template/default.tpl.html"],initialize:function(e){this.setOptions(e),$(document.activeElement).blur(),this.render(),this.bindUIElements(),this.$el.modal({show:!0})},setOptions:function(e){this.options=this.applyDefaultOptions(e)},onFocusinLastElement:function(){this.ui.firstfocuselementinmodal.focus()},onKeydownHandler:function(e){document.activeElement===this.ui.lastfocuselementinmodal[0]&&9==(e.which||e.keyCode)&&(e.preventDefault(),this.ui.firstfocuselementinmodal.focus()),document.activeElement===this.ui.firstfocuselementinmodal[0]&&9==(e.which||e.keyCode)&&e.shiftKey&&(e.preventDefault(),this.ui.lastfocuselementinmodal.focus())},render:function(){var e=this.options.$parent||$("body"),t=this.template(this.options);return this.$el.html(t),this.subscribeToDialog(),e.append(this.$el),this},subscribeToDialog:function(){var e=this;this.$el.on("shown.bs.modal",function(t){e.ui.firstfocuselementinmodal.focus()}),this.$el.on("hidden.bs.modal",function(){e.remove()})},onClickButtonHandler:function(e){e.preventDefault();var t=$(e.target),n=parseInt(t.data("index"),10),i=this.options.buttons[n].onClick;i&&i.apply(null),this.close()},close:function(){"function"==typeof this.options.onClose&&this.options.onClose.call(null),this.$el.modal("hide")},applyDefaultOptions:function(e){var t=_.defaults({},e,{type:"default",buttons:[]});return this.applyDefaultButtonsOptions(t),t},applyDefaultButtonsOptions:function(e){return e.buttons.filter(function(e){return"undefined"==typeof e.type}).forEach(function(e){e.type="default"}),e}});_.extend(MessageBox.prototype,bindUIElementsMixin),InfinniUI.MessageBox=MessageBox,InfinniUI.config.routes&&(InfinniUI.routerService=new RouterService(InfinniUI.config.routes)),InfinniUI.ToolTipService=function(){function e(e,t){var n=i(t),o=n.control.controlView.$el;o.tooltip("destroy")}function t(e,t){var l=i(t),s=n(t),u=l.control.controlView.$el,c={html:!0,title:function(){return s.render()},placement:o,container:r,trigger:a};u.tooltip(c)}function n(e){return e.value.content}function i(e){return e.value.element}var o="auto top",r="body",a="hover",l=InfinniUI.global.messageBus;l.subscribe(messageTypes.onToolTipInit.name,t),l.subscribe(messageTypes.onToolTipDestroy.name,e)}(),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.tooltip"),r="object"==typeof t&&t;!o&&/destroy|hide/.test(t)||(o||i.data("bs.tooltip",o=new n(this,r)),"string"==typeof t&&o[t]())})}var n=function(e,t){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",e,t)};n.VERSION="3.3.5",n.TRANSITION_DURATION=150,n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(t,n,i){if(this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&e(e.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),r=o.length;r--;){var a=o[r];if("click"==a)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=a){var l="hover"==a?"mouseenter":"focusin",s="hover"==a?"mouseleave":"focusout";this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},n.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,i){n[e]!=i&&(t[e]=i)}),t},n.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),t instanceof e.Event&&(n.inState["focusin"==t.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState?void(n.hoverState="in"):(clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show())},n.prototype.isInStateTrue=function(){for(var e in this.inState)if(this.inState[e])return!0;return!1},n.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),t instanceof e.Event&&(n.inState["focusout"==t.type?"focus":"hover"]=!1),!n.isInStateTrue())return clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide()},n.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var i=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!i)return;var o=this,r=this.tip(),a=this.getUID(this.type);this.setContent(),r.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&r.addClass("fade");var l="function"==typeof this.options.placement?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,s=/\s?auto?\s?/i,u=s.test(l);u&&(l=l.replace(s,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(l).data("bs."+this.type,this),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var c=this.getPosition(),d=r[0].offsetWidth,p=r[0].offsetHeight;if(u){var h=l,f=this.getPosition(this.$viewport);l="bottom"==l&&c.bottom+p>f.bottom?"top":"top"==l&&c.top-p<f.top?"bottom":"right"==l&&c.right+d>f.width?"left":"left"==l&&c.left-d<f.left?"right":l,r.removeClass(h).addClass(l)}var m=this.getCalculatedOffset(l,c,d,p);this.applyPlacement(m,l);var g=function(){var e=o.hoverState;o.$element.trigger("shown.bs."+o.type),o.hoverState=null,"out"==e&&o.leave(o)};e.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",g).emulateTransitionEnd(n.TRANSITION_DURATION):g()}},n.prototype.applyPlacement=function(t,n){var i=this.tip(),o=i[0].offsetWidth,r=i[0].offsetHeight,a=parseInt(i.css("margin-top"),10),l=parseInt(i.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(l)&&(l=0),t.top+=a,t.left+=l,e.offset.setOffset(i[0],e.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),i.addClass("in");var s=i[0].offsetWidth,u=i[0].offsetHeight;"top"==n&&u!=r&&(t.top=t.top+r-u);var c=this.getViewportAdjustedDelta(n,t,s,u);c.left?t.left+=c.left:t.top+=c.top;var d=/top|bottom/.test(n),p=d?2*c.left-o+s:2*c.top-r+u,h=d?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(p,i[0][h],d)},n.prototype.replaceArrow=function(e,t,n){this.arrow().css(n?"left":"top",50*(1-e/t)+"%").css(n?"top":"left","")},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},n.prototype.hide=function(t){function i(){"in"!=o.hoverState&&r.detach(),o.$element.removeAttr("aria-describedby").trigger("hidden.bs."+o.type),t&&t()}var o=this,r=e(this.$tip),a=e.Event("hide.bs."+this.type);if(this.$element.trigger(a),!a.isDefaultPrevented())return r.removeClass("in"),e.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",i).emulateTransitionEnd(n.TRANSITION_DURATION):i(),this.hoverState=null,this},n.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(t){t=t||this.$element;var n=t[0],i="BODY"==n.tagName,o=n.getBoundingClientRect();null==o.width&&(o=e.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var r=i?{top:0,left:0}:t.offset(),a={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},l=i?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},o,a,l,r)},n.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},n.prototype.getViewportAdjustedDelta=function(e,t,n,i){var o={top:0,left:0};if(!this.$viewport)return o;var r=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(e)){var l=t.top-r-a.scroll,s=t.top+r-a.scroll+i;l<a.top?o.top=a.top-l:s>a.top+a.height&&(o.top=a.top+a.height-s)}else{var u=t.left-r,c=t.left+r+n;u<a.left?o.left=a.left-u:c>a.right&&(o.left=a.left+a.width-c)}return o},n.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},n.prototype.getUID=function(e){do e+=~~(1e6*Math.random());while(document.getElementById(e));return e},n.prototype.tip=function(){if(!this.$tip&&(this.$tip=e(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(t){var n=this;t&&(n=e(t.currentTarget).data("bs."+this.type),n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),t?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type),e.$tip&&e.$tip.detach(),e.$tip=null,e.$arrow=null,e.$viewport=null})};var i=e.fn.tooltip;e.fn.tooltip=t,e.fn.tooltip.Constructor=n,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),o=n.data("bs.alert");o||n.data("bs.alert",o=new i(this)),"string"==typeof t&&o[t].call(n)})}var n='[data-dismiss="alert"]',i=function(t){e(t).on("click",n,this.close)};i.VERSION="3.3.5",i.TRANSITION_DURATION=150,i.prototype.close=function(t){function n(){a.detach().trigger("closed.bs.alert").remove()}var o=e(this),r=o.attr("data-target");r||(r=o.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var a=e(r);t&&t.preventDefault(),a.length||(a=o.closest(".alert")),a.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(a.removeClass("in"),e.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n())};var o=e.fn.alert;e.fn.alert=t,e.fn.alert.Constructor=i,e.fn.alert.noConflict=function(){return e.fn.alert=o,this},e(document).on("click.bs.alert.data-api",n,i.prototype.close)}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.button"),r="object"==typeof t&&t;o||i.data("bs.button",o=new n(this,r)),"toggle"==t?o.toggle():t&&o.setState(t)})}var n=function(t,i){this.$element=e(t),this.options=e.extend({},n.DEFAULTS,i),this.isLoading=!1};n.VERSION="3.3.5",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(t){var n="disabled",i=this.$element,o=i.is("input")?"val":"html",r=i.data();t+="Text",null==r.resetText&&i.data("resetText",i[o]()),setTimeout(e.proxy(function(){i[o](null==r[t]?this.options[t]:r[t]),"loadingText"==t?(this.isLoading=!0,i.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,i.removeClass(n).removeAttr(n))},this),0)},n.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var n=this.$element.find("input");"radio"==n.prop("type")?(n.prop("checked")&&(e=!1),t.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==n.prop("type")&&(n.prop("checked")!==this.$element.hasClass("active")&&(e=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),e&&n.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var i=e.fn.button;e.fn.button=t,e.fn.button.Constructor=n,e.fn.button.noConflict=function(){return e.fn.button=i,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(n){var i=e(n.target);i.hasClass("btn")||(i=i.closest(".btn")),t.call(i,"toggle"),e(n.target).is('input[type="radio"]')||e(n.target).is('input[type="checkbox"]')||n.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){e(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),+function(e){"use strict";function t(t){var n,i=t.attr("data-target")||(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return e(i)}function n(t){return this.each(function(){var n=e(this),o=n.data("bs.collapse"),r=e.extend({},i.DEFAULTS,n.data(),"object"==typeof t&&t);!o&&r.toggle&&/show|hide/.test(t)&&(r.toggle=!1),o||n.data("bs.collapse",o=new i(this,r)),"string"==typeof t&&o[t]()})}var i=function(t,n){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,n),this.$trigger=e('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};i.VERSION="3.3.5",i.TRANSITION_DURATION=350,i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t,o=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(o&&o.length&&(t=o.data("bs.collapse"),t&&t.transitioning))){var r=e.Event("show.bs.collapse");if(this.$element.trigger(r),!r.isDefaultPrevented()){o&&o.length&&(n.call(o,"hide"),t||o.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var l=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return l.call(this);var s=e.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",e.proxy(l,this)).emulateTransitionEnd(i.TRANSITION_DURATION)[a](this.$element[0][s])}}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var o=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return e.support.transition?void this.$element[n](0).one("bsTransitionEnd",e.proxy(o,this)).emulateTransitionEnd(i.TRANSITION_DURATION):o.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},i.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(n,i){var o=e(i);this.addAriaAndCollapsedClass(t(o),o)},this)).end()},i.prototype.addAriaAndCollapsedClass=function(e,t){var n=e.hasClass("in");e.attr("aria-expanded",n),t.toggleClass("collapsed",!n).attr("aria-expanded",n)};var o=e.fn.collapse;e.fn.collapse=n,e.fn.collapse.Constructor=i,e.fn.collapse.noConflict=function(){return e.fn.collapse=o,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var o=e(this);o.attr("data-target")||i.preventDefault();var r=t(o),a=r.data("bs.collapse"),l=a?"toggle":o.data();n.call(r,l)})}(jQuery),+function(e){"use strict";function t(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&e(n);return i&&i.length?i:t.parent()}function n(n){n&&3===n.which||(e(o).remove(),e(r).each(function(){var i=e(this),o=t(i),r={relatedTarget:this};o.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&e.contains(o[0],n.target)||(o.trigger(n=e.Event("hide.bs.dropdown",r)),n.isDefaultPrevented()||(i.attr("aria-expanded","false"),o.removeClass("open").trigger("hidden.bs.dropdown",r))))}))}function i(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new a(this)),"string"==typeof t&&i[t].call(n)})}var o=".dropdown-backdrop",r='[data-toggle="dropdown"]',a=function(t){e(t).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.5",a.prototype.toggle=function(i){var o=e(this);if(!o.is(".disabled, :disabled")){var r=t(o),a=r.hasClass("open");if(n(),!a){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click",n);var l={relatedTarget:this};if(r.trigger(i=e.Event("show.bs.dropdown",l)),i.isDefaultPrevented())return;o.trigger("focus").attr("aria-expanded","true"),r.toggleClass("open").trigger("shown.bs.dropdown",l)}return!1}},a.prototype.keydown=function(n){if(/(38|40|27|32)/.test(n.which)&&!/input|textarea/i.test(n.target.tagName)){var i=e(this);if(n.preventDefault(),n.stopPropagation(),!i.is(".disabled, :disabled")){var o=t(i),a=o.hasClass("open");if(!a&&27!=n.which||a&&27==n.which)return 27==n.which&&o.find(r).trigger("focus"),i.trigger("click");var l=" li:not(.disabled):visible a",s=o.find(".dropdown-menu"+l);if(s.length){var u=s.index(n.target);38==n.which&&u>0&&u--,40==n.which&&u<s.length-1&&u++,~u||(u=0),s.eq(u).trigger("focus")}}}};var l=e.fn.dropdown;e.fn.dropdown=i,e.fn.dropdown.Constructor=a,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=l,this},e(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",r,a.prototype.toggle).on("keydown.bs.dropdown.data-api",r,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery),+function(e){"use strict";function t(t,n){return this.each(function(){var i=e(this),r=i.data("bs.modal"),a=e.extend({},o.DEFAULTS,i.data(),"object"==typeof t&&t);r||i.data("bs.modal",r=new o(this,a)),"string"==typeof t?r[t](n):a.show&&r.show(n)})}var n=0,i=!1,o=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};o.ALLOWED_CONTROL_CLASSES=["pl-combobox-filter-text"],o.VERSION="3.3.5",o.TRANSITION_DURATION=300,o.BACKDROP_TRANSITION_DURATION=150,o.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},o.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},o.prototype.show=function(t){var n=this,i=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){n.$element.one("mouseup.dismiss.bs.modal",function(t){e(t.target).is(n.$element)&&(n.ignoreBackdropClick=!0)})}),this.backdrop(function(){var i=e.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),n.adjustDialog(),i&&n.$element[0].offsetWidth,n.$element.addClass("in"),n.enforceFocus();var r=e.Event("shown.bs.modal",{relatedTarget:t});i?n.$dialog.one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(r)}).emulateTransitionEnd(o.TRANSITION_DURATION):n.$element.trigger("focus").trigger(r)}))},o.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(o.TRANSITION_DURATION):this.hideModal())},o.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(t){if(this.$element[0]!==t.target&&!this.$element.has(t.target).length){var n=e(t.target),i=o.ALLOWED_CONTROL_CLASSES.some(function(e){return n.hasClass(e)});i||this.$element.trigger("focus")}},this))},o.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},o.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},o.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},o.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},o.prototype.backdrop=function(t){var n=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=e.support.transition&&i;if(this.$backdrop=e(document.createElement("div")).addClass("modal-backdrop "+i).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;r?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(o.BACKDROP_TRANSITION_DURATION):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){n.removeBackdrop(),t&&t()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(o.BACKDROP_TRANSITION_DURATION):a()}else t&&t()},o.prototype.handleUpdate=function(){this.adjustDialog()},o.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},o.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},o.prototype.checkScrollbar=function(){var e=window.innerWidth;if(!e){var t=document.documentElement.getBoundingClientRect();e=t.right-Math.abs(t.left)}this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},o.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},o.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},o.prototype.measureScrollbar=function(){return i===!1&&(i=!0,n=this._measureScrollbar()),n},o.prototype._measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var r=e.fn.modal;e.fn.modal=t,e.fn.modal.Constructor=o,e.fn.modal.noConflict=function(){return e.fn.modal=r,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var i=e(this),o=i.attr("href"),r=e(i.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),a=r.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(o)&&o
},r.data(),i.data());i.is("a")&&n.preventDefault(),r.one("show.bs.modal",function(e){e.isDefaultPrevented()||r.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),t.call(r,a,this)})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.popover"),r="object"==typeof t&&t;!o&&/destroy|hide/.test(t)||(o||i.data("bs.popover",o=new n(this,r)),"string"==typeof t&&o[t]())})}var n=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.3.5",n.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var i=e.fn.popover;e.fn.popover=t,e.fn.popover.Constructor=n,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(jQuery),+function(e){"use strict";function t(n,i){this.$body=e(document.body),this.$scrollElement=e(e(n).is(document.body)?window:n),this.options=e.extend({},t.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",e.proxy(this.process,this)),this.refresh(),this.process()}function n(n){return this.each(function(){var i=e(this),o=i.data("bs.scrollspy"),r="object"==typeof n&&n;o||i.data("bs.scrollspy",o=new t(this,r)),"string"==typeof n&&o[n]()})}t.VERSION="3.3.5",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t=this,n="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),e.isWindow(this.$scrollElement[0])||(n="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=e(this),o=t.data("target")||t.attr("href"),r=/^#./.test(o)&&e(o);return r&&r.length&&r.is(":visible")&&[[r[n]().top+i,o]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),i=this.options.offset+n-this.$scrollElement.height(),o=this.offsets,r=this.targets,a=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),t>=i)return a!=(e=r[r.length-1])&&this.activate(e);if(a&&t<o[0])return this.activeTarget=null,this.clear();for(e=o.length;e--;)a!=r[e]&&t>=o[e]&&(void 0===o[e+1]||t<o[e+1])&&this.activate(r[e])},t.prototype.activate=function(t){this.activeTarget=t,this.clear();var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=e(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},t.prototype.clear=function(){e(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var i=e.fn.scrollspy;e.fn.scrollspy=n,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=i,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);n.call(t,t.data())})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.tab");o||i.data("bs.tab",o=new n(this)),"string"==typeof t&&o[t]()})}var n=function(t){this.element=e(t)};n.VERSION="3.3.5",n.TRANSITION_DURATION=150,n.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),i=t.data("target");if(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var o=n.find(".active:last a"),r=e.Event("hide.bs.tab",{relatedTarget:t[0]}),a=e.Event("show.bs.tab",{relatedTarget:o[0]});if(o.trigger(r),t.trigger(a),!a.isDefaultPrevented()&&!r.isDefaultPrevented()){var l=e(i);this.activate(t.closest("li"),n),this.activate(l,l.parent(),function(){o.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:o[0]})})}}},n.prototype.activate=function(t,i,o){function r(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),l?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu").length&&t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),o&&o()}var a=i.find("> .active"),l=o&&e.support.transition&&(a.length&&a.hasClass("fade")||!!i.find("> .fade").length);a.length&&l?a.one("bsTransitionEnd",r).emulateTransitionEnd(n.TRANSITION_DURATION):r(),a.removeClass("in")};var i=e.fn.tab;e.fn.tab=t,e.fn.tab.Constructor=n,e.fn.tab.noConflict=function(){return e.fn.tab=i,this};var o=function(n){n.preventDefault(),t.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',o).on("click.bs.tab.data-api",'[data-toggle="pill"]',o)}(jQuery),+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,i=this;e(this).one("bsTransitionEnd",function(){n=!0});var o=function(){n||e(i).trigger(e.support.transition.end)};return setTimeout(o,t),this},e(function(){e.support.transition=t(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery)}();